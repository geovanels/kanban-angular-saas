import{a as _i,c as bi,d as vi,f as Et,g as xi,h as wi,i as Si}from"./chunk-TB5PERY5.js";import{a as $}from"./chunk-J5JVRSLK.js";import{c as hi,e as fi}from"./chunk-BZPYHLGH.js";import{a as ae}from"./chunk-HLLJH4E5.js";import"./chunk-KJIKDUO6.js";import{B as H,C as j,D as U,a as yi,b as K,c as k,e as W,f as N,h as Ci,m as nt,n as z,o as Se,r as B,s as Z,t as pe,u as oe,w as re,x as ot}from"./chunk-CXGKOLI5.js";import"./chunk-3VCHQSRR.js";import{$ as Ke,$b as li,Aa as Ce,Ab as a,Ac as L,Bb as p,Bc as R,Ca as Jt,Cc as ui,Dc as pi,Ea as ei,Eb as ni,F as Wt,Fb as oi,G as qe,Gc as it,H as Zt,Hb as w,I as xt,Ib as h,Ic as F,Jb as u,Mb as Y,Mc as gi,N as Qt,Nb as X,Ob as J,Pb as ri,Qb as ee,Ra as We,Rb as P,Sa as ti,Sb as ie,Ta as d,Tb as l,U as Ge,Ub as E,V as yt,Vb as x,W as xe,Wb as ai,X as Yt,Xa as we,Xb as si,Yb as ce,Za as Ze,Zb as me,_ as O,_a as Ct,_b as ue,a as le,ac as di,b as $e,ba as de,bb as T,bc as Xe,cb as Qe,cc as ne,da as v,db as Ye,ec as Je,f as M,fc as et,g as fe,gb as b,ha as Xt,i as Ie,ja as f,jb as S,ka as _,kb as be,l as I,lb as wt,m as qt,na as Te,oa as _e,p as vt,pb as St,qb as ii,qc as tt,sc as ve,ta as ye,tc as ci,uc as mi,v as Gt,ya as ke,yb as c,z as Kt,zb as r}from"./chunk-CM3JQ4U2.js";var Mt;function ln(){if(Mt==null){let o=typeof document<"u"?document.head:null;Mt=!!(o&&(o.createShadowRoot||o.attachShadow))}return Mt}function rt(o){if(ln()){let t=o.getRootNode?o.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&t instanceof ShadowRoot)return t}return null}function Fe(o){return o.composedPath?o.composedPath()[0]:o.target}function Ei(o){return o.buttons===0||o.detail===0}function Mi(o){let t=o.touches&&o.touches[0]||o.changedTouches&&o.changedTouches[0];return!!t&&t.identifier===-1&&(t.radiusX==null||t.radiusX===1)&&(t.radiusY==null||t.radiusY===1)}function at(o,t=0){return dn(o)?Number(o):arguments.length===2?t:0}function dn(o){return!isNaN(parseFloat(o))&&!isNaN(Number(o))}function te(o){return o instanceof Ce?o.nativeElement:o}var st=new WeakMap,Di=(()=>{class o{_appRef;_injector=v(Te);_environmentInjector=v(Xt);load(e){let i=this._appRef=this._appRef||this._injector.get(St),n=st.get(i);n||(n={loaders:new Set,refs:[]},st.set(i,n),i.onDestroy(()=>{st.get(i)?.refs.forEach(s=>s.destroy()),st.delete(i)})),n.loaders.has(e)||(n.loaders.add(e),n.refs.push(mi(e,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(i){return new(i||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var Dt;try{Dt=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Dt=!1}var Pt=(()=>{class o{_platformId=v(ei);isBrowser=this._platformId?gi(this._platformId):typeof document=="object"&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!!(window.chrome||Dt)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(i){return new(i||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var cn=new de("cdk-dir-doc",{providedIn:"root",factory:mn});function mn(){return v(_e)}var un=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;function pn(o){let t=o?.toLowerCase()||"";return t==="auto"&&typeof navigator<"u"&&navigator?.language?un.test(navigator.language)?"rtl":"ltr":t==="rtl"?"rtl":"ltr"}var It=(()=>{class o{get value(){return this.valueSignal()}valueSignal=ye("ltr");change=new S;constructor(){let e=v(cn,{optional:!0});if(e){let i=e.body?e.body.dir:null,n=e.documentElement?e.documentElement.dir:null;this.valueSignal.set(pn(i||n||"ltr"))}}ngOnDestroy(){this.change.complete()}static \u0275fac=function(i){return new(i||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var hn=20,Pi=(()=>{class o{_ngZone=v(be);_platform=v(Pt);_renderer=v(we).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new I;_scrolledCount=0;scrollContainers=new Map;register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){let i=this.scrollContainers.get(e);i&&(i.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=hn){return this._platform.isBrowser?new Ie(i=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let n=e>0?this._scrolled.pipe(xt(e)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{n.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):Gt()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((e,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(e,i){let n=this.getAncestorScrollContainers(e);return this.scrolled(i).pipe(Zt(s=>!s||n.indexOf(s)>-1))}getAncestorScrollContainers(e){let i=[];return this.scrollContainers.forEach((n,s)=>{this._scrollableContainsElement(s,e)&&i.push(s)}),i}_scrollableContainsElement(e,i){let n=te(i),s=e.getElementRef().nativeElement;do if(n==s)return!0;while(n=n.parentElement);return!1}static \u0275fac=function(i){return new(i||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var fn=20,Ii=(()=>{class o{_platform=v(Pt);_listeners;_viewportSize;_change=new I;_document=v(_e);constructor(){let e=v(be),i=v(we).createRenderer(null,null);e.runOutsideAngular(()=>{if(this._platform.isBrowser){let n=s=>this._change.next(s);this._listeners=[i.listen("window","resize",n),i.listen("window","orientationchange",n)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(e=>e()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){let e=this.getViewportScrollPosition(),{width:i,height:n}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+n,right:e.left+i,height:n,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let e=this._document,i=this._getWindow(),n=e.documentElement,s=n.getBoundingClientRect(),m=-s.top||e.body.scrollTop||i.scrollY||n.scrollTop||0,g=-s.left||e.body.scrollLeft||i.scrollX||n.scrollLeft||0;return{top:m,left:g}}change(e=fn){return e>0?this._change.pipe(xt(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static \u0275fac=function(i){return new(i||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var Ti=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=Qe({type:o});static \u0275inj=Ke({})}return o})();var Tt={},ki=(()=>{class o{_appId=v(Jt);getId(e){return this._appId!=="ng"&&(e+=this._appId),Tt.hasOwnProperty(e)||(Tt[e]=0),`${e}${Tt[e]++}`}static \u0275fac=function(i){return new(i||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function Fi(o){return Array.isArray(o)?o:[o]}function Ot(o){let t=o.cloneNode(!0),e=t.querySelectorAll("[id]"),i=o.nodeName.toLowerCase();t.removeAttribute("id");for(let n=0;n<e.length;n++)e[n].removeAttribute("id");return i==="canvas"?Ri(o,t):(i==="input"||i==="select"||i==="textarea")&&Li(o,t),Oi("canvas",o,t,Ri),Oi("input, textarea, select",o,t,Li),t}function Oi(o,t,e,i){let n=t.querySelectorAll(o);if(n.length){let s=e.querySelectorAll(o);for(let m=0;m<n.length;m++)i(n[m],s[m])}}var _n=0;function Li(o,t){t.type!=="file"&&(t.value=o.value),t.type==="radio"&&t.name&&(t.name=`mat-clone-${t.name}-${_n++}`)}function Ri(o,t){let e=t.getContext("2d");if(e)try{e.drawImage(o,0,0)}catch{}}function zt(o){let t=o.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:t.width,height:t.height,x:t.x,y:t.y}}function Lt(o,t,e){let{top:i,bottom:n,left:s,right:m}=o;return e>=i&&e<=n&&t>=s&&t<=m}function bn(o,t){let e=t.left<o.left,i=t.left+t.width>o.right,n=t.top<o.top,s=t.top+t.height>o.bottom;return e||i||n||s}function Re(o,t,e){o.top+=t,o.bottom=o.top+o.height,o.left+=e,o.right=o.left+o.width}function Ai(o,t,e,i){let{top:n,right:s,bottom:m,left:g,width:y,height:C}=o,D=y*t,q=C*t;return i>n-q&&i<m+q&&e>g-D&&e<s+D}var lt=class{_document;positions=new Map;constructor(t){this._document=t}clear(){this.positions.clear()}cache(t){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),t.forEach(e=>{this.positions.set(e,{scrollPosition:{top:e.scrollTop,left:e.scrollLeft},clientRect:zt(e)})})}handleScroll(t){let e=Fe(t),i=this.positions.get(e);if(!i)return null;let n=i.scrollPosition,s,m;if(e===this._document){let C=this.getViewportScrollPosition();s=C.top,m=C.left}else s=e.scrollTop,m=e.scrollLeft;let g=n.top-s,y=n.left-m;return this.positions.forEach((C,D)=>{C.clientRect&&e!==D&&e.contains(D)&&Re(C.clientRect,g,y)}),n.top=s,n.left=m,{top:g,left:y}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}};function Wi(o,t){let e=o.rootNodes;if(e.length===1&&e[0].nodeType===t.ELEMENT_NODE)return e[0];let i=t.createElement("div");return e.forEach(n=>i.appendChild(n)),i}function Bt(o,t,e){for(let i in t)if(t.hasOwnProperty(i)){let n=t[i];n?o.setProperty(i,n,e?.has(i)?"important":""):o.removeProperty(i)}return o}function Ee(o,t){let e=t?"":"none";Bt(o.style,{"touch-action":t?"":"none","-webkit-user-drag":t?"":"none","-webkit-tap-highlight-color":t?"":"transparent","user-select":e,"-ms-user-select":e,"-webkit-user-select":e,"-moz-user-select":e})}function Vi(o,t,e){Bt(o.style,{position:t?"":"fixed",top:t?"":"0",opacity:t?"":"0",left:t?"":"-999em"},e)}function dt(o,t){return t&&t!="none"?o+" "+t:o}function Ni(o,t){o.style.width=`${t.width}px`,o.style.height=`${t.height}px`,o.style.transform=Ae(t.left,t.top)}function Ae(o,t){return`translate3d(${Math.round(o)}px, ${Math.round(t)}px, 0)`}function zi(o){let t=o.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(o)*t}function vn(o){let t=getComputedStyle(o),e=kt(t,"transition-property"),i=e.find(g=>g==="transform"||g==="all");if(!i)return 0;let n=e.indexOf(i),s=kt(t,"transition-duration"),m=kt(t,"transition-delay");return zi(s[n])+zi(m[n])}function kt(o,t){return o.getPropertyValue(t).split(",").map(i=>i.trim())}var xn=new Set(["position"]),Rt=class{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(t,e,i,n,s,m,g,y,C,D){this._document=t,this._rootElement=e,this._direction=i,this._initialDomRect=n,this._previewTemplate=s,this._previewClass=m,this._pickupPositionOnPage=g,this._initialTransform=y,this._zIndex=C,this._renderer=D}attach(t){this._preview=this._createPreview(),t.appendChild(this._preview),Bi(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(t){this._preview.style.transform=t}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(t){this._preview.classList.add(t)}getTransitionDuration(){return vn(this._preview)}addEventListener(t,e){return this._renderer.listen(this._preview,t,e)}_createPreview(){let t=this._previewTemplate,e=this._previewClass,i=t?t.template:null,n;if(i&&t){let s=t.matchSize?this._initialDomRect:null,m=t.viewContainer.createEmbeddedView(i,t.context);m.detectChanges(),n=Wi(m,this._document),this._previewEmbeddedView=m,t.matchSize?Ni(n,s):n.style.transform=Ae(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else n=Ot(this._rootElement),Ni(n,this._initialDomRect),this._initialTransform&&(n.style.transform=this._initialTransform);return Bt(n.style,{"pointer-events":"none",margin:Bi(n)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},xn),Ee(n,!1),n.classList.add("cdk-drag-preview"),n.setAttribute("popover","manual"),n.setAttribute("dir",this._direction),e&&(Array.isArray(e)?e.forEach(s=>n.classList.add(s)):n.classList.add(e)),n}};function Bi(o){return"showPopover"in o}var yn={passive:!0},Hi={passive:!1},Cn={passive:!1,capture:!0},wn=800,ji="cdk-drag-placeholder",Ui=new Set(["position"]),At=class{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_rootElementCleanups;_cleanupShadowRootSelectStart;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_marker;_anchor=null;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=ye(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new I;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=fe.EMPTY;_pointerUpSubscription=fe.EMPTY;_scrollSubscription=fe.EMPTY;_resizeSubscription=fe.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!!(this._dropContainer&&this._dropContainer.disabled)}set disabled(t){t!==this._disabled&&(this._disabled=t,this._toggleNativeDragInteractions(),this._handles.forEach(e=>Ee(e,t)))}_disabled=!1;beforeStarted=new I;started=new I;released=new I;ended=new I;entered=new I;exited=new I;dropped=new I;moved=this._moveEvents;data;constrainPosition;constructor(t,e,i,n,s,m,g){this._config=e,this._document=i,this._ngZone=n,this._viewportRuler=s,this._dragDropRegistry=m,this._renderer=g,this.withRootElement(t).withParent(e.parentDragRef||null),this._parentPositions=new lt(i),m.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(t){this._handles=t.map(i=>te(i)),this._handles.forEach(i=>Ee(i,this.disabled)),this._toggleNativeDragInteractions();let e=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&e.add(i)}),this._disabledHandles=e,this}withPreviewTemplate(t){return this._previewTemplate=t,this}withPlaceholderTemplate(t){return this._placeholderTemplate=t,this}withRootElement(t){let e=te(t);if(e!==this._rootElement){this._removeRootElementListeners();let i=this._renderer;this._rootElementCleanups=this._ngZone.runOutsideAngular(()=>[i.listen(e,"mousedown",this._pointerDown,Hi),i.listen(e,"touchstart",this._pointerDown,yn),i.listen(e,"dragstart",this._nativeDragStart,Hi)]),this._initialTransform=void 0,this._rootElement=e}return typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(t){return this._boundaryElement=t?te(t):null,this._resizeSubscription.unsubscribe(),t&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(t){return this._parentDragRef=t,this}dispose(){this._removeRootElementListeners(),this.isDragging()&&this._rootElement?.remove(),this._marker?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._marker=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}resetToBoundary(){if(this._boundaryElement&&this._rootElement&&bn(this._boundaryElement.getBoundingClientRect(),this._rootElement.getBoundingClientRect())){let t=this._boundaryElement.getBoundingClientRect(),e=this._rootElement.getBoundingClientRect(),i=0,n=0;e.left<t.left?i=t.left-e.left:e.right>t.right&&(i=t.right-e.right),e.top<t.top?n=t.top-e.top:e.bottom>t.bottom&&(n=t.bottom-e.bottom);let s=this._activeTransform.x,m=this._activeTransform.y,g=s+i,y=m+n;this._rootElement.style.transform=Ae(g,y),this._activeTransform={x:g,y},this._passiveTransform={x:g,y}}}disableHandle(t){!this._disabledHandles.has(t)&&this._handles.indexOf(t)>-1&&(this._disabledHandles.add(t),Ee(t,!0))}enableHandle(t){this._disabledHandles.has(t)&&(this._disabledHandles.delete(t),Ee(t,this.disabled))}withDirection(t){return this._direction=t,this}_withDropContainer(t){this._dropContainer=t}getFreeDragPosition(){let t=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:t.x,y:t.y}}setFreeDragPosition(t){return this._activeTransform={x:0,y:0},this._passiveTransform.x=t.x,this._passiveTransform.y=t.y,this._dropContainer||this._applyRootElementTransform(t.x,t.y),this}withPreviewContainer(t){return this._previewContainer=t,this}_sortFromLastPointerPosition(){let t=this._lastKnownPointerPosition;t&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(t),t)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._cleanupShadowRootSelectStart?.(),this._cleanupShadowRootSelectStart=void 0}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._anchor?.remove(),this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._anchor=this._placeholderRef=null}_pointerDown=t=>{if(this.beforeStarted.next(),this._handles.length){let e=this._getTargetHandle(t);e&&!this._disabledHandles.has(e)&&!this.disabled&&this._initializeDragSequence(e,t)}else this.disabled||this._initializeDragSequence(this._rootElement,t)};_pointerMove=t=>{let e=this._getPointerPositionOnPage(t);if(!this._hasStartedDragging()){let n=Math.abs(e.x-this._pickupPositionOnPage.x),s=Math.abs(e.y-this._pickupPositionOnPage.y);if(n+s>=this._config.dragStartThreshold){let g=Date.now()>=this._dragStartTime+this._getDragStartDelay(t),y=this._dropContainer;if(!g){this._endDragSequence(t);return}(!y||!y.isDragging()&&!y.isReceiving())&&(t.cancelable&&t.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(t)))}return}t.cancelable&&t.preventDefault();let i=this._getConstrainedPointerPosition(e);if(this._hasMoved=!0,this._lastKnownPointerPosition=e,this._updatePointerDirectionDelta(i),this._dropContainer)this._updateActiveDropContainer(i,e);else{let n=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,s=this._activeTransform;s.x=i.x-n.x+this._passiveTransform.x,s.y=i.y-n.y+this._passiveTransform.y,this._applyRootElementTransform(s.x,s.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:i,event:t,distance:this._getDragDistance(i),delta:this._pointerDirectionDelta})})};_pointerUp=t=>{this._endDragSequence(t)};_endDragSequence(t){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),!!this._hasStartedDragging()))if(this.released.next({source:this,event:t}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(t),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;let e=this._getPointerPositionOnPage(t);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(e),dropPoint:e,event:t})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(t){Oe(t)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();let e=this._getShadowRoot(),i=this._dropContainer;if(e&&this._ngZone.runOutsideAngular(()=>{this._cleanupShadowRootSelectStart=this._renderer.listen(e,"selectstart",Sn,Cn)}),i){let n=this._rootElement,s=n.parentNode,m=this._placeholder=this._createPlaceholderElement(),g=this._marker=this._marker||this._document.createComment("");s.insertBefore(g,n),this._initialTransform=n.style.transform||"",this._preview=new Rt(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(s,e)),Vi(n,!1,Ui),this._document.body.appendChild(s.replaceChild(m,n)),this.started.next({source:this,event:t}),i.start(),this._initialContainer=i,this._initialIndex=i.getItemIndex(this)}else this.started.next({source:this,event:t}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(i?i.getScrollableParents():[])}_initializeDragSequence(t,e){this._parentDragRef&&e.stopPropagation();let i=this.isDragging(),n=Oe(e),s=!n&&e.button!==0,m=this._rootElement,g=Fe(e),y=!n&&this._lastTouchEventTime&&this._lastTouchEventTime+wn>Date.now(),C=n?Mi(e):Ei(e);if(g&&g.draggable&&e.type==="mousedown"&&e.preventDefault(),i||s||y||C)return;if(this._handles.length){let se=m.style;this._rootElementTapHighlight=se.webkitTapHighlightColor||"",se.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(se=>this._updateOnScroll(se)),this._boundaryElement&&(this._boundaryRect=zt(this._boundaryElement));let D=this._previewTemplate;this._pickupPositionInElement=D&&D.template&&!D.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,t,e);let q=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(e);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:q.x,y:q.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,e)}_cleanupDragArtifacts(t){Vi(this._rootElement,!0,Ui),this._marker.parentNode.replaceChild(this._rootElement,this._marker),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{let e=this._dropContainer,i=e.getItemIndex(this),n=this._getPointerPositionOnPage(t),s=this._getDragDistance(n),m=e._isOverContainer(n.x,n.y);this.ended.next({source:this,distance:s,dropPoint:n,event:t}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:e,previousContainer:this._initialContainer,isPointerOverContainer:m,distance:s,dropPoint:n,event:t}),e.drop(this,i,this._initialIndex,this._initialContainer,m,s,n,t),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:t,y:e},{x:i,y:n}){let s=this._initialContainer._getSiblingContainerFromPosition(this,t,e);!s&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(t,e)&&(s=this._initialContainer),s&&s!==this._dropContainer&&this._ngZone.run(()=>{let m=this._dropContainer.getItemIndex(this),g=this._dropContainer.getItemAtIndex(m+1)?.getVisibleElement()||null;this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._conditionallyInsertAnchor(s,this._dropContainer,g),this._dropContainer=s,this._dropContainer.enter(this,t,e,s===this._initialContainer&&s.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:s,currentIndex:s.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,n),this._dropContainer._sortItem(this,t,e,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(t,e):this._applyPreviewTransform(t-this._pickupPositionInElement.x,e-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();let t=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(t.left,t.top);let e=this._preview.getTransitionDuration();return e===0?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{let n=g=>{(!g||this._preview&&Fe(g)===this._preview.element&&g.propertyName==="transform")&&(m(),i(),clearTimeout(s))},s=setTimeout(n,e*1.5),m=this._preview.addEventListener("transitionend",n)}))}_createPlaceholderElement(){let t=this._placeholderTemplate,e=t?t.template:null,i;return e?(this._placeholderRef=t.viewContainer.createEmbeddedView(e,t.context),this._placeholderRef.detectChanges(),i=Wi(this._placeholderRef,this._document)):i=Ot(this._rootElement),i.style.pointerEvents="none",i.classList.add(ji),i}_getPointerPositionInElement(t,e,i){let n=e===this._rootElement?null:e,s=n?n.getBoundingClientRect():t,m=Oe(i)?i.targetTouches[0]:i,g=this._getViewportScrollPosition(),y=m.pageX-s.left-g.left,C=m.pageY-s.top-g.top;return{x:s.left-t.left+y,y:s.top-t.top+C}}_getPointerPositionOnPage(t){let e=this._getViewportScrollPosition(),i=Oe(t)?t.touches[0]||t.changedTouches[0]||{pageX:0,pageY:0}:t,n=i.pageX-e.left,s=i.pageY-e.top;if(this._ownerSVGElement){let m=this._ownerSVGElement.getScreenCTM();if(m){let g=this._ownerSVGElement.createSVGPoint();return g.x=n,g.y=s,g.matrixTransform(m.inverse())}}return{x:n,y:s}}_getConstrainedPointerPosition(t){let e=this._dropContainer?this._dropContainer.lockAxis:null,{x:i,y:n}=this.constrainPosition?this.constrainPosition(t,this,this._initialDomRect,this._pickupPositionInElement):t;if(this.lockAxis==="x"||e==="x"?n=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):(this.lockAxis==="y"||e==="y")&&(i=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){let{x:s,y:m}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,g=this._boundaryRect,{width:y,height:C}=this._getPreviewRect(),D=g.top+m,q=g.bottom-(C-m),se=g.left+s,_t=g.right-(y-s);i=$i(i,se,_t),n=$i(n,D,q)}return{x:i,y:n}}_updatePointerDirectionDelta(t){let{x:e,y:i}=t,n=this._pointerDirectionDelta,s=this._pointerPositionAtLastDirectionChange,m=Math.abs(e-s.x),g=Math.abs(i-s.y);return m>this._config.pointerDirectionChangeThreshold&&(n.x=e>s.x?1:-1,s.x=e),g>this._config.pointerDirectionChangeThreshold&&(n.y=i>s.y?1:-1,s.y=i),n}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;let t=this._handles.length>0||!this.isDragging();t!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=t,Ee(this._rootElement,t))}_removeRootElementListeners(){this._rootElementCleanups?.forEach(t=>t()),this._rootElementCleanups=void 0}_applyRootElementTransform(t,e){let i=1/this.scale,n=Ae(t*i,e*i),s=this._rootElement.style;this._initialTransform==null&&(this._initialTransform=s.transform&&s.transform!="none"?s.transform:""),s.transform=dt(n,this._initialTransform)}_applyPreviewTransform(t,e){let i=this._previewTemplate?.template?void 0:this._initialTransform,n=Ae(t,e);this._preview.setTransform(dt(n,i))}_getDragDistance(t){let e=this._pickupPositionOnPage;return e?{x:t.x-e.x,y:t.y-e.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:t,y:e}=this._passiveTransform;if(t===0&&e===0||this.isDragging()||!this._boundaryElement)return;let i=this._rootElement.getBoundingClientRect(),n=this._boundaryElement.getBoundingClientRect();if(n.width===0&&n.height===0||i.width===0&&i.height===0)return;let s=n.left-i.left,m=i.right-n.right,g=n.top-i.top,y=i.bottom-n.bottom;n.width>i.width?(s>0&&(t+=s),m>0&&(t-=m)):t=0,n.height>i.height?(g>0&&(e+=g),y>0&&(e-=y)):e=0,(t!==this._passiveTransform.x||e!==this._passiveTransform.y)&&this.setFreeDragPosition({y:e,x:t})}_getDragStartDelay(t){let e=this.dragStartDelay;return typeof e=="number"?e:Oe(t)?e.touch:e?e.mouse:0}_updateOnScroll(t){let e=this._parentPositions.handleScroll(t);if(e){let i=Fe(t);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&Re(this._boundaryRect,e.top,e.left),this._pickupPositionOnPage.x+=e.left,this._pickupPositionOnPage.y+=e.top,this._dropContainer||(this._activeTransform.x-=e.left,this._activeTransform.y-=e.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return this._cachedShadowRoot===void 0&&(this._cachedShadowRoot=rt(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(t,e){let i=this._previewContainer||"global";if(i==="parent")return t;if(i==="global"){let n=this._document;return e||n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement||n.body}return te(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=t=>{if(this._handles.length){let e=this._getTargetHandle(t);e&&!this._disabledHandles.has(e)&&!this.disabled&&t.preventDefault()}else this.disabled||t.preventDefault()};_getTargetHandle(t){return this._handles.find(e=>t.target&&(t.target===e||e.contains(t.target)))}_conditionallyInsertAnchor(t,e,i){if(t===this._initialContainer)this._anchor?.remove(),this._anchor=null;else if(e===this._initialContainer&&e.hasAnchor){let n=this._anchor??=Ot(this._placeholder);n.classList.remove(ji),n.classList.add("cdk-drag-anchor"),n.style.transform="",i?i.before(n):te(e.element).appendChild(n)}}};function $i(o,t,e){return Math.max(t,Math.min(e,o))}function Oe(o){return o.type[0]==="t"}function Sn(o){o.preventDefault()}function Me(o,t,e){let i=ct(t,o.length-1),n=ct(e,o.length-1);if(i===n)return;let s=o[i],m=n<i?-1:1;for(let g=i;g!==n;g+=m)o[g]=o[g+m];o[n]=s}function Zi(o,t,e,i){let n=ct(e,o.length-1),s=ct(i,t.length);o.length&&t.splice(s,0,o.splice(n,1)[0])}function ct(o,t){return Math.max(0,Math.min(t,o))}var mt=class{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(t){this._dragDropRegistry=t}_previousSwap={drag:null,delta:0,overlaps:!1};start(t){this.withItems(t)}sort(t,e,i,n){let s=this._itemPositions,m=this._getItemIndexFromPointerPosition(t,e,i,n);if(m===-1&&s.length>0)return null;let g=this.orientation==="horizontal",y=s.findIndex(G=>G.drag===t),C=s[m],D=s[y].clientRect,q=C.clientRect,se=y>m?1:-1,_t=this._getItemOffsetPx(D,q,se),rn=this._getSiblingOffsetPx(y,s,se),an=s.slice();return Me(s,y,m),s.forEach((G,sn)=>{if(an[sn]===G)return;let jt=G.drag===t,bt=jt?_t:rn,Ut=jt?t.getPlaceholderElement():G.drag.getRootElement();G.offset+=bt;let $t=Math.round(G.offset*(1/G.drag.scale));g?(Ut.style.transform=dt(`translate3d(${$t}px, 0, 0)`,G.initialTransform),Re(G.clientRect,0,bt)):(Ut.style.transform=dt(`translate3d(0, ${$t}px, 0)`,G.initialTransform),Re(G.clientRect,bt,0))}),this._previousSwap.overlaps=Lt(q,e,i),this._previousSwap.drag=C.drag,this._previousSwap.delta=g?n.x:n.y,{previousIndex:y,currentIndex:m}}enter(t,e,i,n){let s=n==null||n<0?this._getItemIndexFromPointerPosition(t,e,i):n,m=this._activeDraggables,g=m.indexOf(t),y=t.getPlaceholderElement(),C=m[s];if(C===t&&(C=m[s+1]),!C&&(s==null||s===-1||s<m.length-1)&&this._shouldEnterAsFirstChild(e,i)&&(C=m[0]),g>-1&&m.splice(g,1),C&&!this._dragDropRegistry.isDragging(C)){let D=C.getRootElement();D.parentElement.insertBefore(y,D),m.splice(s,0,t)}else this._element.appendChild(y),m.push(t);y.style.transform="",this._cacheItemPositions()}withItems(t){this._activeDraggables=t.slice(),this._cacheItemPositions()}withSortPredicate(t){this._sortPredicate=t}reset(){this._activeDraggables?.forEach(t=>{let e=t.getRootElement();if(e){let i=this._itemPositions.find(n=>n.drag===t)?.initialTransform;e.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(t){return this._getVisualItemPositions().findIndex(e=>e.drag===t)}getItemAtIndex(t){return this._getVisualItemPositions()[t]?.drag||null}updateOnScroll(t,e){this._itemPositions.forEach(({clientRect:i})=>{Re(i,t,e)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}withElementContainer(t){this._element=t}_cacheItemPositions(){let t=this.orientation==="horizontal";this._itemPositions=this._activeDraggables.map(e=>{let i=e.getVisibleElement();return{drag:e,offset:0,initialTransform:i.style.transform||"",clientRect:zt(i)}}).sort((e,i)=>t?e.clientRect.left-i.clientRect.left:e.clientRect.top-i.clientRect.top)}_getVisualItemPositions(){return this.orientation==="horizontal"&&this.direction==="rtl"?this._itemPositions.slice().reverse():this._itemPositions}_getItemOffsetPx(t,e,i){let n=this.orientation==="horizontal",s=n?e.left-t.left:e.top-t.top;return i===-1&&(s+=n?e.width-t.width:e.height-t.height),s}_getSiblingOffsetPx(t,e,i){let n=this.orientation==="horizontal",s=e[t].clientRect,m=e[t+i*-1],g=s[n?"width":"height"]*i;if(m){let y=n?"left":"top",C=n?"right":"bottom";i===-1?g-=m.clientRect[y]-s[C]:g+=s[y]-m.clientRect[C]}return g}_shouldEnterAsFirstChild(t,e){if(!this._activeDraggables.length)return!1;let i=this._itemPositions,n=this.orientation==="horizontal";if(i[0].drag!==this._activeDraggables[0]){let m=i[i.length-1].clientRect;return n?t>=m.right:e>=m.bottom}else{let m=i[0].clientRect;return n?t<=m.left:e<=m.top}}_getItemIndexFromPointerPosition(t,e,i,n){let s=this.orientation==="horizontal",m=this._itemPositions.findIndex(({drag:g,clientRect:y})=>{if(g===t)return!1;if(n){let C=s?n.x:n.y;if(g===this._previousSwap.drag&&this._previousSwap.overlaps&&C===this._previousSwap.delta)return!1}return s?e>=Math.floor(y.left)&&e<Math.floor(y.right):i>=Math.floor(y.top)&&i<Math.floor(y.bottom)});return m===-1||!this._sortPredicate(m,t)?-1:m}},Vt=class{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(t,e){this._document=t,this._dragDropRegistry=e}start(t){let e=this._element.childNodes;this._relatedNodes=[];for(let i=0;i<e.length;i++){let n=e[i];this._relatedNodes.push([n,n.nextSibling])}this.withItems(t)}sort(t,e,i,n){let s=this._getItemIndexFromPointerPosition(t,e,i),m=this._previousSwap;if(s===-1||this._activeItems[s]===t)return null;let g=this._activeItems[s];if(m.drag===g&&m.overlaps&&m.deltaX===n.x&&m.deltaY===n.y)return null;let y=this.getItemIndex(t),C=t.getPlaceholderElement(),D=g.getRootElement();s>y?D.after(C):D.before(C),Me(this._activeItems,y,s);let q=this._getRootNode().elementFromPoint(e,i);return m.deltaX=n.x,m.deltaY=n.y,m.drag=g,m.overlaps=D===q||D.contains(q),{previousIndex:y,currentIndex:s}}enter(t,e,i,n){let s=this._activeItems.indexOf(t);s>-1&&this._activeItems.splice(s,1);let m=n==null||n<0?this._getItemIndexFromPointerPosition(t,e,i):n;m===-1&&(m=this._getClosestItemIndexToPointer(t,e,i));let g=this._activeItems[m];g&&!this._dragDropRegistry.isDragging(g)?(this._activeItems.splice(m,0,t),g.getRootElement().before(t.getPlaceholderElement())):(this._activeItems.push(t),this._element.appendChild(t.getPlaceholderElement()))}withItems(t){this._activeItems=t.slice()}withSortPredicate(t){this._sortPredicate=t}reset(){let t=this._element,e=this._previousSwap;for(let i=this._relatedNodes.length-1;i>-1;i--){let[n,s]=this._relatedNodes[i];n.parentNode===t&&n.nextSibling!==s&&(s===null?t.appendChild(n):s.parentNode===t&&t.insertBefore(n,s))}this._relatedNodes=[],this._activeItems=[],e.drag=null,e.deltaX=e.deltaY=0,e.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(t){return this._activeItems.indexOf(t)}getItemAtIndex(t){return this._activeItems[t]||null}updateOnScroll(){this._activeItems.forEach(t=>{this._dragDropRegistry.isDragging(t)&&t._sortFromLastPointerPosition()})}withElementContainer(t){t!==this._element&&(this._element=t,this._rootNode=void 0)}_getItemIndexFromPointerPosition(t,e,i){let n=this._getRootNode().elementFromPoint(Math.floor(e),Math.floor(i)),s=n?this._activeItems.findIndex(m=>{let g=m.getRootElement();return n===g||g.contains(n)}):-1;return s===-1||!this._sortPredicate(s,t)?-1:s}_getRootNode(){return this._rootNode||(this._rootNode=rt(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(t,e,i){if(this._activeItems.length===0)return-1;if(this._activeItems.length===1)return 0;let n=1/0,s=-1;for(let m=0;m<this._activeItems.length;m++){let g=this._activeItems[m];if(g!==t){let{x:y,y:C}=g.getRootElement().getBoundingClientRect(),D=Math.hypot(e-y,i-C);D<n&&(n=D,s=m)}}return s}},qi=.05,Qi=.05,Q=(function(o){return o[o.NONE=0]="NONE",o[o.UP=1]="UP",o[o.DOWN=2]="DOWN",o})(Q||{}),V=(function(o){return o[o.NONE=0]="NONE",o[o.LEFT=1]="LEFT",o[o.RIGHT=2]="RIGHT",o})(V||{}),Nt=class{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis;autoScrollDisabled=!1;autoScrollStep=2;hasAnchor=!1;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new I;entered=new I;exited=new I;dropped=new I;sorted=new I;receivingStarted=new I;receivingStopped=new I;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=fe.EMPTY;_verticalScrollDirection=Q.NONE;_horizontalScrollDirection=V.NONE;_scrollNode;_stopScrollTimers=new I;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(t,e,i,n,s){this._dragDropRegistry=e,this._ngZone=n,this._viewportRuler=s;let m=this.element=te(t);this._document=i,this.withOrientation("vertical").withElementContainer(m),e.registerDropContainer(this),this._parentPositions=new lt(i)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(t,e,i,n){this._draggingStarted(),n==null&&this.sortingDisabled&&(n=this._draggables.indexOf(t)),this._sortStrategy.enter(t,e,i,n),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:t,container:this,currentIndex:this.getItemIndex(t)})}exit(t){this._reset(),this.exited.next({item:t,container:this})}drop(t,e,i,n,s,m,g,y={}){this._reset(),this.dropped.next({item:t,currentIndex:e,previousIndex:i,container:this,previousContainer:n,isPointerOverContainer:s,distance:m,dropPoint:g,event:y})}withItems(t){let e=this._draggables;return this._draggables=t,t.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(e.filter(n=>n.isDragging()).every(n=>t.indexOf(n)===-1)?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(t){return this._direction=t,this._sortStrategy instanceof mt&&(this._sortStrategy.direction=t),this}connectedTo(t){return this._siblings=t.slice(),this}withOrientation(t){if(t==="mixed")this._sortStrategy=new Vt(this._document,this._dragDropRegistry);else{let e=new mt(this._dragDropRegistry);e.direction=this._direction,e.orientation=t,this._sortStrategy=e}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((e,i)=>this.sortPredicate(e,i,this)),this}withScrollableParents(t){let e=this._container;return this._scrollableElements=t.indexOf(e)===-1?[e,...t]:t.slice(),this}withElementContainer(t){if(t===this._container)return this;let e=te(this.element),i=this._scrollableElements.indexOf(this._container),n=this._scrollableElements.indexOf(t);return i>-1&&this._scrollableElements.splice(i,1),n>-1&&this._scrollableElements.splice(n,1),this._sortStrategy&&this._sortStrategy.withElementContainer(t),this._cachedShadowRoot=null,this._scrollableElements.unshift(t),this._container=t,this}getScrollableParents(){return this._scrollableElements}getItemIndex(t){return this._isDragging?this._sortStrategy.getItemIndex(t):this._draggables.indexOf(t)}getItemAtIndex(t){return this._isDragging?this._sortStrategy.getItemAtIndex(t):this._draggables[t]||null}isReceiving(){return this._activeSiblings.size>0}_sortItem(t,e,i,n){if(this.sortingDisabled||!this._domRect||!Ai(this._domRect,qi,e,i))return;let s=this._sortStrategy.sort(t,e,i,n);s&&this.sorted.next({previousIndex:s.previousIndex,currentIndex:s.currentIndex,container:this,item:t})}_startScrollingIfNecessary(t,e){if(this.autoScrollDisabled)return;let i,n=Q.NONE,s=V.NONE;if(this._parentPositions.positions.forEach((m,g)=>{g===this._document||!m.clientRect||i||Ai(m.clientRect,qi,t,e)&&([n,s]=En(g,m.clientRect,this._direction,t,e),(n||s)&&(i=g))}),!n&&!s){let{width:m,height:g}=this._viewportRuler.getViewportSize(),y={width:m,height:g,top:0,right:m,bottom:g,left:0};n=Yi(y,e),s=Xi(y,t),i=window}i&&(n!==this._verticalScrollDirection||s!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=n,this._horizontalScrollDirection=s,this._scrollNode=i,(n||s)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){let t=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=t.msScrollSnapType||t.scrollSnapType||"",t.scrollSnapType=t.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;let t=this._container.style;t.scrollSnapType=t.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(e=>e._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),Wt(0,vt).pipe(xe(this._stopScrollTimers)).subscribe(()=>{let t=this._scrollNode,e=this.autoScrollStep;this._verticalScrollDirection===Q.UP?t.scrollBy(0,-e):this._verticalScrollDirection===Q.DOWN&&t.scrollBy(0,e),this._horizontalScrollDirection===V.LEFT?t.scrollBy(-e,0):this._horizontalScrollDirection===V.RIGHT&&t.scrollBy(e,0)})};_isOverContainer(t,e){return this._domRect!=null&&Lt(this._domRect,t,e)}_getSiblingContainerFromPosition(t,e,i){return this._siblings.find(n=>n._canReceive(t,e,i))}_canReceive(t,e,i){if(!this._domRect||!Lt(this._domRect,e,i)||!this.enterPredicate(t,this))return!1;let n=this._getShadowRoot().elementFromPoint(e,i);return n?n===this._container||this._container.contains(n):!1}_startReceiving(t,e){let i=this._activeSiblings;!i.has(t)&&e.every(n=>this.enterPredicate(n,this)||this._draggables.indexOf(n)>-1)&&(i.add(t),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:t,receiver:this,items:e}))}_stopReceiving(t){this._activeSiblings.delete(t),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:t,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(t=>{if(this.isDragging()){let e=this._parentPositions.handleScroll(t);e&&this._sortStrategy.updateOnScroll(e.top,e.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){let t=rt(this._container);this._cachedShadowRoot=t||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){let t=this._sortStrategy.getActiveItemsSnapshot().filter(e=>e.isDragging());this._siblings.forEach(e=>e._startReceiving(this,t))}};function Yi(o,t){let{top:e,bottom:i,height:n}=o,s=n*Qi;return t>=e-s&&t<=e+s?Q.UP:t>=i-s&&t<=i+s?Q.DOWN:Q.NONE}function Xi(o,t){let{left:e,right:i,width:n}=o,s=n*Qi;return t>=e-s&&t<=e+s?V.LEFT:t>=i-s&&t<=i+s?V.RIGHT:V.NONE}function En(o,t,e,i,n){let s=Yi(t,n),m=Xi(t,i),g=Q.NONE,y=V.NONE;if(s){let C=o.scrollTop;s===Q.UP?C>0&&(g=Q.UP):o.scrollHeight-C>o.clientHeight&&(g=Q.DOWN)}if(m){let C=o.scrollLeft;e==="rtl"?m===V.RIGHT?C<0&&(y=V.RIGHT):o.scrollWidth+C>o.clientWidth&&(y=V.LEFT):m===V.LEFT?C>0&&(y=V.LEFT):o.scrollWidth-C>o.clientWidth&&(y=V.RIGHT)}return[g,y]}var Le={capture:!0},Ft={passive:!1,capture:!0},Mn=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275cmp=T({type:o,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(i,n){},styles:[`@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}
`],encapsulation:2,changeDetection:0})}return o})(),Ji=(()=>{class o{_ngZone=v(be);_document=v(_e);_styleLoader=v(Di);_renderer=v(we).createRenderer(null,null);_cleanupDocumentTouchmove;_scroll=new I;_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=ye([]);_globalListeners;_draggingPredicate=e=>e.isDragging();_domNodesToDirectives=null;pointerMove=new I;pointerUp=new I;constructor(){}registerDropContainer(e){this._dropInstances.has(e)||this._dropInstances.add(e)}registerDragItem(e){this._dragInstances.add(e),this._dragInstances.size===1&&this._ngZone.runOutsideAngular(()=>{this._cleanupDocumentTouchmove?.(),this._cleanupDocumentTouchmove=this._renderer.listen(this._document,"touchmove",this._persistentTouchmoveListener,Ft)})}removeDropContainer(e){this._dropInstances.delete(e)}removeDragItem(e){this._dragInstances.delete(e),this.stopDragging(e),this._dragInstances.size===0&&this._cleanupDocumentTouchmove?.()}startDragging(e,i){if(!(this._activeDragInstances().indexOf(e)>-1)&&(this._styleLoader.load(Mn),this._activeDragInstances.update(n=>[...n,e]),this._activeDragInstances().length===1)){let n=i.type.startsWith("touch"),s=g=>this.pointerUp.next(g),m=[["scroll",g=>this._scroll.next(g),Le],["selectstart",this._preventDefaultWhileDragging,Ft]];n?m.push(["touchend",s,Le],["touchcancel",s,Le]):m.push(["mouseup",s,Le]),n||m.push(["mousemove",g=>this.pointerMove.next(g),Ft]),this._ngZone.runOutsideAngular(()=>{this._globalListeners=m.map(([g,y,C])=>this._renderer.listen(this._document,g,y,C))})}}stopDragging(e){this._activeDragInstances.update(i=>{let n=i.indexOf(e);return n>-1?(i.splice(n,1),[...i]):i}),this._activeDragInstances().length===0&&this._clearGlobalListeners()}isDragging(e){return this._activeDragInstances().indexOf(e)>-1}scrolled(e){let i=[this._scroll];return e&&e!==this._document&&i.push(new Ie(n=>this._ngZone.runOutsideAngular(()=>{let s=this._renderer.listen(e,"scroll",m=>{this._activeDragInstances().length&&n.next(m)},Le);return()=>{s()}}))),qe(...i)}registerDirectiveNode(e,i){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(e,i)}removeDirectiveNode(e){this._domNodesToDirectives?.delete(e)}getDragDirectiveForNode(e){return this._domNodesToDirectives?.get(e)||null}ngOnDestroy(){this._dragInstances.forEach(e=>this.removeDragItem(e)),this._dropInstances.forEach(e=>this.removeDropContainer(e)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=e=>{this._activeDragInstances().length>0&&e.preventDefault()};_persistentTouchmoveListener=e=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&e.preventDefault(),this.pointerMove.next(e))};_clearGlobalListeners(){this._globalListeners?.forEach(e=>e()),this._globalListeners=void 0}static \u0275fac=function(i){return new(i||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Dn={dragStartThreshold:5,pointerDirectionChangeThreshold:5},Ht=(()=>{class o{_document=v(_e);_ngZone=v(be);_viewportRuler=v(Ii);_dragDropRegistry=v(Ji);_renderer=v(we).createRenderer(null,null);constructor(){}createDrag(e,i=Dn){return new At(e,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry,this._renderer)}createDropList(e){return new Nt(e,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(i){return new(i||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})(),Gi=new de("CDK_DRAG_PARENT");var Pn=new de("CdkDragHandle");var en=new de("CDK_DRAG_CONFIG"),tn=new de("CdkDropList"),ut=(()=>{class o{element=v(Ce);dropContainer=v(tn,{optional:!0,skipSelf:!0});_ngZone=v(be);_viewContainerRef=v(Ct);_dir=v(It,{optional:!0});_changeDetectorRef=v(tt);_selfHandle=v(Pn,{optional:!0,self:!0});_parentDrag=v(Gi,{optional:!0,skipSelf:!0});_dragDropRegistry=v(Ji);_destroyed=new I;_handles=new qt([]);_previewTemplate;_placeholderTemplate;_dragRef;data;lockAxis;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!!(this.dropContainer&&this.dropContainer.disabled)}set disabled(e){this._disabled=e,this._dragRef.disabled=this._disabled}_disabled;constrainPosition;previewClass;previewContainer;scale=1;started=new S;released=new S;ended=new S;entered=new S;exited=new S;dropped=new S;moved=new Ie(e=>{let i=this._dragRef.moved.pipe(Kt(n=>({source:this,pointerPosition:n.pointerPosition,event:n.event,delta:n.delta,distance:n.distance}))).subscribe(e);return()=>{i.unsubscribe()}});_injector=v(Te);constructor(){let e=this.dropContainer,i=v(en,{optional:!0}),n=v(Ht);this._dragRef=n.createDrag(this.element,{dragStartThreshold:i&&i.dragStartThreshold!=null?i.dragStartThreshold:5,pointerDirectionChangeThreshold:i&&i.pointerDirectionChangeThreshold!=null?i.pointerDirectionChangeThreshold:5,zIndex:i?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),i&&this._assignDefaults(i),e&&(e.addItem(this),e._dropListRef.beforeStarted.pipe(xe(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}resetToBoundary(){this._dragRef.resetToBoundary()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(e){this._dragRef.setFreeDragPosition(e)}ngAfterViewInit(){wt(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(e){let i=e.rootElementSelector,n=e.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,n&&!n.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(e){let i=this._handles.getValue();i.push(e),this._handles.next(i)}_removeHandle(e){let i=this._handles.getValue(),n=i.indexOf(e);n>-1&&(i.splice(n,1),this._handles.next(i))}_setPreviewTemplate(e){this._previewTemplate=e}_resetPreviewTemplate(e){e===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(e){this._placeholderTemplate=e}_resetPlaceholderTemplate(e){e===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){let e=this.element.nativeElement,i=e;this.rootElementSelector&&(i=e.closest!==void 0?e.closest(this.rootElementSelector):e.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||e)}_getBoundaryElement(){let e=this.boundaryElement;return e?typeof e=="string"?this.element.nativeElement.closest(e):te(e):null}_syncInputs(e){e.beforeStarted.subscribe(()=>{if(!e.isDragging()){let i=this._dir,n=this.dragStartDelay,s=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,m=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.scale=this.scale,e.dragStartDelay=typeof n=="object"&&n?n:at(n),e.constrainPosition=this.constrainPosition,e.previewClass=this.previewClass,e.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(s).withPreviewTemplate(m).withPreviewContainer(this.previewContainer||"global"),i&&e.withDirection(i.value)}}),e.beforeStarted.pipe(Qt(1)).subscribe(()=>{if(this._parentDrag){e.withParent(this._parentDrag._dragRef);return}let i=this.element.nativeElement.parentElement;for(;i;){let n=this._dragDropRegistry.getDragDirectiveForNode(i);if(n){e.withParent(n._dragRef);break}i=i.parentElement}})}_handleEvents(e){e.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),e.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),e.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(e){let{lockAxis:i,dragStartDelay:n,constrainPosition:s,previewClass:m,boundaryElement:g,draggingDisabled:y,rootElementSelector:C,previewContainer:D}=e;this.disabled=y??!1,this.dragStartDelay=n||0,i&&(this.lockAxis=i),s&&(this.constrainPosition=s),m&&(this.previewClass=m),g&&(this.boundaryElement=g),C&&(this.rootElementSelector=C),D&&(this.previewContainer=D)}_setupHandlesListener(){this._handles.pipe(Yt(e=>{let i=e.map(n=>n.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),yt(e=>qe(...e.map(i=>i._stateChanges.pipe(Ge(i))))),xe(this._destroyed)).subscribe(e=>{let i=this._dragRef,n=e.element.nativeElement;e.disabled?i.disableHandle(n):i.enableHandle(n)})}static \u0275fac=function(i){return new(i||o)};static \u0275dir=Ye({type:o,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,n){i&2&&P("cdk-drag-disabled",n.disabled)("cdk-drag-dragging",n._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",ve],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",ci]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Xe([{provide:Gi,useExisting:o}]),ke]})}return o})(),Ki=new de("CdkDropListGroup");var pt=(()=>{class o{element=v(Ce);_changeDetectorRef=v(tt);_scrollDispatcher=v(Pi);_dir=v(It,{optional:!0});_group=v(Ki,{optional:!0,skipSelf:!0});_latestSortedRefs;_destroyed=new I;_scrollableParentsResolved;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation;id=v(ki).getId("cdk-drop-list-");lockAxis;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(e){this._dropListRef.disabled=this._disabled=e}_disabled;sortingDisabled;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled;autoScrollStep;elementContainerSelector;hasAnchor;dropped=new S;entered=new S;exited=new S;sorted=new S;_unsortedItems=new Set;constructor(){let e=v(Ht),i=v(en,{optional:!0});this._dropListRef=e.createDropList(this.element),this._dropListRef.data=this,i&&this._assignDefaults(i),this._dropListRef.enterPredicate=(n,s)=>this.enterPredicate(n.data,s.data),this._dropListRef.sortPredicate=(n,s,m)=>this.sortPredicate(n,s.data,m.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),o._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(e){this._unsortedItems.add(e),e._dragRef._withDropContainer(this._dropListRef),this._dropListRef.isDragging()&&this._syncItemsWithRef(this.getSortedItems().map(i=>i._dragRef))}removeItem(e){if(this._unsortedItems.delete(e),this._latestSortedRefs){let i=this._latestSortedRefs.indexOf(e._dragRef);i>-1&&(this._latestSortedRefs.splice(i,1),this._syncItemsWithRef(this._latestSortedRefs))}}getSortedItems(){return Array.from(this._unsortedItems).sort((e,i)=>e._dragRef.getVisibleElement().compareDocumentPosition(i._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){let e=o._dropLists.indexOf(this);e>-1&&o._dropLists.splice(e,1),this._group&&this._group._items.delete(this),this._latestSortedRefs=void 0,this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(e){this._dir&&this._dir.change.pipe(Ge(this._dir.value),xe(this._destroyed)).subscribe(i=>e.withDirection(i)),e.beforeStarted.subscribe(()=>{let i=Fi(this.connectedTo).map(n=>{if(typeof n=="string"){let s=o._dropLists.find(m=>m.id===n);return s}return n});if(this._group&&this._group._items.forEach(n=>{i.indexOf(n)===-1&&i.push(n)}),!this._scrollableParentsResolved){let n=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(s=>s.getElementRef().nativeElement);this._dropListRef.withScrollableParents(n),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){let n=this.element.nativeElement.querySelector(this.elementContainerSelector);e.withElementContainer(n)}e.disabled=this.disabled,e.lockAxis=this.lockAxis,e.sortingDisabled=this.sortingDisabled,e.autoScrollDisabled=this.autoScrollDisabled,e.autoScrollStep=at(this.autoScrollStep,2),e.hasAnchor=this.hasAnchor,e.connectedTo(i.filter(n=>n&&n!==this).map(n=>n._dropListRef)).withOrientation(this.orientation)})}_handleEvents(e){e.beforeStarted.subscribe(()=>{this._syncItemsWithRef(this.getSortedItems().map(i=>i._dragRef)),this._changeDetectorRef.markForCheck()}),e.entered.subscribe(i=>{this.entered.emit({container:this,item:i.item.data,currentIndex:i.currentIndex})}),e.exited.subscribe(i=>{this.exited.emit({container:this,item:i.item.data}),this._changeDetectorRef.markForCheck()}),e.sorted.subscribe(i=>{this.sorted.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,container:this,item:i.item.data})}),e.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,item:i.item.data,isPointerOverContainer:i.isPointerOverContainer,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),qe(e.receivingStarted,e.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(e){let{lockAxis:i,draggingDisabled:n,sortingDisabled:s,listAutoScrollDisabled:m,listOrientation:g}=e;this.disabled=n??!1,this.sortingDisabled=s??!1,this.autoScrollDisabled=m??!1,this.orientation=g||"vertical",i&&(this.lockAxis=i)}_syncItemsWithRef(e){this._latestSortedRefs=e,this._dropListRef.withItems(e)}static \u0275fac=function(i){return new(i||o)};static \u0275dir=Ye({type:o,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(i,n){i&2&&(ii("id",n.id),P("cdk-drop-list-disabled",n.disabled)("cdk-drop-list-dragging",n._dropListRef.isDragging())("cdk-drop-list-receiving",n._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",ve],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",ve],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",ve],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"],hasAnchor:[2,"cdkDropListHasAnchor","hasAnchor",ve]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Xe([{provide:Ki,useValue:void 0},{provide:tn,useExisting:o}])]})}return o})();var gt=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=Qe({type:o});static \u0275inj=Ke({providers:[Ht],imports:[Ti]})}return o})();var De=class o{storage=v(_i);uploadFile(t,e){return M(this,null,function*(){try{let i=Et(this.storage,e),n=yield xi(i,t);return yield vi(n.ref)}catch(i){throw console.error("Erro ao fazer upload:",i),i}})}uploadLeadAttachment(t,e,i,n){return M(this,null,function*(){let s=Date.now(),m=`users/${t}/boards/${e}/leads/${i}/attachments/${s}_${n.name}`;try{let g=yield this.uploadFile(n,m);return{name:n.name,url:g}}catch(g){throw console.error("Erro ao fazer upload do anexo:",g),g}})}deleteFile(t){return M(this,null,function*(){try{let e=Et(this.storage,t);yield bi(e)}catch(e){throw console.error("Erro ao deletar arquivo:",e),e}})}static \u0275fac=function(e){return new(e||o)};static \u0275prov=O({token:o,factory:o.\u0275fac,providedIn:"root"})};function In(o,t){o&1&&(r(0,"span",27),l(1,"*"),a())}function Tn(o,t){if(o&1&&p(0,"input",28),o&2){let e,i=u().$implicit,n=u(2);P("border-red-500",((e=n.leadForm.get(i.name))==null?null:e.invalid)&&((e=n.leadForm.get(i.name))==null?null:e.touched)),c("type",i.type)("id",i.name)("formControlName",i.name)("disabled",n.isLoading)}}function kn(o,t){if(o&1&&(r(0,"option",32),l(1),Je(2,"titlecase"),a()),o&2){let e=t.$implicit;c("value",e),d(),x(" ",et(2,2,e)," ")}}function Fn(o,t){if(o&1&&(r(0,"select",29)(1,"option",30),l(2,"Selecione..."),a(),b(3,kn,3,4,"option",31),a()),o&2){let e,i=u().$implicit,n=u(2);P("border-red-500",((e=n.leadForm.get(i.name))==null?null:e.invalid)&&((e=n.leadForm.get(i.name))==null?null:e.touched)),c("id",i.name)("formControlName",i.name)("disabled",n.isLoading),d(3),c("ngForOf",i.options)}}function On(o,t){if(o&1&&p(0,"textarea",33),o&2){let e,i=u().$implicit,n=u(2);P("border-red-500",((e=n.leadForm.get(i.name))==null?null:e.invalid)&&((e=n.leadForm.get(i.name))==null?null:e.touched)),c("id",i.name)("formControlName",i.name)("disabled",n.isLoading)}}function Ln(o,t){if(o&1&&(r(0,"div",34),l(1),a()),o&2){let e=u().$implicit,i=u(2);d(),x(" ",i.getFieldError(e.name)," ")}}function Rn(o,t){if(o&1&&(r(0,"div",20)(1,"label",21),l(2),b(3,In,2,0,"span",22),a(),b(4,Tn,1,6,"input",23)(5,Fn,4,6,"select",24)(6,On,1,5,"textarea",25)(7,Ln,2,1,"div",26),a()),o&2){let e=t.$implicit,i=u(2);d(),c("for",e.name),d(),x(" ",e.label," "),d(),c("ngIf",e.required),d(),c("ngIf",e.type==="text"||e.type==="email"||e.type==="tel"),d(),c("ngIf",e.type==="select"),d(),c("ngIf",e.type==="textarea"),d(),c("ngIf",i.getFieldError(e.name))}}function An(o,t){if(o&1){let e=w();r(0,"div",20)(1,"label",35),l(2," Anexos (opcional) "),a(),r(3,"input",36),h("change",function(n){f(e);let s=u(2);return _(s.onFileSelected(n))}),a(),r(4,"p",37),l(5," Voc\xEA pode anexar arquivos como documentos, imagens, etc. "),a()()}if(o&2){let e=u(2);d(3),c("disabled",e.isLoading)}}function Vn(o,t){if(o&1&&(r(0,"div",38),l(1),a()),o&2){let e=u(2);d(),x(" ",e.errorMessage," ")}}function Nn(o,t){o&1&&p(0,"div",39)}function zn(o,t){if(o&1){let e=w();r(0,"div",1),h("click",function(n){f(e);let s=u();return _(s.onBackdropClick(n))}),r(1,"div",2)(2,"div",3)(3,"h2",4),l(4),a(),r(5,"button",5),h("click",function(){f(e);let n=u();return _(n.hide())}),l(6," \xD7 "),a()(),r(7,"form",6),h("ngSubmit",function(){f(e);let n=u();return _(n.saveLead())}),r(8,"div",7),b(9,Rn,8,7,"div",8)(10,An,6,1,"div",9)(11,Vn,2,1,"div",10),r(12,"div",11)(13,"div",12),p(14,"i",13),r(15,"div",14)(16,"strong"),l(17,"Temperatura do Lead:"),a(),r(18,"ul",15)(19,"li")(20,"strong"),l(21,"Frio:"),a(),l(22," Lead inicial, pouco interesse"),a(),r(23,"li")(24,"strong"),l(25,"Morno:"),a(),l(26," Lead com interesse moderado"),a(),r(27,"li")(28,"strong"),l(29,"Quente:"),a(),l(30," Lead qualificado, alta probabilidade de convers\xE3o"),a()()()()()(),r(31,"div",16)(32,"button",17),h("click",function(){f(e);let n=u();return _(n.hide())}),l(33," Cancelar "),a(),r(34,"button",18),b(35,Nn,1,0,"div",19),l(36),a()()()()()}if(o&2){let e=u();d(4),x(" ",e.isEditing?"Editar Lead":"Novo Lead"," "),d(),c("disabled",e.isLoading),d(2),c("formGroup",e.leadForm),d(2),c("ngForOf",e.formFields),d(),c("ngIf",!e.isEditing),d(),c("ngIf",e.errorMessage),d(21),c("disabled",e.isLoading),d(2),c("disabled",e.isLoading||!e.leadForm.valid),d(),c("ngIf",e.isLoading),d(),x(" ",e.isLoading?"Salvando...":e.isEditing?"Atualizar Lead":"Criar Lead"," ")}}var Ve=class o{authService=v(ae);firestoreService=v($);storageService=v(De);fb=v(H);ownerId="";boardId="";columns=[];leadCreated=new S;leadUpdated=new S;closeModal=new S;isVisible=!1;isEditing=!1;isLoading=!1;errorMessage="";currentLead=null;leadForm=this.fb.group({});formFields=[];selectedFiles=[];ngOnInit(){this.initializeForm()}initializeForm(){this.formFields=[{name:"companyName",label:"Nome da Empresa",type:"text",required:!0},{name:"cnpj",label:"CNPJ",type:"text",required:!0},{name:"contactName",label:"Nome do Contato",type:"text",required:!0},{name:"contactEmail",label:"Email do Contato",type:"email",required:!0},{name:"contactPhone",label:"Telefone do Contato",type:"tel",required:!0},{name:"temperature",label:"Temperatura",type:"select",required:!1,options:["frio","morno","quente"]},{name:"description",label:"Observa\xE7\xF5es",type:"textarea",required:!1}],this.buildForm()}buildForm(){let t={};this.formFields.forEach(e=>{let i=e.required?[k.required]:[];e.type==="email"&&i.push(k.email),t[e.name]=["",i]}),this.leadForm=this.fb.group(t)}showCreateModal(){this.isEditing=!1,this.currentLead=null,this.isVisible=!0,this.resetForm()}showEditModal(t){this.isEditing=!0,this.currentLead=t,this.isVisible=!0,this.populateForm(t)}hide(){this.isVisible=!1,this.resetForm(),this.closeModal.emit()}resetForm(){this.leadForm.reset(),this.errorMessage="",this.selectedFiles=[],this.isLoading=!1}populateForm(t){t.fields&&Object.keys(t.fields).forEach(e=>{this.leadForm.controls[e]&&this.leadForm.patchValue({[e]:t.fields[e]})})}saveLead(){return M(this,null,function*(){if(!this.leadForm.valid){this.errorMessage="Por favor, preencha todos os campos obrigat\xF3rios.";return}this.isLoading=!0,this.errorMessage="";try{let t=this.leadForm.value,e=this.authService.getCurrentUser();if(!e)throw new Error("Usu\xE1rio n\xE3o autenticado");if(this.isEditing&&this.currentLead)yield this.firestoreService.updateLead(this.ownerId,this.boardId,this.currentLead.id,{fields:t}),yield this.firestoreService.addLeadHistory(this.ownerId,this.boardId,this.currentLead.id,{type:"update",text:"Lead atualizado",user:e.displayName||e.email}),this.leadUpdated.emit();else{let i=this.columns.find(m=>m.order===0);if(!i)throw new Error("Nenhuma coluna inicial encontrada");let n={fields:t,columnId:i.id,companyId:"",boardId:this.boardId,createdAt:null,movedToCurrentColumnAt:null,responsibleUserId:e.uid,responsibleUserName:e.displayName||"",responsibleUserEmail:e.email||"",phaseHistory:{},executedAutomations:{}},s=yield this.firestoreService.createLead(this.ownerId,this.boardId,n);yield this.firestoreService.addLeadHistory(this.ownerId,this.boardId,s.id,{type:"creation",text:`Lead criado na fase <b>${i.name}</b>`,user:e.displayName||e.email}),this.leadCreated.emit()}this.hide()}catch(t){console.error("Erro ao salvar lead:",t),this.errorMessage="Erro ao salvar lead. Tente novamente."}finally{this.isLoading=!1}})}onFileSelected(t){let e=t.target.files;e&&(this.selectedFiles=Array.from(e))}onBackdropClick(t){t.target===t.currentTarget&&this.hide()}getFieldError(t){let e=this.leadForm.get(t);if(e?.errors&&e.touched){if(e.errors.required)return`${this.getFieldLabel(t)} \xE9 obrigat\xF3rio`;if(e.errors.email)return"Email inv\xE1lido"}return""}getFieldLabel(t){return this.formFields.find(i=>i.name===t)?.label||t}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=T({type:o,selectors:[["app-lead-modal"]],inputs:{ownerId:"ownerId",boardId:"boardId",columns:"columns"},outputs:{leadCreated:"leadCreated",leadUpdated:"leadUpdated",closeModal:"closeModal"},decls:1,vars:1,consts:[["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",3,"click",4,"ngIf"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-2xl","max-h-[90vh]","overflow-y-auto"],[1,"flex","justify-between","items-center","p-6","border-b","border-gray-200"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","text-2xl","font-bold",3,"click","disabled"],[1,"p-6",3,"ngSubmit","formGroup"],[1,"space-y-4"],["class","form-group",4,"ngFor","ngForOf"],["class","form-group",4,"ngIf"],["class","bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",4,"ngIf"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-3"],[1,"flex","items-start"],[1,"fas","fa-info-circle","text-blue-500","mt-0.5","mr-2"],[1,"text-sm","text-blue-700"],[1,"mt-1","ml-2","list-disc"],[1,"flex","justify-end","gap-3","mt-6","pt-4","border-t","border-gray-200"],["type","button",1,"px-4","py-2","text-gray-700","bg-gray-200","hover:bg-gray-300","rounded-lg","font-medium","transition-colors",3,"click","disabled"],["type","submit",1,"px-6","py-2","bg-blue-500","hover:bg-blue-600","disabled:bg-blue-300","text-white","rounded-lg","font-medium","transition-colors","flex","items-center",3,"disabled"],["class","animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2",4,"ngIf"],[1,"form-group"],[1,"block","text-sm","font-medium","text-gray-700","mb-1",3,"for"],["class","text-red-500",4,"ngIf"],["class","w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",3,"type","id","formControlName","border-red-500","disabled",4,"ngIf"],["class","w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",3,"id","formControlName","border-red-500","disabled",4,"ngIf"],["rows","3","class","w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors resize-none",3,"id","formControlName","border-red-500","disabled",4,"ngIf"],["class","text-red-500 text-sm mt-1",4,"ngIf"],[1,"text-red-500"],[1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors",3,"type","id","formControlName","disabled"],[1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors",3,"id","formControlName","disabled"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["rows","3",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors","resize-none",3,"id","formControlName","disabled"],[1,"text-red-500","text-sm","mt-1"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","file","multiple","",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors",3,"change","disabled"],[1,"text-xs","text-gray-500","mt-1"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-lg"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-white","mr-2"]],template:function(e,i){e&1&&b(0,zn,37,10,"div",0),e&2&&c("ngIf",i.isVisible)},dependencies:[F,L,R,j,z,oe,re,K,pe,W,N,U,B,Z,it],styles:[`.fixed[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.bg-white[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.form-group[_ngcontent-%COMP%]{position:relative}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #3b82f61a}.border-red-500[_ngcontent-%COMP%]{border-color:#ef4444!important}select[_ngcontent-%COMP%]{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");background-position:right .5rem center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:2.5rem}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}`]})};function Bn(o,t){if(o&1&&(r(0,"div",33),l(1),a()),o&2){let e=u(2);d(),x(" ",e.getFieldError("name")," ")}}function Hn(o,t){if(o&1){let e=w();r(0,"button",34),h("click",function(){let n=f(e).$implicit,s=u(2);return _(s.columnForm.patchValue({color:n}))}),a()}if(o&2){let e,i,n=t.$implicit,s=u(2);ee("background-color",n),P("border-gray-800",((e=s.columnForm.get("color"))==null?null:e.value)===n)("border-gray-300",((i=s.columnForm.get("color"))==null?null:i.value)!==n),c("disabled",s.isLoading)}}function jn(o,t){if(o&1&&(r(0,"option",35),l(1),a()),o&2){let e=t.$implicit;c("value",e.value),d(),x(" ",e.label," ")}}function Un(o,t){if(o&1&&(r(0,"div",33),l(1),a()),o&2){let e=u(2);d(),x(" ",e.getFieldError("slaDays")," ")}}function $n(o,t){if(o&1&&(r(0,"div",36),l(1),a()),o&2){let e=u(2);d(),x(" ",e.errorMessage," ")}}function qn(o,t){o&1&&p(0,"div",37)}function Gn(o,t){if(o&1){let e=w();r(0,"div",1),h("click",function(n){f(e);let s=u();return _(s.onBackdropClick(n))}),r(1,"div",2)(2,"div",3)(3,"h2",4),l(4),a(),r(5,"button",5),h("click",function(){f(e);let n=u();return _(n.hide())}),l(6," \xD7 "),a()(),r(7,"form",6),h("ngSubmit",function(){f(e);let n=u();return _(n.saveColumn())}),r(8,"div",7)(9,"div",8)(10,"label",9),l(11," Nome da Fase "),r(12,"span",10),l(13,"*"),a()(),p(14,"input",11),b(15,Bn,2,1,"div",12),a(),r(16,"div",8)(17,"label",13),l(18," Cor da Fase "),a(),r(19,"div",14),b(20,Hn,1,7,"button",15),a(),p(21,"input",16),a(),r(22,"div",8)(23,"label",17),l(24," Tipo de Finaliza\xE7\xE3o "),a(),r(25,"select",18),b(26,jn,2,2,"option",19),a(),r(27,"p",20),l(28," Fases de finaliza\xE7\xE3o n\xE3o permitem que leads sejam movidos para outras fases. "),a()(),r(29,"div",8)(30,"label",21),l(31," SLA (dias) "),a(),p(32,"input",22),b(33,Un,2,1,"div",12),r(34,"p",20),l(35," Defina um prazo em dias para esta fase. Use 0 para desabilitar o SLA. "),a()(),b(36,$n,2,1,"div",23),r(37,"div",24)(38,"div",25),p(39,"i",26),r(40,"div",27)(41,"strong"),l(42,"Dica:"),a(),r(43,"ul",28)(44,"li"),l(45,"Organize suas fases na ordem do seu funil de vendas"),a(),r(46,"li"),l(47,"Use cores diferentes para facilitar a identifica\xE7\xE3o"),a(),r(48,"li"),l(49,"Fases de "),r(50,"strong"),l(51,"Sucesso"),a(),l(52," indicam leads convertidos"),a(),r(53,"li"),l(54,"Fases de "),r(55,"strong"),l(56,"Fracasso"),a(),l(57," indicam leads perdidos"),a()()()()()(),r(58,"div",29)(59,"button",30),h("click",function(){f(e);let n=u();return _(n.hide())}),l(60," Cancelar "),a(),r(61,"button",31),b(62,qn,1,0,"div",32),l(63),a()()()()()}if(o&2){let e,i,n=u();d(4),x(" ",n.isEditing?"Editar Fase":"Nova Fase"," "),d(),c("disabled",n.isLoading),d(2),c("formGroup",n.columnForm),d(7),P("border-red-500",((e=n.columnForm.get("name"))==null?null:e.invalid)&&((e=n.columnForm.get("name"))==null?null:e.touched)),c("disabled",n.isLoading),d(),c("ngIf",n.getFieldError("name")),d(5),c("ngForOf",n.predefinedColors),d(),c("disabled",n.isLoading),d(4),c("disabled",n.isLoading),d(),c("ngForOf",n.endStageTypes),d(6),P("border-red-500",((i=n.columnForm.get("slaDays"))==null?null:i.invalid)&&((i=n.columnForm.get("slaDays"))==null?null:i.touched)),c("disabled",n.isLoading),d(),c("ngIf",n.getFieldError("slaDays")),d(3),c("ngIf",n.errorMessage),d(23),c("disabled",n.isLoading),d(2),c("disabled",n.isLoading||!n.columnForm.valid),d(),c("ngIf",n.isLoading),d(),x(" ",n.isLoading?"Salvando...":n.isEditing?"Atualizar Fase":"Criar Fase"," ")}}var Ne=class o{authService=v(ae);firestoreService=v($);fb=v(H);ownerId="";boardId="";columns=[];columnCreated=new S;columnUpdated=new S;closeModal=new S;isVisible=!1;isEditing=!1;isLoading=!1;errorMessage="";currentColumn=null;columnForm=this.fb.group({name:["",[k.required]],color:["#3B82F6"],endStageType:["none"],slaDays:[0,[k.min(0)]]});predefinedColors=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#6B7280","#F97316","#06B6D4","#84CC16"];endStageTypes=[{value:"none",label:"Nenhuma (fase normal)"},{value:"success",label:"Sucesso (lead convertido)"},{value:"fail",label:"Fracasso (lead perdido)"}];showCreateModal(){this.isEditing=!1,this.currentColumn=null,this.isVisible=!0,this.resetForm()}showEditModal(t){this.isEditing=!0,this.currentColumn=t,this.isVisible=!0,this.populateForm(t)}hide(){this.isVisible=!1,this.resetForm(),this.closeModal.emit()}resetForm(){this.columnForm.reset({name:"",color:"#3B82F6",endStageType:"none",slaDays:0}),this.errorMessage="",this.isLoading=!1}populateForm(t){this.columnForm.patchValue({name:t.name,color:t.color||"#3B82F6",endStageType:t.endStageType||"none",slaDays:t.slaDays||0})}saveColumn(){return M(this,null,function*(){if(!this.columnForm.valid){this.errorMessage="Por favor, preencha todos os campos obrigat\xF3rios.";return}this.isLoading=!0,this.errorMessage="";try{let t=this.columnForm.value;if(!this.authService.getCurrentUser())throw new Error("Usu\xE1rio n\xE3o autenticado");if(this.isEditing&&this.currentColumn)yield this.firestoreService.updateColumn(this.ownerId,this.boardId,this.currentColumn.id,{name:t.name,color:t.color,endStageType:t.endStageType,slaDays:t.slaDays,updatedAt:new Date}),this.columnUpdated.emit();else{let i=Math.max(...this.columns.map(s=>s.order||0),-1)+1,n={name:t.name,color:t.color,order:i,endStageType:t.endStageType,slaDays:t.slaDays,boardId:this.boardId,companyId:"",createdAt:new Date,updatedAt:new Date};yield this.firestoreService.createColumn(this.ownerId,this.boardId,n),this.columnCreated.emit()}this.hide()}catch(t){console.error("Erro ao salvar coluna:",t),this.errorMessage="Erro ao salvar fase. Tente novamente."}finally{this.isLoading=!1}})}onBackdropClick(t){t.target===t.currentTarget&&this.hide()}getFieldError(t){let e=this.columnForm.get(t);return e?.errors&&e.touched&&e.errors.required?`${this.getFieldLabel(t)} \xE9 obrigat\xF3rio`:""}getFieldLabel(t){return{name:"Nome da Fase",color:"Cor",endStageType:"Tipo de Finaliza\xE7\xE3o",slaDays:"SLA (dias)"}[t]||t}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=T({type:o,selectors:[["app-column-modal"]],inputs:{ownerId:"ownerId",boardId:"boardId",columns:"columns"},outputs:{columnCreated:"columnCreated",columnUpdated:"columnUpdated",closeModal:"closeModal"},decls:1,vars:1,consts:[["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",3,"click",4,"ngIf"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-lg","max-h-[90vh]","overflow-y-auto"],[1,"flex","justify-between","items-center","p-6","border-b","border-gray-200"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","text-2xl","font-bold",3,"click","disabled"],[1,"p-6",3,"ngSubmit","formGroup"],[1,"space-y-4"],[1,"form-group"],["for","name",1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"text-red-500"],["type","text","id","name","formControlName","name","placeholder","Digite o nome da fase",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors",3,"disabled"],["class","text-red-500 text-sm mt-1",4,"ngIf"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"flex","flex-wrap","gap-2","mb-2"],["type","button","class","w-8 h-8 rounded-full border-2 transition-all hover:scale-110",3,"backgroundColor","border-gray-800","border-gray-300","disabled","click",4,"ngFor","ngForOf"],["type","color","formControlName","color",1,"w-full","h-10","border","border-gray-300","rounded-lg","cursor-pointer",3,"disabled"],["for","endStageType",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","endStageType","formControlName","endStageType",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],[1,"text-xs","text-gray-500","mt-1"],["for","slaDays",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","number","id","slaDays","formControlName","slaDays","min","0","placeholder","Ex: 3",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors",3,"disabled"],["class","bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",4,"ngIf"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-3"],[1,"flex","items-start"],[1,"fas","fa-info-circle","text-blue-500","mt-0.5","mr-2"],[1,"text-sm","text-blue-700"],[1,"mt-1","ml-2","list-disc"],[1,"flex","justify-end","gap-3","mt-6","pt-4","border-t","border-gray-200"],["type","button",1,"px-4","py-2","text-gray-700","bg-gray-200","hover:bg-gray-300","rounded-lg","font-medium","transition-colors",3,"click","disabled"],["type","submit",1,"px-6","py-2","bg-blue-500","hover:bg-blue-600","disabled:bg-blue-300","text-white","rounded-lg","font-medium","transition-colors","flex","items-center",3,"disabled"],["class","animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2",4,"ngIf"],[1,"text-red-500","text-sm","mt-1"],["type","button",1,"w-8","h-8","rounded-full","border-2","transition-all","hover:scale-110",3,"click","disabled"],[3,"value"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-lg"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-white","mr-2"]],template:function(e,i){e&1&&b(0,Gn,64,20,"div",0),e&2&&c("ngIf",i.isVisible)},dependencies:[F,L,R,j,z,oe,re,K,Se,pe,W,N,ot,U,B,Z],styles:[`.fixed[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.bg-white[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.form-group[_ngcontent-%COMP%]{position:relative}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #3b82f61a}.border-red-500[_ngcontent-%COMP%]{border-color:#ef4444!important}select[_ngcontent-%COMP%]{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");background-position:right .5rem center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:2.5rem}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}`]})};var Kn=()=>["form-canvas"],Wn=()=>[],Zn=()=>["text","email","tel","number","date"];function Qn(o,t){if(o&1&&(r(0,"div",29),p(1,"i",30),r(2,"span"),l(3),a()()),o&2){let e=t.$implicit;P("hidden",e.category!=="basic"),c("cdkDragData",e),d(),ie(e.icon),d(2),E(e.label)}}function Yn(o,t){o&1&&(r(0,"div",31),p(1,"i",32),r(2,"p",33),l(3,"Arraste campos aqui para montar seu formul\xE1rio"),a()())}function Xn(o,t){o&1&&(r(0,"span",55),l(1,"*"),a())}function Jn(o,t){if(o&1&&p(0,"input",56),o&2){let e=u().$implicit;c("type",e.type)("placeholder",e.placeholder||"Digite aqui...")}}function eo(o,t){o&1&&(r(0,"div",57),p(1,"input",58),r(2,"div",59),p(3,"i",60),r(4,"span"),l(5,"Anexar documentos (PDF, DOC, JPG, PNG)"),a()()())}function to(o,t){if(o&1&&p(0,"textarea",61),o&2){let e=u().$implicit;c("placeholder",e.placeholder||"Digite seu texto...")}}function io(o,t){if(o&1&&(r(0,"option",65),l(1),a()),o&2){let e=t.$implicit;c("value",e),d(),E(e)}}function no(o,t){if(o&1&&(r(0,"select",62)(1,"option",63),l(2,"Selecione uma op\xE7\xE3o"),a(),b(3,io,2,2,"option",64),a()),o&2){let e=u().$implicit;d(3),c("ngForOf",e.options)}}function oo(o,t){if(o&1&&(r(0,"div",68),p(1,"input",69),r(2,"label"),l(3),a()()),o&2){let e=t.$implicit,i=u(2).$implicit;d(),c("name",i.name)("value",e),d(2),E(e)}}function ro(o,t){if(o&1&&(r(0,"div",66),b(1,oo,4,3,"div",67),a()),o&2){let e=u().$implicit;d(),c("ngForOf",e.options)}}function ao(o,t){if(o&1&&(r(0,"div",70),p(1,"input",71),r(2,"label"),l(3),a()()),o&2){let e=u().$implicit;d(3),E(e.placeholder||"Marque esta op\xE7\xE3o")}}function so(o,t){if(o&1&&(r(0,"div",72),l(1),a()),o&2){let e=u().$implicit;d(),E(e.description)}}function lo(o,t){if(o&1){let e=w();r(0,"div",34),h("click",function(){let n=f(e).$implicit,s=u();return _(s.selectField(n))}),r(1,"div",35)(2,"div",36),p(3,"i",30),a(),r(4,"div",37)(5,"div",38),l(6),a(),r(7,"div",39),l(8),a()(),r(9,"div",40)(10,"button",41),h("click",function(n){let s=f(e).$implicit;return u().selectField(s),_(n.stopPropagation())}),p(11,"i",42),a(),r(12,"button",43),h("click",function(n){let s=f(e).$implicit;return u().deleteField(s),_(n.stopPropagation())}),p(13,"i",44),a()()(),r(14,"div",45)(15,"label",46),l(16),b(17,Xn,2,0,"span",47),a(),b(18,Jn,1,2,"input",48)(19,eo,6,0,"div",49)(20,to,1,1,"textarea",50)(21,no,4,1,"select",51)(22,ro,2,1,"div",52)(23,ao,4,1,"div",53)(24,so,2,1,"div",54),a()()}if(o&2){let e=t.$implicit,i=u();P("selected",(i.selectedField==null?null:i.selectedField.id)===e.id),c("cdkDragData",e),d(3),ie(i.getFieldTypeIcon(e.type)),d(3),E(e.label),d(2),E(e.name),d(8),x(" ",e.label," "),d(),c("ngIf",e.required),d(),c("ngIf",ne(16,Zn).includes(e.type)),d(),c("ngIf",e.type==="file"),d(),c("ngIf",e.type==="textarea"),d(),c("ngIf",e.type==="select"),d(),c("ngIf",e.type==="radio"),d(),c("ngIf",e.type==="checkbox"),d(),c("ngIf",e.description)}}function co(o,t){o&1&&(r(0,"div",78)(1,"label",79),l(2,"Op\xE7\xF5es "),r(3,"span",55),l(4,"*"),a()(),p(5,"textarea",90),r(6,"div",81),l(7,"Separe as op\xE7\xF5es com v\xEDrgulas"),a()())}function mo(o,t){if(o&1){let e=w();r(0,"div",73)(1,"div",74)(2,"h3",13),l(3,"Configurar Campo"),a(),r(4,"button",75),h("click",function(){f(e);let n=u();return _(n.closeFieldConfig())}),p(5,"i",76),a()(),r(6,"form",77),h("ngSubmit",function(){f(e);let n=u();return _(n.saveFieldConfig())}),r(7,"div",78)(8,"label",79),l(9,"Nome do Campo "),r(10,"span",55),l(11,"*"),a()(),p(12,"input",80),r(13,"div",81),l(14,"Nome t\xE9cnico (sem espa\xE7os)"),a()(),r(15,"div",78)(16,"label",79),l(17,"R\xF3tulo "),r(18,"span",55),l(19,"*"),a()(),p(20,"input",82),a(),r(21,"div",78)(22,"label",79),l(23,"Placeholder"),a(),p(24,"input",83),a(),r(25,"div",78)(26,"label",79),l(27,"Descri\xE7\xE3o"),a(),p(28,"textarea",84),a(),r(29,"div",78)(30,"label",85),p(31,"input",86),l(32," Campo obrigat\xF3rio "),a()(),b(33,co,8,0,"div",87),r(34,"div",88)(35,"button",26),h("click",function(){f(e);let n=u();return _(n.closeFieldConfig())}),l(36," Cancelar "),a(),r(37,"button",89),l(38," Salvar "),a()()()()}if(o&2){let e=u();d(6),c("formGroup",e.configForm),d(27),c("ngIf",e.selectedField&&e.isFieldTypeWithOptions(e.selectedField.type)),d(4),c("disabled",!e.configForm.valid)}}var ht=class o{constructor(t){this.fb=t;this.configForm=this.createConfigForm()}initialFields=[];fieldsChanged=new S;saveForm=new S;cancelForm=new S;fieldTypes=[{id:"text",name:"text",label:"Texto",icon:"fa-font",category:"basic",defaultConfig:{type:"text",required:!1}},{id:"email",name:"email",label:"Email",icon:"fa-envelope",category:"basic",defaultConfig:{type:"email",required:!1}},{id:"phone",name:"tel",label:"Telefone",icon:"fa-phone",category:"basic",defaultConfig:{type:"tel",required:!1}},{id:"number",name:"number",label:"N\xFAmero",icon:"fa-hashtag",category:"basic",defaultConfig:{type:"number",required:!1}},{id:"textarea",name:"textarea",label:"Texto Longo",icon:"fa-align-left",category:"basic",defaultConfig:{type:"textarea",required:!1}},{id:"select",name:"select",label:"Lista de Op\xE7\xF5es",icon:"fa-list",category:"basic",defaultConfig:{type:"select",required:!1,options:["Op\xE7\xE3o 1","Op\xE7\xE3o 2","Op\xE7\xE3o 3"]}},{id:"radio",name:"radio",label:"Bot\xF5es de Op\xE7\xE3o",icon:"fa-dot-circle",category:"basic",defaultConfig:{type:"radio",required:!1,options:["Sim","N\xE3o"]}},{id:"checkbox",name:"checkbox",label:"Caixa de Sele\xE7\xE3o",icon:"fa-check-square",category:"basic",defaultConfig:{type:"checkbox",required:!1}},{id:"file",name:"file",label:"Anexo de Documentos",icon:"fa-paperclip",category:"basic",defaultConfig:{type:"file",required:!1}},{id:"date",name:"date",label:"Data",icon:"fa-calendar",category:"basic",defaultConfig:{type:"date",required:!1}}];formFields=[];selectedField=null;showFieldConfig=!1;configForm;fieldIdCounter=1;ngOnInit(){this.initialFields.length>0&&(this.formFields=[...this.initialFields],this.fieldIdCounter=Math.max(...this.formFields.map(t=>parseInt(t.id.replace("field_",""))))+1)}createConfigForm(){return this.fb.group({name:["",[k.required,k.pattern(/^[a-zA-Z][a-zA-Z0-9_]*$/)]],label:["",k.required],placeholder:[""],description:[""],required:[!1],options:[""]})}onFieldTypeDrop(t){if(t.previousContainer!==t.container){let e=this.fieldTypes[t.previousIndex],i=this.createFieldFromType(e),n=[...this.formFields];n.splice(t.currentIndex,0,i),this.formFields=n,this.emitFieldsChange()}}onFieldReorder(t){t.previousContainer===t.container&&(Me(this.formFields,t.previousIndex,t.currentIndex),this.emitFieldsChange())}createFieldFromType(t){return le({id:`field_${this.fieldIdCounter++}`,name:`${t.name}_${this.fieldIdCounter}`,label:`${t.label} ${this.fieldIdCounter}`,type:t.name,required:!1},t.defaultConfig)}selectField(t){this.selectedField=t,this.showFieldConfig=!0,this.populateConfigForm(t)}populateConfigForm(t){this.configForm.patchValue({name:t.name,label:t.label,placeholder:t.placeholder||"",description:t.description||"",required:t.required,options:t.options?t.options.join(", "):""})}saveFieldConfig(){if(this.configForm.valid&&this.selectedField){let t=this.configForm.value;this.selectedField.name=t.name,this.selectedField.label=t.label,this.selectedField.placeholder=t.placeholder,this.selectedField.description=t.description,this.selectedField.required=t.required,this.isFieldTypeWithOptions(this.selectedField.type)&&(this.selectedField.options=t.options.split(",").map(e=>e.trim()).filter(e=>e.length>0)),this.showFieldConfig=!1,this.selectedField=null,this.emitFieldsChange()}}deleteField(t){let e=this.formFields.findIndex(i=>i.id===t.id);e>-1&&(this.formFields.splice(e,1),this.selectedField?.id===t.id&&this.closeFieldConfig(),this.emitFieldsChange())}closeFieldConfig(){this.showFieldConfig=!1,this.selectedField=null,this.configForm.reset()}isFieldTypeWithOptions(t){return["select","radio","checkbox"].includes(t)}getFieldTypeIcon(t){return this.fieldTypes.find(i=>i.name===t)?.icon||"fa-question"}emitFieldsChange(){this.fieldsChanged.emit([...this.formFields])}onSave(){this.saveForm.emit([...this.formFields])}onCancel(){this.cancelForm.emit()}clearForm(){confirm("Tem certeza que deseja limpar todos os campos?")&&(this.formFields=[],this.closeFieldConfig(),this.emitFieldsChange())}static \u0275fac=function(e){return new(e||o)(Ze(H))};static \u0275cmp=T({type:o,selectors:[["app-visual-form-builder"]],inputs:{initialFields:"initialFields"},outputs:{fieldsChanged:"fieldsChanged",saveForm:"saveForm",cancelForm:"cancelForm"},decls:38,vars:14,consts:[[1,"form-builder-container"],[1,"form-builder-header"],[1,"text-xl","font-bold","text-gray-900","mb-2"],[1,"text-sm","text-gray-600","mb-4"],[1,"form-builder-layout"],[1,"field-types-sidebar"],[1,"font-semibold","text-gray-900","mb-3"],[1,"field-category","mb-4"],[1,"text-xs","font-medium","text-gray-500","uppercase","tracking-wide","mb-2"],["cdkDropList","","cdkDropListSortingDisabled","true",1,"field-type-list",3,"cdkDropListData","cdkDropListConnectedTo"],["cdkDrag","","class","field-type-item",3,"hidden","cdkDragData",4,"ngFor","ngForOf"],[1,"form-canvas-container"],[1,"form-canvas-header"],[1,"font-semibold","text-gray-900"],[1,"canvas-actions"],["type","button",1,"text-red-600","hover:text-red-800","text-sm",3,"click"],[1,"fas","fa-trash","mr-1"],["id","form-canvas","cdkDropList","",1,"form-canvas",3,"cdkDropListDropped","cdkDropListData","cdkDropListConnectedTo"],["class","drop-zone-empty",4,"ngIf"],["cdkDrag","","class","form-field-item",3,"cdkDragData","selected","click",4,"ngFor","ngForOf"],[1,"field-config-sidebar"],["class","field-config-panel",4,"ngIf"],[1,"form-builder-actions"],[1,"flex","justify-between","items-center"],[1,"text-sm","text-gray-600"],[1,"flex","gap-3"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-success",3,"click","disabled"],[1,"fas","fa-save","mr-2"],["cdkDrag","",1,"field-type-item",3,"cdkDragData"],[1,"fas"],[1,"drop-zone-empty"],[1,"fas","fa-plus-circle","text-4xl","text-gray-300","mb-3"],[1,"text-gray-500"],["cdkDrag","",1,"form-field-item",3,"click","cdkDragData"],[1,"form-field-header"],[1,"field-type-indicator"],[1,"field-info"],[1,"field-label"],[1,"field-name"],[1,"field-actions"],["type","button",1,"field-action-btn",3,"click"],[1,"fas","fa-cog"],["type","button",1,"field-action-btn","text-red-500","hover:text-red-700",3,"click"],[1,"fas","fa-trash"],[1,"field-preview"],[1,"field-preview-label"],["class","text-red-500",4,"ngIf"],["class","field-preview-input","disabled","",3,"type","placeholder",4,"ngIf"],["class","field-preview-file",4,"ngIf"],["rows","3","class","field-preview-textarea","disabled","",3,"placeholder",4,"ngIf"],["class","field-preview-select","disabled","",4,"ngIf"],["class","field-preview-radio",4,"ngIf"],["class","field-preview-checkbox",4,"ngIf"],["class","field-description",4,"ngIf"],[1,"text-red-500"],["disabled","",1,"field-preview-input",3,"type","placeholder"],[1,"field-preview-file"],["type","file","disabled","",1,"field-preview-input"],[1,"file-info"],[1,"fas","fa-paperclip","mr-2"],["rows","3","disabled","",1,"field-preview-textarea",3,"placeholder"],["disabled","",1,"field-preview-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"field-preview-radio"],["class","radio-option",4,"ngFor","ngForOf"],[1,"radio-option"],["type","radio","disabled","",3,"name","value"],[1,"field-preview-checkbox"],["type","checkbox","disabled",""],[1,"field-description"],[1,"field-config-panel"],[1,"config-header"],["type","button",1,"text-gray-500","hover:text-gray-700",3,"click"],[1,"fas","fa-times"],[1,"config-form",3,"ngSubmit","formGroup"],[1,"form-group"],[1,"form-label"],["type","text","formControlName","name","placeholder","Ex: nomeEmpresa",1,"form-input"],[1,"form-hint"],["type","text","formControlName","label","placeholder","Ex: Nome da Empresa",1,"form-input"],["type","text","formControlName","placeholder","placeholder","Texto de exemplo",1,"form-input"],["formControlName","description","rows","2","placeholder","Texto de ajuda (opcional)",1,"form-textarea"],[1,"form-checkbox-label"],["type","checkbox","formControlName","required",1,"form-checkbox"],["class","form-group",4,"ngIf"],[1,"config-actions"],["type","submit",1,"btn","btn-primary",3,"disabled"],["formControlName","options","rows","3","placeholder","Op\xE7\xE3o 1, Op\xE7\xE3o 2, Op\xE7\xE3o 3",1,"form-textarea"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"div",1)(2,"h2",2),l(3,"Construtor de Formul\xE1rio"),a(),r(4,"p",3),l(5,"Arraste os tipos de campo da esquerda para o centro para montar seu formul\xE1rio."),a()(),r(6,"div",4)(7,"div",5)(8,"h3",6),l(9,"Tipos de Campo"),a(),r(10,"div",7)(11,"h4",8),l(12,"Campos B\xE1sicos"),a(),r(13,"div",9),b(14,Qn,4,6,"div",10),a()()(),r(15,"div",11)(16,"div",12)(17,"h3",13),l(18,"Formul\xE1rio"),a(),r(19,"div",14)(20,"button",15),h("click",function(){return i.clearForm()}),p(21,"i",16),l(22,"Limpar "),a()()(),r(23,"div",17),h("cdkDropListDropped",function(s){return i.onFieldTypeDrop(s)}),b(24,Yn,4,0,"div",18)(25,lo,25,17,"div",19),a()(),r(26,"div",20),b(27,mo,39,3,"div",21),a()(),r(28,"div",22)(29,"div",23)(30,"div",24),l(31),a(),r(32,"div",25)(33,"button",26),h("click",function(){return i.onCancel()}),l(34," Cancelar "),a(),r(35,"button",27),h("click",function(){return i.onSave()}),p(36,"i",28),l(37,"Salvar Formul\xE1rio "),a()()()()()),e&2&&(d(13),c("cdkDropListData",i.fieldTypes)("cdkDropListConnectedTo",ne(12,Kn)),d(),c("ngForOf",i.fieldTypes),d(9),c("cdkDropListData",i.formFields)("cdkDropListConnectedTo",ne(13,Wn)),d(),c("ngIf",i.formFields.length===0),d(),c("ngForOf",i.formFields),d(),P("show",i.showFieldConfig),d(),c("ngIf",i.showFieldConfig&&i.selectedField),d(4),x(" ",i.formFields.length," campo(s) adicionado(s) "),d(4),c("disabled",i.formFields.length===0))},dependencies:[F,L,R,j,z,oe,re,K,yi,W,N,U,B,Z,gt,pt,ut],styles:[".form-builder-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:70vh;min-height:600px;background-color:#f8fafc}.form-builder-header[_ngcontent-%COMP%]{padding:1.5rem;background:#fff;border-bottom:1px solid #e2e8f0}.form-builder-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:250px 1fr 350px;height:100%;gap:1px;overflow:hidden;background:#e2e8f0}.field-types-sidebar[_ngcontent-%COMP%]{background:#fff;padding:1rem;overflow-y:auto}.field-category[_ngcontent-%COMP%]{margin-bottom:1rem}.field-category[_ngcontent-%COMP%]:last-child{margin-bottom:0}.field-type-list[_ngcontent-%COMP%]{min-height:50px}.field-type-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.75rem;margin-bottom:.5rem;background:#f1f5f9;border:2px dashed #cbd5e1;border-radius:.5rem;cursor:grab;transition:all .2s ease;-webkit-user-select:none;user-select:none}.field-type-item[_ngcontent-%COMP%]:hover{background:#e2e8f0;border-color:#94a3b8;transform:translateY(-1px);box-shadow:0 2px 4px #0000001a}.field-type-item[_ngcontent-%COMP%]:active{cursor:grabbing}.field-type-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.5rem;width:16px;text-align:center;color:#475569}.field-type-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:#334155}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:.5;transform:scale(.95)}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .3s cubic-bezier(0,0,.2,1)}.form-canvas-container[_ngcontent-%COMP%]{background:#fafafa;display:flex;flex-direction:column}.form-canvas-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem;background:#fff;border-bottom:1px solid #e2e8f0}.canvas-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:.875rem;padding:.25rem .5rem;border-radius:.375rem;transition:colors .2s}.canvas-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#fef2f2}.form-canvas[_ngcontent-%COMP%]{flex:1;padding:1rem;overflow-y:auto;min-height:300px;position:relative}.form-canvas.cdk-drop-list-dragging[_ngcontent-%COMP%]   .form-field-item[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .3s cubic-bezier(0,0,.2,1)}.drop-zone-empty[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:300px;border:2px dashed #cbd5e1;border-radius:.75rem;background:#fff;margin:2rem 0}.form-field-item[_ngcontent-%COMP%]{background:#fff;border:2px solid #e2e8f0;border-radius:.75rem;margin-bottom:1rem;transition:all .2s ease;cursor:pointer}.form-field-item[_ngcontent-%COMP%]:hover{border-color:#3b82f6;box-shadow:0 4px 6px -1px #0000001a}.form-field-item.selected[_ngcontent-%COMP%]{border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.form-field-item.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 25px 50px -12px #00000040;transform:rotate(2deg)}.form-field-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:1rem;border-bottom:1px solid #f1f5f9}.field-type-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:#3b82f6;color:#fff;border-radius:.5rem;margin-right:.75rem;flex-shrink:0}.field-info[_ngcontent-%COMP%]{flex:1}.field-label[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;margin-bottom:.125rem}.field-name[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-family:Courier New,monospace}.field-actions[_ngcontent-%COMP%]{display:flex;gap:.25rem}.field-action-btn[_ngcontent-%COMP%]{padding:.375rem;border:none;background:none;border-radius:.375rem;color:#6b7280;transition:all .2s;cursor:pointer}.field-action-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.field-preview[_ngcontent-%COMP%]{padding:1rem}.field-preview-label[_ngcontent-%COMP%]{display:block;font-weight:500;color:#374151;margin-bottom:.5rem;font-size:.875rem}.field-preview-input[_ngcontent-%COMP%], .field-preview-textarea[_ngcontent-%COMP%], .field-preview-select[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:.375rem;font-size:.875rem;background:#f9fafb;color:#6b7280}.field-preview-input[_ngcontent-%COMP%]:focus, .field-preview-textarea[_ngcontent-%COMP%]:focus, .field-preview-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.field-preview-textarea[_ngcontent-%COMP%]{resize:vertical;min-height:80px}.field-preview-radio[_ngcontent-%COMP%]   .radio-option[_ngcontent-%COMP%], .field-preview-checkbox[_ngcontent-%COMP%]   .radio-option[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:.5rem}.field-preview-radio[_ngcontent-%COMP%]   .radio-option[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .field-preview-checkbox[_ngcontent-%COMP%]   .radio-option[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-right:.5rem}.field-preview-radio[_ngcontent-%COMP%]   .radio-option[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .field-preview-checkbox[_ngcontent-%COMP%]   .radio-option[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;margin-bottom:0}.field-preview-file[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]{margin-top:.5rem;padding:.75rem;background:#f8fafc;border:1px dashed #cbd5e1;border-radius:.375rem;text-align:center;color:#64748b;font-size:.875rem}.field-description[_ngcontent-%COMP%]{margin-top:.5rem;font-size:.75rem;color:#6b7280;font-style:italic}.field-config-sidebar[_ngcontent-%COMP%]{background:#fff;border-left:1px solid #e2e8f0;transition:transform .3s ease;overflow-y:auto}.field-config-sidebar.show[_ngcontent-%COMP%]{transform:translate(0)}.field-config-panel[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.config-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem;border-bottom:1px solid #e2e8f0}.config-form[_ngcontent-%COMP%]{flex:1;padding:1rem;overflow-y:auto}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-label[_ngcontent-%COMP%]{display:block;font-weight:500;color:#374151;margin-bottom:.5rem;font-size:.875rem}.form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:.375rem;font-size:.875rem;transition:border-color .2s}.form-input[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.form-textarea[_ngcontent-%COMP%]{resize:vertical;min-height:60px}.form-hint[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;margin-top:.25rem}.form-checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:400;cursor:pointer}.form-checkbox[_ngcontent-%COMP%]{margin-right:.5rem;width:16px;height:16px}.config-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;padding:1rem;border-top:1px solid #e2e8f0;margin-top:auto}.form-builder-actions[_ngcontent-%COMP%]{background:#fff;padding:1rem;border-top:1px solid #e2e8f0}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:.5rem 1rem;border-radius:.375rem;font-size:.875rem;font-weight:500;border:none;cursor:pointer;transition:all .2s ease}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{background-color:#3b82f6;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#2563eb}.btn-secondary[_ngcontent-%COMP%]{background-color:#6b7280;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#4b5563}.btn-success[_ngcontent-%COMP%]{background-color:#10b981;color:#fff}.btn-success[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#059669}@media (max-width: 1024px){.form-builder-layout[_ngcontent-%COMP%]{grid-template-columns:250px 1fr}.field-config-sidebar[_ngcontent-%COMP%]{position:fixed;top:0;right:0;width:320px;height:100vh;z-index:50;transform:translate(100%);box-shadow:-4px 0 6px -1px #0000001a}}@media (max-width: 768px){.form-builder-layout[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-template-rows:auto 1fr}.field-types-sidebar[_ngcontent-%COMP%]{border-right:none;border-bottom:1px solid #e2e8f0;max-height:200px}.field-type-list[_ngcontent-%COMP%]{display:flex;gap:.5rem;overflow-x:auto;padding-bottom:.5rem}.field-type-item[_ngcontent-%COMP%]{min-width:120px;margin-bottom:0}}"]})};function uo(o,t){if(o&1&&(r(0,"div",10),l(1),a()),o&2){let e=u(2);d(),x(" ",e.errorMessage," ")}}function po(o,t){if(o&1){let e=w();r(0,"div",1),h("click",function(n){f(e);let s=u();return _(s.onBackdropClick(n))}),r(1,"div",2)(2,"div",3)(3,"h2",4),l(4),a(),r(5,"button",5),h("click",function(){f(e);let n=u();return _(n.hide())}),l(6," \xD7 "),a()(),r(7,"form",6),h("ngSubmit",function(){f(e);let n=u();return _(n.saveFormConfig())}),r(8,"div",7)(9,"app-visual-form-builder",8),h("fieldsChanged",function(n){f(e);let s=u();return _(s.onFormFieldsChanged(n))})("saveForm",function(n){f(e);let s=u();return _(s.onFormBuilderSave(n))})("cancelForm",function(){f(e);let n=u();return _(n.hide())}),a(),b(10,uo,2,1,"div",9),a()()()()}if(o&2){let e=u();d(4),x(" Formul\xE1rio da Fase: ",e.column==null?null:e.column.name," "),d(),c("disabled",e.isLoading),d(2),c("formGroup",e.formConfigForm),d(2),c("initialFields",e.formFields),d(),c("ngIf",e.errorMessage)}}var ze=class o{authService=v(ae);firestoreService=v($);fb=v(H);ownerId="";boardId="";column=null;formConfigSaved=new S;closeModal=new S;isVisible=!1;isLoading=!1;errorMessage="";currentFormConfig=null;form=new Ci({});model={};fields=[{fieldGroupClassName:"row",fieldGroup:[{className:"col-6",key:"fieldName",type:"input",props:{label:"Nome do Campo",placeholder:"Ex: companyName",required:!0},validators:{validation:["required"]}},{className:"col-6",key:"fieldLabel",type:"input",props:{label:"R\xF3tulo do Campo",placeholder:"Ex: Nome da Empresa",required:!0}}]},{fieldGroupClassName:"row",fieldGroup:[{className:"col-6",key:"fieldType",type:"select",props:{label:"Tipo do Campo",required:!0,options:[{value:"input",label:"Texto"},{value:"email",label:"Email"},{value:"number",label:"N\xFAmero"},{value:"tel",label:"Telefone"},{value:"textarea",label:"Texto Longo"},{value:"select",label:"Lista de Op\xE7\xF5es"},{value:"checkbox",label:"Caixa de Sele\xE7\xE3o"},{value:"radio",label:"Bot\xF5es de Op\xE7\xE3o"},{value:"date",label:"Data"}]}},{className:"col-6",key:"required",type:"checkbox",props:{label:"Campo Obrigat\xF3rio"}}]},{key:"placeholder",type:"input",props:{label:"Texto de Exemplo",placeholder:"Ex: Digite o nome da empresa"}},{key:"options",type:"textarea",props:{label:"Op\xE7\xF5es (separadas por v\xEDrgula)",placeholder:"Ex: Op\xE7\xE3o 1, Op\xE7\xE3o 2, Op\xE7\xE3o 3",rows:3},hideExpression:t=>!["select","radio","checkbox"].includes(t.fieldType)}];formFields=[];formConfigForm=this.fb.group({fields:this.fb.array([])});fieldTypes=[{value:"text",label:"Texto"},{value:"email",label:"Email"},{value:"tel",label:"Telefone"},{value:"number",label:"N\xFAmero"},{value:"date",label:"Data"},{value:"select",label:"Lista de Op\xE7\xF5es"},{value:"textarea",label:"Texto Longo"}];get fieldsArray(){return this.formConfigForm.get("fields")}showModal(t,e){this.column=t,this.currentFormConfig=e||null,this.isVisible=!0,this.initializeForm()}hide(){this.isVisible=!1,this.resetForm(),this.closeModal.emit()}initializeForm(){this.formFields=[],this.currentFormConfig?.fields&&(this.formFields=this.currentFormConfig.fields.map((t,e)=>({id:`field_${e+1}`,name:t.name,label:t.label,type:t.type,required:t.required,placeholder:t.placeholder,options:t.options,description:void 0}))),this.model={},this.form.reset()}createFieldGroup(t){return this.fb.group({name:[t?.name||"",[k.required]],label:[t?.label||"",[k.required]],type:[t?.type||"text",[k.required]],required:[t?.required||!1],placeholder:[t?.placeholder||""],options:[t?.options?.join(`
`)||""]})}onFormFieldsChanged(t){this.formFields=t}onFormBuilderSave(t){this.formFields=t,this.saveFormConfig()}getFieldTypeLabel(t){return{input:"Texto",email:"Email",number:"N\xFAmero",tel:"Telefone",textarea:"Texto Longo",select:"Lista de Op\xE7\xF5es",checkbox:"Caixa de Sele\xE7\xE3o",radio:"Bot\xF5es de Op\xE7\xE3o",date:"Data",text:"Texto"}[t]||t}saveFormConfig(){return M(this,null,function*(){if(this.formFields.length===0){this.errorMessage="Por favor, adicione pelo menos um campo ao formul\xE1rio.";return}if(!this.column){this.errorMessage="Fase n\xE3o encontrada.";return}this.isLoading=!0,this.errorMessage="";try{let t=this.formFields.map(s=>s.name),e=new Set(t);if(t.length!==e.size){this.errorMessage="Cada campo deve ter um nome \xFAnico.",this.isLoading=!1;return}let i=this.formFields.map(s=>({name:s.name,label:s.label,type:s.type,required:s.required,placeholder:s.placeholder,options:s.options})),n={columnId:this.column.id,fields:i,updatedAt:new Date};this.currentFormConfig?.id?yield this.firestoreService.updatePhaseFormConfig(this.ownerId,this.boardId,this.currentFormConfig.id,n):(n.createdAt=new Date,yield this.firestoreService.createPhaseFormConfig(this.ownerId,this.boardId,n)),this.formConfigSaved.emit(),this.hide()}catch(t){console.error("Erro ao salvar configura\xE7\xE3o do formul\xE1rio:",t),this.errorMessage="Erro ao salvar configura\xE7\xE3o. Tente novamente."}finally{this.isLoading=!1}})}resetForm(){this.formConfigForm.reset(),this.errorMessage="",this.isLoading=!1,this.currentFormConfig=null,this.column=null}onBackdropClick(t){t.target===t.currentTarget&&this.hide()}generateFieldName(t){return t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]/g,"").substring(0,30)}onLabelChange(t){let e=this.fieldsArray.at(t),i=e.get("label")?.value,n=e.get("name")?.value;(!n||n===this.generateFieldName(e.get("label")?.value))&&e.patchValue({name:this.generateFieldName(i)})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=T({type:o,selectors:[["app-phase-form-modal"]],inputs:{ownerId:"ownerId",boardId:"boardId",column:"column"},outputs:{formConfigSaved:"formConfigSaved",closeModal:"closeModal"},decls:1,vars:1,consts:[["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",3,"click",4,"ngIf"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-7xl","max-h-[95vh]","overflow-y-auto"],[1,"flex","justify-between","items-center","p-6","border-b","border-gray-200"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","text-2xl","font-bold",3,"click","disabled"],[1,"p-6",3,"ngSubmit","formGroup"],[1,"space-y-6"],[3,"fieldsChanged","saveForm","cancelForm","initialFields"],["class","bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",4,"ngIf"],[1,"bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-lg"]],template:function(e,i){e&1&&b(0,po,11,5,"div",0),e&2&&c("ngIf",i.isVisible)},dependencies:[F,R,j,z,N,U,B,wi,Si,ht],styles:[`.fixed[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.bg-white[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.form-group[_ngcontent-%COMP%]{position:relative}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #3b82f61a}.border-red-500[_ngcontent-%COMP%]{border-color:#ef4444!important}select[_ngcontent-%COMP%]{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");background-position:right .5rem center;background-repeat:no-repeat;background-size:1.5em 1.5em;padding-right:2.5rem}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f5f9}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#cbd5e1;border-radius:3px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#94a3b8}.bg-gray-50[_ngcontent-%COMP%]{transition:all .2s ease}.bg-gray-50[_ngcontent-%COMP%]:hover{background-color:#f8fafc}button[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.5}`]})};function go(o,t){if(o&1&&(r(0,"div",12)(1,"strong",13),l(2),a(),r(3,"span",14),l(4),a()()),o&2){let e=t.$implicit;d(2),x("",e.label,":"),d(2),E(e.value)}}function ho(o,t){if(o&1&&(r(0,"div",53),l(1),a()),o&2){let e=u().$implicit;d(),x("Sa\xEDda: ",e.exitedAt)}}function fo(o,t){if(o&1&&(r(0,"div",51)(1,"div",52),l(2),a(),r(3,"div",53),l(4),a(),b(5,ho,2,1,"div",54),r(6,"div",53),l(7),a()()),o&2){let e=t.$implicit;ee("border-left-color",e.phaseColor),d(2),E(e.phaseName),d(2),x("Entrada: ",e.enteredAt),d(),c("ngIf",e.exitedAt!=="Atual"),d(2),x("Dura\xE7\xE3o: ",e.duration)}}function _o(o,t){if(o&1&&(r(0,"div",62)(1,"a",63),p(2,"i",64),l(3),a()()),o&2){let e=u().$implicit;d(),c("href",e.attachment.url,ti),d(2),x(" ",e.attachment.name," ")}}function bo(o,t){if(o&1&&(r(0,"div",55)(1,"div",56),p(2,"i",57),r(3,"span",58),l(4),a(),r(5,"span",59),l(6),a()(),p(7,"div",60),b(8,_o,4,2,"div",61),a()),o&2){let e=t.$implicit,i=u(2);d(2),ie(i.getActivityIcon(e.type)),d(2),E(e.user),d(2),E(i.formatDateTime(e.timestamp)),d(),c("innerHTML",e.text,We),d(),c("ngIf",e.attachment)}}function vo(o,t){if(o&1&&(r(0,"option",65),l(1),a()),o&2){let e=t.$implicit;c("value",e.uid),d(),x(" ",e.displayName||e.email," ")}}function xo(o,t){o&1&&(r(0,"span",72),l(1,"*"),a())}function yo(o,t){if(o&1&&p(0,"input",73),o&2){let e=u().$implicit;c("type",e.type)("formControlName",e.name)("placeholder",e.placeholder||"")}}function Co(o,t){if(o&1&&(r(0,"textarea",74),l(1,"                "),a()),o&2){let e=u().$implicit;c("formControlName",e.name)("placeholder",e.placeholder||"")}}function wo(o,t){if(o&1&&p(0,"input",75),o&2){let e=u().$implicit;c("formControlName",e.name)("placeholder",e.placeholder||"")}}function So(o,t){if(o&1&&p(0,"input",76),o&2){let e=u().$implicit;c("formControlName",e.name)}}function Eo(o,t){if(o&1&&(r(0,"option",65),l(1),a()),o&2){let e=t.$implicit;c("value",e),d(),E(e)}}function Mo(o,t){if(o&1&&(r(0,"select",77)(1,"option",25),l(2,"Selecione..."),a(),b(3,Eo,2,2,"option",26),a()),o&2){let e=u().$implicit;c("formControlName",e.name),d(3),c("ngForOf",e.options)}}function Do(o,t){if(o&1&&(ni(0),r(1,"div",22)(2,"label",23),l(3),b(4,xo,2,0,"span",66),a(),b(5,yo,1,3,"input",67)(6,Co,2,2,"textarea",68)(7,wo,1,2,"input",69)(8,So,1,1,"input",70)(9,Mo,4,2,"select",71),a(),oi()),o&2){let e=t.$implicit;d(3),x(" ",e.label," "),d(),c("ngIf",e.required),d(),c("ngIf",e.type==="text"||e.type==="email"||e.type==="tel"||e.type==="url"),d(),c("ngIf",e.type==="textarea"),d(),c("ngIf",e.type==="number"),d(),c("ngIf",e.type==="date"),d(),c("ngIf",e.type==="select")}}function Po(o,t){if(o&1){let e=w();r(0,"div",78)(1,"span"),l(2),a(),r(3,"button",79),h("click",function(){f(e);let n=u(2);return _(n.clearAttachment())}),p(4,"i",80),a()()}if(o&2){let e=u(2);d(2),E(e.attachmentPreview)}}function Io(o,t){o&1&&p(0,"div",81)}function To(o,t){if(o&1){let e=w();r(0,"button",86),h("click",function(){let n=f(e).$implicit,s=u(3);return _(s.moveLead(n.id))}),p(1,"div",87),r(2,"span",58),l(3),a()()}if(o&2){let e=t.$implicit,i=u(3);c("disabled",i.isLoading),d(),ee("background-color",e.color),d(2),E(e.name)}}function ko(o,t){if(o&1&&(r(0,"div",82)(1,"h4",83),l(2,"\u{1F680} Avan\xE7ar para:"),a(),r(3,"div",84),b(4,To,4,4,"button",85),a()()),o&2){let e=u(2);d(4),c("ngForOf",e.getAdvancePhases())}}function Fo(o,t){if(o&1){let e=w();r(0,"button",91),h("click",function(){let n=f(e).$implicit,s=u(3);return _(s.moveLead(n.id))}),p(1,"div",92),r(2,"span"),l(3),a()()}if(o&2){let e=t.$implicit,i=u(3);c("disabled",i.isLoading),d(),ee("background-color",e.color),d(2),E(e.name)}}function Oo(o,t){if(o&1&&(r(0,"div",82)(1,"h4",88),l(2,"\u{1F504} Retornar para:"),a(),r(3,"div",89),b(4,Fo,4,4,"button",90),a()()),o&2){let e=u(2);d(4),c("ngForOf",e.getRetreatPhases())}}function Lo(o,t){o&1&&(r(0,"div",93),l(1," Lead em fase final. N\xE3o \xE9 poss\xEDvel movimentar. "),a())}function Ro(o,t){if(o&1){let e=w();r(0,"div",11)(1,"p",94),l(2,"Compartilhe este link para permitir edi\xE7\xE3o externa:"),a(),r(3,"div",95),p(4,"input",96),r(5,"button",97),h("click",function(){f(e);let n=u(2);return _(n.copyPublicLink())}),p(6,"i",98),a()()()}if(o&2){let e=u(2);d(4),c("value",e.publicLink)}}function Ao(o,t){if(o&1&&(r(0,"div",99),l(1),a()),o&2){let e=u(2);d(),x(" ",e.errorMessage," ")}}function Vo(o,t){o&1&&p(0,"div",81)}function No(o,t){if(o&1){let e=w();r(0,"div",2),h("click",function(n){f(e);let s=u();return _(s.onBackdropClick(n))}),r(1,"div",3)(2,"div",4)(3,"h2",5),l(4),a(),r(5,"button",6),h("click",function(){f(e);let n=u();return _(n.hide())}),l(6," \xD7 "),a()(),r(7,"div",7)(8,"div",8)(9,"div",9)(10,"h3",10),l(11,"Dados do Lead"),a(),r(12,"div",11)(13,"div",12)(14,"strong",13),l(15,"Respons\xE1vel:"),a(),r(16,"span",14),l(17),a()(),b(18,go,5,2,"div",15),a()(),r(19,"div",9)(20,"h3",10),l(21,"Hist\xF3rico de Fases"),a(),r(22,"div",16),b(23,fo,8,6,"div",17),a()(),r(24,"div")(25,"h3",10),l(26,"Atividades Recentes"),a(),r(27,"div",18),b(28,bo,9,6,"div",19),a()()(),r(29,"div",20)(30,"div",9)(31,"h3",10),l(32,"Formul\xE1rio da Fase Atual"),a(),r(33,"form",21)(34,"div",22)(35,"label",23),l(36," Respons\xE1vel "),a(),r(37,"select",24)(38,"option",25),l(39,"Ningu\xE9m"),a(),b(40,vo,2,2,"option",26),a()(),r(41,"div",22)(42,"label",23),l(43," Temperatura "),r(44,"span",27),l(45,"(Qualifica\xE7\xE3o do lead)"),a()(),r(46,"select",28)(47,"option",25),l(48,"Selecione..."),a(),r(49,"option",29),l(50,"\u2744\uFE0F Frio - Pouco interesse"),a(),r(51,"option",30),l(52,"\u{1F321}\uFE0F Morno - Interesse moderado"),a(),r(53,"option",31),l(54,"\u{1F525} Quente - Muito interessado"),a(),r(55,"option",32),l(56,"\u2B50 Cliente - J\xE1 convertido"),a()()(),b(57,Do,10,7,"ng-container",33),a()(),r(58,"div")(59,"h3",10),l(60,"Coment\xE1rios"),a(),r(61,"div",34)(62,"div")(63,"textarea",35),ue("ngModelChange",function(n){f(e);let s=u();return me(s.commentText,n)||(s.commentText=n),_(n)}),l(64,"              "),a(),b(65,Po,5,1,"div",36),r(66,"div",37)(67,"div")(68,"button",38),h("click",function(){f(e);let n=ri(72);return _(n.click())}),p(69,"i",39),l(70,"Anexar Arquivo "),a(),r(71,"input",40,0),h("change",function(n){f(e);let s=u();return _(s.onFileSelected(n))}),a()(),r(73,"button",41),h("click",function(){f(e);let n=u();return _(n.addComment())}),b(74,Io,1,0,"div",42),p(75,"i",43),l(76),a()()()()()(),r(77,"div",44)(78,"div")(79,"div",9)(80,"h3",10),l(81,"Mover Lead"),a(),b(82,ko,5,1,"div",45)(83,Oo,5,1,"div",45)(84,Lo,2,0,"div",46),a(),r(85,"div",9)(86,"h3",10),l(87,"Link P\xFAblico"),a(),b(88,Ro,7,1,"div",47),a()(),r(89,"div",16),b(90,Ao,2,1,"div",48),r(91,"button",49),h("click",function(){f(e);let n=u();return _(n.saveChanges())}),b(92,Vo,1,0,"div",42),l(93),a(),r(94,"button",50),h("click",function(){f(e);let n=u();return _(n.deleteLead())}),l(95," Apagar Lead "),a()()()()()()}if(o&2){let e,i=u();d(4),x(" ",((e=i.getCurrentColumn())==null?null:e.order)===0?(i.currentLead==null||i.currentLead.fields==null?null:i.currentLead.fields.companyName)||"Lead":(i.currentLead==null||i.currentLead.fields==null?null:i.currentLead.fields.title)||"Editar Lead"," "),d(),c("disabled",i.isLoading),d(12),x(" ",(i.currentLead==null?null:i.currentLead.responsibleUserName)||"Ningu\xE9m"," "),d(),c("ngForOf",i.getInitialFields()),d(5),c("ngForOf",i.getPhaseHistoryItems()),d(5),c("ngForOf",i.getActivityLog()),d(5),c("formGroup",i.leadForm),d(7),c("ngForOf",i.users),d(17),c("ngForOf",i.currentFormFields),d(6),ce("ngModel",i.commentText),d(2),c("ngIf",i.attachmentPreview),d(8),c("disabled",i.isUploadingComment||!i.commentText.trim()&&!i.selectedFile),d(),c("ngIf",i.isUploadingComment),d(2),x(" ",i.isUploadingComment?"Enviando...":"Enviar"," "),d(6),c("ngIf",i.getAdvancePhases().length>0),d(),c("ngIf",i.getRetreatPhases().length>0),d(),c("ngIf",i.getAdvancePhases().length===0&&i.getRetreatPhases().length===0),d(4),c("ngIf",i.publicLink),d(2),c("ngIf",i.errorMessage),d(),c("disabled",i.isSaving||i.isLoading),d(),c("ngIf",i.isSaving),d(),x(" ",i.isSaving?"Salvando...":"Salvar Altera\xE7\xF5es"," "),d(),c("disabled",i.isLoading||i.isSaving)}}var Be=class o{authService=v(ae);firestoreService=v($);storageService=v(De);fb=v(H);ownerId="";boardId="";columns=[];users=[];leadUpdated=new S;leadDeleted=new S;closeModal=new S;isVisible=!1;isLoading=!1;isSaving=!1;errorMessage="";currentLead=null;leadHistory=[];phaseHistory={};leadForm=this.fb.group({});commentText="";selectedFile=null;attachmentPreview="";isUploadingComment=!1;publicLink="";show(t){return M(this,null,function*(){this.currentLead=t,this.isVisible=!0,this.resetForm(),yield this.loadLeadData()})}hide(){this.isVisible=!1,this.resetForm(),this.closeModal.emit()}resetForm(){this.leadForm=this.fb.group({}),this.commentText="",this.selectedFile=null,this.attachmentPreview="",this.errorMessage="",this.publicLink="",this.leadHistory=[],this.phaseHistory={}}loadLeadData(){return M(this,null,function*(){if(this.currentLead)try{let t=yield this.firestoreService.getLeadHistory(this.ownerId,this.boardId,this.currentLead.id);this.leadHistory=t,this.phaseHistory=this.currentLead.phaseHistory||{},yield this.loadCurrentFormFields(),yield this.buildDynamicForm(),this.generatePublicLink()}catch(t){console.error("Erro ao carregar dados do lead:",t),this.errorMessage="Erro ao carregar dados do lead."}})}buildDynamicForm(){return M(this,null,function*(){if(!this.currentLead)return;let t={};t.responsibleUserId=[this.currentLead.responsibleUserId||""],t.temperature=[this.currentLead.fields?.temperature||""],this.currentFormFields.forEach(e=>{let i=this.currentLead.fields?.[e.name]||"";t[e.name]=[i]}),this.leadForm=this.fb.group(t)})}getCurrentColumn(){return this.currentLead&&this.columns.find(t=>t.id===this.currentLead.columnId)||null}getInitialColumn(){return this.columns.find(t=>t.order===0)||null}getInitialFields(){return this.getInitialColumn()?[{name:"companyName",label:"Empresa"},{name:"cnpj",label:"CNPJ"},{name:"contactName",label:"Contato"},{name:"contactEmail",label:"Email"},{name:"contactPhone",label:"Telefone"},{name:"temperature",label:"Temperatura"}].map(i=>$e(le({},i),{value:this.currentLead?.fields?.[i.name]||"N\xE3o informado"})):[]}currentFormFields=[];loadCurrentFormFields(){return M(this,null,function*(){let t=this.getCurrentColumn();if(!t){this.currentFormFields=[];return}try{let e=yield this.firestoreService.getPhaseFormConfig(this.ownerId,this.boardId,t.id);this.currentFormFields=e?.fields||[]}catch(e){console.error("Erro ao buscar campos do formul\xE1rio:",e),this.currentFormFields=[]}})}getPhaseHistoryItems(){let t=[];return Object.values(this.phaseHistory).forEach(e=>{let i=this.columns.find(n=>n.id===e.phaseId);if(i){let n=e.enteredAt?.toDate?e.enteredAt.toDate():new Date(e.enteredAt),s=e.exitedAt?.toDate?e.exitedAt.toDate():e.exitedAt?new Date(e.exitedAt):null,m="";if(e.duration){let g=Math.floor(e.duration/864e5),y=Math.floor(e.duration%(1e3*60*60*24)/(1e3*60*60));g>0?m=`${g}d ${y}h`:m=`${y}h`}t.push({phaseName:i.name,phaseColor:i.color,enteredAt:n.toLocaleString("pt-BR"),exitedAt:s?.toLocaleString("pt-BR")||"Atual",duration:m||"Em andamento"})}}),t.sort((e,i)=>new Date(e.enteredAt).getTime()-new Date(i.enteredAt).getTime())}getActivityLog(){return this.leadHistory.sort((t,e)=>{let i=t.timestamp?.toDate?t.timestamp.toDate():new Date(t.timestamp);return(e.timestamp?.toDate?e.timestamp.toDate():new Date(e.timestamp)).getTime()-i.getTime()})}getAvailablePhases(){let t=this.getCurrentColumn();return t?t.endStageType&&t.endStageType!=="none"?[]:this.columns.filter(e=>e.id!==t.id):[]}getAdvancePhases(){let t=this.getCurrentColumn();return t?t.endStageType&&t.endStageType!=="none"?[]:this.columns.filter(e=>e.id!==t.id&&e.order>t.order).sort((e,i)=>e.order-i.order):[]}getRetreatPhases(){let t=this.getCurrentColumn();return t?t.order===0?[]:this.columns.filter(e=>e.id!==t.id&&e.order<t.order).sort((e,i)=>i.order-e.order):[]}saveChanges(){return M(this,null,function*(){if(!(!this.currentLead||!this.leadForm.valid)){this.isSaving=!0,this.errorMessage="";try{let t=this.leadForm.value,e=this.authService.getCurrentUser();if(!e)throw new Error("Usu\xE1rio n\xE3o autenticado");let i={fields:le(le({},this.currentLead.fields),t)};if(t.responsibleUserId!==this.currentLead.responsibleUserId){let n=this.users.find(s=>s.uid===t.responsibleUserId);i.responsibleUserId=t.responsibleUserId,i.responsibleUserName=n?.displayName||"",i.responsibleUserEmail=n?.email||"",yield this.firestoreService.addLeadHistory(this.ownerId,this.boardId,this.currentLead.id,{type:"update",text:`Respons\xE1vel alterado para <strong>${n?.displayName||"Ningu\xE9m"}</strong>`,user:e.displayName||e.email})}yield this.firestoreService.updateLead(this.ownerId,this.boardId,this.currentLead.id,i),this.leadUpdated.emit(),yield this.loadLeadData()}catch(t){console.error("Erro ao salvar altera\xE7\xF5es:",t),this.errorMessage="Erro ao salvar altera\xE7\xF5es. Tente novamente."}finally{this.isSaving=!1}}})}moveLead(t){return M(this,null,function*(){if(this.currentLead){this.isLoading=!0;try{let e=this.getCurrentColumn(),i=this.columns.find(g=>g.id===t),n=this.authService.getCurrentUser();if(!e||!i||!n)return;let s=new Date,m=le({},this.phaseHistory);if(m[e.id]){let g=m[e.id].enteredAt?.toDate()||new Date;m[e.id].exitedAt=s,m[e.id].duration=s.getTime()-g.getTime()}m[t]={phaseId:t,enteredAt:s,exitedAt:void 0,duration:void 0},yield this.firestoreService.moveLead(this.ownerId,this.boardId,this.currentLead.id,t),yield this.firestoreService.addLeadHistory(this.ownerId,this.boardId,this.currentLead.id,{type:"move",text:`Moveu de <strong>${e.name}</strong> para <strong>${i.name}</strong>`,user:n.displayName||n.email}),yield this.firestoreService.updateLead(this.ownerId,this.boardId,this.currentLead.id,{phaseHistory:m}),this.leadUpdated.emit(),this.hide()}catch(e){console.error("Erro ao mover lead:",e),this.errorMessage="Erro ao mover lead. Tente novamente."}finally{this.isLoading=!1}}})}onFileSelected(t){let e=t.target.files[0];if(e){if(e.size>10485760){this.errorMessage="Arquivo muito grande. O tamanho m\xE1ximo \xE9 10MB.",t.target.value="";return}if(!["image/jpeg","image/jpg","image/png","image/gif","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","application/zip","application/x-rar-compressed"].includes(e.type)){this.errorMessage="Tipo de arquivo n\xE3o permitido. Use: PDF, DOC, DOCX, JPG, PNG, GIF, TXT, ZIP, RAR.",t.target.value="";return}this.selectedFile=e,this.attachmentPreview=`\u{1F4CE} ${e.name} (${(e.size/1024/1024).toFixed(2)} MB)`,this.errorMessage=""}}clearAttachment(){this.selectedFile=null,this.attachmentPreview=""}addComment(){return M(this,null,function*(){if(!this.currentLead||!this.commentText.trim()&&!this.selectedFile){this.errorMessage="Digite um coment\xE1rio ou anexe um arquivo.";return}this.isUploadingComment=!0,this.errorMessage="";try{let t=this.authService.getCurrentUser();if(!t)throw new Error("Usu\xE1rio n\xE3o autenticado");let e=null;if(this.selectedFile){console.log("Iniciando upload do arquivo:",this.selectedFile.name);let n=`leads/${this.currentLead.id}/comments/${Date.now()}_${this.selectedFile.name}`;try{let s=yield this.storageService.uploadFile(this.selectedFile,n);console.log("Upload conclu\xEDdo:",s),e={name:this.selectedFile.name,url:s,type:this.selectedFile.type,size:this.selectedFile.size}}catch(s){throw console.error("Erro no upload:",s),new Error("Falha no upload do arquivo. Verifique sua conex\xE3o.")}}let i={type:"comment",text:this.commentText.trim()||"Anexou um arquivo",user:t.displayName||t.email,timestamp:new Date,attachment:e};console.log("Adicionando ao hist\xF3rico:",i),yield this.firestoreService.addLeadHistory(this.ownerId,this.boardId,this.currentLead.id,i),console.log("Coment\xE1rio adicionado com sucesso"),this.commentText="",this.clearAttachment(),yield this.loadLeadData()}catch(t){console.error("Erro ao adicionar coment\xE1rio:",t),this.errorMessage=t.message||"Erro ao adicionar coment\xE1rio. Tente novamente."}finally{this.isUploadingComment=!1}})}generatePublicLink(){if(!this.currentLead)return;let t=this.getCurrentColumn();t&&(this.publicLink=`https://www.supplik.com.br/kanban/?page=form&userId=${this.ownerId}&boardId=${this.boardId}&leadId=${this.currentLead.id}&columnId=${t.id}`)}copyPublicLink(){this.publicLink&&navigator.clipboard.writeText(this.publicLink)}deleteLead(){return M(this,null,function*(){if(!(!this.currentLead||!confirm("Tem certeza que deseja apagar este lead? Esta a\xE7\xE3o n\xE3o pode ser desfeita."))){this.isLoading=!0;try{yield this.firestoreService.deleteLead(this.ownerId,this.boardId,this.currentLead.id),this.leadDeleted.emit(),this.hide()}catch(e){console.error("Erro ao excluir lead:",e),this.errorMessage="Erro ao excluir lead. Tente novamente."}finally{this.isLoading=!1}}})}onBackdropClick(t){t.target===t.currentTarget&&this.hide()}formatDateTime(t){return(t?.toDate?t.toDate():new Date(t)).toLocaleString("pt-BR")}getActivityIcon(t){switch(t){case"move":return"fas fa-arrow-right";case"comment":return"fas fa-comment";case"update":return"fas fa-edit";default:return"fas fa-info-circle"}}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=T({type:o,selectors:[["app-lead-detail-modal"]],inputs:{ownerId:"ownerId",boardId:"boardId",columns:"columns",users:"users"},outputs:{leadUpdated:"leadUpdated",leadDeleted:"leadDeleted",closeModal:"closeModal"},decls:1,vars:1,consts:[["fileInput",""],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",3,"click",4,"ngIf"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-7xl","max-h-[95vh]","overflow-hidden"],[1,"flex","justify-between","items-center","p-6","border-b","border-gray-200"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","text-2xl","font-bold",3,"click","disabled"],[1,"grid","grid-cols-12","gap-6","p-6","max-h-[calc(95vh-120px)]","overflow-y-auto"],[1,"col-span-12","md:col-span-3","border-r","border-gray-200","pr-6"],[1,"mb-8"],[1,"font-bold","text-lg","mb-3","text-gray-800"],[1,"space-y-2"],[1,"grid","grid-cols-3","gap-2"],[1,"col-span-1","text-sm","text-gray-600"],[1,"col-span-2","text-sm","break-all"],["class","grid grid-cols-3 gap-2",4,"ngFor","ngForOf"],[1,"space-y-3"],["class","text-xs p-2 rounded border-l-4",3,"border-left-color",4,"ngFor","ngForOf"],[1,"space-y-3","max-h-64","overflow-y-auto"],["class","text-xs p-2 bg-gray-50 rounded",4,"ngFor","ngForOf"],[1,"col-span-12","md:col-span-6"],[1,"space-y-4",3,"formGroup"],[1,"form-group"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["formControlName","responsibleUserId",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"text-xs","text-gray-500"],["formControlName","temperature",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500"],["value","frio"],["value","morno"],["value","quente"],["value","cliente"],[4,"ngFor","ngForOf"],[1,"space-y-4"],["placeholder","Escreva um coment\xE1rio...","rows","3",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","ngModel"],["class","mt-2 p-2 bg-gray-50 rounded text-sm text-gray-600 flex items-center justify-between",4,"ngIf"],[1,"flex","justify-between","items-center","mt-3"],["type","button",1,"bg-gray-200","hover:bg-gray-300","text-gray-700","font-semibold","py-2","px-4","rounded-lg","text-sm","mr-2",3,"click"],[1,"fas","fa-paperclip","mr-2"],["type","file","accept",".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif,.txt,.zip,.rar",1,"hidden",3,"change"],[1,"bg-blue-500","hover:bg-blue-600","disabled:bg-blue-300","text-white","font-semibold","py-2","px-4","rounded-lg","flex","items-center",3,"click","disabled"],["class","animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2",4,"ngIf"],[1,"fas","fa-paper-plane","mr-2"],[1,"col-span-12","md:col-span-3","border-l","border-gray-200","pl-6","flex","flex-col","justify-between"],["class","mb-4",4,"ngIf"],["class","text-gray-500 text-sm italic p-3 bg-gray-50 rounded-lg",4,"ngIf"],["class","space-y-2",4,"ngIf"],["class","bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded-lg text-sm",4,"ngIf"],[1,"w-full","bg-green-500","hover:bg-green-600","disabled:bg-green-300","text-white","font-bold","py-3","px-4","rounded-lg","flex","items-center","justify-center",3,"click","disabled"],[1,"w-full","bg-red-500","hover:bg-red-600","disabled:bg-red-300","text-white","font-bold","py-3","px-4","rounded-lg",3,"click","disabled"],[1,"text-xs","p-2","rounded","border-l-4"],[1,"font-medium","text-gray-800"],[1,"text-gray-600"],["class","text-gray-600",4,"ngIf"],[1,"text-xs","p-2","bg-gray-50","rounded"],[1,"flex","items-center","mb-1"],[1,"mr-2","text-blue-500"],[1,"font-medium"],[1,"ml-auto","text-gray-500"],[1,"text-gray-700",3,"innerHTML"],["class","mt-2",4,"ngIf"],[1,"mt-2"],["target","_blank",1,"text-blue-600","hover:underline","flex","items-center",3,"href"],[1,"fas","fa-paperclip","mr-1"],[3,"value"],["class","text-red-500",4,"ngIf"],["class","w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",3,"type","formControlName","placeholder",4,"ngIf"],["rows","3","class","w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",3,"formControlName","placeholder",4,"ngIf"],["type","number","class","w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",3,"formControlName","placeholder",4,"ngIf"],["type","date","class","w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",3,"formControlName",4,"ngIf"],["class","w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",3,"formControlName",4,"ngIf"],[1,"text-red-500"],[1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"type","formControlName","placeholder"],["rows","3",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"formControlName","placeholder"],["type","number",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"formControlName","placeholder"],["type","date",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"formControlName"],[1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"formControlName"],[1,"mt-2","p-2","bg-gray-50","rounded","text-sm","text-gray-600","flex","items-center","justify-between"],[1,"text-red-500","hover:text-red-700",3,"click"],[1,"fas","fa-times"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-white","mr-2"],[1,"mb-4"],[1,"text-sm","font-semibold","text-green-700","mb-2"],[1,"grid","grid-cols-1","gap-2"],["class","text-left p-2 border border-green-200 rounded-md hover:bg-green-50 transition-colors flex items-center text-sm bg-white",3,"disabled","click",4,"ngFor","ngForOf"],[1,"text-left","p-2","border","border-green-200","rounded-md","hover:bg-green-50","transition-colors","flex","items-center","text-sm","bg-white",3,"click","disabled"],[1,"w-3","h-3","rounded-full","mr-2"],[1,"text-sm","font-medium","text-orange-600","mb-2"],[1,"grid","grid-cols-1","gap-1"],["class","text-left p-2 border border-orange-100 rounded-md hover:bg-orange-50 transition-colors flex items-center text-xs bg-orange-25 opacity-75",3,"disabled","click",4,"ngFor","ngForOf"],[1,"text-left","p-2","border","border-orange-100","rounded-md","hover:bg-orange-50","transition-colors","flex","items-center","text-xs","bg-orange-25","opacity-75",3,"click","disabled"],[1,"w-2","h-2","rounded-full","mr-2"],[1,"text-gray-500","text-sm","italic","p-3","bg-gray-50","rounded-lg"],[1,"text-xs","text-gray-600"],[1,"flex"],["type","text","readonly","",1,"flex-1","p-2","border","border-gray-300","rounded-l-lg","bg-gray-50","text-xs",3,"value"],[1,"bg-blue-500","hover:bg-blue-600","text-white","px-3","rounded-r-lg",3,"click"],[1,"fas","fa-copy"],[1,"bg-red-50","border","border-red-200","text-red-700","px-3","py-2","rounded-lg","text-sm"]],template:function(e,i){e&1&&b(0,No,96,23,"div",1),e&2&&c("ngIf",i.isVisible)},dependencies:[F,L,R,j,z,oe,re,K,Se,pe,W,N,nt,U,B,Z],styles:[".modal-body[_ngcontent-%COMP%]{max-height:calc(95vh - 120px)}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#374151;margin-bottom:.25rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{transition:border-color .2s ease,box-shadow .2s ease}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.activity-item[_ngcontent-%COMP%]{padding:.75rem;background:#f9fafb;border-radius:.5rem;border-left:3px solid #e5e7eb}.phase-item[_ngcontent-%COMP%]{padding:.5rem;border-radius:.25rem;border-left:4px solid}.phase-item.current[_ngcontent-%COMP%]{background-color:#eff6ff;border-left-color:#3b82f6}.action-button[_ngcontent-%COMP%]{transition:all .2s ease;border:1px solid #d1d5db}.action-button[_ngcontent-%COMP%]:hover{background-color:#f9fafb;border-color:#9ca3af}.public-link-container[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e2e8f0;border-radius:.5rem;padding:1rem}.attachment-preview[_ngcontent-%COMP%]{background:#f1f5f9;border:1px solid #cbd5e1;padding:.5rem;border-radius:.375rem;font-size:.875rem;color:#475569}.spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.modal-body[_ngcontent-%COMP%]::-webkit-scrollbar, .activity-log[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.modal-body[_ngcontent-%COMP%]::-webkit-scrollbar-track, .activity-log[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}.modal-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb, .activity-log[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}.modal-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover, .activity-log[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}"]})};var zo=["visualEditor"],Bo=["htmlEditor"];function Ho(o,t){if(o&1){let e=w();r(0,"button",37),h("click",function(){let n=f(e).$implicit,s=u(2);return _(s.insertVariable(n.value))}),l(1),a()}if(o&2){let e=t.$implicit,i=u(2);c("disabled",i.isLoading),d(),x(" ",e.value," ")}}function jo(o,t){if(o&1){let e=w();r(0,"div",38)(1,"div",39)(2,"button",40),h("click",function(){f(e);let n=u(2);return _(n.execCommand("bold"))}),r(3,"strong"),l(4,"B"),a()(),r(5,"button",41),h("click",function(){f(e);let n=u(2);return _(n.execCommand("italic"))}),r(6,"em"),l(7,"I"),a()(),r(8,"button",42),h("click",function(){f(e);let n=u(2);return _(n.execCommand("underline"))}),r(9,"u"),l(10,"U"),a()(),p(11,"div",43),r(12,"button",44),h("click",function(){f(e);let n=u(2);return _(n.execCommand("insertUnorderedList"))}),l(13," \u2022 "),a(),r(14,"button",45),h("click",function(){f(e);let n=u(2);return _(n.execCommand("insertOrderedList"))}),l(15," 1. "),a(),p(16,"div",43),r(17,"button",46),h("click",function(){f(e);let n=u(2);return _(n.createLink())}),l(18," \u{1F517} "),a()()()}}function Uo(o,t){if(o&1){let e=w();r(0,"div",47,0),h("input",function(n){f(e);let s=u(2);return _(s.onVisualEditorInput(n))}),a()}if(o&2){let e=u(2);c("innerHTML",e.editorContent,We)}}function $o(o,t){if(o&1){let e=w();r(0,"textarea",48,1),h("input",function(n){f(e);let s=u(2);return _(s.onHtmlEditorInput(n))}),l(2,"            "),a()}if(o&2){let e=u(2);c("value",e.editorContent)}}function qo(o,t){if(o&1&&(r(0,"div",49),l(1),a()),o&2){let e=u(2);d(),x(" ",e.errorMessage," ")}}function Go(o,t){o&1&&p(0,"div",50)}function Ko(o,t){if(o&1){let e=w();r(0,"div",3),h("click",function(n){f(e);let s=u();return _(s.onBackdropClick(n))}),r(1,"div",4)(2,"div",5)(3,"h2",6),l(4),a(),r(5,"button",7),h("click",function(){f(e);let n=u();return _(n.hide())}),l(6," \xD7 "),a()(),r(7,"form",8),h("ngSubmit",function(){f(e);let n=u();return _(n.saveTemplate())}),r(8,"div",9)(9,"div",10)(10,"label",11),l(11," Nome do Template "),r(12,"span",12),l(13,"*"),a()(),p(14,"input",13),a(),r(15,"div",10)(16,"label",14),l(17," Destinat\xE1rios "),a(),p(18,"input",15),a()(),r(19,"div",16)(20,"label",17),l(21," Assunto "),r(22,"span",12),l(23,"*"),a()(),p(24,"input",18),a(),r(25,"div",19)(26,"div",20)(27,"label",21),l(28," Corpo do Email "),r(29,"span",12),l(30,"*"),a()()(),r(31,"div",22)(32,"p",23),l(33,"Clique para inserir vari\xE1veis:"),a(),r(34,"div",24),b(35,Ho,2,2,"button",25),a(),r(36,"p",26),l(37," As vari\xE1veis ser\xE3o substitu\xEDdas automaticamente pelos dados reais do lead quando o email for enviado. "),a()(),r(38,"div",19)(39,"div",20)(40,"label",21),l(41," Corpo do E-mail "),r(42,"span",12),l(43,"*"),a()(),r(44,"button",27),h("click",function(){f(e);let n=u();return _(n.toggleHtmlMode())}),l(45),a()(),r(46,"div",28),b(47,jo,19,0,"div",29)(48,Uo,2,1,"div",30)(49,$o,3,1,"textarea",31),a()()(),b(50,qo,2,1,"div",32),r(51,"div",33)(52,"button",34),h("click",function(){f(e);let n=u();return _(n.hide())}),l(53," Cancelar "),a(),r(54,"button",35),b(55,Go,1,0,"div",36),l(56),a()()()()()}if(o&2){let e=u();d(4),x(" ",e.isEditing?"Editar Template":"Criar Novo Template"," "),d(),c("disabled",e.isLoading),d(2),c("formGroup",e.templateForm),d(7),c("disabled",e.isLoading),d(4),c("placeholder",di("Ex: ","{{","contactEmail","}}"))("disabled",e.isLoading),d(6),c("disabled",e.isLoading),d(11),c("ngForOf",e.variables),d(10),x(" ",e.showHtmlMode?"Editor Visual":"Ver HTML"," "),d(2),c("ngIf",!e.showHtmlMode),d(),c("ngIf",!e.showHtmlMode),d(),c("ngIf",e.showHtmlMode),d(),c("ngIf",e.errorMessage),d(2),c("disabled",e.isLoading),d(2),c("disabled",e.isLoading||!e.templateForm.valid),d(),c("ngIf",e.isLoading),d(),x(" ",e.isLoading?"Salvando...":e.isEditing?"Atualizar Template":"Criar Template"," ")}}var He=class o{firestoreService=v($);fb=v(H);ownerId="";boardId="";templateSaved=new S;closeModal=new S;visualEditor;htmlEditor;isVisible=!1;isEditing=!1;isLoading=!1;errorMessage="";currentTemplate=null;showHtmlMode=!1;editorContent="";templateForm=this.fb.group({name:["",[k.required]],subject:["",[k.required]],recipients:[""],body:["",[k.required]]});variables=[{name:"Nome da Empresa",value:"{{companyName}}"},{name:"CNPJ",value:"{{cnpj}}"},{name:"Nome do Contato",value:"{{contactName}}"},{name:"Email do Contato",value:"{{contactEmail}}"},{name:"Telefone do Contato",value:"{{contactPhone}}"},{name:"Nome do Respons\xE1vel",value:"{{nomeResponsavel}}"},{name:"Email do Respons\xE1vel",value:"{{emailResponsavel}}"},{name:"Nome da Fase Atual",value:"{{currentPhaseName}}"},{name:"Data Atual",value:"{{currentDate}}"},{name:"Link do Lead",value:"{{leadLink}}"}];ngAfterViewInit(){console.log("Template modal inicializado")}execCommand(t){document.execCommand(t,!1)}createLink(){let t=window.prompt("Digite a URL:");t&&document.execCommand("createLink",!1,t)}onVisualEditorChange(t){this.editorContent=t.target.innerHTML,console.log("Visual editor changed:",this.editorContent)}onHtmlEditorChange(t){this.editorContent=t,console.log("HTML editor changed:",this.editorContent)}showCreateModal(){this.isEditing=!1,this.currentTemplate=null,this.isVisible=!0,this.resetForm()}showEditModal(t){this.isEditing=!0,this.currentTemplate=t,this.isVisible=!0,this.populateForm(t)}hide(){this.isVisible=!1,this.resetForm(),this.closeModal.emit()}resetForm(){this.templateForm.reset({name:"",subject:"",recipients:"",body:""}),this.errorMessage="",this.isLoading=!1,this.editorContent=""}populateForm(t){console.log("Carregando template:",t),this.templateForm.patchValue({name:t.name||"",subject:t.subject||"",recipients:t.recipients||"",body:t.body||""}),this.editorContent=t.body||"",console.log("Conte\xFAdo do editor definido:",this.editorContent),setTimeout(()=>{this.visualEditor&&this.editorContent&&(this.visualEditor.nativeElement.innerHTML=this.editorContent)},100)}toggleHtmlMode(){this.showHtmlMode=!this.showHtmlMode,this.showHtmlMode?setTimeout(()=>{this.htmlEditor&&(this.htmlEditor.nativeElement.value=this.editorContent)},100):this.htmlEditor&&(this.editorContent=this.htmlEditor.nativeElement.value,setTimeout(()=>{this.visualEditor&&(this.visualEditor.nativeElement.innerHTML=this.editorContent)},100))}insertVariable(t){if(this.showHtmlMode&&this.htmlEditor){let e=this.htmlEditor.nativeElement,i=e.selectionStart,n=e.selectionEnd,s=e.value,m=s.substring(0,i)+t+s.substring(n);e.value=m,e.selectionStart=e.selectionEnd=i+t.length,this.editorContent=m}else!this.showHtmlMode&&this.visualEditor&&(this.editorContent+=t,this.visualEditor.nativeElement.innerHTML=this.editorContent)}onVisualEditorInput(t){this.editorContent=t.target.innerHTML}onHtmlEditorInput(t){this.editorContent=t.target.value}saveTemplate(){return M(this,null,function*(){if(!this.templateForm.valid){this.errorMessage="Por favor, preencha todos os campos obrigat\xF3rios.";return}this.isLoading=!0,this.errorMessage="";try{let t=this.templateForm.value,e=this.editorContent||"";console.log("Salvando template, conte\xFAdo:",e),console.log("Salvando template com body final:",e),this.templateForm.patchValue({body:e});let i={name:t.name,subject:t.subject,recipients:t.recipients||"",body:e};this.isEditing&&this.currentTemplate?yield this.firestoreService.updateEmailTemplate(this.ownerId,this.boardId,this.currentTemplate.id,i):yield this.firestoreService.createEmailTemplate(this.ownerId,this.boardId,i),this.templateSaved.emit(),this.hide()}catch(t){console.error("Erro ao salvar template:",t),this.errorMessage="Erro ao salvar template. Tente novamente."}finally{this.isLoading=!1}})}onBackdropClick(t){t.target===t.currentTarget&&this.hide()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=T({type:o,selectors:[["app-template-modal"]],viewQuery:function(e,i){if(e&1&&(Y(zo,5),Y(Bo,5)),e&2){let n;X(n=J())&&(i.visualEditor=n.first),X(n=J())&&(i.htmlEditor=n.first)}},inputs:{ownerId:"ownerId",boardId:"boardId"},outputs:{templateSaved:"templateSaved",closeModal:"closeModal"},decls:1,vars:1,consts:[["visualEditor",""],["htmlEditor",""],["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",3,"click",4,"ngIf"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50","p-4",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-6xl","max-h-[95vh]","overflow-hidden"],[1,"flex","justify-between","items-center","p-6","border-b","border-gray-200"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","text-2xl","font-bold",3,"click","disabled"],[1,"p-6","max-h-[calc(95vh-120px)]","overflow-y-auto",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],[1,"form-group"],["for","templateName",1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"text-red-500"],["type","text","id","templateName","formControlName","name","placeholder","Ex: Template de boas-vindas, email promocional, etc.",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"disabled"],["for","templateRecipients",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","templateRecipients","formControlName","recipients",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"disabled","placeholder"],[1,"form-group","mb-4"],["for","templateSubject",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","templateSubject","formControlName","subject","placeholder","Ex: Obrigado por entrar em contato",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"disabled"],[1,"mb-4"],[1,"flex","justify-between","items-center","mb-2"],[1,"block","text-sm","font-medium","text-gray-700"],[1,"bg-gray-50","p-3","rounded-md","mb-3"],[1,"text-xs","text-gray-600","mb-2"],[1,"flex","flex-wrap","gap-1"],["type","button","class","variable-tag px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded hover:bg-blue-200 transition-colors",3,"disabled","click",4,"ngFor","ngForOf"],[1,"text-xs","text-gray-500","mt-2"],["type","button",1,"px-3","py-1","text-xs","bg-gray-200","hover:bg-gray-300","rounded","transition-colors",3,"click"],[1,"border","border-gray-300","rounded-lg","overflow-hidden"],["class","border-b border-gray-300 p-2 bg-gray-50",4,"ngIf"],["contenteditable","true","class","min-h-[300px] p-4 focus:outline-none","style","max-height: 400px; overflow-y: auto;",3,"innerHTML","input",4,"ngIf"],["class","w-full min-h-[300px] max-h-[400px] p-4 font-mono text-sm focus:outline-none resize-none","placeholder","Digite o HTML aqui...",3,"value","input",4,"ngIf"],["class","mb-4 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",4,"ngIf"],[1,"flex","justify-end","gap-3","pt-4","border-t","border-gray-200"],["type","button",1,"px-6","py-3","text-gray-700","bg-gray-200","hover:bg-gray-300","rounded-lg","font-medium","transition-colors",3,"click","disabled"],["type","submit",1,"px-6","py-3","bg-blue-500","hover:bg-blue-600","disabled:bg-blue-300","text-white","rounded-lg","font-medium","transition-colors","flex","items-center",3,"disabled"],["class","animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2",4,"ngIf"],["type","button",1,"variable-tag","px-2","py-1","bg-blue-100","text-blue-800","text-xs","rounded","hover:bg-blue-200","transition-colors",3,"click","disabled"],[1,"border-b","border-gray-300","p-2","bg-gray-50"],[1,"flex","gap-1","flex-wrap"],["type","button","title","Negrito",1,"px-2","py-1","text-sm","bg-white","border","rounded","hover:bg-gray-100",3,"click"],["type","button","title","It\xE1lico",1,"px-2","py-1","text-sm","bg-white","border","rounded","hover:bg-gray-100",3,"click"],["type","button","title","Sublinhado",1,"px-2","py-1","text-sm","bg-white","border","rounded","hover:bg-gray-100",3,"click"],[1,"border-l","border-gray-300","mx-1"],["type","button","title","Lista",1,"px-2","py-1","text-sm","bg-white","border","rounded","hover:bg-gray-100",3,"click"],["type","button","title","Lista Numerada",1,"px-2","py-1","text-sm","bg-white","border","rounded","hover:bg-gray-100",3,"click"],["type","button","title","Link",1,"px-2","py-1","text-sm","bg-white","border","rounded","hover:bg-gray-100",3,"click"],["contenteditable","true",1,"min-h-[300px]","p-4","focus:outline-none",2,"max-height","400px","overflow-y","auto",3,"input","innerHTML"],["placeholder","Digite o HTML aqui...",1,"w-full","min-h-[300px]","max-h-[400px]","p-4","font-mono","text-sm","focus:outline-none","resize-none",3,"input","value"],[1,"mb-4","bg-red-50","border","border-red-200","text-red-700","px-4","py-3","rounded-lg"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-white","mr-2"]],template:function(e,i){e&1&&b(0,Ko,57,19,"div",2),e&2&&c("ngIf",i.isVisible)},dependencies:[F,L,R,j,z,K,W,N,U,B,Z],styles:[".form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#374151}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{transition:border-color .2s ease,box-shadow .2s ease}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.variable-tag[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none}.variable-tag[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}[_nghost-%COMP%]     .ql-editor{min-height:300px;font-size:14px;line-height:1.6}[_nghost-%COMP%]     .ql-toolbar{border-top:1px solid #d1d5db;border-left:1px solid #d1d5db;border-right:1px solid #d1d5db;background-color:#f9fafb}[_nghost-%COMP%]     .ql-container{border-bottom:1px solid #d1d5db;border-left:1px solid #d1d5db;border-right:1px solid #d1d5db}[_nghost-%COMP%]     .ql-editor.ql-blank:before{color:#9ca3af;content:attr(data-placeholder);font-style:italic}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}.overflow-y-auto[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}"]})};var Ue=()=>({standalone:!0});function Wo(o,t){if(o&1&&(r(0,"option",27),l(1),a()),o&2){let e=t.$implicit;c("value",e.id),d(),E(e.name)}}function Zo(o,t){if(o&1&&(r(0,"option",27),l(1),a()),o&2){let e=t.$implicit;c("value",e.id),d(),E(e.name)}}function Qo(o,t){if(o&1){let e=w();r(0,"div")(1,"select",39),ue("ngModelChange",function(n){f(e);let s=u().$implicit;return me(s.templateId,n)||(s.templateId=n),_(n)}),r(2,"option",40),l(3,"Selecione um template"),a(),b(4,Zo,2,2,"option",16),a()()}if(o&2){let e=u().$implicit,i=u();d(),ce("ngModel",e.templateId),c("ngModelOptions",ne(3,Ue)),d(3),c("ngForOf",i.emailTemplates)}}function Yo(o,t){if(o&1&&(r(0,"option",27),l(1),a()),o&2){let e=t.$implicit;c("value",e.id),d(),E(e.name)}}function Xo(o,t){if(o&1){let e=w();r(0,"div")(1,"select",39),ue("ngModelChange",function(n){f(e);let s=u().$implicit;return me(s.phaseId,n)||(s.phaseId=n),_(n)}),r(2,"option",40),l(3,"Selecione uma fase"),a(),b(4,Yo,2,2,"option",16),a()()}if(o&2){let e=u().$implicit,i=u();d(),ce("ngModel",e.phaseId),c("ngModelOptions",ne(3,Ue)),d(3),c("ngForOf",i.phases)}}function Jo(o,t){if(o&1&&(r(0,"option",27),l(1),a()),o&2){let e=t.$implicit;c("value",e.id),d(),E(e.name)}}function er(o,t){if(o&1){let e=w();r(0,"div")(1,"select",39),ue("ngModelChange",function(n){f(e);let s=u().$implicit;return me(s.userId,n)||(s.userId=n),_(n)}),r(2,"option",40),l(3,"Selecione um usu\xE1rio"),a(),b(4,Jo,2,2,"option",16),a()()}if(o&2){let e=u().$implicit,i=u();d(),ce("ngModel",e.userId),c("ngModelOptions",ne(3,Ue)),d(3),c("ngForOf",i.users)}}function tr(o,t){if(o&1){let e=w();r(0,"div")(1,"textarea",41),ue("ngModelChange",function(n){f(e);let s=u().$implicit;return me(s.note,n)||(s.note=n),_(n)}),a()()}if(o&2){let e=u().$implicit;d(),ce("ngModel",e.note),c("ngModelOptions",ne(2,Ue))}}function ir(o,t){if(o&1){let e=w();r(0,"div",28)(1,"div",29)(2,"select",30),ue("ngModelChange",function(n){let s=f(e).$implicit;return me(s.type,n)||(s.type=n),_(n)}),r(3,"option",31),l(4,"Enviar e-mail"),a(),r(5,"option",32),l(6,"Mover para fase"),a(),r(7,"option",33),l(8,"Atribuir usu\xE1rio"),a(),r(9,"option",34),l(10,"Adicionar nota"),a()(),r(11,"button",35),h("click",function(){let n=f(e).index,s=u();return _(s.removeAction(n))}),p(12,"i",36),a()(),r(13,"div",37),b(14,Qo,5,4,"div",38)(15,Xo,5,4,"div",38)(16,er,5,4,"div",38)(17,tr,2,3,"div",38),a()()}if(o&2){let e=t.$implicit;d(2),ce("ngModel",e.type),c("ngModelOptions",ne(7,Ue)),d(11),c("ngSwitch",e.type),d(),c("ngSwitchCase","send-email"),d(),c("ngSwitchCase","move-to-phase"),d(),c("ngSwitchCase","assign-user"),d(),c("ngSwitchCase","add-note")}}var je=class o{constructor(t){this.fb=t;this.automationForm=this.createForm()}isVisible=!1;automation=null;phases=[];emailTemplates=[];users=[];closeModalEvent=new S;saveAutomation=new S;automationForm;modalTitle="Criar Automa\xE7\xE3o";isEditing=!1;showTriggerPhase=!1;showTriggerTime=!1;ngOnInit(){this.automation&&(this.isEditing=!0,this.modalTitle="Editar Automa\xE7\xE3o",this.loadAutomationData())}createForm(){return this.fb.group({id:[""],name:["",k.required],triggerType:["new-lead-created",k.required],triggerPhase:[""],triggerDays:[1],actions:this.fb.array([])})}loadAutomationData(){if(this.automation){this.automationForm.patchValue({id:this.automation.id,name:this.automation.name,triggerType:this.automation.triggerType,triggerPhase:this.automation.triggerPhase,triggerDays:this.automation.triggerDays});let t=this.automationForm.get("actions");t.clear(),this.automation.actions&&this.automation.actions.forEach(e=>{t.push(this.fb.group(e))}),this.onTriggerTypeChange()}}onTriggerTypeChange(){let t=this.automationForm.get("triggerType")?.value;this.showTriggerPhase=t==="card-enters-phase"||t==="card-in-phase-for-time"||t==="form-not-answered",this.showTriggerTime=t==="card-in-phase-for-time",this.showTriggerPhase||this.automationForm.get("triggerPhase")?.setValue(""),this.showTriggerTime||this.automationForm.get("triggerDays")?.setValue(1)}get actionsFormArray(){return this.automationForm.get("actions")}addAction(){let t=this.fb.group({type:["send-email"],templateId:[""],phaseId:[""],userId:[""],note:[""]});this.actionsFormArray.push(t)}removeAction(t){this.actionsFormArray.removeAt(t)}onSubmit(){if(this.automationForm.valid){let t=this.automationForm.value,e=$e(le({},t),{name:t.name||`Automa\xE7\xE3o ${this.getAutomationTypeName(t.triggerType)}`,actions:t.actions.filter(i=>this.isValidAction(i))});this.saveAutomation.emit(e),this.closeModal()}}isValidAction(t){switch(t.type){case"send-email":return!!t.templateId;case"move-to-phase":return!!t.phaseId;case"assign-user":return!!t.userId;case"add-note":return!!t.note&&t.note.trim().length>0;default:return!1}}getAutomationTypeName(t){return{"new-lead-created":"Novo Lead","card-enters-phase":"Entrada em Fase","card-in-phase-for-time":"Tempo em Fase","form-not-answered":"Formul\xE1rio Pendente","sla-overdue":"SLA Vencido"}[t]||"Sem Nome"}closeModal(){this.automationForm.reset(),this.actionsFormArray.clear(),this.isEditing=!1,this.modalTitle="Criar Automa\xE7\xE3o",this.showTriggerPhase=!1,this.showTriggerTime=!1,this.closeModalEvent.emit()}static \u0275fac=function(e){return new(e||o)(Ze(H))};static \u0275cmp=T({type:o,selectors:[["app-automation-modal"]],inputs:{isVisible:"isVisible",automation:"automation",phases:"phases",emailTemplates:"emailTemplates",users:"users"},outputs:{closeModalEvent:"closeModalEvent",saveAutomation:"saveAutomation"},decls:44,vars:10,consts:[[1,"modal-overlay",3,"click"],[1,"modal-content","modal-content-md","p-6",3,"click"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-2xl","font-bold"],[1,"text-gray-500","hover:text-gray-800","text-2xl",3,"click"],[1,"modal-body","space-y-6",3,"ngSubmit","formGroup"],[1,"border","rounded-lg","p-4"],[1,"font-semibold","text-md","mb-3","text-gray-700"],["formControlName","triggerType",1,"w-full","p-2","border","rounded-md","mb-2","bg-white",3,"change"],["value","new-lead-created"],["value","card-enters-phase"],["value","card-in-phase-for-time"],["value","form-not-answered"],["value","sla-overdue"],["for","triggerPhase",1,"text-sm","font-medium","text-gray-700"],["formControlName","triggerPhase",1,"w-full","p-2","border","rounded-md","mt-1","bg-white"],[3,"value",4,"ngFor","ngForOf"],[1,"mt-2"],["for","triggerDays",1,"text-sm","font-medium","text-gray-700"],["type","number","formControlName","triggerDays","min","1","placeholder","Ex: 3",1,"w-full","p-2","border","rounded-md","mt-1"],[1,"space-y-3"],["class","border rounded-lg p-3 bg-gray-50",4,"ngFor","ngForOf"],["type","button",1,"mt-4","bg-gray-200","hover:bg-gray-300","text-gray-700","font-semibold","py-2","px-4","rounded-lg","text-sm",3,"click"],[1,"fas","fa-plus","mr-2"],[1,"mt-6","flex","justify-end","gap-4"],["type","button",1,"bg-gray-200","hover:bg-gray-300","text-gray-800","font-bold","py-2","px-4","rounded-lg",3,"click"],["type","submit",1,"bg-blue-500","hover:bg-blue-600","text-white","font-bold","py-2","px-4","rounded-lg","disabled:bg-gray-400",3,"disabled"],[3,"value"],[1,"border","rounded-lg","p-3","bg-gray-50"],[1,"flex","justify-between","items-start","mb-2"],[1,"p-2","border","rounded-md","bg-white","flex-1","mr-2",3,"ngModelChange","ngModel","ngModelOptions"],["value","send-email"],["value","move-to-phase"],["value","assign-user"],["value","add-note"],["type","button",1,"text-red-500","hover:text-red-700",3,"click"],[1,"fas","fa-trash"],[1,"mt-2",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"w-full","p-2","border","rounded-md","bg-white",3,"ngModelChange","ngModel","ngModelOptions"],["value",""],["rows","3","placeholder","Digite a nota...",1,"w-full","p-2","border","rounded-md",3,"ngModelChange","ngModel","ngModelOptions"]],template:function(e,i){if(e&1&&(r(0,"div",0),h("click",function(){return i.closeModal()}),r(1,"div",1),h("click",function(s){return s.stopPropagation()}),r(2,"div",2)(3,"h2",3),l(4),a(),r(5,"button",4),h("click",function(){return i.closeModal()}),l(6,"\xD7"),a()(),r(7,"form",5),h("ngSubmit",function(){return i.onSubmit()}),r(8,"div",6)(9,"h3",7),l(10,"Gatilho (Quando...)"),a(),r(11,"select",8),h("change",function(){return i.onTriggerTypeChange()}),r(12,"option",9),l(13,"Um novo lead \xE9 criado"),a(),r(14,"option",10),l(15,"Um card entra em uma fase"),a(),r(16,"option",11),l(17,"Um card est\xE1 em uma fase por um tempo"),a(),r(18,"option",12),l(19,"Ainda n\xE3o respondeu o formul\xE1rio da fase"),a(),r(20,"option",13),l(21,"O SLA de um card vence"),a()(),r(22,"div")(23,"label",14),l(24,"Fase:"),a(),r(25,"select",15),b(26,Wo,2,2,"option",16),a()(),r(27,"div",17)(28,"label",18),l(29,"Por (dias \xFAteis):"),a(),p(30,"input",19),a()(),r(31,"div",6)(32,"h3",7),l(33,"A\xE7\xF5es (Fa\xE7a isso...)"),a(),r(34,"div",20),b(35,ir,18,8,"div",21),a(),r(36,"button",22),h("click",function(){return i.addAction()}),p(37,"i",23),l(38,"Adicionar A\xE7\xE3o "),a()(),r(39,"div",24)(40,"button",25),h("click",function(){return i.closeModal()}),l(41,"Cancelar"),a(),r(42,"button",26),l(43),a()()()()()),e&2){let n;d(4),E(i.modalTitle),d(3),c("formGroup",i.automationForm),d(15),P("hidden",!i.showTriggerPhase),d(4),c("ngForOf",i.phases),d(),P("hidden",!i.showTriggerTime),d(8),c("ngForOf",(n=i.automationForm.get("actions"))==null?null:n.value),d(7),c("disabled",!i.automationForm.valid),d(),x(" ",i.isEditing?"Atualizar":"Salvar"," Automa\xE7\xE3o ")}},dependencies:[F,L,ui,pi,U,z,oe,re,K,Se,pe,W,N,ot,B,Z,j,nt],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 4px 6px #0000001a;max-height:90vh;overflow-y:auto}.modal-content-md[_ngcontent-%COMP%]{width:90%;max-width:600px}.hidden[_ngcontent-%COMP%]{display:none!important}form[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border:1px solid #e5e7eb}form[_ngcontent-%COMP%]   .rounded-lg[_ngcontent-%COMP%]{border-radius:8px}form[_ngcontent-%COMP%]   .p-4[_ngcontent-%COMP%]{padding:1rem}form[_ngcontent-%COMP%]   .p-6[_ngcontent-%COMP%]{padding:1.5rem}form[_ngcontent-%COMP%]   .space-y-6[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:1.5rem}form[_ngcontent-%COMP%]   .space-y-3[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-top:.75rem}form[_ngcontent-%COMP%]   select.w-full[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   input.w-full[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   textarea.w-full[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   select.p-2[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   input.p-2[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   textarea.p-2[_ngcontent-%COMP%]{padding:.5rem}form[_ngcontent-%COMP%]   select.border[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   input.border[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   textarea.border[_ngcontent-%COMP%]{border:1px solid #d1d5db}form[_ngcontent-%COMP%]   select.rounded-md[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   input.rounded-md[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   textarea.rounded-md[_ngcontent-%COMP%]{border-radius:6px}form[_ngcontent-%COMP%]   select.bg-white[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   input.bg-white[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   textarea.bg-white[_ngcontent-%COMP%]{background-color:#fff}form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}form[_ngcontent-%COMP%]   button.bg-gray-200[_ngcontent-%COMP%]{background-color:#e5e7eb}form[_ngcontent-%COMP%]   button.hover\\\\[_ngcontent-%COMP%]:bg-gray-300:hover{background-color:#d1d5db}form[_ngcontent-%COMP%]   button.bg-blue-500[_ngcontent-%COMP%]{background-color:#3b82f6}form[_ngcontent-%COMP%]   button.hover\\\\[_ngcontent-%COMP%]:bg-blue-600:hover{background-color:#2563eb}form[_ngcontent-%COMP%]   button.text-gray-700[_ngcontent-%COMP%]{color:#374151}form[_ngcontent-%COMP%]   button.text-gray-800[_ngcontent-%COMP%]{color:#1f2937}form[_ngcontent-%COMP%]   button.text-white[_ngcontent-%COMP%]{color:#fff}form[_ngcontent-%COMP%]   button.font-semibold[_ngcontent-%COMP%]{font-weight:600}form[_ngcontent-%COMP%]   button.font-bold[_ngcontent-%COMP%]{font-weight:700}form[_ngcontent-%COMP%]   button.py-2[_ngcontent-%COMP%]{padding-top:.5rem;padding-bottom:.5rem}form[_ngcontent-%COMP%]   button.px-4[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}form[_ngcontent-%COMP%]   button.rounded-lg[_ngcontent-%COMP%]{border-radius:8px}form[_ngcontent-%COMP%]   button.text-sm[_ngcontent-%COMP%]{font-size:.875rem}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}form[_ngcontent-%COMP%]   button.disabled\\\\[_ngcontent-%COMP%]:bg-gray-400:disabled{background-color:#9ca3af}.text-red-500[_ngcontent-%COMP%]{color:#ef4444}.hover\\\\[_ngcontent-%COMP%]:text-red-700:hover{color:#b91c1c}.bg-gray-50[_ngcontent-%COMP%]{background-color:#f9fafb}.flex[_ngcontent-%COMP%]{display:flex}.justify-between[_ngcontent-%COMP%]{justify-content:space-between}.justify-end[_ngcontent-%COMP%]{justify-content:flex-end}.items-center[_ngcontent-%COMP%]{align-items:center}.items-start[_ngcontent-%COMP%]{align-items:flex-start}.mb-2[_ngcontent-%COMP%]{margin-bottom:.5rem}.mb-3[_ngcontent-%COMP%]{margin-bottom:.75rem}.mb-4[_ngcontent-%COMP%]{margin-bottom:1rem}.mr-2[_ngcontent-%COMP%]{margin-right:.5rem}.mt-1[_ngcontent-%COMP%]{margin-top:.25rem}.mt-2[_ngcontent-%COMP%]{margin-top:.5rem}.mt-4[_ngcontent-%COMP%]{margin-top:1rem}.mt-6[_ngcontent-%COMP%]{margin-top:1.5rem}.gap-4[_ngcontent-%COMP%]{gap:1rem}.flex-1[_ngcontent-%COMP%]{flex:1 1 0%}.text-2xl[_ngcontent-%COMP%]{font-size:1.5rem;line-height:2rem}.text-md[_ngcontent-%COMP%]{font-size:1rem;line-height:1.5rem}.text-gray-500[_ngcontent-%COMP%]{color:#6b7280}.text-gray-700[_ngcontent-%COMP%]{color:#374151}.hover\\\\[_ngcontent-%COMP%]:text-gray-800:hover{color:#1f2937}"]})};function nr(o,t){o&1&&(r(0,"tr")(1,"td",14),p(2,"i",15),l(3,"Carregando hist\xF3rico... "),a()())}function or(o,t){o&1&&(r(0,"tr")(1,"td",14),l(2,"Nenhuma execu\xE7\xE3o registrada."),a()())}function rr(o,t){if(o&1&&(r(0,"tr",16)(1,"td",17),l(2),a(),r(3,"td",17),l(4),a(),r(5,"td",17)(6,"span",18),l(7),a()(),r(8,"td",17),l(9),a()()),o&2){let e=t.$implicit,i=u(2);d(2),E(i.formatDate(e.timestamp)),d(2),E(i.getLeadName(e.leadId)),d(2),P("bg-green-100",e.status==="success")("text-green-800",e.status==="success")("bg-red-100",e.status==="error")("text-red-800",e.status==="error")("bg-yellow-100",e.status==="pending")("text-yellow-800",e.status==="pending"),d(),x(" ",i.getStatusText(e.status)," "),d(2),E(e.text||e.action||"A\xE7\xE3o executada")}}function ar(o,t){if(o&1){let e=w();r(0,"div",19)(1,"button",20),h("click",function(){f(e);let n=u(2);return _(n.previousPage())}),p(2,"i",21),l(3,"Anterior "),a(),r(4,"span",22),l(5),a(),r(6,"button",20),h("click",function(){f(e);let n=u(2);return _(n.nextPage())}),l(7," Pr\xF3xima"),p(8,"i",23),a()()}if(o&2){let e=u(2);d(),c("disabled",e.currentPage===1),d(4),si(" P\xE1gina ",e.currentPage," de ",e.totalPages," (",e.historyItems.length," registros) "),d(),c("disabled",e.currentPage===e.totalPages)}}function sr(o,t){if(o&1){let e=w();r(0,"div",1),h("click",function(){f(e);let n=u();return _(n.closeModal())}),r(1,"div",2),h("click",function(n){return f(e),_(n.stopPropagation())}),r(2,"div",3)(3,"h2",4),l(4),a(),r(5,"button",5),h("click",function(){f(e);let n=u();return _(n.closeModal())}),l(6,"\xD7"),a()(),r(7,"div",6)(8,"table",7)(9,"thead",8)(10,"tr")(11,"th",9),l(12,"Data"),a(),r(13,"th",9),l(14,"Lead Afetado"),a(),r(15,"th",9),l(16,"Status"),a(),r(17,"th",9),l(18,"A\xE7\xE3o Executada"),a()()(),r(19,"tbody",10),b(20,nr,4,0,"tr",11)(21,or,3,0,"tr",11)(22,rr,10,16,"tr",12),a()()(),b(23,ar,9,5,"div",13),a()()}if(o&2){let e=u();d(4),x("Hist\xF3rico: ",e.automationName),d(16),c("ngIf",e.isLoading),d(),c("ngIf",!e.isLoading&&e.historyItems.length===0),d(),c("ngForOf",e.paginatedItems),d(),c("ngIf",e.totalPages>1)}}var ft=class o{firestoreService=v($);isVisible=!1;automationId="";automationName="";ownerId="";boardId="";leads=[];closeModalEvent=new S;historyItems=[];paginatedItems=[];isLoading=!1;currentPage=1;itemsPerPage=10;totalPages=0;subscription;ngOnInit(){this.isVisible&&this.automationId&&this.loadHistory()}ngOnDestroy(){this.unsubscribe()}ngOnChanges(){this.isVisible&&this.automationId?this.loadHistory():this.isVisible||this.unsubscribe()}unsubscribe(){this.subscription&&(this.subscription(),this.subscription=void 0)}loadHistory(){return M(this,null,function*(){this.isLoading=!0,this.unsubscribe();try{this.subscription=this.firestoreService.subscribeToAutomationHistory(this.ownerId,this.boardId,this.automationId,t=>{this.historyItems=t.sort((e,i)=>{let n=e.timestamp?.toMillis?e.timestamp.toMillis():0;return(i.timestamp?.toMillis?i.timestamp.toMillis():0)-n}),this.currentPage=1,this.updatePagination(),this.isLoading=!1})}catch(t){console.error("Erro ao carregar hist\xF3rico de automa\xE7\xE3o:",t),this.isLoading=!1}})}updatePagination(){this.totalPages=Math.ceil(this.historyItems.length/this.itemsPerPage);let t=(this.currentPage-1)*this.itemsPerPage,e=t+this.itemsPerPage;this.paginatedItems=this.historyItems.slice(t,e)}previousPage(){this.currentPage>1&&(this.currentPage--,this.updatePagination())}nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.updatePagination())}getLeadName(t){let e=this.leads.find(i=>i.id===t);return e?e.fields?.companyName||e.fields?.title||"Lead sem nome":"Lead removido"}formatDate(t){if(!t)return"N/A";let e;if(t.toDate)e=t.toDate();else if(t instanceof Date)e=t;else return"N/A";return e.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}getStatusText(t){return{success:"Sucesso",error:"Erro",pending:"Pendente",scheduled:"Agendada"}[t]||"Desconhecido"}closeModal(){this.unsubscribe(),this.closeModalEvent.emit()}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=T({type:o,selectors:[["app-automation-history-modal"]],inputs:{isVisible:"isVisible",automationId:"automationId",automationName:"automationName",ownerId:"ownerId",boardId:"boardId",leads:"leads"},outputs:{closeModalEvent:"closeModalEvent"},features:[ke],decls:1,vars:1,consts:[["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"modal-content","modal-content-lg","p-6",3,"click"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-2xl","font-bold"],[1,"text-gray-500","hover:text-gray-800","text-2xl",3,"click"],[1,"overflow-x-auto"],[1,"min-w-full","bg-white"],[1,"bg-gray-50"],[1,"text-left","py-3","px-4","uppercase","font-semibold","text-sm","text-gray-600"],[1,"text-gray-700","divide-y","divide-gray-200"],[4,"ngIf"],["class","hover:bg-gray-50",4,"ngFor","ngForOf"],["class","p-4 flex justify-between items-center",4,"ngIf"],["colspan","4",1,"text-center","p-6","text-gray-500"],[1,"fas","fa-spinner","fa-spin","mr-2"],[1,"hover:bg-gray-50"],[1,"py-3","px-4"],[1,"px-2","py-1","text-xs","font-medium","rounded-full"],[1,"p-4","flex","justify-between","items-center"],[1,"bg-gray-200","hover:bg-gray-300","disabled:bg-gray-100","disabled:text-gray-400","text-gray-700","font-medium","py-2","px-4","rounded-lg",3,"click","disabled"],[1,"fas","fa-chevron-left","mr-1"],[1,"text-sm","text-gray-600"],[1,"fas","fa-chevron-right","ml-1"]],template:function(e,i){e&1&&b(0,sr,24,5,"div",0),e&2&&c("ngIf",i.isVisible)},dependencies:[F,L,R],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;z-index:1000}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;box-shadow:0 4px 6px #0000001a;max-height:90vh;overflow-y:auto}.modal-content-lg[_ngcontent-%COMP%]{width:95%;max-width:900px}.overflow-x-auto[_ngcontent-%COMP%]{overflow-x:auto}table[_ngcontent-%COMP%]{min-width:100%;background-color:#fff}thead[_ngcontent-%COMP%]{background-color:#f9fafb}th[_ngcontent-%COMP%]{text-align:left;padding:.75rem 1rem;text-transform:uppercase;font-weight:600;font-size:.875rem;color:#4b5563}td[_ngcontent-%COMP%]{padding:.75rem 1rem}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{color:#374151}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:not(:last-child){border-bottom:1px solid #e5e7eb}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9fafb}.text-center[_ngcontent-%COMP%]{text-align:center}.text-gray-500[_ngcontent-%COMP%]{color:#6b7280}.text-gray-600[_ngcontent-%COMP%]{color:#4b5563}.text-gray-700[_ngcontent-%COMP%]{color:#374151}.text-gray-800[_ngcontent-%COMP%]{color:#1f2937}.text-2xl[_ngcontent-%COMP%]{font-size:1.5rem;line-height:2rem}.font-bold[_ngcontent-%COMP%]{font-weight:700}.font-medium[_ngcontent-%COMP%]{font-weight:500}.text-sm[_ngcontent-%COMP%]{font-size:.875rem}.text-xs[_ngcontent-%COMP%]{font-size:.75rem}.px-2[_ngcontent-%COMP%]{padding-left:.5rem;padding-right:.5rem}.py-1[_ngcontent-%COMP%]{padding-top:.25rem;padding-bottom:.25rem}.py-2[_ngcontent-%COMP%]{padding-top:.5rem;padding-bottom:.5rem}.px-4[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}.p-4[_ngcontent-%COMP%]{padding:1rem}.p-6[_ngcontent-%COMP%]{padding:1.5rem}.mb-4[_ngcontent-%COMP%]{margin-bottom:1rem}.mr-1[_ngcontent-%COMP%]{margin-right:.25rem}.mr-2[_ngcontent-%COMP%]{margin-right:.5rem}.ml-1[_ngcontent-%COMP%]{margin-left:.25rem}.rounded-full[_ngcontent-%COMP%]{border-radius:9999px}.rounded-lg[_ngcontent-%COMP%]{border-radius:.5rem}.bg-green-100[_ngcontent-%COMP%]{background-color:#dcfce7}.text-green-800[_ngcontent-%COMP%]{color:#166534}.bg-red-100[_ngcontent-%COMP%]{background-color:#fee2e2}.text-red-800[_ngcontent-%COMP%]{color:#991b1b}.bg-yellow-100[_ngcontent-%COMP%]{background-color:#fef3c7}.text-yellow-800[_ngcontent-%COMP%]{color:#92400e}.bg-gray-200[_ngcontent-%COMP%]{background-color:#e5e7eb}.bg-gray-100[_ngcontent-%COMP%]{background-color:#f3f4f6}button[_ngcontent-%COMP%]:hover.hover\\\\:bg-gray-300{background-color:#d1d5db}button[_ngcontent-%COMP%]:hover.hover\\\\:text-gray-800{color:#1f2937}button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}button[_ngcontent-%COMP%]:disabled.disabled\\\\:bg-gray-100{background-color:#f3f4f6}button[_ngcontent-%COMP%]:disabled.disabled\\\\:text-gray-400{color:#9ca3af}.flex[_ngcontent-%COMP%]{display:flex}.justify-between[_ngcontent-%COMP%]{justify-content:space-between}.items-center[_ngcontent-%COMP%]{align-items:center}.space-x-2[_ngcontent-%COMP%] > *[_ngcontent-%COMP%] + *[_ngcontent-%COMP%]{margin-left:.5rem}"]})};function lr(o,t){if(o&1){let e=w();r(0,"button",29),h("click",function(){f(e);let n=u();return _(n.showCreateColumnModal())}),p(1,"i",10),l(2," Nova Fase "),a()}}function dr(o,t){o&1&&(r(0,"div",30),p(1,"div",31),a())}function cr(o,t){if(o&1){let e=w();r(0,"button",35),h("click",function(){let n=f(e).$implicit,s=u(2);return _(s.switchTab(n.id))}),p(1,"i"),l(2),a()}if(o&2){let e=t.$implicit,i=u(2);P("border-blue-500",i.activeTab===e.id)("text-blue-600",i.activeTab===e.id)("border-transparent",i.activeTab!==e.id)("text-gray-500",i.activeTab!==e.id)("hover:text-gray-700",i.activeTab!==e.id),d(),ie(li("fas ",e.icon," mr-2")),d(),x(" ",e.name," ")}}function mr(o,t){if(o&1&&(r(0,"nav",32)(1,"div",33),b(2,cr,3,14,"button",34),a()()),o&2){let e=u();d(2),c("ngForOf",e.tabs)}}function ur(o,t){if(o&1){let e=w();r(0,"div",50)(1,"button",51),h("click",function(){f(e);let n=u().$implicit,s=u(2);return _(s.editColumn(n))}),p(2,"i",52),l(3," Editar Fase "),a(),r(4,"button",53),h("click",function(){f(e);let n=u().$implicit,s=u(2);return _(s.showColumnForm(n))}),p(5,"i",54),l(6," Formul\xE1rio da Fase "),a(),p(7,"hr",55),r(8,"button",56),h("click",function(){f(e);let n=u().$implicit,s=u(2);return _(s.deleteColumn(n))}),p(9,"i",57),l(10," Excluir Fase "),a()()}}function pr(o,t){if(o&1&&(r(0,"div",73),l(1),a()),o&2){let e=u().$implicit;d(),x(" CNPJ: ",e.fields.cnpj," ")}}function gr(o,t){if(o&1&&(r(0,"div",74),l(1),Je(2,"titlecase"),a()),o&2){let e=u().$implicit,i=u(3);ie(i.getLeadStatusColor(e)),d(),x(" ",et(2,3,e.fields.temperature)," ")}}function hr(o,t){if(o&1&&(r(0,"div",75),p(1,"i",76),r(2,"span",77),l(3),a()()),o&2){let e=u().$implicit;d(3),E(e.fields.contactName)}}function fr(o,t){if(o&1&&(r(0,"div",78),p(1,"i",79),r(2,"span",77),l(3),a()()),o&2){let e=u().$implicit;d(3),E(e.fields.contactEmail)}}function _r(o,t){if(o&1&&(r(0,"div",78),p(1,"i",80),r(2,"span",77),l(3),a()()),o&2){let e=u().$implicit;d(3),E(e.fields.contactPhone)}}function br(o,t){if(o&1&&(r(0,"div",81)(1,"div",82),p(2,"i",83),r(3,"span"),l(4),a()()()),o&2){let e=u().$implicit,i=u(3);d(),ie(i.getSlaStatus(e).colorClass),d(3),E(i.getSlaStatus(e).text)}}function vr(o,t){if(o&1&&(r(0,"div",84)(1,"p",85),l(2),a()()),o&2){let e=u().$implicit;d(2),x(" ",e.fields.description," ")}}function xr(o,t){if(o&1){let e=w();r(0,"div",58),h("click",function(){let n=f(e).$implicit,s=u(3);return _(s.showLeadDetailModal(n))}),r(1,"div",59)(2,"div",60)(3,"h4",61),l(4),a(),b(5,pr,2,1,"div",62),a(),b(6,gr,3,5,"div",63),a(),r(7,"div",64),b(8,hr,4,1,"div",65)(9,fr,4,1,"div",66)(10,_r,4,1,"div",66),a(),b(11,br,5,3,"div",67),r(12,"div",68)(13,"div",69),p(14,"i",70),r(15,"span"),l(16),a()(),r(17,"div",71),l(18),a()(),b(19,vr,3,1,"div",72),a()}if(o&2){let e=t.$implicit,i=u(3);ie(i.getSlaStatus(e).borderClass||i.getLeadPriorityClass(e)),c("cdkDragData",e.id),d(4),x(" ",e.fields.companyName||"Empresa n\xE3o informada"," "),d(),c("ngIf",e.fields==null?null:e.fields.cnpj),d(),c("ngIf",e.fields==null?null:e.fields.temperature),d(2),c("ngIf",e.fields==null?null:e.fields.contactName),d(),c("ngIf",e.fields==null?null:e.fields.contactEmail),d(),c("ngIf",e.fields==null?null:e.fields.contactPhone),d(),c("ngIf",i.getSlaStatus(e).text),d(5),E(i.formatDate(e.createdAt)),d(2),x(" ",i.getLeadInitials(e)," "),d(),c("ngIf",e.fields==null?null:e.fields.description)}}function yr(o,t){o&1&&(r(0,"div",86),p(1,"i",87),r(2,"p",88),l(3,"Nenhum lead nesta fase"),a()())}function Cr(o,t){if(o&1){let e=w();r(0,"div",38)(1,"div",39)(2,"div",40)(3,"h3",41),l(4),a(),r(5,"span",42),l(6),a()(),r(7,"div",43)(8,"button",44),h("click",function(){let n=f(e).$implicit,s=u(2);return _(s.toggleColumnMenu(n.id))}),p(9,"i",45),a(),b(10,ur,11,0,"div",46),a()(),r(11,"div",47),h("cdkDropListDropped",function(n){f(e);let s=u(2);return _(s.onLeadDrop(n))}),b(12,xr,20,13,"div",48)(13,yr,4,0,"div",49),a()()}if(o&2){let e=t.$implicit,i=u(2);ee("background-color","#e2e8f0"),d(),ee("border-top-color",i.getColumnBorderColor(e)),d(3),E(e.name),d(2),x(" ",i.getLeadsForColumn(e.id).length," "),d(4),c("ngIf",i.showColumnMenu===e.id),d(),c("id","column-"+e.id)("cdkDropListData",i.getLeadsForColumn(e.id))("cdkDropListConnectedTo",i.getColumnConnectedTo()),d(),c("ngForOf",i.getLeadsForColumn(e.id)),d(),c("ngIf",i.getLeadsForColumn(e.id).length===0)}}function wr(o,t){if(o&1&&(r(0,"div",36),b(1,Cr,14,12,"div",37),a()),o&2){let e=u();d(),c("ngForOf",e.columns)}}function Sr(o,t){o&1&&(r(0,"div",89)(1,"div",90),p(2,"i",91),r(3,"h3",92),l(4,"Nenhuma coluna encontrada"),a(),r(5,"p",93),l(6," Este quadro ainda n\xE3o possui colunas configuradas. "),a()()())}function Er(o,t){if(o&1&&(r(0,"span"),p(1,"i",115),l(2),a()),o&2){let e=u().$implicit,i=u(3);d(2),x(" Atualizado em ",i.formatDate(e.updatedAt)," ")}}function Mr(o,t){if(o&1){let e=w();r(0,"div",104)(1,"div",105)(2,"div",106)(3,"h3",107),l(4),a(),r(5,"p",108)(6,"strong"),l(7,"Assunto:"),a(),l(8),a(),r(9,"p",109)(10,"strong"),l(11,"Para:"),a(),l(12),a(),r(13,"div",110)(14,"span"),p(15,"i",111),l(16),a(),b(17,Er,3,1,"span",112),a()(),r(18,"div",113)(19,"button",114),h("click",function(){let n=f(e).$implicit,s=u(3);return _(s.editTemplate(n))}),p(20,"i",115),l(21," Editar "),a(),r(22,"button",116),h("click",function(){let n=f(e).$implicit,s=u(3);return _(s.deleteTemplate(n))}),p(23,"i",117),l(24," Excluir "),a()()()()}if(o&2){let e=t.$implicit,i=u(3);d(4),x(" ",e.name||"Template sem nome"," "),d(4),x(" ",e.subject||"Sem assunto"," "),d(4),x(" ",e.recipients||"N\xE3o especificado"," "),d(4),x(" Criado em ",i.formatDate(e.createdAt)," "),d(),c("ngIf",e.updatedAt)}}function Dr(o,t){if(o&1&&(r(0,"div",102),b(1,Mr,25,5,"div",103),a()),o&2){let e=u(2);d(),c("ngForOf",e.emailTemplates)}}function Pr(o,t){o&1&&(r(0,"div",118)(1,"div",119),p(2,"i",120),r(3,"h3",121),l(4,"Nenhum template encontrado"),a(),r(5,"p"),l(6,"Crie templates personalizados para automa\xE7\xF5es de email"),a()()())}function Ir(o,t){if(o&1){let e=w();r(0,"div",94)(1,"div",95)(2,"div",96)(3,"h2",97),l(4,"Templates de Email"),a(),r(5,"button",98),h("click",function(){f(e);let n=u();return _(n.createTemplate())}),p(6,"i",99),l(7," Novo Template "),a()(),b(8,Dr,2,1,"div",100)(9,Pr,7,0,"div",101),a()()}if(o&2){let e=u();d(8),c("ngIf",e.emailTemplates.length>0),d(),c("ngIf",e.emailTemplates.length===0)}}function Tr(o,t){if(o&1&&(r(0,"span"),p(1,"i",134),l(2),a()),o&2){let e=u().$implicit,i=u(3);d(2),x(" \xDAltima execu\xE7\xE3o: ",i.formatDate(e.lastExecuted)," ")}}function kr(o,t){if(o&1){let e=w();r(0,"div",104)(1,"div",105)(2,"div",106)(3,"div",123)(4,"h3",124),l(5),a(),r(6,"span",125),l(7),a()(),r(8,"div",126)(9,"p",127),p(10,"i",128),r(11,"strong"),l(12,"Gatilho:"),a(),l(13),a(),r(14,"p",127),p(15,"i",129),r(16,"strong"),l(17,"A\xE7\xF5es:"),a(),l(18),a()(),r(19,"div",110)(20,"span"),p(21,"i",111),l(22),a(),b(23,Tr,3,1,"span",112),a()(),r(24,"div",113)(25,"button",130),h("click",function(n){let s=f(e).$implicit,m=u(3);return _(m.showAutomationHistory(s,n))}),p(26,"i",131),l(27," Hist\xF3rico "),a(),r(28,"button",114),h("click",function(n){let s=f(e).$implicit,m=u(3);return _(m.editAutomation(s,n))}),p(29,"i",115),l(30," Editar "),a(),r(31,"button",132),h("click",function(){let n=f(e).$implicit,s=u(3);return _(s.toggleAutomation(n))}),p(32,"i",133),l(33),a(),r(34,"button",116),h("click",function(){let n=f(e).$implicit,s=u(3);return _(s.deleteAutomation(n))}),p(35,"i",117),l(36," Excluir "),a()()()()}if(o&2){let e=t.$implicit,i=u(3);d(5),x(" ",e.name," "),d(),P("bg-green-100",e.active)("text-green-800",e.active)("bg-red-100",!e.active)("text-red-800",!e.active),d(),x(" ",e.active?"Ativa":"Inativa"," "),d(6),x(" ",i.getTriggerDescription(e.trigger)," "),d(5),x(" ",i.getActionsCount(e.actions)," a\xE7\xE3o(\xF5es) configurada(s) "),d(4),x(" Criada em ",i.formatDate(e.createdAt)," "),d(),c("ngIf",e.lastExecuted),d(8),P("text-red-600",e.active)("hover:text-red-800",e.active)("text-green-600",!e.active)("hover:text-green-800",!e.active),d(),P("fa-pause",e.active)("fa-play",!e.active),d(),x(" ",e.active?"Pausar":"Ativar"," ")}}function Fr(o,t){if(o&1&&(r(0,"div",102),b(1,kr,37,27,"div",103),a()),o&2){let e=u(2);d(),c("ngForOf",e.getValidAutomations())}}function Or(o,t){o&1&&(r(0,"div",118)(1,"div",119),p(2,"i",135),r(3,"h3",121),l(4,"Nenhuma automa\xE7\xE3o encontrada"),a(),r(5,"p"),l(6,"Configure automa\xE7\xF5es para disparar a\xE7\xF5es quando leads mudarem de fase"),a()()())}function Lr(o,t){if(o&1){let e=w();r(0,"div",94)(1,"div",95)(2,"div",96)(3,"h2",97),l(4,"Automa\xE7\xF5es"),a(),r(5,"button",122),h("click",function(n){f(e);let s=u();return _(s.createAutomation(n))}),p(6,"i",99),l(7," Nova Automa\xE7\xE3o "),a()(),b(8,Fr,2,1,"div",100)(9,Or,7,0,"div",101),a()()}if(o&2){let e=u();d(8),c("ngIf",e.getValidAutomations().length>0),d(),c("ngIf",e.getValidAutomations().length===0)}}function Rr(o,t){if(o&1&&(r(0,"div",68)(1,"div",40),p(2,"div",149),r(3,"span",150),l(4),a()(),r(5,"span",93),l(6),a()()),o&2){let e=t.$implicit,i=u(2);d(2),ee("background-color",e.color||"#4A90E2"),d(2),E(e.name),d(2),x("",i.getLeadsForColumn(e.id).length," leads")}}function Ar(o,t){if(o&1&&(r(0,"div",94)(1,"div",95)(2,"div",96)(3,"h2",97),l(4,"Relat\xF3rios"),a(),r(5,"button",136),p(6,"i",137),l(7," Exportar Relat\xF3rio "),a()(),r(8,"div",138)(9,"div",118)(10,"div",68)(11,"div")(12,"p",139),l(13,"Total de Leads"),a(),r(14,"p",97),l(15),a()(),r(16,"div",140),p(17,"i",141),a()()(),r(18,"div",118)(19,"div",68)(20,"div")(21,"p",139),l(22,"Leads Ativos"),a(),r(23,"p",97),l(24),a()(),r(25,"div",142),p(26,"i",143),a()()(),r(27,"div",118)(28,"div",68)(29,"div")(30,"p",139),l(31,"Total de Colunas"),a(),r(32,"p",97),l(33),a()(),r(34,"div",144),p(35,"i",145),a()()()(),r(36,"div",118)(37,"h3",146),l(38,"Leads por Fase"),a(),r(39,"div",147),b(40,Rr,7,4,"div",148),a()()()()),o&2){let e=u();d(15),E(e.leads.length),d(9),E(e.getActiveLeads().length),d(9),E(e.columns.length),d(7),c("ngForOf",e.columns)}}function Vr(o,t){if(o&1){let e=w();r(0,"button",35),h("click",function(){let n=f(e).$implicit,s=u(2);return _(s.activeEmailStatus=n.id)}),l(1),r(2,"span",42),l(3),a()()}if(o&2){let e=t.$implicit,i=u(2);P("border-blue-500",i.activeEmailStatus===e.id)("text-blue-600",i.activeEmailStatus===e.id)("border-transparent",i.activeEmailStatus!==e.id)("text-gray-500",i.activeEmailStatus!==e.id),d(),x(" ",e.name," "),d(2),x(" ",e.count," ")}}function Nr(o,t){o&1&&(r(0,"div",119),p(1,"i",164),r(2,"h3",121),l(3,"Nenhum email encontrado"),a(),r(4,"p"),l(5,"Emails enviados aparecer\xE3o aqui"),a()())}function zr(o,t){if(o&1){let e=w();r(0,"button",179),h("click",function(){f(e);let n=u().$implicit,s=u(3);return _(s.retryEmail(n))}),p(1,"i",180),a()}}function Br(o,t){if(o&1){let e=w();r(0,"div",166)(1,"div",68)(2,"div",106)(3,"div",167),p(4,"div",168),r(5,"h4",169),l(6),a(),r(7,"span",170),l(8),a()(),r(9,"div",171)(10,"span"),p(11,"i",172),l(12),a(),r(13,"span"),p(14,"i",173),l(15),a()()(),r(16,"div",12)(17,"button",174),h("click",function(){let n=f(e).$implicit,s=u(3);return _(s.viewEmail(n))}),p(18,"i",175),a(),b(19,zr,2,0,"button",176),r(20,"button",177),h("click",function(){let n=f(e).$implicit,s=u(3);return _(s.deleteEmail(n))}),p(21,"i",178),a()()()()}if(o&2){let e=t.$implicit,i=u(3);d(4),P("bg-yellow-400",!e.delivery||e.delivery.state==="PENDING")("bg-green-400",(e.delivery==null?null:e.delivery.state)==="SUCCESS")("bg-red-400",(e.delivery==null?null:e.delivery.state)==="ERROR"),d(2),E(e.subject||"Sem assunto"),d(),P("bg-yellow-100",!e.delivery||e.delivery.state==="PENDING")("text-yellow-800",!e.delivery||e.delivery.state==="PENDING")("bg-green-100",(e.delivery==null?null:e.delivery.state)==="SUCCESS")("text-green-800",(e.delivery==null?null:e.delivery.state)==="SUCCESS")("bg-red-100",(e.delivery==null?null:e.delivery.state)==="ERROR")("text-red-800",(e.delivery==null?null:e.delivery.state)==="ERROR"),d(),x(" ",i.getEmailStatusLabel(e)," "),d(4),x("Para: ",e.to),d(3),E(i.formatDate(e.createdAt)),d(4),c("ngIf",(e.delivery==null?null:e.delivery.state)==="ERROR"||!e.delivery)}}function Hr(o,t){if(o&1&&(r(0,"div",147),b(1,Br,22,23,"div",165),a()),o&2){let e=u(2);d(),c("ngForOf",e.getFilteredEmails())}}function jr(o,t){if(o&1&&(r(0,"div",94)(1,"div",151)(2,"div",96)(3,"h2",97),l(4,"Caixa de Sa\xEDda"),a(),r(5,"div",152)(6,"button",153),p(7,"i",154),l(8," Atualizar "),a(),r(9,"button",155),p(10,"i",156),l(11," Novo Email "),a()()(),r(12,"div",157)(13,"div",158)(14,"nav",159),b(15,Vr,4,10,"button",160),a()(),r(16,"div",161),b(17,Nr,6,0,"div",162)(18,Hr,2,1,"div",163),a()()()()),o&2){let e=u();d(15),c("ngForOf",e.emailStatuses),d(2),c("ngIf",e.getFilteredEmails().length===0),d(),c("ngIf",e.getFilteredEmails().length>0)}}function Ur(o,t){if(o&1){let e=w();r(0,"div",94)(1,"div",95)(2,"div",96)(3,"h2",97),l(4,"Configura\xE7\xE3o da API"),a(),r(5,"div",12)(6,"span",127),l(7,"Status:"),a(),r(8,"span",181),p(9,"i",182),l(10,"Ativa "),a()()(),r(11,"div",183)(12,"div",184)(13,"h3",107),p(14,"i",185),l(15,"Endpoint para Novos Leads "),a(),r(16,"p",186),l(17," Use este endpoint para enviar novos leads diretamente para o seu kanban via API REST. "),a(),r(18,"div",187)(19,"div",188)(20,"span",189),l(21,"URL do Endpoint:"),a(),r(22,"button",190),h("click",function(){f(e);let n=u();return _(n.copyToClipboard(n.apiEndpoint))}),p(23,"i",191),l(24,"Copiar "),a()(),r(25,"code",192),l(26),a()()(),r(27,"div",184)(28,"h4",193),p(29,"i",194),l(30,"Token de Autentica\xE7\xE3o "),a(),r(31,"p",108),l(32," Inclua este token no header "),r(33,"code",195),l(34,"Authorization"),a(),l(35," de suas requisi\xE7\xF5es. "),a(),r(36,"div",187)(37,"div",188)(38,"span",189),l(39,"Bearer Token:"),a(),r(40,"button",190),h("click",function(){f(e);let n=u();return _(n.copyToClipboard(n.apiToken))}),p(41,"i",191),l(42,"Copiar "),a()(),r(43,"code",196),l(44),a()()(),r(45,"div",161)(46,"h4",193),p(47,"i",197),l(48,"Exemplo de Requisi\xE7\xE3o "),a(),r(49,"p",108),l(50," Exemplo de como enviar um novo lead via POST request: "),a(),r(51,"div",198)(52,"pre",88)(53,"code"),l(54),a()()()()(),r(55,"div",183)(56,"div",184)(57,"h3",107),p(58,"i",199),l(59,"Webhooks (Em breve) "),a(),r(60,"p",127),l(61," Receba notifica\xE7\xF5es quando leads mudarem de fase, forem criados ou atualizados. "),a()(),r(62,"div",161)(63,"div",200),p(64,"i",201),r(65,"h4",202),l(66,"Funcionalidade em Desenvolvimento"),a(),r(67,"p",88),l(68,"Webhooks estar\xE3o dispon\xEDveis em breve para integra\xE7\xE3o avan\xE7ada."),a()()()(),r(69,"div",203)(70,"h3",204),p(71,"i",205),l(72,"Documenta\xE7\xE3o da API "),a(),r(73,"div",206)(74,"div",207),p(75,"i",208),r(76,"div")(77,"strong"),l(78,"M\xE9todo:"),a(),l(79," POST para criar novos leads "),a()(),r(80,"div",207),p(81,"i",208),r(82,"div")(83,"strong"),l(84,"Content-Type:"),a(),l(85," application/json obrigat\xF3rio "),a()(),r(86,"div",207),p(87,"i",208),r(88,"div")(89,"strong"),l(90,"Autentica\xE7\xE3o:"),a(),l(91," Bearer token no header Authorization "),a()(),r(92,"div",207),p(93,"i",208),r(94,"div")(95,"strong"),l(96,"Campos obrigat\xF3rios:"),a(),l(97," companyName, contactName, contactEmail "),a()(),r(98,"div",207),p(99,"i",208),r(100,"div")(101,"strong"),l(102,"Resposta de sucesso:"),a(),l(103," Status 201 com dados do lead criado "),a()()()()()()}if(o&2){let e=u();d(26),x(" ",e.apiEndpoint," "),d(18),x(" ",e.apiToken," "),d(10),ai("POST ",e.apiEndpoint,`
Content-Type: application/json
Authorization: Bearer `,e.apiToken,`

{
  "companyName": "Nome da Empresa Exemplo",
  "cnpj": "00.000.000/0001-00",
  "contactName": "Nome do Contato",
  "contactEmail": "email@exemplo.com",
  "contactPhone": "(11) 99999-9999",
  "phaseId": "(Opcional) ID da fase para onde o lead deve ir"
}`)}}function $r(o,t){if(o&1){let e=w();r(0,"app-automation-modal",209),h("closeModalEvent",function(){f(e);let n=u();return _(n.onCloseAutomationModal())})("saveAutomation",function(n){f(e);let s=u();return _(s.onSaveAutomation(n))}),a()}if(o&2){let e=u();c("isVisible",e.showAutomationModal)("automation",e.selectedAutomation)("phases",e.columns)("emailTemplates",e.emailTemplates)("users",e.users)}}var on=class o{authService=v(ae);firestoreService=v($);route=v(hi);router=v(fi);leadModal;columnModal;phaseFormModal;leadDetailModal;templateModal;automationModal;board=null;columns=[];leads=[];currentUser=null;boardId="";ownerId="";subscriptions=[];isLoading=!0;activeTab="kanban";tabs=[{id:"kanban",name:"Kanban",icon:"fa-columns"},{id:"reports",name:"Relat\xF3rios",icon:"fa-chart-bar"},{id:"outbox",name:"Caixa de Sa\xEDda",icon:"fa-paper-plane"},{id:"templates",name:"Templates",icon:"fa-envelope"},{id:"automations",name:"Automa\xE7\xF5es",icon:"fa-cogs"},{id:"api",name:"API",icon:"fa-code"}];apiEndpoint="https://your-domain.com/functions/v1/lead-intake";apiToken="KzB47@p!qR9$tW2m&e*J";ngOnInit(){this.currentUser=this.authService.getCurrentUser(),this.boardId=this.route.snapshot.paramMap.get("boardId")||"",this.ownerId=this.route.snapshot.queryParamMap.get("ownerId")||this.currentUser?.uid||"",console.log("KanbanComponent - boardId:",this.boardId,"ownerId:",this.ownerId),this.currentUser&&this.boardId&&this.ownerId?(this.loadBoardData(),this.subscribeToRealtimeUpdates()):console.error("Par\xE2metros faltando:",{currentUser:!!this.currentUser,boardId:this.boardId,ownerId:this.ownerId})}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}loadBoardData(){return M(this,null,function*(){try{yield this.loadUsers(),yield this.debugFirestoreCollections(),this.isLoading=!1}catch(t){console.error("Erro ao carregar dados do quadro:",t),this.isLoading=!1}})}debugFirestoreCollections(){return M(this,null,function*(){try{console.log("=== DEBUG: Testando acesso \xE0s cole\xE7\xF5es ==="),console.log("ownerId:",this.ownerId,"boardId:",this.boardId),console.log("Testando: users/"+this.ownerId+"/boards/"+this.boardId+"/emailTemplates");let t=yield this.firestoreService.getEmailTemplates(this.ownerId,this.boardId);console.log("Templates encontrados (m\xE9todo direto):",t),console.log("Testando: users/"+this.ownerId+"/boards/"+this.boardId+"/automations");let e=yield this.firestoreService.getAutomations(this.ownerId,this.boardId);console.log("Automa\xE7\xF5es encontradas (m\xE9todo direto):",e),console.log("=== Testando estrutura alternativa ==="),console.log("Testando: boards/"+this.boardId+"/emailTemplates");try{let i=yield this.firestoreService.getEmailTemplates("",this.boardId);console.log("Templates encontrados (estrutura alternativa):",i)}catch(i){console.log("Erro na estrutura alternativa para templates:",i)}}catch(t){console.error("Erro no debug das cole\xE7\xF5es:",t)}})}loadUsers(){return M(this,null,function*(){try{this.users=[{uid:this.currentUser?.uid,displayName:this.currentUser?.displayName,email:this.currentUser?.email}]}catch(t){console.error("Erro ao carregar usu\xE1rios:",t)}})}subscribeToRealtimeUpdates(){console.log("Subscribing to updates with ownerId:",this.ownerId,"boardId:",this.boardId);let t=this.firestoreService.subscribeToColumns(this.ownerId,this.boardId,m=>{console.log("Colunas recebidas:",m),this.columns=m});this.subscriptions.push({unsubscribe:t});let e=this.firestoreService.subscribeToLeads(this.ownerId,this.boardId,m=>{console.log("Leads recebidos:",m),this.leads=m,this.isLoading=!1});this.subscriptions.push({unsubscribe:e});let i=this.firestoreService.subscribeToOutboxEmails(this.ownerId,this.boardId,m=>{console.log("Emails da caixa de sa\xEDda recebidos:",m),this.outboxEmails=m,this.updateEmailStatusCounts()});this.subscriptions.push({unsubscribe:i});let n=this.firestoreService.subscribeToEmailTemplates(this.ownerId,this.boardId,m=>{console.log("Templates recebidos:",m),this.emailTemplates=m});this.subscriptions.push({unsubscribe:n}),console.log("=== SUBSCRI\xC7\xC3O DE AUTOMA\xC7\xD5ES ==="),console.log("ownerId:",this.ownerId,"boardId:",this.boardId),console.log("Iniciando subscri\xE7\xE3o...");let s=this.firestoreService.subscribeToAutomations(this.ownerId,this.boardId,m=>{console.log("=== CALLBACK DE AUTOMA\xC7\xD5ES EXECUTADO ==="),console.log("Automa\xE7\xF5es recebidas:",m),console.log("N\xFAmero de automa\xE7\xF5es:",m.length),console.log("Tipo dos dados:",typeof m,Array.isArray(m)),m&&m.length>0?(console.log("Primeira automa\xE7\xE3o completa:",m[0]),console.log("Campos da primeira automa\xE7\xE3o:",Object.keys(m[0]))):console.log("Nenhuma automa\xE7\xE3o encontrada ou array vazio"),this.automations=m||[],console.log("this.automations definido como:",this.automations),this.cleanupInvalidAutomations(),console.log("=== FIM CALLBACK AUTOMA\xC7\xD5ES ===")});this.subscriptions.push({unsubscribe:s})}getLeadsForColumn(t){return this.leads.filter(e=>e.columnId===t)}getColumnConnectedTo(){return this.columns.map(t=>`column-${t.id}`)}onLeadDrop(t){return M(this,null,function*(){let e=t.item.data,i=t.container.id.replace("column-","");if(t.previousContainer===t.container)Me(t.container.data,t.previousIndex,t.currentIndex);else{Zi(t.previousContainer.data,t.container.data,t.previousIndex,t.currentIndex);try{yield this.firestoreService.moveLead(this.ownerId,this.boardId,e,i)}catch(n){console.error("Erro ao mover lead:",n),this.subscribeToRealtimeUpdates()}}})}logout(){return M(this,null,function*(){(yield this.authService.logout()).success&&this.router.navigate(["/login"])})}goToDashboard(){this.router.navigate(["/dashboard"])}formatDate(t){if(!t)return console.log("formatDate: timestamp is null/undefined"),"Data n\xE3o dispon\xEDvel";try{return t.seconds?new Date(t.seconds*1e3).toLocaleDateString("pt-BR"):t.toDate?t.toDate().toLocaleDateString("pt-BR"):t instanceof Date?t.toLocaleDateString("pt-BR"):new Date(t).toLocaleDateString("pt-BR")}catch(e){return console.log("formatDate error:",e,"timestamp:",t),"Data inv\xE1lida"}}getColumnBorderColor(t){return t.color||"#e5e7eb"}getLeadPriorityClass(t){let e=t.fields?.temperature;return e==="quente"?"border-l-red-500":e==="morno"?"border-l-yellow-500":"border-l-transparent"}getLeadInitials(t){return(t.fields?.companyName||t.fields?.contactName||"").split(" ").map(i=>i.charAt(0)).join("").substring(0,2).toUpperCase()}showCreateLeadModal(){this.leadModal.showCreateModal()}showEditLeadModal(t){this.leadModal.showEditModal(t)}showLeadDetailModal(t){this.leadDetailModal.show(t)}onLeadCreated(){console.log("Novo lead criado!")}onLeadUpdated(){console.log("Lead atualizado!")}onLeadDeleted(){console.log("Lead exclu\xEDdo!")}switchTab(t){this.activeTab=t}getActiveLeads(){return this.leads.filter(t=>{let e=this.columns.find(i=>i.id===t.columnId);return e&&(!e.endStageType||e.endStageType==="none")})}outboxEmails=[];activeEmailStatus="all";emailStatuses=[{id:"all",name:"Todos",count:0},{id:"scheduled",name:"Agendados",count:0},{id:"success",name:"Enviados",count:0},{id:"error",name:"Com Erro",count:0}];emailTemplates=[];automations=[];showColumnMenu=null;users=[];updateEmailStatusCounts(){let t={all:this.outboxEmails.length,scheduled:this.outboxEmails.filter(e=>!e.delivery||e.delivery.state==="PENDING").length,success:this.outboxEmails.filter(e=>e.delivery?.state==="SUCCESS").length,error:this.outboxEmails.filter(e=>e.delivery?.state==="ERROR").length};this.emailStatuses=[{id:"all",name:"Todos",count:t.all},{id:"scheduled",name:"Na Fila",count:t.scheduled},{id:"success",name:"Enviados",count:t.success},{id:"error",name:"Com Erro",count:t.error}]}getFilteredEmails(){return this.activeEmailStatus==="all"?this.outboxEmails:this.outboxEmails.filter(t=>{switch(this.activeEmailStatus){case"scheduled":return!t.delivery||t.delivery.state==="PENDING";case"success":return t.delivery?.state==="SUCCESS";case"error":return t.delivery?.state==="ERROR";default:return!1}})}getEmailStatusLabel(t){if(!t.delivery)return"Na Fila";switch(t.delivery.state){case"SUCCESS":return"Enviado";case"ERROR":return"Erro";case"PENDING":return"Na Fila";default:return t.delivery.state||"Desconhecido"}}viewEmail(t){console.log("Visualizar email:",t);let e=t.delivery?.endTime?new Date(t.delivery.endTime.seconds*1e3).toLocaleString("pt-BR"):"---",i=t.createdAt?new Date(t.createdAt.seconds*1e3).toLocaleString("pt-BR"):"---";alert(`Visualizar Email:

Para: ${t.to||"N\xE3o especificado"}
Assunto: ${t.subject||"Sem assunto"}
Status: ${this.getEmailStatusLabel(t)}
Criado em: ${i}
Enviado em: ${e}

Conte\xFAdo:
${t.html||t.text||"Sem conte\xFAdo dispon\xEDvel"}`)}retryEmail(t){return M(this,null,function*(){try{yield this.firestoreService.updateOutboxEmail(this.ownerId,this.boardId,t.id,{status:"scheduled",scheduledAt:new Date,retryCount:(t.retryCount||0)+1}),console.log("Email reagendado para reenvio")}catch(e){console.error("Erro ao reenviar email:",e),alert("Erro ao reenviar email. Tente novamente.")}})}deleteEmail(t){return M(this,null,function*(){if(confirm("Tem certeza que deseja excluir este email?"))try{yield this.firestoreService.deleteOutboxEmail(this.ownerId,this.boardId,t.id),console.log("Email exclu\xEDdo com sucesso")}catch(e){console.error("Erro ao excluir email:",e),alert("Erro ao excluir email. Tente novamente.")}})}toggleColumnMenu(t){this.showColumnMenu=this.showColumnMenu===t?null:t}showCreateColumnModal(){this.columnModal.showCreateModal(),this.showColumnMenu=null}editColumn(t){this.columnModal.showEditModal(t),this.showColumnMenu=null}showColumnForm(t){return M(this,null,function*(){try{let e=yield this.firestoreService.getPhaseFormConfig(this.ownerId,this.boardId,t.id);this.phaseFormModal.showModal(t,e||void 0)}catch(e){console.error("Erro ao carregar configura\xE7\xE3o do formul\xE1rio:",e),this.phaseFormModal.showModal(t,void 0)}this.showColumnMenu=null})}deleteColumn(t){return M(this,null,function*(){if(confirm(`Tem certeza que deseja excluir a fase "${t.name}"? Esta a\xE7\xE3o n\xE3o pode ser desfeita.`))try{yield this.firestoreService.deleteColumn(this.ownerId,this.boardId,t.id),console.log("Fase exclu\xEDda com sucesso")}catch(e){console.error("Erro ao excluir fase:",e),alert("Erro ao excluir fase. Tente novamente.")}this.showColumnMenu=null})}onColumnCreated(){console.log("Nova fase criada!")}onColumnUpdated(){console.log("Fase atualizada!")}onPhaseFormConfigSaved(){console.log("Configura\xE7\xE3o de formul\xE1rio salva!")}getSlaStatus(t){let e=this.columns.find(y=>y.id===t.columnId);if(!e||!e.slaDays||e.slaDays<=0||!t.movedToCurrentColumnAt)return{status:"none",text:"",colorClass:"",borderClass:""};let i=t.movedToCurrentColumnAt.seconds?new Date(t.movedToCurrentColumnAt.seconds*1e3):new Date(t.movedToCurrentColumnAt),n=new Date,m=new Date(i.getTime()+e.slaDays*24*60*60*1e3).getTime()-n.getTime(),g=m/(1e3*60*60*24);return g<0?{status:"overdue",text:`Atrasado ${Math.abs(Math.floor(g))}d`,colorClass:"text-red-600",borderClass:"border-l-red-500"}:g<e.slaDays*.25?{status:"at-risk",text:`${Math.ceil(m/36e5)}h restantes`,colorClass:"text-yellow-600",borderClass:"border-l-yellow-500"}:{status:"ok",text:`${Math.ceil(g)}d restantes`,colorClass:"text-green-600",borderClass:"border-l-green-500"}}getLeadStatusColor(t){let e=t.fields?.temperature;return e==="quente"?"bg-red-100 text-red-800":e==="morno"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}getTriggerDescription(t){if(!t)return"N\xE3o especificado";let i={"new-lead-created":"Quando um novo lead \xE9 criado","card-enters-phase":"Quando lead entra em uma fase","card-in-phase-for-time":"Quando lead fica muito tempo na fase","form-not-answered":"Quando formul\xE1rio n\xE3o \xE9 respondido","sla-overdue":"Quando SLA da fase vence"}[t.type]||t.type;if(t.phase&&this.columns.length>0){let n=this.columns.find(s=>s.id===t.phase);n&&(i+=` (${n.name})`)}return t.days&&(i+=` (${t.days} dias)`),i}toggleAutomationStatus(t,e){return M(this,null,function*(){try{yield this.firestoreService.updateAutomation(this.ownerId,this.boardId,t,{active:!e}),console.log("Status da automa\xE7\xE3o alterado:",t)}catch(i){console.error("Erro ao alterar status da automa\xE7\xE3o:",i)}})}deleteAutomation(t){return M(this,null,function*(){if(confirm("Tem certeza que deseja excluir esta automa\xE7\xE3o?"))try{yield this.firestoreService.deleteAutomation(this.ownerId,this.boardId,t.id),console.log("Automa\xE7\xE3o exclu\xEDda:",t.id)}catch(e){console.error("Erro ao excluir automa\xE7\xE3o:",e)}})}toggleAutomation(t){this.toggleAutomationStatus(t.id,t.active)}getActionsCount(t){return t?t.length:0}getValidAutomations(){return this.automations.filter(t=>t&&t.name&&t.name.trim()!==""&&t.name!=="Automa\xE7\xE3o sem nome")}cleanupInvalidAutomations(){return M(this,null,function*(){let t=this.automations.filter(e=>!e||!e.name||e.name.trim()===""||e.name==="Automa\xE7\xE3o sem nome");if(t.length>0){console.log("Encontradas automa\xE7\xF5es inv\xE1lidas, removendo:",t);for(let e of t)if(e.id)try{yield this.firestoreService.deleteAutomation(this.ownerId,this.boardId,e.id),console.log("Automa\xE7\xE3o inv\xE1lida removida:",e.id)}catch(i){console.error("Erro ao remover automa\xE7\xE3o inv\xE1lida:",i)}}})}createTemplate(){this.templateModal.showCreateModal()}editTemplate(t){this.templateModal.showEditModal(t)}deleteTemplate(t){return M(this,null,function*(){if(confirm("Tem certeza que deseja excluir este template?"))try{yield this.firestoreService.deleteEmailTemplate(this.ownerId,this.boardId,t.id),console.log("Template exclu\xEDdo com sucesso!")}catch(e){console.error("Erro ao excluir template:",e)}})}onTemplateSaved(){this.templateModal.hide()}showAutomationModal=!1;selectedAutomation=null;showHistoryModal=!1;selectedAutomationForHistory=null;createAutomation(t){t&&(t.preventDefault(),t.stopPropagation()),console.log("=== BOT\xC3O NOVA AUTOMA\xC7\xC3O CLICADO ==="),this.selectedAutomation=null,this.showAutomationModal=!0}editAutomation(t,e){e&&(e.preventDefault(),e.stopPropagation()),console.log("=== EDITAR AUTOMA\xC7\xC3O ===",t),this.selectedAutomation=t,this.showAutomationModal=!0}onCloseAutomationModal(){this.showAutomationModal=!1,this.selectedAutomation=null}onSaveAutomation(t){return M(this,null,function*(){try{t.id?(yield this.firestoreService.updateAutomation(this.ownerId,this.boardId,t.id,t),console.log("Automa\xE7\xE3o atualizada com sucesso:",t.name)):(yield this.firestoreService.createAutomation(this.ownerId,this.boardId,t),console.log("Automa\xE7\xE3o criada com sucesso:",t.name))}catch(e){console.error("Erro ao salvar automa\xE7\xE3o:",e),alert("Erro ao salvar automa\xE7\xE3o. Verifique o console para detalhes.")}})}showAutomationHistory(t,e){e&&(e.preventDefault(),e.stopPropagation()),console.log("=== MOSTRAR HIST\xD3RICO DE AUTOMA\xC7\xC3O ===",t),this.selectedAutomationForHistory=t,this.showHistoryModal=!0}onCloseHistoryModal(){this.showHistoryModal=!1,this.selectedAutomationForHistory=null}copyToClipboard(t){navigator.clipboard.writeText(t).then(()=>{console.log("Texto copiado:",t)}).catch(e=>{console.error("Erro ao copiar texto:",e)})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=T({type:o,selectors:[["app-kanban"]],viewQuery:function(e,i){if(e&1&&(Y(Ve,5),Y(Ne,5),Y(ze,5),Y(Be,5),Y(He,5),Y(je,5)),e&2){let n;X(n=J())&&(i.leadModal=n.first),X(n=J())&&(i.columnModal=n.first),X(n=J())&&(i.phaseFormModal=n.first),X(n=J())&&(i.leadDetailModal=n.first),X(n=J())&&(i.templateModal=n.first),X(n=J())&&(i.automationModal=n.first)}},decls:38,vars:34,consts:[[1,"min-h-screen","bg-gray-100"],[1,"bg-white","shadow-sm","border-b","border-gray-200"],[1,"max-w-full","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"flex","justify-between","items-center","h-16"],[1,"flex","items-center","space-x-4"],[1,"text-gray-500","hover:text-gray-700","p-2","rounded-lg","hover:bg-gray-100","transition-colors",3,"click"],[1,"fas","fa-arrow-left"],["src","https://apps.gobuyer.com.br/sso/assets/images/logos/logo-gobuyer.png","alt","Logo GoBuyer",1,"h-8"],[1,"text-xl","font-semibold","text-gray-900"],[1,"bg-green-500","hover:bg-green-600","text-white","px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors",3,"click"],[1,"fas","fa-plus","mr-1"],["class","bg-gray-400 hover:bg-gray-500 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors",3,"click",4,"ngIf"],[1,"flex","items-center","space-x-2"],[1,"w-8","h-8","bg-blue-500","rounded-full","flex","items-center","justify-center","text-white","text-sm","font-bold"],[1,"text-sm","text-gray-700","hidden","sm:block"],[1,"text-gray-500","hover:text-gray-700","px-3","py-2","rounded-md","text-sm","font-medium","transition-colors",3,"click"],[1,"fas","fa-sign-out-alt"],["class","flex justify-center items-center py-20",4,"ngIf"],["class","bg-white px-8 border-b border-gray-200",4,"ngIf"],["class","kanban-board",4,"ngIf"],["class","text-center py-20",4,"ngIf"],["class","p-8",4,"ngIf"],[3,"leadCreated","leadUpdated","closeModal","ownerId","boardId","columns"],[3,"columnCreated","columnUpdated","closeModal","ownerId","boardId","columns"],[3,"formConfigSaved","closeModal","ownerId","boardId"],[3,"leadUpdated","leadDeleted","closeModal","ownerId","boardId","columns","users"],[3,"templateSaved","closeModal","ownerId","boardId"],[3,"isVisible","automation","phases","emailTemplates","users","closeModalEvent","saveAutomation",4,"ngIf"],[3,"closeModalEvent","isVisible","automationId","automationName","ownerId","boardId","leads"],[1,"bg-gray-400","hover:bg-gray-500","text-white","px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors",3,"click"],[1,"flex","justify-center","items-center","py-20"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-500"],[1,"bg-white","px-8","border-b","border-gray-200"],[1,"flex","space-x-8"],["class","py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200",3,"border-blue-500","text-blue-600","border-transparent","text-gray-500","hover:text-gray-700","click",4,"ngFor","ngForOf"],[1,"py-4","px-1","border-b-2","font-medium","text-sm","transition-colors","duration-200",3,"click"],[1,"kanban-board"],["class","kanban-column",3,"background-color",4,"ngFor","ngForOf"],[1,"kanban-column"],[1,"kanban-column-header","relative"],[1,"flex","items-center"],[1,"font-semibold","text-gray-800"],[1,"ml-2","bg-gray-200","text-gray-600","text-xs","px-2","py-1","rounded-full"],[1,"relative"],[1,"text-gray-400","hover:text-gray-600","p-1",3,"click"],[1,"fas","fa-ellipsis-v","text-sm"],["class","absolute right-0 top-8 bg-white border border-gray-200 rounded-lg shadow-lg z-10 w-48",4,"ngIf"],["cdkDropList","",1,"kanban-cards",3,"cdkDropListDropped","id","cdkDropListData","cdkDropListConnectedTo"],["class","bg-white rounded-lg shadow-sm border border-gray-200 hover:shadow-md transition-all duration-200 cursor-pointer mb-3 p-4 border-l-4","cdkDrag","",3,"class","cdkDragData","click",4,"ngFor","ngForOf"],["class","text-center py-8 text-gray-400",4,"ngIf"],[1,"absolute","right-0","top-8","bg-white","border","border-gray-200","rounded-lg","shadow-lg","z-10","w-48"],[1,"w-full","text-left","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100","rounded-t-lg",3,"click"],[1,"fas","fa-edit","mr-2"],[1,"w-full","text-left","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100",3,"click"],[1,"fas","fa-wpforms","mr-2"],[1,"my-1"],[1,"w-full","text-left","px-4","py-2","text-sm","text-red-600","hover:bg-red-50","rounded-b-lg",3,"click"],[1,"fas","fa-trash","mr-2"],["cdkDrag","",1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","hover:shadow-md","transition-all","duration-200","cursor-pointer","mb-3","p-4","border-l-4",3,"click","cdkDragData"],[1,"flex","items-start","justify-between","mb-3"],[1,"flex-1","min-w-0"],[1,"font-semibold","text-gray-900","text-sm","truncate","mb-1"],["class","text-xs text-gray-500",4,"ngIf"],["class","px-2 py-1 rounded-full text-xs font-medium flex-shrink-0 ml-2",3,"class",4,"ngIf"],[1,"space-y-1","mb-3"],["class","flex items-center text-sm text-gray-700",4,"ngIf"],["class","flex items-center text-xs text-gray-600",4,"ngIf"],["class","mb-3",4,"ngIf"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","text-xs","text-gray-500"],[1,"far","fa-calendar-alt","w-3","h-3","mr-1"],[1,"w-6","h-6","bg-blue-500","text-white","rounded-full","flex","items-center","justify-center","text-xs","font-bold","border-2","border-white","shadow-sm"],["class","mt-2 pt-2 border-t border-gray-100",4,"ngIf"],[1,"text-xs","text-gray-500"],[1,"px-2","py-1","rounded-full","text-xs","font-medium","flex-shrink-0","ml-2"],[1,"flex","items-center","text-sm","text-gray-700"],[1,"fas","fa-user","w-3","h-3","mr-2","text-gray-400"],[1,"truncate"],[1,"flex","items-center","text-xs","text-gray-600"],[1,"fas","fa-envelope","w-3","h-3","mr-2","text-gray-400"],[1,"fas","fa-phone","w-3","h-3","mr-2","text-gray-400"],[1,"mb-3"],[1,"flex","items-center","text-xs","font-medium"],[1,"fas","fa-clock","w-3","h-3","mr-1"],[1,"mt-2","pt-2","border-t","border-gray-100"],[1,"text-xs","text-gray-600","line-clamp-2"],[1,"text-center","py-8","text-gray-400"],[1,"fas","fa-inbox","text-2xl","mb-2"],[1,"text-sm"],[1,"text-center","py-20"],[1,"max-w-md","mx-auto"],[1,"fas","fa-columns","text-6xl","text-gray-300","mb-4"],[1,"text-xl","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600"],[1,"p-8"],[1,"max-w-4xl","mx-auto"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"bg-blue-500","hover:bg-blue-600","text-white","px-4","py-2","rounded-lg","font-medium","transition-colors",3,"click"],[1,"fas","fa-plus","mr-2"],["class","grid gap-4",4,"ngIf"],["class","bg-white rounded-lg shadow p-6",4,"ngIf"],[1,"grid","gap-4"],["class","bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",4,"ngFor","ngForOf"],[1,"bg-white","border","border-gray-200","rounded-lg","p-6","hover:shadow-md","transition-shadow"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-sm","text-gray-600","mb-3"],[1,"text-xs","text-gray-500","mb-4"],[1,"flex","items-center","text-xs","text-gray-500","space-x-4"],[1,"far","fa-calendar-alt","mr-1"],[4,"ngIf"],[1,"flex","items-center","space-x-2","ml-4"],[1,"text-blue-600","hover:text-blue-800","px-3","py-1","text-sm","font-medium",3,"click"],[1,"fas","fa-edit","mr-1"],[1,"text-red-600","hover:text-red-800","px-3","py-1","text-sm","font-medium",3,"click"],[1,"fas","fa-trash","mr-1"],[1,"bg-white","rounded-lg","shadow","p-6"],[1,"text-center","py-12","text-gray-500"],[1,"fas","fa-envelope","text-6xl","mb-4"],[1,"text-xl","font-semibold","mb-2"],[1,"bg-green-500","hover:bg-green-600","text-white","px-4","py-2","rounded-lg","font-medium","transition-colors",3,"click"],[1,"flex","items-center","mb-2"],[1,"text-lg","font-semibold","text-gray-900","mr-3"],[1,"px-2","py-1","text-xs","font-medium","rounded-full"],[1,"space-y-2","mb-4"],[1,"text-sm","text-gray-600"],[1,"fas","fa-bolt","mr-2"],[1,"fas","fa-play","mr-2"],["title","Ver Hist\xF3rico",1,"text-gray-500","hover:text-blue-600","px-3","py-1","text-sm","font-medium",3,"click"],[1,"fas","fa-history","mr-1"],[1,"px-3","py-1","text-sm","font-medium",3,"click"],[1,"fas","mr-1"],[1,"fas","fa-play","mr-1"],[1,"fas","fa-cogs","text-6xl","mb-4"],[1,"bg-purple-500","hover:bg-purple-600","text-white","px-4","py-2","rounded-lg","font-medium","transition-colors"],[1,"fas","fa-download","mr-2"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6","mb-8"],[1,"text-sm","font-medium","text-gray-600"],[1,"bg-blue-100","p-3","rounded-full"],[1,"fas","fa-users","text-blue-500"],[1,"bg-green-100","p-3","rounded-full"],[1,"fas","fa-chart-line","text-green-500"],[1,"bg-purple-100","p-3","rounded-full"],[1,"fas","fa-columns","text-purple-500"],[1,"text-lg","font-semibold","mb-4"],[1,"space-y-4"],["class","flex items-center justify-between",4,"ngFor","ngForOf"],[1,"w-4","h-4","rounded-full","mr-3"],[1,"font-medium"],[1,"max-w-6xl","mx-auto"],[1,"flex","space-x-2"],[1,"bg-blue-500","hover:bg-blue-600","text-white","px-4","py-2","rounded-lg","font-medium","transition-colors"],[1,"fas","fa-sync","mr-2"],[1,"bg-green-500","hover:bg-green-600","text-white","px-4","py-2","rounded-lg","font-medium","transition-colors"],[1,"fas","fa-envelope","mr-2"],[1,"bg-white","rounded-lg","shadow"],[1,"border-b","border-gray-200"],[1,"flex","space-x-8","px-6"],["class","py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200",3,"border-blue-500","text-blue-600","border-transparent","text-gray-500","click",4,"ngFor","ngForOf"],[1,"p-6"],["class","text-center py-12 text-gray-500",4,"ngIf"],["class","space-y-4",4,"ngIf"],[1,"fas","fa-paper-plane","text-6xl","mb-4"],["class","border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",4,"ngFor","ngForOf"],[1,"border","border-gray-200","rounded-lg","p-4","hover:bg-gray-50","transition-colors"],[1,"flex","items-center","space-x-3"],[1,"w-3","h-3","rounded-full"],[1,"font-medium","text-gray-900"],[1,"px-2","py-1","text-xs","rounded-full"],[1,"mt-2","flex","items-center","space-x-4","text-sm","text-gray-500"],[1,"fas","fa-envelope","mr-1"],[1,"fas","fa-clock","mr-1"],[1,"text-blue-600","hover:text-blue-800",3,"click"],[1,"fas","fa-eye"],["class","text-green-600 hover:text-green-800",3,"click",4,"ngIf"],[1,"text-red-600","hover:text-red-800",3,"click"],[1,"fas","fa-trash"],[1,"text-green-600","hover:text-green-800",3,"click"],[1,"fas","fa-redo"],[1,"px-2","py-1","bg-green-100","text-green-800","text-xs","font-medium","rounded"],[1,"fas","fa-check-circle","mr-1"],[1,"bg-white","rounded-lg","shadow","mb-6"],[1,"p-6","border-b","border-gray-200"],[1,"fas","fa-link","mr-2","text-blue-500"],[1,"text-sm","text-gray-600","mb-4"],[1,"bg-gray-50","border","border-gray-200","rounded-lg","p-4"],[1,"flex","items-center","justify-between","mb-2"],[1,"text-sm","font-medium","text-gray-700"],[1,"text-blue-600","hover:text-blue-800","text-sm",3,"click"],[1,"fas","fa-copy","mr-1"],[1,"bg-blue-50","text-blue-800","text-sm","p-2","rounded","border","block"],[1,"text-md","font-semibold","text-gray-900","mb-2"],[1,"fas","fa-key","mr-2","text-yellow-500"],[1,"bg-gray-100","px-1","rounded"],[1,"bg-yellow-50","text-yellow-800","text-sm","p-2","rounded","border","block","font-mono"],[1,"fas","fa-code","mr-2","text-green-500"],[1,"bg-gray-900","text-gray-100","rounded-lg","p-4","overflow-x-auto"],[1,"fas","fa-broadcast-tower","mr-2","text-purple-500"],[1,"text-center","py-8","text-gray-500"],[1,"fas","fa-construction","text-4xl","mb-3"],[1,"font-semibold","mb-2"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-6"],[1,"text-lg","font-semibold","text-blue-900","mb-3"],[1,"fas","fa-book","mr-2"],[1,"space-y-3","text-sm","text-blue-800"],[1,"flex","items-start","space-x-3"],[1,"fas","fa-check-circle","mt-0.5","text-blue-600"],[3,"closeModalEvent","saveAutomation","isVisible","automation","phases","emailTemplates","users"]],template:function(e,i){e&1&&(r(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),h("click",function(){return i.goToDashboard()}),p(6,"i",6),a(),p(7,"img",7),r(8,"h1",8),l(9),a()(),r(10,"div",4)(11,"button",9),h("click",function(){return i.showCreateLeadModal()}),p(12,"i",10),l(13," Novo Lead "),a(),b(14,lr,3,0,"button",11),r(15,"div",12)(16,"div",13),l(17),a(),r(18,"span",14),l(19),a()(),r(20,"button",15),h("click",function(){return i.logout()}),p(21,"i",16),a()()()()(),b(22,dr,2,0,"div",17)(23,mr,3,1,"nav",18)(24,wr,2,1,"div",19)(25,Sr,7,0,"div",20)(26,Ir,10,2,"div",21)(27,Lr,10,2,"div",21)(28,Ar,41,4,"div",21)(29,jr,19,3,"div",21)(30,Ur,104,4,"div",21),r(31,"app-lead-modal",22),h("leadCreated",function(){return i.onLeadCreated()})("leadUpdated",function(){return i.onLeadUpdated()})("closeModal",function(){return i.onLeadUpdated()}),a(),r(32,"app-column-modal",23),h("columnCreated",function(){return i.onColumnCreated()})("columnUpdated",function(){return i.onColumnUpdated()})("closeModal",function(){return i.onColumnUpdated()}),a(),r(33,"app-phase-form-modal",24),h("formConfigSaved",function(){return i.onPhaseFormConfigSaved()})("closeModal",function(){return i.onPhaseFormConfigSaved()}),a(),r(34,"app-lead-detail-modal",25),h("leadUpdated",function(){return i.onLeadUpdated()})("leadDeleted",function(){return i.onLeadDeleted()})("closeModal",function(){return i.onLeadUpdated()}),a(),r(35,"app-template-modal",26),h("templateSaved",function(){return i.onTemplateSaved()})("closeModal",function(){return i.onTemplateSaved()}),a(),b(36,$r,1,5,"app-automation-modal",27),r(37,"app-automation-history-modal",28),h("closeModalEvent",function(){return i.onCloseHistoryModal()}),a()()),e&2&&(d(9),x(" ",(i.board==null?null:i.board.name)||"Quadro Kanban"," "),d(5),c("ngIf",i.activeTab==="kanban"),d(3),x(" ",(i.currentUser==null||i.currentUser.displayName==null?null:i.currentUser.displayName.charAt(0))||(i.currentUser==null||i.currentUser.email==null?null:i.currentUser.email.charAt(0))||"U"," "),d(2),x(" ",(i.currentUser==null?null:i.currentUser.displayName)||(i.currentUser==null?null:i.currentUser.email)," "),d(3),c("ngIf",i.isLoading),d(),c("ngIf",!i.isLoading),d(),c("ngIf",!i.isLoading&&i.activeTab==="kanban"),d(),c("ngIf",!i.isLoading&&i.activeTab==="kanban"&&i.columns.length===0),d(),c("ngIf",!i.isLoading&&i.activeTab==="templates"),d(),c("ngIf",!i.isLoading&&i.activeTab==="automations"),d(),c("ngIf",!i.isLoading&&i.activeTab==="reports"),d(),c("ngIf",!i.isLoading&&i.activeTab==="outbox"),d(),c("ngIf",!i.isLoading&&i.activeTab==="api"),d(),c("ownerId",i.ownerId)("boardId",i.boardId)("columns",i.columns),d(),c("ownerId",i.ownerId)("boardId",i.boardId)("columns",i.columns),d(),c("ownerId",i.ownerId)("boardId",i.boardId),d(),c("ownerId",i.ownerId)("boardId",i.boardId)("columns",i.columns)("users",i.users),d(),c("ownerId",i.ownerId)("boardId",i.boardId),d(),c("ngIf",i.showAutomationModal),d(),c("isVisible",i.showHistoryModal)("automationId",(i.selectedAutomationForHistory==null?null:i.selectedAutomationForHistory.id)||"")("automationName",(i.selectedAutomationForHistory==null?null:i.selectedAutomationForHistory.name)||"")("ownerId",i.ownerId)("boardId",i.boardId)("leads",i.leads))},dependencies:[F,L,R,gt,pt,ut,Ve,Ne,ze,Be,He,je,ft,it],styles:[".kanban-board[_ngcontent-%COMP%]{display:flex;gap:16px;padding:24px;overflow-x:auto;min-height:calc(100vh - 80px)}.kanban-column[_ngcontent-%COMP%]{min-width:320px;max-width:320px;background-color:#e2e8f0;border-radius:12px;display:flex;flex-direction:column;transition:opacity .2s ease-in-out}.kanban-column-header[_ngcontent-%COMP%]{padding:12px 16px;font-weight:600;display:flex;justify-content:space-between;align-items:center;border-top-width:4px;border-top-style:solid;border-top-left-radius:12px;border-top-right-radius:12px;transition:background-color .3s}.kanban-cards[_ngcontent-%COMP%]{flex-grow:1;padding:8px 16px;overflow-y:auto;min-height:200px}.kanban-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;padding:12px;margin-bottom:12px;cursor:pointer;box-shadow:0 1px 3px #0000001a,0 1px 2px #0000000f;transition:box-shadow .2s,transform .2s;border-left:5px solid transparent;position:relative}.kanban-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f;transform:translateY(-1px)}.card-avatar[_ngcontent-%COMP%]{position:absolute;bottom:8px;right:8px;width:28px;height:28px;background-color:#94a3b8;color:#fff;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:12px;border:2px solid white}.line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:8px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging[_ngcontent-%COMP%]   .kanban-card[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]})};export{on as KanbanComponent};
