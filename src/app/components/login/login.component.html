<div class="auth-container">
  <div class="auth-card">
    <!-- Header -->
    <div class="auth-header">
      <div class="logo-container">
        <i class="fas fa-tasks logo-icon"></i>
      </div>
      <h1 class="auth-title">TaskBoard</h1>
      <p class="auth-subtitle">Sistema de Gestão Kanban</p>
    </div>

    <!-- Tab Navigation -->
    <div class="auth-tabs">
      <button 
        class="auth-tab"
        [class.active]="currentView() === 'login'"
        (click)="switchView('login')">
        <i class="fas fa-sign-in-alt"></i>
        Entrar
      </button>
      <button 
        class="auth-tab"
        [class.active]="currentView() === 'register'"
        (click)="switchView('register')">
        <i class="fas fa-building"></i>
        Criar Empresa
      </button>
    </div>

    <!-- Messages -->
    <div class="alert alert-success" *ngIf="successMessage()">
      <i class="fas fa-check-circle"></i>
      {{ successMessage() }}
    </div>
    
    <div class="alert alert-danger" *ngIf="errorMessage()">
      <i class="fas fa-exclamation-circle"></i>
      {{ errorMessage() }}
    </div>

    <!-- Login Form -->
    <div class="auth-content" *ngIf="currentView() === 'login'">
      <form [formGroup]="loginForm" (ngSubmit)="signInWithEmail()" class="auth-form">
        <div class="form-group">
          <label for="email" class="form-label">
            <i class="fas fa-envelope"></i>
            Email
          </label>
          <input 
            type="email" 
            id="email"
            class="form-control"
            formControlName="email"
            placeholder="seu@email.com"
            [class.is-invalid]="loginForm.get('email')?.touched && loginForm.get('email')?.invalid">
          <div class="invalid-feedback" *ngIf="loginForm.get('email')?.touched && loginForm.get('email')?.invalid">
            {{ getFieldError('login', 'email') }}
          </div>
        </div>

        <div class="form-group">
          <label for="password" class="form-label">
            <i class="fas fa-lock"></i>
            Senha
          </label>
          <input 
            type="password" 
            id="password"
            class="form-control"
            formControlName="password"
            placeholder="Sua senha"
            [class.is-invalid]="loginForm.get('password')?.touched && loginForm.get('password')?.invalid">
          <div class="invalid-feedback" *ngIf="loginForm.get('password')?.touched && loginForm.get('password')?.invalid">
            {{ getFieldError('login', 'password') }}
          </div>
        </div>

        <button 
          type="submit" 
          class="btn btn-primary btn-block"
          [disabled]="isLoading() || !loginFormValid">
          <i class="fas fa-spinner fa-spin" *ngIf="isLoading()"></i>
          <i class="fas fa-sign-in-alt" *ngIf="!isLoading()"></i>
          {{ isLoading() ? 'Entrando...' : 'Entrar' }}
        </button>

        <div class="text-center mt-3">
          <button 
            type="button"
            class="btn-link"
            (click)="switchView('forgot-password')"
            [disabled]="isLoading()">
            <i class="fas fa-key"></i>
            Esqueceu a senha?
          </button>
        </div>
      </form>

      <div class="auth-divider">
        <span>ou</span>
      </div>

      <button 
        class="btn btn-google btn-block"
        (click)="signInWithGoogle()"
        [disabled]="isLoading()">
        <svg class="google-icon" viewBox="0 0 24 24">
          <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
          <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
          <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
          <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
        </svg>
        Entrar com Google
      </button>
    </div>

    <!-- Register Form -->
    <div class="auth-content" *ngIf="currentView() === 'register'">
      <form [formGroup]="registerForm" (ngSubmit)="registerUser()" class="auth-form">
        <!-- Informações do Responsável -->
        <div class="form-section">
          <h4 class="section-title">
            <i class="fas fa-user"></i>
            Informações do Responsável
          </h4>
          
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label class="form-label">Nome Completo *</label>
                <input 
                  type="text" 
                  class="form-control"
                  formControlName="ownerName"
                  placeholder="João Silva"
                  [class.is-invalid]="registerForm.get('ownerName')?.touched && registerForm.get('ownerName')?.invalid">
                <div class="invalid-feedback" *ngIf="registerForm.get('ownerName')?.touched && registerForm.get('ownerName')?.invalid">
                  {{ getFieldError('register', 'ownerName') }}
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label class="form-label">Telefone *</label>
                <input 
                  type="tel" 
                  class="form-control"
                  formControlName="ownerPhone"
                  placeholder="(11) 99999-9999"
                  [class.is-invalid]="registerForm.get('ownerPhone')?.touched && registerForm.get('ownerPhone')?.invalid">
                <div class="invalid-feedback" *ngIf="registerForm.get('ownerPhone')?.touched && registerForm.get('ownerPhone')?.invalid">
                  {{ getFieldError('register', 'ownerPhone') }}
                </div>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Email *</label>
            <input 
              type="email" 
              class="form-control"
              formControlName="ownerEmail"
              placeholder="joao@empresa.com"
              [class.is-invalid]="registerForm.get('ownerEmail')?.touched && registerForm.get('ownerEmail')?.invalid">
            <div class="invalid-feedback" *ngIf="registerForm.get('ownerEmail')?.touched && registerForm.get('ownerEmail')?.invalid">
              {{ getFieldError('register', 'ownerEmail') }}
            </div>
          </div>
        </div>

        <!-- Informações da Empresa -->
        <div class="form-section">
          <h4 class="section-title">
            <i class="fas fa-building"></i>
            Informações da Empresa
          </h4>
          
          <div class="form-group">
            <label class="form-label">Nome da Empresa *</label>
            <input 
              type="text" 
              class="form-control"
              formControlName="companyName"
              placeholder="Minha Empresa Ltda"
              [class.is-invalid]="registerForm.get('companyName')?.touched && registerForm.get('companyName')?.invalid">
            <div class="invalid-feedback" *ngIf="registerForm.get('companyName')?.touched && registerForm.get('companyName')?.invalid">
              {{ getFieldError('register', 'companyName') }}
            </div>
          </div>

        </div>

        <!-- Configuração do Subdomínio -->
        <div class="form-section">
          <h4 class="section-title">
            <i class="fas fa-link"></i>
            Configuração do Subdomínio
          </h4>
          
          <div class="form-group">
            <label class="form-label">Alias/Subdomínio *</label>
            <div class="input-group">
              <input 
                type="text" 
                class="form-control"
                formControlName="subdomain"
                placeholder="minhaempresa"
                [class.is-invalid]="(subdomainControl?.touched && subdomainControl?.invalid) || aliasError()"
                [class.is-valid]="aliasAvailable() === true">
              <div class="input-group-text">.taskboard.com.br</div>
            </div>
            
            <!-- Status da verificação -->
            <div class="mt-2">
              <div class="text-info" *ngIf="isCheckingAlias()">
                <i class="fas fa-spinner fa-spin"></i>
                Verificando disponibilidade...
              </div>
              <div class="text-success" *ngIf="aliasAvailable() === true">
                <i class="fas fa-check-circle"></i>
                Alias disponível!
              </div>
              <div class="text-danger" *ngIf="aliasError()">
                <i class="fas fa-times-circle"></i>
                {{ aliasError() }}
              </div>
            </div>

            <!-- Preview do domínio -->
            <div class="domain-preview mt-2" *ngIf="subdomainControl?.value">
              <strong>Seu domínio será:</strong>
              <code class="domain-url">{{ getAliasPreview() }}</code>
            </div>

            <div class="invalid-feedback" *ngIf="subdomainControl?.touched && subdomainControl?.invalid">
              {{ getFieldError('register', 'subdomain') }}
            </div>

            <button 
              type="button" 
              class="btn btn-outline-secondary btn-sm mt-2"
              (click)="generateSuggestions()">
              <i class="fas fa-magic"></i>
              Gerar Sugestões
            </button>
          </div>
        </div>

        <!-- Senha -->
        <div class="form-section">
          <h4 class="section-title">
            <i class="fas fa-key"></i>
            Configuração de Acesso
          </h4>
          
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label class="form-label">Senha *</label>
                <input 
                  type="password" 
                  class="form-control"
                  formControlName="password"
                  placeholder="Mínimo 6 caracteres"
                  [class.is-invalid]="registerForm.get('password')?.touched && registerForm.get('password')?.invalid">
                <div class="invalid-feedback" *ngIf="registerForm.get('password')?.touched && registerForm.get('password')?.invalid">
                  {{ getFieldError('register', 'password') }}
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label class="form-label">Confirmar Senha *</label>
                <input 
                  type="password" 
                  class="form-control"
                  formControlName="confirmPassword"
                  placeholder="Digite a senha novamente"
                  [class.is-invalid]="registerForm.get('confirmPassword')?.touched && registerForm.errors?.['passwordMismatch']">
                <div class="invalid-feedback" *ngIf="registerForm.get('confirmPassword')?.touched && registerForm.errors?.['passwordMismatch']">
                  {{ getFieldError('register', 'confirmPassword') }}
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Termos -->
        <div class="form-group">
          <div class="form-check">
            <input 
              class="form-check-input" 
              type="checkbox" 
              formControlName="agreeTerms"
              id="agreeTerms"
              [class.is-invalid]="registerForm.get('agreeTerms')?.touched && registerForm.get('agreeTerms')?.invalid">
            <label class="form-check-label" for="agreeTerms">
              Aceito os <a href="/termos" target="_blank">termos de uso</a> e <a href="/privacidade" target="_blank">política de privacidade</a> *
            </label>
            <div class="invalid-feedback" *ngIf="registerForm.get('agreeTerms')?.touched && registerForm.get('agreeTerms')?.invalid">
              Você deve aceitar os termos para continuar
            </div>
          </div>
        </div>

        <button 
          type="submit" 
          class="btn btn-success btn-block btn-lg"
          [disabled]="isLoading() || !registerFormValid">
          <i class="fas fa-spinner fa-spin" *ngIf="isLoading()"></i>
          <i class="fas fa-rocket" *ngIf="!isLoading()"></i>
          {{ isLoading() ? 'Criando empresa...' : 'Criar Empresa' }}
        </button>
      </form>
    </div>

    <!-- Forgot Password Form -->
    <div class="auth-content" *ngIf="currentView() === 'forgot-password'">
      <div class="forgot-password-header">
        <i class="fas fa-key icon-large"></i>
        <h3>Recuperar Senha</h3>
        <p class="text-muted">
          Informe seu email e enviaremos instruções para redefinir sua senha.
        </p>
      </div>

      <div class="auth-form">
        <div class="form-group">
          <label for="reset-email" class="form-label">
            <i class="fas fa-envelope"></i>
            Email
          </label>
          <input
            type="email"
            id="reset-email"
            class="form-control"
            [value]="resetEmail()"
            (input)="resetEmail.set($any($event.target).value)"
            (keyup.enter)="sendPasswordReset()"
            placeholder="seu@email.com"
            required>
        </div>

        <button
          type="button"
          class="btn btn-primary btn-block"
          (click)="sendPasswordReset()"
          [disabled]="resetLoading() || !resetEmail().trim()">
          <i class="fas fa-spinner fa-spin" *ngIf="resetLoading()"></i>
          <i class="fas fa-paper-plane" *ngIf="!resetLoading()"></i>
          {{ resetLoading() ? 'Enviando...' : 'Enviar Email de Recuperação' }}
        </button>
      </div>

      <div class="text-center mt-4">
        <button 
          type="button"
          class="btn-link"
          (click)="switchView('login')"
          [disabled]="resetLoading()">
          <i class="fas fa-arrow-left"></i>
          Voltar para o login
        </button>
      </div>
    </div>

    <!-- Footer Info -->
    <div class="auth-footer">
      <div class="footer-features">
        <div class="feature-item">
          <i class="fas fa-cloud"></i>
          <span>100% Nuvem</span>
        </div>
        <div class="feature-item">
          <i class="fas fa-shield-alt"></i>
          <span>Seguro</span>
        </div>
        <div class="feature-item">
          <i class="fas fa-mobile-alt"></i>
          <span>Responsivo</span>
        </div>
      </div>
      
      <p class="copyright">
        © 2024 TaskBoard - Sistema de Gestão Kanban
      </p>
    </div>
  </div>
</div>