import{a as $,b as x,c as M,e as V,f as j,g as y,h as G,i as H,j as J,k as q,m as B,n as N,o as W,p as X,q as Y,r as z,s as k,t as K,u as Z,x as Q,y as ee}from"./chunk-ZZVDKIU7.js";import{da as R,f as d,ga as P,pb as U,qa as L,za as A}from"./chunk-JPAM732G.js";var le="type.googleapis.com/google.protobuf.Int64Value",fe="type.googleapis.com/google.protobuf.UInt64Value";function oe(e,t){let n={};for(let r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}function v(e){if(e==null)return null;if(e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&isFinite(e)||e===!0||e===!1||Object.prototype.toString.call(e)==="[object String]")return e;if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.map(t=>v(t));if(typeof e=="function"||typeof e=="object")return oe(e,t=>v(t));throw new Error("Data cannot be encoded in JSON: "+e)}function g(e){if(e==null)return e;if(e["@type"])switch(e["@type"]){case le:case fe:{let t=Number(e.value);if(isNaN(t))throw new Error("Data cannot be decoded from JSON: "+e);return t}default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map(t=>g(t)):typeof e=="function"||typeof e=="object"?oe(e,t=>g(t)):e}var S="functions";var te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},f=class e extends j{constructor(t,n,r){super(`${S}/${t}`,n||""),this.details=r,Object.setPrototypeOf(this,e.prototype)}};function de(e){if(e>=200&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function I(e,t){let n=de(e),r=n,o;try{let i=t&&t.error;if(i){let a=i.status;if(typeof a=="string"){if(!te[a])return new f("internal","internal");n=te[a],r=a}let s=i.message;typeof s=="string"&&(r=s),o=i.details,o!==void 0&&(o=g(o))}}catch{}return n==="ok"?null:new f(n,r,o)}var C=class{constructor(t,n,r,o){this.app=t,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,q(t)&&t.settings.appCheckToken&&(this.serverAppAppCheckToken=t.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||o?.get().then(i=>this.appCheck=i,()=>{})}getAuthToken(){return d(this,null,function*(){if(this.auth)try{let t=yield this.auth.getToken();return t?.accessToken}catch{return}})}getMessagingToken(){return d(this,null,function*(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return yield this.messaging.getToken()}catch{return}})}getAppCheckToken(t){return d(this,null,function*(){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){let n=t?yield this.appCheck.getLimitedUseToken():yield this.appCheck.getToken();return n.error?null:n.token}return null})}getContext(t){return d(this,null,function*(){let n=yield this.getAuthToken(),r=yield this.getMessagingToken(),o=yield this.getAppCheckToken(t);return{authToken:n,messagingToken:r,appCheckToken:o}})}};var b="us-central1",pe=/^data: (.*?)(?:\n|$)/;function me(e){let t=null;return{promise:new Promise((n,r)=>{t=setTimeout(()=>{r(new f("deadline-exceeded","deadline-exceeded"))},e)}),cancel:()=>{t&&clearTimeout(t)}}}var O=class{constructor(t,n,r,o,i=b,a=(...s)=>fetch(...s)){this.app=t,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new C(t,n,r,o),this.cancelAllRequests=new Promise(s=>{this.deleteService=()=>Promise.resolve(s())});try{let s=new URL(i);this.customDomain=s.origin+(s.pathname==="/"?"":s.pathname),this.region=b}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(t){let n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${t}`:this.customDomain!==null?`${this.customDomain}/${t}`:`https://${this.region}-${n}.cloudfunctions.net/${t}`}};function he(e,t,n){let r=x(t);e.emulatorOrigin=`http${r?"s":""}://${t}:${n}`,r&&(M(e.emulatorOrigin),V("Functions",!0))}function ge(e,t,n){let r=o=>Ne(e,t,o,n||{});return r.stream=(o,i)=>Te(e,t,o,i),r}function Ae(e,t,n,r){return d(this,null,function*(){n["Content-Type"]="application/json";let o;try{o=yield r(e,{method:"POST",body:JSON.stringify(t),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=yield o.json()}catch{}return{status:o.status,json:i}})}function se(e,t){return d(this,null,function*(){let n={},r=yield e.contextProvider.getContext(t.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n})}function Ne(e,t,n,r){let o=e._url(t);return Ee(e,o,n,r)}function Ee(e,t,n,r){return d(this,null,function*(){n=v(n);let o={data:n},i=yield se(e,r),a=r.timeout||7e4,s=me(a),l=yield Promise.race([Ae(t,o,i,e.fetchImpl),s.promise,e.cancelAllRequests]);if(s.cancel(),!l)throw new f("cancelled","Firebase Functions instance was deleted.");let u=I(l.status,l.json);if(u)throw u;if(!l.json)throw new f("internal","Response is not valid JSON object.");let c=l.json.data;if(typeof c>"u"&&(c=l.json.result),typeof c>"u")throw new f("internal","Response is missing data field.");return{data:g(c)}})}function Te(e,t,n,r){let o=e._url(t);return we(e,o,n,r||{})}function we(e,t,n,r){return d(this,null,function*(){var o;n=v(n);let i={data:n},a=yield se(e,r);a["Content-Type"]="application/json",a.Accept="text/event-stream";let s;try{s=yield e.fetchImpl(t,{method:"POST",body:JSON.stringify(i),headers:a,signal:r?.signal})}catch(p){if(p instanceof Error&&p.name==="AbortError"){let w=new f("cancelled","Request was cancelled.");return{data:Promise.reject(w),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(w)}}}}}}let T=I(0,null);return{data:Promise.reject(T),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(T)}}}}}}let l,u,c=new Promise((p,T)=>{l=p,u=T});(o=r?.signal)===null||o===void 0||o.addEventListener("abort",()=>{let p=new f("cancelled","Request was cancelled.");u(p)});let m=s.body.getReader(),h=ye(m,l,u,r?.signal);return{stream:{[Symbol.asyncIterator](){let p=h.getReader();return{next(){return d(this,null,function*(){let{value:w,done:ue}=yield p.read();return{value:w,done:ue}})},return(){return d(this,null,function*(){return yield p.cancel(),{done:!0,value:void 0}})}}}},data:c}})}function ye(e,t,n,r){let o=(a,s)=>{let l=a.match(pe);if(!l)return;let u=l[1];try{let c=JSON.parse(u);if("result"in c){t(g(c.result));return}if("message"in c){s.enqueue(g(c.message));return}if("error"in c){let m=I(0,c);s.error(m),n(m);return}}catch(c){if(c instanceof f){s.error(c),n(c);return}}},i=new TextDecoder;return new ReadableStream({start(a){let s="";return l();function l(){return d(this,null,function*(){if(r?.aborted){let u=new f("cancelled","Request was cancelled");return a.error(u),n(u),Promise.resolve()}try{let{value:u,done:c}=yield e.read();if(c){s.trim()&&o(s.trim(),a),a.close();return}if(r?.aborted){let h=new f("cancelled","Request was cancelled");a.error(h),n(h),yield e.cancel();return}s+=i.decode(u,{stream:!0});let m=s.split(`
`);s=m.pop()||"";for(let h of m)h.trim()&&o(h.trim(),a);return l()}catch(u){let c=u instanceof f?u:I(0,null);a.error(c),n(c)}})}},cancel(){return e.cancel()}})}var ne="@firebase/functions",re="0.12.9";var ke="auth-internal",ve="app-check-internal",Ie="messaging-internal";function Ce(e){let t=(n,{instanceIdentifier:r})=>{let o=n.getProvider("app").getImmediate(),i=n.getProvider(ke),a=n.getProvider(Ie),s=n.getProvider(ve);return new O(o,i,a,s,r)};H(new G(S,t,"PUBLIC").setMultipleInstances(!0)),N(ne,re,e),N(ne,re,"esm2017")}function ie(e=B(),t=b){let r=J(y(e),S).getImmediate({identifier:t}),o=$("functions");return o&&D(r,...o),r}function D(e,t,n){he(y(e),t,n)}function ae(e,t,n){return ge(y(e),t,n)}Ce();var E=class{constructor(t){return t}},ce="functions",F=class{constructor(){return Y(ce)}};var _=new R("angularfire2.functions-instances");function be(e,t){let n=X(ce,e,t);return n&&new E(n)}function Oe(e){return(t,n)=>{let r=t.runOutsideAngular(()=>e(n));return new E(r)}}var Se={provide:F,deps:[[new A,_]]},De={provide:E,useFactory:be,deps:[[new A,_],K]};function We(e,...t){return N("angularfire",W.full,"fn"),P([De,Se,{provide:_,useFactory:Oe(e),multi:!0,deps:[U,L,z,Z,[new A,ee],[new A,Q],...t]}])}var Xe=k(D,!0),Ye=k(ie,!0),ze=k(ae,!0);export{E as a,We as b,Xe as c,Ye as d,ze as e};
