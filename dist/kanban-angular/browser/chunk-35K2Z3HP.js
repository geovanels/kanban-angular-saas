import{a as de}from"./chunk-RLRLA65D.js";import{a as se}from"./chunk-SDQVWWPD.js";import{A as B,C as Q,J as U,c as ie,e as ne,h as re,i as ae,l as $,s as j,z as oe}from"./chunk-QT4WKFE7.js";import{G as le,H as z}from"./chunk-77VQYYTZ.js";import{$b as q,Eb as m,Fb as a,Gb as o,Hb as u,Nc as V,Ob as y,Oc as L,Pb as x,Rb as c,Uc as te,Vc as N,Xb as H,Ya as l,Yb as w,Zb as S,ac as s,bc as v,cc as h,dc as J,f as F,fa as O,fc as A,gb as P,gc as C,hc as M,jc as Y,la as _,lb as p,ma as g,mc as k,ob as R,pc as K,qc as X,tc as Z,uc as ee}from"./chunk-HM7IHYI7.js";function ge(r,t){if(r&1&&(a(0,"span",10),s(1),o()),r&2){let e=c();l(),h(" ",e.getDynamicFilterCount()+(e.filterOnlyMine?1:0)," ")}}function fe(r,t){if(r&1){let e=y();a(0,"button",11),x("click",function(){_(e);let i=c();return g(i.clearFilters())}),u(1,"i",12),o()}}function ve(r,t){if(r&1){let e=y();a(0,"input",36),x("input",function(i){_(e);let d=c().$implicit,f=c(3);return g(f.setDynamicFilter(d.name,i.target.value))}),o()}if(r&2){let e=c().$implicit,n=c(3);m("type",e.type==="number"?"number":"text")("value",n.dynamicFilters[e.name]||"")("placeholder","Filtrar por "+e.label.toLowerCase())}}function he(r,t){if(r&1){let e=y();a(0,"input",37),x("input",function(i){_(e);let d=c().$implicit,f=c(3);return g(f.setDynamicFilter(d.name,i.target.value))}),o()}if(r&2){let e=c().$implicit,n=c(3);m("value",n.dynamicFilters[e.name]||"")}}function xe(r,t){if(r&1&&(a(0,"option",41),s(1),o()),r&2){let e=t.$implicit;m("value",e),l(),h(" ",e," ")}}function ye(r,t){if(r&1){let e=y();a(0,"select",38),x("change",function(i){_(e);let d=c().$implicit,f=c(3);return g(f.setDynamicFilter(d.name,i.target.value))}),a(1,"option",39),s(2,"Todos"),o(),p(3,xe,2,2,"option",40),o()}if(r&2){let e=c().$implicit,n=c(3);m("value",n.dynamicFilters[e.name]||""),l(3),m("ngForOf",n.getFieldOptions(e))}}function be(r,t){if(r&1){let e=y();a(0,"select",38),x("change",function(i){_(e);let d=c().$implicit,f=c(3);return g(f.setDynamicFilter(d.name,i.target.value))}),a(1,"option",39),s(2,"Todas as temperaturas"),o(),a(3,"option",42),s(4,"\u{1F525} Quente"),o(),a(5,"option",43),s(6,"\u{1F321}\uFE0F Morno"),o(),a(7,"option",44),s(8,"\u2744\uFE0F Frio"),o()()}if(r&2){let e=c().$implicit,n=c(3);m("value",n.dynamicFilters[e.name]||"")}}function Ce(r,t){if(r&1){let e=y();a(0,"div",1)(1,"input",45),x("change",function(i){_(e);let d=c().$implicit,f=c(3);return g(f.setDynamicFilter(d.name,i.target.checked))}),o(),a(2,"span",46),s(3,"Apenas marcados"),o()()}if(r&2){let e=c().$implicit,n=c(3);l(),m("checked",n.dynamicFilters[e.name]===!0)}}function we(r,t){if(r&1&&(a(0,"div",30)(1,"label",31),s(2),o(),p(3,ve,1,3,"input",32)(4,he,1,1,"input",33)(5,ye,4,2,"select",34)(6,be,9,1,"select",34)(7,Ce,4,1,"div",35),o()),r&2){let e=t.$implicit;l(2),h(" ",e.label," "),l(),m("ngIf",e.type==="text"||e.type==="email"||e.type==="tel"||e.type==="number"||e.type==="cnpj"||e.type==="cpf"),l(),m("ngIf",e.type==="date"),l(),m("ngIf",e.type==="select"||e.type==="radio"),l(),m("ngIf",e.type==="temperatura"),l(),m("ngIf",e.type==="checkbox")}}function Fe(r,t){if(r&1&&(a(0,"div",27)(1,"h4",28),s(2,"Filtros Din\xE2micos"),o(),p(3,we,8,6,"div",29),o()),r&2){let e=c(2);l(3),m("ngForOf",e.availableFilterFields)}}function Se(r,t){r&1&&(a(0,"div",47),u(1,"i",48),a(2,"p",49),s(3," Nenhum campo configurado para filtros."),u(4,"br"),s(5,' Configure campos com "Mostrar em filtros" ativado no formul\xE1rio. '),o()())}function Ie(r,t){if(r&1){let e=y();a(0,"div",13)(1,"div",14)(2,"div",15)(3,"h3",16),s(4,"Filtros Avan\xE7ados"),o(),a(5,"button",17),x("click",function(){_(e);let i=c();return g(i.toggleAdvancedFilters())}),u(6,"i",12),o()(),a(7,"div",18)(8,"label",19)(9,"input",20),M("ngModelChange",function(i){_(e);let d=c();return C(d.filterOnlyMine,i)||(d.filterOnlyMine=i),g(i)}),x("ngModelChange",function(){_(e);let i=c();return g(i.toggleOnlyMine())}),o(),a(10,"span",21),s(11,"Mostrar apenas meus registros"),o()()(),p(12,Fe,4,1,"div",22)(13,Se,6,0,"div",23),a(14,"div",24)(15,"button",25),x("click",function(){_(e);let i=c();return g(i.clearFilters())}),s(16," Limpar "),o(),a(17,"button",26),x("click",function(){_(e);let i=c();return g(i.toggleAdvancedFilters())}),s(18," Aplicar "),o()()()()}if(r&2){let e=c();l(9),A("ngModel",e.filterOnlyMine),l(3),m("ngIf",e.availableFilterFields.length>0),l(),m("ngIf",e.availableFilterFields.length===0)}}var W=class r{firestoreService=O(z);boardId="";ownerId="";columns=[];currentUser=null;filterQuery="";filterOnlyMine=!1;dynamicFilters={};showAdvancedFilters=!1;availableFilterFields=[];initialFormFields=[];phaseFormConfigs={};filterQueryChange=new R;filterOnlyMineChange=new R;dynamicFiltersChange=new R;showAdvancedFiltersChange=new R;filtersApplied=new R;ngOnInit(){return F(this,null,function*(){this.boardId&&this.ownerId&&(yield this.loadInitialFormFields(),yield this.loadAllPhaseFormConfigs(),this.loadAvailableFilterFields())})}loadInitialFormFields(){return F(this,null,function*(){if(this.boardId)try{let t=yield this.firestoreService.getInitialFormConfig(this.boardId);t&&t.fields?(this.initialFormFields=t.fields||[],console.log("\u{1F4CB} [AdvancedFilters] Campos do formul\xE1rio carregados:",this.initialFormFields)):this.initialFormFields=[]}catch{console.log("\u2139\uFE0F [AdvancedFilters] Nenhuma configura\xE7\xE3o de formul\xE1rio encontrada"),this.initialFormFields=[]}})}loadAllPhaseFormConfigs(){return F(this,null,function*(){for(let t of this.columns)try{let e=yield this.firestoreService.getPhaseFormConfig(this.ownerId,this.boardId,t.id);e?.fields&&(this.phaseFormConfigs[t.id]=e)}catch{}this.loadAvailableFilterFields()})}migrateFieldsToIncludeShowInFilters(){if(console.log("\u{1F527} [AdvancedFilters] Migrando campos para incluir showInFilters..."),this.initialFormFields){let t=!1;this.initialFormFields.forEach(e=>{"showInFilters"in e?console.log(`\u2705 [AdvancedFilters] Campo ${e.name} j\xE1 tem showInFilters: ${e.showInFilters}`):(e.showInFilters=!1,t=!0,console.log(`\u{1F527} [AdvancedFilters] Adicionado showInFilters: false ao campo ${e.name} (campo antigo)`))}),console.log(t?"\u{1F527} [AdvancedFilters] Alguns campos do formul\xE1rio inicial foram migrados em mem\xF3ria":"\u2705 [AdvancedFilters] Todos os campos do formul\xE1rio inicial j\xE1 t\xEAm showInFilters")}Object.entries(this.phaseFormConfigs||{}).forEach(([t,e])=>{if(e?.fields){let n=!1;e.fields.forEach(i=>{"showInFilters"in i?console.log(`\u2705 [AdvancedFilters] Campo ${i.name} da fase ${t} j\xE1 tem showInFilters: ${i.showInFilters}`):(i.showInFilters=!1,n=!0,console.log(`\u{1F527} [AdvancedFilters] Adicionado showInFilters: false ao campo ${i.name} da fase ${t} (campo antigo)`))}),console.log(n?`\u{1F527} [AdvancedFilters] Alguns campos da fase ${t} foram migrados em mem\xF3ria`:`\u2705 [AdvancedFilters] Todos os campos da fase ${t} j\xE1 t\xEAm showInFilters`)}})}loadAvailableFilterFields(){console.log("\u{1F50D} [AdvancedFilters] loadAvailableFilterFields INICIADO"),console.log("\u{1F50D} [AdvancedFilters] initialFormFields:",this.initialFormFields),console.log("\u{1F50D} [AdvancedFilters] phaseFormConfigs:",this.phaseFormConfigs),this.migrateFieldsToIncludeShowInFilters();let t=[];this.initialFormFields?(console.log("\u{1F50D} [AdvancedFilters] Processando campos do formul\xE1rio inicial..."),this.initialFormFields.forEach((e,n)=>{if(console.log(`\u{1F50D} [AdvancedFilters] Campo inicial ${n+1}:`,e),console.log(`\u{1F50D} [AdvancedFilters] Campo inicial ${n+1} - Detalhes:`,{name:e.name,type:e.type,showInFilters:e.showInFilters,hasShowInFilters:"showInFilters"in e,keys:Object.keys(e)}),e.name&&e.type&&e.showInFilters){let i={name:e.name,label:e.label||e.name,type:e.type,source:"initial"};t.push(i),console.log("\u2705 [AdvancedFilters] Campo adicionado aos filtros:",i)}else console.log("\u274C [AdvancedFilters] Campo N\xC3O adicionado aos filtros (falta name, type ou showInFilters = false)")})):console.log("\u26A0\uFE0F [AdvancedFilters] Nenhum initialFormFields encontrado"),console.log("\u{1F50D} [AdvancedFilters] Processando campos das fases..."),Object.entries(this.phaseFormConfigs||{}).forEach(([e,n])=>{console.log(`\u{1F50D} [AdvancedFilters] Fase ${e}:`,n),n?.fields&&n.fields.forEach((i,d)=>{if(console.log(`\u{1F50D} [AdvancedFilters] Campo da fase ${e} - ${d+1}:`,i),console.log(`\u{1F50D} [AdvancedFilters] Campo da fase ${e} - ${d+1} - Detalhes:`,{name:i.name,type:i.type,showInFilters:i.showInFilters,hasShowInFilters:"showInFilters"in i,keys:Object.keys(i)}),i.name&&i.type&&i.showInFilters&&!t.find(f=>f.name===i.name)){let f={name:i.name,label:i.label||i.name,type:i.type,source:"phase",phaseId:e};t.push(f),console.log("\u2705 [AdvancedFilters] Campo da fase adicionado aos filtros:",f)}else console.log("\u274C [AdvancedFilters] Campo da fase N\xC3O adicionado (falta name, type, showInFilters = false, ou j\xE1 existe)")})}),console.log("\u{1F50D} [AdvancedFilters] Todos os campos coletados:",t),this.availableFilterFields=t.filter(e=>{let i=["text","email","select","radio","checkbox","date","number","tel","cnpj","cpf","temperatura"].includes(e.type.toLowerCase());return console.log(`\u{1F50D} [AdvancedFilters] Campo ${e.name} (${e.type}) - Suportado: ${i}`),i}),console.log("\u{1F50D} [AdvancedFilters] Campos filtrados finais (availableFilterFields):",this.availableFilterFields),console.log("\u{1F50D} [AdvancedFilters] availableFilterFields.length:",this.availableFilterFields.length),console.log("\u{1F50D} [AdvancedFilters] showAdvancedFilters:",this.showAdvancedFilters)}getFieldOptions(t){if(t.type==="select"||t.type==="radio"){let e=this.findOriginalField(t.name,t.source);if(e&&e.options&&Array.isArray(e.options))return e.options}return t.type==="temperatura"?["Quente","Morno","Frio"]:[]}findOriginalField(t,e){if(e==="initial")return this.initialFormFields?.find(n=>n.name===t);if(e==="phase")for(let n of Object.values(this.phaseFormConfigs)){let i=n?.fields?.find(d=>d.name===t);if(i)return i}return null}onFilterQueryChange(t){this.filterQuery=t,this.filterQueryChange.emit(t),this.filtersApplied.emit()}toggleOnlyMine(){this.filterOnlyMine=!this.filterOnlyMine,this.filterOnlyMineChange.emit(this.filterOnlyMine),this.filtersApplied.emit()}toggleAdvancedFilters(){this.showAdvancedFilters=!this.showAdvancedFilters,this.showAdvancedFiltersChange.emit(this.showAdvancedFilters)}setDynamicFilter(t,e){e===""||e===null||e===void 0?delete this.dynamicFilters[t]:this.dynamicFilters[t]=e,this.dynamicFiltersChange.emit(this.dynamicFilters),this.filtersApplied.emit()}clearFilters(){this.filterQuery="",this.filterOnlyMine=!1,this.dynamicFilters={},this.filterQueryChange.emit(this.filterQuery),this.filterOnlyMineChange.emit(this.filterOnlyMine),this.dynamicFiltersChange.emit(this.dynamicFilters),this.filtersApplied.emit()}hasActiveFilters(){return this.filterQuery.length>0||this.filterOnlyMine||Object.keys(this.dynamicFilters).length>0}getDynamicFilterCount(){return Object.keys(this.dynamicFilters).length}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-advanced-filters"]],inputs:{boardId:"boardId",ownerId:"ownerId",columns:"columns",currentUser:"currentUser",filterQuery:"filterQuery",filterOnlyMine:"filterOnlyMine",dynamicFilters:"dynamicFilters",showAdvancedFilters:"showAdvancedFilters"},outputs:{filterQueryChange:"filterQueryChange",filterOnlyMineChange:"filterOnlyMineChange",dynamicFiltersChange:"dynamicFiltersChange",showAdvancedFiltersChange:"showAdvancedFiltersChange",filtersApplied:"filtersApplied"},decls:10,vars:8,consts:[[1,"mb-4"],[1,"flex","items-center","space-x-2"],[1,"relative","flex-1"],["type","text","placeholder","Pesquisar...",1,"w-full","pl-10","pr-12","py-2","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"ngModelChange","ngModel"],[1,"fas","fa-search","absolute","left-3","top-1/2","transform","-translate-y-1/2","text-gray-400"],[1,"absolute","right-2","top-1/2","transform","-translate-y-1/2","p-1.5","hover:bg-gray-100","rounded","transition-colors",3,"click"],[1,"fas","fa-filter","text-sm"],["class","absolute -top-1 -right-1 bg-blue-500 text-white text-xs rounded-full w-4 h-4 flex items-center justify-center","style","font-size: 10px;",4,"ngIf"],["class","px-3 py-2 bg-red-100 hover:bg-red-200 text-red-700 border border-red-300 rounded-lg transition-colors",3,"click",4,"ngIf"],["class","fixed top-20 left-4 w-full max-w-lg bg-white rounded-xl shadow-xl border border-gray-200 z-[9999]",4,"ngIf"],[1,"absolute","-top-1","-right-1","bg-blue-500","text-white","text-xs","rounded-full","w-4","h-4","flex","items-center","justify-center",2,"font-size","10px"],[1,"px-3","py-2","bg-red-100","hover:bg-red-200","text-red-700","border","border-red-300","rounded-lg","transition-colors",3,"click"],[1,"fas","fa-times"],[1,"fixed","top-20","left-4","w-full","max-w-lg","bg-white","rounded-xl","shadow-xl","border","border-gray-200","z-[9999]"],[1,"p-6"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600",3,"click"],[1,"mb-6","p-3","bg-gray-50","rounded-lg"],[1,"flex","items-center","space-x-2","cursor-pointer"],["type","checkbox",1,"rounded","border-gray-300","text-blue-600","focus:ring-blue-500",3,"ngModelChange","ngModel"],[1,"text-sm","text-gray-700","font-medium"],["class","space-y-4",4,"ngIf"],["class","text-center py-6",4,"ngIf"],[1,"flex","justify-end","space-x-3","mt-6","pt-4","border-t","border-gray-200"],[1,"px-4","py-2","text-gray-600","bg-gray-100","hover:bg-gray-200","rounded-lg","transition-colors",3,"click"],[1,"px-4","py-2","bg-blue-600","hover:bg-blue-700","text-white","rounded-lg","transition-colors",3,"click"],[1,"space-y-4"],[1,"text-sm","font-medium","text-gray-700","mb-3"],["class","space-y-2",4,"ngFor","ngForOf"],[1,"space-y-2"],[1,"block","text-sm","font-medium","text-gray-700"],["class","w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",3,"type","value","placeholder","input",4,"ngIf"],["type","date","class","w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",3,"value","input",4,"ngIf"],["class","w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent",3,"value","change",4,"ngIf"],["class","flex items-center space-x-2",4,"ngIf"],[1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"input","type","value","placeholder"],["type","date",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"input","value"],[1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-2","focus:ring-blue-500","focus:border-transparent",3,"change","value"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["value","Quente"],["value","Morno"],["value","Frio"],["type","checkbox",1,"rounded","border-gray-300","text-blue-600","focus:ring-blue-500",3,"change","checked"],[1,"text-sm","text-gray-700"],[1,"text-center","py-6"],[1,"fas","fa-filter","text-gray-300","text-3xl","mb-3"],[1,"text-gray-500","text-sm"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1)(2,"div",2)(3,"input",3),M("ngModelChange",function(d){return C(n.filterQuery,d)||(n.filterQuery=d),d}),x("ngModelChange",function(d){return n.onFilterQueryChange(d)}),o(),u(4,"i",4),a(5,"button",5),x("click",function(){return n.toggleAdvancedFilters()}),u(6,"i",6),p(7,ge,2,1,"span",7),o()(),p(8,fe,2,0,"button",8),o()(),p(9,Ie,19,3,"div",9)),e&2&&(l(3),A("ngModel",n.filterQuery),l(2),S("text-blue-600",n.showAdvancedFilters)("bg-blue-50",n.showAdvancedFilters),l(2),m("ngIf",n.hasActiveFilters()),l(),m("ngIf",n.hasActiveFilters()),l(),m("ngIf",n.showAdvancedFilters))},dependencies:[N,V,L,U,B,Q,ae,re,$,j],styles:[".advanced-filters-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;z-index:9998}.advanced-filters-modal[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:#fff;border-radius:12px;box-shadow:0 25px 50px -12px #00000040;z-index:9999;max-height:90vh;overflow-y:auto}.filter-badge[_ngcontent-%COMP%]{display:flex;height:1.25rem;width:1.25rem;align-items:center;justify-content:center;border-radius:9999px;--tw-bg-opacity: 1;background-color:rgb(59 130 246 / var(--tw-bg-opacity, 1));font-size:.75rem;line-height:1rem;--tw-text-opacity: 1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.search-input[_ngcontent-%COMP%]{width:100%;border-radius:.5rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1));padding:.5rem 1rem .5rem 2.5rem}.search-input[_ngcontent-%COMP%]:focus{border-color:transparent;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.search-input[_ngcontent-%COMP%]{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.2s}.filter-button[_ngcontent-%COMP%]{border-radius:.5rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1));padding:.5rem 1rem}.filter-button[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(229 231 235 / var(--tw-bg-opacity, 1))}.filter-button[_ngcontent-%COMP%]{display:flex;align-items:center}.filter-button[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not([hidden]) ~ [_ngcontent-%COMP%]:not([hidden]){--tw-space-x-reverse: 0;margin-right:calc(.5rem * var(--tw-space-x-reverse));margin-left:calc(.5rem * calc(1 - var(--tw-space-x-reverse)))}.filter-button[_ngcontent-%COMP%]{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.2s}.filter-button.active[_ngcontent-%COMP%]{--tw-border-opacity: 1;border-color:rgb(147 197 253 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.clear-button[_ngcontent-%COMP%]{border-radius:.5rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(252 165 165 / var(--tw-border-opacity, 1));--tw-bg-opacity: 1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1));padding:.5rem .75rem;--tw-text-opacity: 1;color:rgb(185 28 28 / var(--tw-text-opacity, 1))}.clear-button[_ngcontent-%COMP%]:hover{--tw-bg-opacity: 1;background-color:rgb(254 202 202 / var(--tw-bg-opacity, 1))}.clear-button[_ngcontent-%COMP%]{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.2s}.form-input[_ngcontent-%COMP%]{width:100%;border-radius:.375rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1));padding:.5rem .75rem}.form-input[_ngcontent-%COMP%]:focus{border-color:transparent;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.form-input[_ngcontent-%COMP%]{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.2s}.form-select[_ngcontent-%COMP%]{width:100%;border-radius:.375rem;border-width:1px;--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1));padding:.5rem .75rem}.form-select[_ngcontent-%COMP%]:focus{border-color:transparent;--tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow, 0 0 #0000);--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}.form-select[_ngcontent-%COMP%]{transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:.2s}.form-checkbox[_ngcontent-%COMP%]{border-radius:.25rem;--tw-border-opacity: 1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1));--tw-text-opacity: 1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.form-checkbox[_ngcontent-%COMP%]:focus{--tw-ring-opacity: 1;--tw-ring-color: rgb(59 130 246 / var(--tw-ring-opacity, 1))}"]})};var Ee=()=>({key:"overview",label:"Vis\xE3o Geral",icon:"fas fa-chart-pie"}),Oe=()=>({key:"sla",label:"Indicadores SLA",icon:"fas fa-clock"}),Ae=()=>({key:"phases",label:"M\xE9tricas por Fase",icon:"fas fa-columns"}),Me=()=>({key:"registros",label:"Lista de Registros",icon:"fas fa-list"}),Te=(r,t,e,n)=>[r,t,e,n];function Re(r,t){if(r&1){let e=y();a(0,"app-advanced-filters",12),M("filterQueryChange",function(i){_(e);let d=c(2);return C(d.filterQuery,i)||(d.filterQuery=i),g(i)})("filterOnlyMineChange",function(i){_(e);let d=c(2);return C(d.filterOnlyMine,i)||(d.filterOnlyMine=i),g(i)})("dynamicFiltersChange",function(i){_(e);let d=c(2);return C(d.dynamicFilters,i)||(d.dynamicFilters=i),g(i)})("showAdvancedFiltersChange",function(i){_(e);let d=c(2);return C(d.showAdvancedFilters,i)||(d.showAdvancedFilters=i),g(i)}),x("filtersApplied",function(){_(e);let i=c(2);return g(i.applyFilters())}),o()}if(r&2){let e=c(2);m("boardId",e.boardId)("ownerId",e.ownerId)("columns",e.columns)("currentUser",e.currentUser),A("filterQuery",e.filterQuery)("filterOnlyMine",e.filterOnlyMine)("dynamicFilters",e.dynamicFilters)("showAdvancedFilters",e.showAdvancedFilters)}}function De(r,t){if(r&1){let e=y();a(0,"button",13),x("click",function(){let i=_(e).$implicit,d=c(2);return g(d.setView(i.key))}),u(1,"i"),s(2),o()}if(r&2){let e=t.$implicit,n=c(2);S("border-blue-500",n.currentView===e.key)("text-blue-600",n.currentView===e.key)("border-transparent",n.currentView!==e.key)("text-gray-500",n.currentView!==e.key),l(),q(e.icon+" mr-2"),l(),h(" ",e.label," ")}}function ke(r,t){if(r&1&&(a(0,"div",14)(1,"div",15),u(2,"i",16),a(3,"p",17),s(4),o()()()),r&2){let e=c(2);l(4),v(e.isLoading?"Carregando dados...":"Gerando relat\xF3rio...")}}function Pe(r,t){if(r&1&&(a(0,"div",44)(1,"p",45),s(2," \u{1F50D} Debug: Nenhum dado de fase encontrado "),u(3,"br"),s(4),o()()),r&2){let e=c(4);l(4),J("Fases: ",e.columns.length," | Registros: ",e.filteredRecords.length," ")}}function Ve(r,t){if(r&1&&(a(0,"div",37)(1,"div",46)(2,"div",20),u(3,"div",47),a(4,"span",48),s(5),o()(),a(6,"span",49),s(7),o()(),a(8,"div",50),u(9,"div",51),o()()),r&2){let e=t.$implicit,n=c(4);l(3),w("background-color",e.color),l(2),v(e.name),l(2),v(e.value),l(2),w("background-color",e.color)("width",n.getPhasePercentage(e.value),"%")}}function Le(r,t){r&1&&(a(0,"div",55),u(1,"i",56),o())}function Ne(r,t){if(r&1&&(a(0,"div",52)(1,"div",53)(2,"span",48),s(3),o(),a(4,"span",49),s(5),o()(),p(6,Le,2,0,"div",54),o()),r&2){let e=t.$implicit,n=t.index,i=c(4);l(3),v(e.phase),l(2),v(e.registros),l(),m("ngIf",n<i.chartData.conversionFunnel.length-1)}}function $e(r,t){if(r&1&&(a(0,"option",57),s(1),o()),r&2){let e=t.$implicit,n=c(4);m("value",e),l(),h(" ",n.getFieldLabel(e)," ")}}function je(r,t){if(r&1&&(a(0,"div",37)(1,"div",46)(2,"div",20),u(3,"div",47),a(4,"span",48),s(5),o()(),a(6,"span",49),s(7),o()(),a(8,"div",50),u(9,"div",51),o()()),r&2){let e=t.$implicit,n=c(6);l(3),w("background-color",e.color),l(2),v(e.name),l(2),v(e.value),l(2),w("background-color",e.color)("width",n.getDynamicChartPercentage(e.value),"%")}}function Be(r,t){if(r&1&&(a(0,"div")(1,"div",59)(2,"span",60),s(3),o()(),a(4,"div",61),p(5,je,10,8,"div",36),o()()),r&2){let e=t.$implicit;l(3),J("",e.fieldLabel," (",e.total," registros)"),l(2),m("ngForOf",e.items)}}function Qe(r,t){if(r&1&&(a(0,"div",34),p(1,Be,6,3,"div",58),o()),r&2){let e=c(4);l(),m("ngForOf",e.chartData.dynamicCharts)}}function Ue(r,t){r&1&&(a(0,"div",44)(1,"p",45),s(2,"Nenhum dado dispon\xEDvel para o campo selecionado"),o()())}function ze(r,t){if(r&1){let e=y();a(0,"div")(1,"div",18)(2,"div",19)(3,"div",20)(4,"div",21),u(5,"i",22),o(),a(6,"div",23)(7,"p",24),s(8,"Total de Registros"),o(),a(9,"p",25),s(10),o()()()(),a(11,"div",19)(12,"div",20)(13,"div",21),u(14,"i",26),o(),a(15,"div",23)(16,"p",24),s(17,"Novos no Per\xEDodo"),o(),a(18,"p",25),s(19),o()()()(),a(20,"div",19)(21,"div",20)(22,"div",21),u(23,"i",27),o(),a(24,"div",23)(25,"p",24),s(26,"Conclu\xEDdos"),o(),a(27,"p",25),s(28),o()()()(),a(29,"div",19)(30,"div",20)(31,"div",21),u(32,"i",28),o(),a(33,"div",23)(34,"p",24),s(35,"Tempo M\xE9dio"),o(),a(36,"p",25),s(37),o()()()(),a(38,"div",19)(39,"div",20)(40,"div",21),u(41,"i",29),o(),a(42,"div",23)(43,"p",24),s(44,"Ativos"),o(),a(45,"p",25),s(46),o()()()(),a(47,"div",19)(48,"div",20)(49,"div",21),u(50,"i",30),o(),a(51,"div",23)(52,"p",24),s(53,"Em Atraso"),o(),a(54,"p",25),s(55),o()()()()(),a(56,"div",31)(57,"div",19)(58,"h3",32),u(59,"i",33),s(60," Registros por Fase "),o(),a(61,"div",34),p(62,Pe,5,2,"div",35)(63,Ve,10,8,"div",36),o()(),a(64,"div",19)(65,"h3",32),s(66,"Funil de Convers\xE3o"),o(),a(67,"div",37),p(68,Ne,7,3,"div",38),o()(),a(69,"div",19)(70,"div",39)(71,"h3",40),u(72,"i",33),s(73," Gr\xE1fico Din\xE2mico "),o(),a(74,"select",41),M("ngModelChange",function(i){_(e);let d=c(3);return C(d.selectedChartField,i)||(d.selectedChartField=i),g(i)}),x("change",function(){_(e);let i=c(3);return g(i.onChartFieldChange())}),p(75,$e,2,2,"option",42),o()(),p(76,Qe,2,1,"div",43)(77,Ue,3,0,"ng-template",null,0,ee),o()()()}if(r&2){let e=H(78),n=c(3);l(10),v(n.summaryStats.totalRecords),l(9),v(n.summaryStats.newRecordsThisPeriod),l(9),v(n.summaryStats.concludedRecords),l(9),v(n.formatDuration(n.summaryStats.avgConversionTime)),l(9),v(n.summaryStats.activeRecords),l(9),v(n.summaryStats.overdueRecords),l(7),m("ngIf",n.chartData.phaseDistribution.length===0),l(),m("ngForOf",n.chartData.phaseDistribution),l(5),m("ngForOf",n.chartData.conversionFunnel),l(6),A("ngModel",n.selectedChartField),l(),m("ngForOf",n.availableChartFields),l(),m("ngIf",n.chartData.dynamicCharts.length>0)("ngIfElse",e)}}function We(r,t){if(r&1&&(a(0,"tr")(1,"td",72)(2,"div",20),u(3,"div",73),a(4,"span",74),s(5),o()()(),a(6,"td",75),s(7),o(),a(8,"td",75),s(9),o(),a(10,"td",76)(11,"span",77),s(12),o()(),a(13,"td",76)(14,"span",78),s(15),o()(),a(16,"td",76)(17,"div",79)(18,"div",80),u(19,"div",81),o(),a(20,"span",74),s(21),o()()()()),r&2){let e=t.$implicit;l(3),w("background-color",e.phaseColor),l(2),v(e.phaseName),l(2),h(" ",e.slaDays," "),l(2),h(" ",e.totalRecords," "),l(3),h(" ",e.onTime," "),l(3),h(" ",e.overdue," "),l(4),w("width",e.compliance,"%"),S("bg-green-500",e.compliance>=80)("bg-yellow-500",e.compliance>=60&&e.compliance<80)("bg-red-500",e.compliance<60),l(2),h("",e.compliance,"%")}}function Ge(r,t){r&1&&(a(0,"div",82),u(1,"i",83),a(2,"p",84),s(3,"Nenhuma fase possui SLA configurado"),o()())}function qe(r,t){if(r&1&&(a(0,"div")(1,"div",62)(2,"div",63)(3,"h3",40),s(4,"Indicadores de SLA por Fase"),o(),a(5,"p",64),s(6,"An\xE1lise de cumprimento de prazos definidos para cada fase"),o()(),a(7,"div",65)(8,"table",66)(9,"thead",67)(10,"tr")(11,"th",68),s(12,"Fase"),o(),a(13,"th",69),s(14,"SLA (dias)"),o(),a(15,"th",69),s(16,"Total"),o(),a(17,"th",69),s(18,"No Prazo"),o(),a(19,"th",69),s(20,"Em Atraso"),o(),a(21,"th",69),s(22,"% Cumprimento"),o()()(),a(23,"tbody",70),p(24,We,22,16,"tr",58),o()()(),p(25,Ge,4,0,"div",71),o()()),r&2){let e=c(3);l(24),m("ngForOf",e.slaIndicators),l(),m("ngIf",e.slaIndicators.length===0)}}function Je(r,t){if(r&1&&(a(0,"div",19)(1,"div",39)(2,"h3",40),s(3),o(),u(4,"div",87),o(),a(5,"div",34)(6,"div",88)(7,"span",60),s(8,"Registros"),o(),a(9,"span",89),s(10),o()(),a(11,"div",88)(12,"span",60),s(13,"Tempo M\xE9dio"),o(),a(14,"span",89),s(15),o()(),a(16,"div",88)(17,"span",60),s(18,"Taxa de Convers\xE3o"),o(),a(19,"span",89),s(20),o()()()()),r&2){let e=t.$implicit,n=c(4);l(3),v(e.phaseName),l(),w("background-color",e.phaseColor),l(6),v(e.recordsCount),l(5),v(n.formatDuration(e.avgTimeInPhase)),l(5),h("",e.conversionRate,"%")}}function He(r,t){if(r&1&&(a(0,"div")(1,"div",85),p(2,Je,21,6,"div",86),o()()),r&2){let e=c(3);l(2),m("ngForOf",e.phaseMetrics)}}function Ye(r,t){if(r&1){let e=y();a(0,"label",109)(1,"input",110),x("change",function(){let i=_(e).$implicit,d=c(5);return g(d.toggleColumn(i.key))}),o(),a(2,"span",111),s(3),o()()}if(r&2){let e=t.$implicit,n=c(5);l(),m("checked",n.isColumnSelected(e.key)),l(2),v(e.label)}}function Ke(r,t){if(r&1){let e=y();a(0,"label",109)(1,"input",110),x("change",function(){let i=_(e).$implicit,d=c(6);return g(d.toggleColumn(i.key))}),o(),a(2,"span",111),s(3),o(),a(4,"span",113),s(5),o()()}if(r&2){let e=t.$implicit,n=c(6);l(),m("checked",n.isColumnSelected(e.key)),l(2),v(e.label),l(2),v(e.fieldType)}}function Xe(r,t){if(r&1&&(a(0,"div",112)(1,"h5",104),s(2,"Campos do Formul\xE1rio"),o(),a(3,"div",37),p(4,Ke,6,3,"label",105),o()()),r&2){let e=c(5);l(4),m("ngForOf",e.getFormColumns())}}function Ze(r,t){if(r&1){let e=y();a(0,"div",98)(1,"div",99)(2,"h4",100),s(3,"Selecionar Colunas"),o(),a(4,"p",101),s(5,"Escolha as colunas que deseja exibir na tabela"),o()(),a(6,"div",102)(7,"div",103)(8,"h5",104),s(9,"Colunas do Sistema"),o(),a(10,"div",37),p(11,Ye,4,2,"label",105),o()(),p(12,Xe,5,1,"div",106),o(),a(13,"div",107)(14,"button",108),x("click",function(){_(e);let i=c(4);return g(i.toggleColumnSelector())}),s(15," Aplicar "),o()()()}if(r&2){let e=c(4);l(11),m("ngForOf",e.getSystemColumns()),l(),m("ngIf",e.hasFormColumns())}}function et(r,t){if(r&1&&(a(0,"th",114),s(1),o()),r&2){let e=t.$implicit;l(),h(" ",e.label," ")}}function tt(r,t){if(r&1&&(a(0,"div",20),u(1,"div",47),a(2,"span",118),s(3),o()()),r&2){let e=c().$implicit,n=c().$implicit,i=c(4);l(),w("background-color",i.getColumnColor(n.columnId)),l(2),v(i.getColumnValue(n,e))}}function it(r,t){if(r&1&&(a(0,"div")(1,"span",119),s(2),o()()),r&2){let e=c().$implicit,n=c().$implicit,i=c(4);l(),S("bg-green-100",i.isLeadConcluded(n))("text-green-800",i.isLeadConcluded(n))("bg-red-100",i.isLeadOverdue(n)&&!i.isLeadConcluded(n))("text-red-800",i.isLeadOverdue(n)&&!i.isLeadConcluded(n))("bg-blue-100",!i.isLeadConcluded(n)&&!i.isLeadOverdue(n))("text-blue-800",!i.isLeadConcluded(n)&&!i.isLeadOverdue(n)),l(),h(" ",i.getColumnValue(n,e)," ")}}function nt(r,t){if(r&1&&(a(0,"div",118),s(1),o()),r&2){let e=c().$implicit,n=c().$implicit,i=c(4);l(),h(" ",i.getColumnValue(n,e)," ")}}function rt(r,t){if(r&1&&(a(0,"td",72),p(1,tt,4,3,"div",116)(2,it,3,13,"div",1)(3,nt,2,1,"div",117),o()),r&2){let e=t.$implicit;l(),m("ngIf",e.key==="currentPhase"),l(),m("ngIf",e.key==="status"),l(),m("ngIf",e.key!=="currentPhase"&&e.key!=="status")}}function at(r,t){if(r&1&&(a(0,"tr"),p(1,rt,4,3,"td",115),o()),r&2){let e=t.index,n=c(4);S("bg-gray-50",e%2===1),l(),m("ngForOf",n.getSelectedColumns())}}function ot(r,t){r&1&&(a(0,"div",82),u(1,"i",120),a(2,"p",84),s(3,"Nenhum registro encontrado com os filtros aplicados"),o()())}function lt(r,t){if(r&1){let e=y();a(0,"div")(1,"div",62)(2,"div",90)(3,"div",91)(4,"div")(5,"h3",40),s(6,"Lista Detalhada de Registros"),o(),a(7,"p",64),s(8),o()()(),a(9,"div",52)(10,"button",92),x("click",function(){_(e);let i=c(3);return g(i.toggleColumnSelector())}),u(11,"i",93),s(12),u(13,"i",94),o(),p(14,Ze,16,2,"div",95),o()(),a(15,"div",65)(16,"table",66)(17,"thead",67)(18,"tr"),p(19,et,2,1,"th",96),o()(),a(20,"tbody",70),p(21,at,2,3,"tr",97),o()()(),p(22,ot,4,0,"div",71),o()()}if(r&2){let e=c(3);l(8),h("",e.filteredRecords.length," registros encontrados"),l(4),h(" Colunas (",e.selectedColumns.length,") "),l(2),m("ngIf",e.showColumnSelector),l(5),m("ngForOf",e.getSelectedColumns()),l(2),m("ngForOf",e.filteredRecords),l(),m("ngIf",e.filteredRecords.length===0)}}function st(r,t){if(r&1&&(a(0,"div"),p(1,ze,79,13,"div",1)(2,qe,26,2,"div",1)(3,He,3,1,"div",1)(4,lt,23,6,"div",1),o()),r&2){let e=c(2);l(),m("ngIf",e.currentView==="overview"),l(),m("ngIf",e.currentView==="sla"),l(),m("ngIf",e.currentView==="phases"),l(),m("ngIf",e.currentView==="registros")}}function dt(r,t){if(r&1&&(a(0,"app-main-layout"),u(1,"app-company-breadcrumb",4),a(2,"div",5),p(3,Re,1,8,"app-advanced-filters",6),a(4,"div",7)(5,"div",8)(6,"nav",9),p(7,De,3,11,"button",10),o()()(),p(8,ke,5,1,"div",11)(9,st,5,4,"div",1),o()()),r&2){let e=c();l(),m("title","Relat\xF3rios - "+((e.board==null?null:e.board.name)||"Quadro")),l(2),m("ngIf",!e.isLoading&&e.boardId&&e.ownerId&&e.columns.length>0),l(4),m("ngForOf",K(9,Te,k(5,Ee),k(6,Oe),k(7,Ae),k(8,Me))),l(),m("ngIf",e.isLoading||e.isGeneratingReport),l(),m("ngIf",!e.isLoading&&!e.isGeneratingReport)}}function ct(r,t){if(r&1){let e=y();a(0,"app-advanced-filters",12),M("filterQueryChange",function(i){_(e);let d=c(2);return C(d.filterQuery,i)||(d.filterQuery=i),g(i)})("filterOnlyMineChange",function(i){_(e);let d=c(2);return C(d.filterOnlyMine,i)||(d.filterOnlyMine=i),g(i)})("dynamicFiltersChange",function(i){_(e);let d=c(2);return C(d.dynamicFilters,i)||(d.dynamicFilters=i),g(i)})("showAdvancedFiltersChange",function(i){_(e);let d=c(2);return C(d.showAdvancedFilters,i)||(d.showAdvancedFilters=i),g(i)}),x("filtersApplied",function(){_(e);let i=c(2);return g(i.applyFilters())}),o()}if(r&2){let e=c(2);m("boardId",e.boardId)("ownerId",e.ownerId)("columns",e.columns)("currentUser",e.currentUser),A("filterQuery",e.filterQuery)("filterOnlyMine",e.filterOnlyMine)("dynamicFilters",e.dynamicFilters)("showAdvancedFilters",e.showAdvancedFilters)}}function mt(r,t){if(r&1){let e=y();a(0,"button",127),x("click",function(){let i=_(e).$implicit,d=c(2);return g(d.setView(i.key))}),u(1,"i"),s(2),o()}if(r&2){let e=t.$implicit,n=c(2);S("border-blue-500",n.currentView===e.key)("text-blue-600",n.currentView===e.key)("border-transparent",n.currentView!==e.key)("text-gray-500",n.currentView!==e.key)("hover:text-gray-700",n.currentView!==e.key),l(),q(Y("fas ",e.icon," mr-2")),l(),h(" ",e.name," ")}}function pt(r,t){if(r&1&&(a(0,"div")(1,"div",128)(2,"div",129)(3,"div",46)(4,"div")(5,"p",130),s(6,"Total de Registros"),o(),a(7,"p",131),s(8),o()(),a(9,"div",132),u(10,"i",133),o()()(),a(11,"div",134)(12,"div",46)(13,"div")(14,"p",135),s(15,"Registros Conclu\xEDdos"),o(),a(16,"p",131),s(17),o()(),a(18,"div",136),u(19,"i",137),o()()(),a(20,"div",138)(21,"div",46)(22,"div")(23,"p",139),s(24,"Registros Atrasados"),o(),a(25,"p",131),s(26),o()(),a(27,"div",140),u(28,"i",141),o()()()()()),r&2){let e=c(2);l(8),v(e.summaryStats.totalRecords),l(9),v(e.summaryStats.concludedRecords),l(9),v(e.summaryStats.overdueRecords)}}function ut(r,t){if(r&1&&(a(0,"tr")(1,"td",72)(2,"div",20),u(3,"div",73),a(4,"span",74),s(5),o()()(),a(6,"td",75),s(7),o(),a(8,"td",76)(9,"span",143),s(10),o()(),a(11,"td",144),s(12),o(),a(13,"td",145),s(14),o()()),r&2){let e=t.$implicit;l(3),w("background-color",e.phaseColor),l(2),v(e.phaseName),l(2),h(" ",e.slaDays," "),l(2),S("bg-green-100",e.compliance>=80)("text-green-800",e.compliance>=80)("bg-yellow-100",e.compliance>=60&&e.compliance<80)("text-yellow-800",e.compliance>=60&&e.compliance<80)("bg-red-100",e.compliance<60)("text-red-800",e.compliance<60),l(),h(" ",e.compliance,"% "),l(2),h(" ",e.onTime," "),l(2),h(" ",e.overdue," ")}}function _t(r,t){if(r&1&&(a(0,"div")(1,"div",142)(2,"h3",32),s(3,"Indicadores de SLA por Fase"),o(),a(4,"div",65)(5,"table",66)(6,"thead",67)(7,"tr")(8,"th",68),s(9,"Fase"),o(),a(10,"th",69),s(11,"SLA (dias)"),o(),a(12,"th",69),s(13,"% Cumprimento"),o(),a(14,"th",69),s(15,"No Prazo"),o(),a(16,"th",69),s(17,"Atrasados"),o()()(),a(18,"tbody",70),p(19,ut,15,19,"tr",58),o()()()()()),r&2){let e=c(2);l(19),m("ngForOf",e.slaIndicators)}}function gt(r,t){if(r&1&&(a(0,"div",148)(1,"div",39)(2,"div",20),u(3,"div",149),a(4,"h3",40),s(5),o()(),a(6,"span",25),s(7),o()(),a(8,"div",150)(9,"div",151)(10,"p",60),s(11,"Tempo M\xE9dio na Fase"),o(),a(12,"p",152),s(13),o()(),a(14,"div",151)(15,"p",60),s(16,"Taxa de Convers\xE3o"),o(),a(17,"p",152),s(18),o()()()()),r&2){let e=t.$implicit,n=c(3);l(3),w("background-color",e.phaseColor),l(2),v(e.phaseName),l(2),h("",e.recordsCount," registros"),l(6),v(n.formatDuration(e.avgTimeInPhase)),l(5),h("",e.conversionRate,"%")}}function ft(r,t){if(r&1&&(a(0,"div")(1,"div",146),p(2,gt,19,6,"div",147),o()()),r&2){let e=c(2);l(2),m("ngForOf",e.phaseMetrics)}}function vt(r,t){if(r&1){let e=y();a(0,"label",109)(1,"input",110),x("change",function(){let i=_(e).$implicit,d=c(4);return g(d.toggleColumn(i.key))}),o(),a(2,"span",111),s(3),o()()}if(r&2){let e=t.$implicit,n=c(4);l(),m("checked",n.isColumnSelected(e.key)),l(2),v(e.label)}}function ht(r,t){if(r&1){let e=y();a(0,"label",109)(1,"input",110),x("change",function(){let i=_(e).$implicit,d=c(5);return g(d.toggleColumn(i.key))}),o(),a(2,"span",111),s(3),o(),a(4,"span",113),s(5),o()()}if(r&2){let e=t.$implicit,n=c(5);l(),m("checked",n.isColumnSelected(e.key)),l(2),v(e.label),l(2),v(e.fieldType)}}function xt(r,t){if(r&1&&(a(0,"div",112)(1,"h5",104),s(2,"Campos do Formul\xE1rio"),o(),a(3,"div",37),p(4,ht,6,3,"label",105),o()()),r&2){let e=c(4);l(4),m("ngForOf",e.getFormColumns())}}function yt(r,t){if(r&1){let e=y();a(0,"div",98)(1,"div",99)(2,"h4",100),s(3,"Selecionar Colunas"),o(),a(4,"p",101),s(5,"Escolha as colunas que deseja exibir na tabela"),o()(),a(6,"div",102)(7,"div",103)(8,"h5",104),s(9,"Colunas do Sistema"),o(),a(10,"div",37),p(11,vt,4,2,"label",105),o()(),p(12,xt,5,1,"div",106),o(),a(13,"div",107)(14,"button",108),x("click",function(){_(e);let i=c(3);return g(i.toggleColumnSelector())}),s(15," Aplicar "),o()()()}if(r&2){let e=c(3);l(11),m("ngForOf",e.getSystemColumns()),l(),m("ngIf",e.hasFormColumns())}}function bt(r,t){if(r&1&&(a(0,"th",114),s(1),o()),r&2){let e=t.$implicit;l(),h(" ",e.label," ")}}function Ct(r,t){if(r&1&&(a(0,"div",20),u(1,"div",47),a(2,"span",118),s(3),o()()),r&2){let e=c().$implicit,n=c().$implicit,i=c(3);l(),w("background-color",i.getColumnColor(n.columnId)),l(2),v(i.getColumnValue(n,e))}}function wt(r,t){if(r&1&&(a(0,"div")(1,"span",119),s(2),o()()),r&2){let e=c().$implicit,n=c().$implicit,i=c(3);l(),S("bg-green-100",i.isLeadConcluded(n))("text-green-800",i.isLeadConcluded(n))("bg-red-100",i.isLeadOverdue(n)&&!i.isLeadConcluded(n))("text-red-800",i.isLeadOverdue(n)&&!i.isLeadConcluded(n))("bg-blue-100",!i.isLeadConcluded(n)&&!i.isLeadOverdue(n))("text-blue-800",!i.isLeadConcluded(n)&&!i.isLeadOverdue(n)),l(),h(" ",i.getColumnValue(n,e)," ")}}function Ft(r,t){if(r&1&&(a(0,"div",118),s(1),o()),r&2){let e=c().$implicit,n=c().$implicit,i=c(3);l(),h(" ",i.getColumnValue(n,e)," ")}}function St(r,t){if(r&1&&(a(0,"td",72),p(1,Ct,4,3,"div",116)(2,wt,3,13,"div",1)(3,Ft,2,1,"div",117),o()),r&2){let e=t.$implicit;l(),m("ngIf",e.key==="currentPhase"),l(),m("ngIf",e.key==="status"),l(),m("ngIf",e.key!=="currentPhase"&&e.key!=="status")}}function It(r,t){if(r&1&&(a(0,"tr"),p(1,St,4,3,"td",115),o()),r&2){let e=c(3);l(),m("ngForOf",e.getSelectedColumns())}}function Et(r,t){if(r&1){let e=y();a(0,"div")(1,"div",142)(2,"div",153)(3,"div",91)(4,"h3",40),s(5),o()(),a(6,"div",154)(7,"button",155),x("click",function(){_(e);let i=c(2);return g(i.exportToExcel())}),u(8,"i",156),s(9," Exportar Excel "),o(),a(10,"div",52)(11,"button",92),x("click",function(){_(e);let i=c(2);return g(i.toggleColumnSelector())}),u(12,"i",93),s(13),u(14,"i",94),o(),p(15,yt,16,2,"div",95),o()()(),a(16,"div",65)(17,"table",66)(18,"thead",67)(19,"tr"),p(20,bt,2,1,"th",96),o()(),a(21,"tbody",70),p(22,It,2,1,"tr",58),X(23,"slice"),o()()()()()}if(r&2){let e=c(2);l(5),h("Lista de Registros (",e.filteredRecords.length,")"),l(8),h(" Colunas (",e.selectedColumns.length,") "),l(2),m("ngIf",e.showColumnSelector),l(5),m("ngForOf",e.getSelectedColumns()),l(2),m("ngForOf",Z(23,5,e.filteredRecords,0,50))}}function Ot(r,t){if(r&1&&(a(0,"div",121)(1,"div",122)(2,"div",123)(3,"h2",25),u(4,"i",33),s(5),o()(),p(6,ct,1,8,"app-advanced-filters",6),a(7,"div",7)(8,"div",8)(9,"nav",124),p(10,mt,3,14,"button",125),o()(),a(11,"div",126),p(12,pt,29,3,"div",1)(13,_t,20,1,"div",1)(14,ft,3,1,"div",1)(15,Et,24,9,"div",1),o()()()()),r&2){let e=c();l(5),h(" Relat\xF3rios - ",e.board==null?null:e.board.name," "),l(),m("ngIf",!e.isLoading&&e.boardId&&e.ownerId&&e.columns.length>0),l(4),m("ngForOf",e.viewTabs),l(2),m("ngIf",e.currentView==="overview"),l(),m("ngIf",e.currentView==="sla"),l(),m("ngIf",e.currentView==="phases"),l(),m("ngIf",e.currentView==="registros")}}function At(r,t){if(r&1&&(a(0,"p",60),s(1),o()),r&2){let e=c().$implicit;l(),v(e.description)}}function Mt(r,t){if(r&1){let e=y();a(0,"div",166),x("click",function(){let i=_(e).$implicit,d=c(2);return g(d.selectBoard(i.id))}),a(1,"div",46)(2,"div")(3,"h3",167),s(4),o(),p(5,At,2,1,"p",168),o(),u(6,"i",169),o()()}if(r&2){let e=t.$implicit;l(4),v(e.name),l(),m("ngIf",e.description)}}function Tt(r,t){if(r&1){let e=y();a(0,"div",170)(1,"p",84),s(2,"Nenhum quadro encontrado"),o(),a(3,"button",171),x("click",function(){_(e);let i=c(2);return g(i.goBack())}),s(4," Voltar ao Dashboard "),o()()}}function Rt(r,t){if(r&1&&(a(0,"div",157)(1,"div",158)(2,"div",159)(3,"div",160)(4,"div",161),u(5,"i",162),o(),a(6,"h2",163),s(7,"Relat\xF3rios"),o(),a(8,"p",17),s(9,"Selecione um quadro para visualizar seus relat\xF3rios"),o()(),a(10,"div",61),p(11,Mt,7,2,"div",164)(12,Tt,5,0,"div",165),o()()()()),r&2){let e=c();l(11),m("ngForOf",e.availableBoards),l(),m("ngIf",e.availableBoards.length===0)}}var ce=class r{authService=O(le);firestoreService=O(z);router=O(ne);route=O(ie);boardId="";ownerId="";currentUser=null;board=null;availableBoards=[];records=[];columns=[];users=[];filterQuery="";filterOnlyMine=!1;dynamicFilters={};showAdvancedFilters=!1;isLoading=!1;isGeneratingReport=!1;filteredRecords=[];slaIndicators=[];phaseMetrics=[];summaryStats={totalRecords:0,newRecordsThisPeriod:0,concludedRecords:0,avgConversionTime:0,activeRecords:0,overdueRecords:0};chartData={phaseDistribution:[],registrosOverTime:[],conversionFunnel:[],dynamicCharts:[]};availableChartFields=[];selectedChartField="";chartType="bar";currentView="overview";exportFormats=["PDF","Excel","CSV"];availableColumns=[];selectedColumns=[];showColumnSelector=!1;viewTabs=[{key:"overview",name:"Vis\xE3o Geral",icon:"fa-chart-pie"},{key:"sla",name:"SLA",icon:"fa-clock"},{key:"phases",name:"Fases",icon:"fa-columns"},{key:"registros",name:"Registros",icon:"fa-users"}];ngOnInit(){return F(this,null,function*(){this.currentUser=this.authService.getCurrentUser(),this.ownerId||(this.ownerId=this.currentUser?.uid||""),this.boardId||this.route.queryParams.subscribe(t=>{t.boardId&&(this.boardId=t.boardId)}),yield this.loadAvailableBoards(),this.boardId&&this.ownerId&&(yield this.loadData(),this.initializeColumns(),this.generateReport())})}ngOnDestroy(){}loadAvailableBoards(){return F(this,null,function*(){if(this.ownerId)try{this.availableBoards=yield this.firestoreService.getBoards(this.ownerId)}catch(t){console.error("Erro ao carregar boards dispon\xEDveis:",t)}})}selectBoard(t){return F(this,null,function*(){this.boardId=t,yield this.loadData(),this.initializeColumns(),this.generateReport()})}loadData(){return F(this,null,function*(){this.isLoading=!0;try{let t=yield this.firestoreService.getBoards(this.ownerId);this.board=t.find(i=>i.id===this.boardId)||null;let[e,n]=yield Promise.all([this.firestoreService.getLeads(this.ownerId,this.boardId),this.firestoreService.getColumns(this.ownerId,this.boardId)]);this.records=e,this.columns=n,this.users=[],console.log("Dados carregados:",{boardId:this.boardId,recordsCount:e.length,columnsCount:n.length,formFieldsCount:this.board?.initialFormFields?.length||0,registros:e.slice(0,3)}),e.length>0&&e[0].fields&&console.log("\u{1F4CB} Campos dispon\xEDveis no primeiro registro:",Object.keys(e[0].fields))}catch(t){console.error("Erro ao carregar dados do relat\xF3rio:",t)}finally{this.isLoading=!1}})}generateReport(){if(!this.isGeneratingReport){this.isGeneratingReport=!0;try{this.applyFilters(),this.calculateSummaryStats(),this.calculateSLAIndicators(),this.calculatePhaseMetrics(),this.generateChartData()}finally{this.isGeneratingReport=!1}}}getLeadDate(t){return t.createdAt?.toDate?t.createdAt.toDate():t.createdAt?.seconds?new Date(t.createdAt.seconds*1e3):t.createdAt?new Date(t.createdAt):new Date}isLeadOverdue(t){let e=this.columns.find(d=>d.id===t.columnId);if(!e?.slaDays)return!1;let n=t.movedToCurrentColumnAt?.toDate?t.movedToCurrentColumnAt.toDate():t.movedToCurrentColumnAt?.seconds?new Date(t.movedToCurrentColumnAt.seconds*1e3):new Date(t.movedToCurrentColumnAt||t.createdAt);return(Date.now()-n.getTime())/(1e3*60*60*24)>e.slaDays}isLeadConcluded(t){let e=this.columns.find(n=>n.id===t.columnId);return!!(e?.endStageType&&e.endStageType!=="none")}calculateSummaryStats(){let t=this.dynamicFilters.startDate?new Date(this.dynamicFilters.startDate):null,e=this.dynamicFilters.endDate?new Date(this.dynamicFilters.endDate):null;this.summaryStats={totalRecords:this.filteredRecords.length,newRecordsThisPeriod:t&&e?this.filteredRecords.filter(n=>{let i=this.getLeadDate(n);return i>=t&&i<=e}).length:this.filteredRecords.length,concludedRecords:this.filteredRecords.filter(n=>this.isLeadConcluded(n)).length,avgConversionTime:this.calculateAverageConversionTime(),activeRecords:this.filteredRecords.filter(n=>!this.isLeadConcluded(n)).length,overdueRecords:this.filteredRecords.filter(n=>this.isLeadOverdue(n)&&!this.isLeadConcluded(n)).length}}calculateAverageConversionTime(){let t=this.filteredRecords.filter(n=>this.isLeadConcluded(n));if(t.length===0)return 0;let e=t.reduce((n,i)=>{let d=this.getLeadDate(i),f=i.movedToCurrentColumnAt?.toDate?i.movedToCurrentColumnAt.toDate():new Date;return n+(f.getTime()-d.getTime())},0);return Math.round(e/t.length/(1e3*60*60*24))}calculateSLAIndicators(){this.slaIndicators=this.columns.filter(t=>t.slaDays&&t.slaDays>0).map(t=>{let e=this.filteredRecords.filter(d=>d.columnId===t.id),n=e.filter(d=>this.isLeadOverdue(d)),i=e.length-n.length;return{phaseId:t.id,phaseName:t.name,phaseColor:t.color,slaDays:t.slaDays,totalRecords:e.length,onTime:i,overdue:n.length,compliance:e.length>0?Math.round(i/e.length*100):100}})}calculatePhaseMetrics(){this.phaseMetrics=this.columns.map(t=>{let e=this.filteredRecords.filter(d=>d.columnId===t.id),n=this.calculateAverageTimeInPhase(e),i=this.calculatePhaseConversionRate(t);return{phaseId:t.id,phaseName:t.name,phaseColor:t.color,recordsCount:e.length,avgTimeInPhase:n,conversionRate:i}})}calculateAverageTimeInPhase(t){if(t.length===0)return 0;let e=t.reduce((n,i)=>{let d=i.phaseHistory||{},f=Object.values(d).find(b=>b.phaseId===i.columnId);if(f?.duration)return n+f.duration;if(f?.enteredAt){let b=f.enteredAt.toDate?f.enteredAt.toDate():new Date(f.enteredAt);return n+(Date.now()-b.getTime())}return n},0);return Math.round(e/t.length/(1e3*60*60*24))}calculatePhaseConversionRate(t){let e=this.columns.findIndex(b=>b.id===t.id);if(e===this.columns.length-1)return 0;let n=this.filteredRecords.filter(b=>b.columnId===t.id).length,i=this.columns.slice(e+1),d=this.filteredRecords.filter(b=>i.some(T=>T.id===b.columnId)).length,f=n+d;return f>0?Math.round(d/f*100):0}generateChartData(){this.chartData.phaseDistribution=this.phaseMetrics.map(t=>({name:t.phaseName,value:t.recordsCount,color:t.phaseColor})),console.log("\u{1F4CA} Chart Data Generated:",{phaseMetrics:this.phaseMetrics,phaseDistribution:this.chartData.phaseDistribution,columnsCount:this.columns.length,recordsCount:this.filteredRecords.length}),this.chartData.registrosOverTime=this.generateLeadsOverTimeData(),this.chartData.conversionFunnel=this.phaseMetrics.map((t,e)=>({phase:t.phaseName,registros:t.recordsCount,order:e})),this.generateDynamicCharts()}generateLeadsOverTimeData(){let t=this.dynamicFilters.startDate?new Date(this.dynamicFilters.startDate):new Date(new Date().setMonth(new Date().getMonth()-6)),e=this.dynamicFilters.endDate?new Date(this.dynamicFilters.endDate):new Date,n=[],i=new Date(t);for(;i<=e;){let d=new Date(i);d.setDate(d.getDate()+6);let f=this.filteredRecords.filter(b=>{let T=this.getLeadDate(b);return T>=i&&T<=d}).length;n.push({period:`${i.getDate()}/${i.getMonth()+1}`,registros:f}),i.setDate(i.getDate()+7)}return n}setView(t){this.currentView=t}isStandaloneView(){return!!this.route.snapshot.queryParams.boardId&&!this.boardIdFromInput}get boardIdFromInput(){return this.boardId!==""&&!this.route.snapshot.queryParams.boardId}exportReport(t){return F(this,null,function*(){try{console.log(`Exportando relat\xF3rio em formato ${t}`),alert(`Exporta\xE7\xE3o em ${t} ser\xE1 implementada em breve!`)}catch(e){console.error("Erro ao exportar relat\xF3rio:",e),alert("Erro ao exportar relat\xF3rio. Tente novamente.")}})}formatDate(t){return t?(t.toDate?t.toDate():new Date(t)).toLocaleDateString("pt-BR"):"-"}formatDuration(t){return t===0?"-":t===1?"1 dia":`${t} dias`}getResponsibleName(t){let e=this.users.find(n=>n.uid===t);return e?.displayName||e?.email||"N\xE3o atribu\xEDdo"}getColumnName(t){return this.columns.find(n=>n.id===t)?.name||"Fase desconhecida"}getColumnColor(t){return this.columns.find(n=>n.id===t)?.color||"#6B7280"}goBack(){this.route.snapshot.queryParams.boardId?this.router.navigate(["/kanban",this.boardId],{queryParams:{ownerId:this.ownerId}}):this.router.navigate(["/dashboard"])}getChartBarHeight(t){if(this.chartData.registrosOverTime.length===0)return 0;let e=Math.max(...this.chartData.registrosOverTime.map(n=>n.registros));return e>0?t/e*100:0}getPhasePercentage(t){if(!this.chartData.phaseDistribution.length)return 0;let e=Math.max(...this.chartData.phaseDistribution.map(n=>n.value));return e>0?t/e*100:0}initializeColumns(){this.initializeAvailableColumns(),this.loadSelectedColumns()}initializeAvailableColumns(){this.availableColumns=[];let t=[{key:"currentPhase",label:"Fase Atual",type:"system",field:"columnId"},{key:"createdAt",label:"Criado em",type:"system",field:"createdAt"},{key:"status",label:"Status",type:"system",field:"status"},{key:"responsibleUser",label:"Respons\xE1vel",type:"system",field:"responsibleUserEmail"}];this.availableColumns.push(...t);let e=this.board?.initialFormFields||[];console.log("\u{1F50D} Campos do formul\xE1rio para colunas:",e),[{name:"contactName",label:"Nome do Contato",type:"text"},{name:"contactEmail",label:"Email do Contato",type:"email"},{name:"contactPhone",label:"Telefone do Contato",type:"tel"},{name:"companyName",label:"Nome da Empresa",type:"text"},{name:"cnpj",label:"CNPJ",type:"text"}].forEach(i=>{this.availableColumns.push({key:i.name,label:i.label,type:"form",field:`fields.${i.name}`,fieldType:i.type})}),e.forEach(i=>{if(i.name&&i.label){let d=this.availableColumns.find(f=>f.key===i.name);d?(d.label=i.label||d.label,d.fieldType=i.type||d.fieldType):this.availableColumns.push({key:i.name,label:i.label||i.name,type:"form",field:`fields.${i.name}`,fieldType:i.type||"text"})}}),console.log("\u{1F4CA} Colunas dispon\xEDveis inicializadas:",this.availableColumns)}loadSelectedColumns(){if(this.boardId)try{let t=localStorage.getItem(`report-columns-${this.boardId}`);t?this.selectedColumns=JSON.parse(t):this.selectedColumns=["contactName","contactEmail","companyName","currentPhase","createdAt","status"]}catch(t){console.warn("Could not load selected columns from localStorage:",t),this.selectedColumns=["contactName","contactEmail","companyName","currentPhase","createdAt","status"]}}saveSelectedColumns(){if(this.boardId)try{localStorage.setItem(`report-columns-${this.boardId}`,JSON.stringify(this.selectedColumns))}catch(t){console.warn("Could not save selected columns to localStorage:",t)}}toggleColumnSelector(){this.showColumnSelector=!this.showColumnSelector}isColumnSelected(t){return this.selectedColumns.includes(t)}toggleColumn(t){this.isColumnSelected(t)?this.selectedColumns=this.selectedColumns.filter(e=>e!==t):this.selectedColumns.push(t),this.saveSelectedColumns()}getSelectedColumns(){return this.availableColumns.filter(t=>this.selectedColumns.includes(t.key))}getColumnValue(t,e){switch(e.key){case"currentPhase":return this.getColumnName(t.columnId);case"createdAt":return this.formatDate(t.createdAt);case"status":return this.isLeadConcluded(t)?"Conclu\xEDdo":this.isLeadOverdue(t)?"Em Atraso":"Ativo";case"responsibleUser":return t.responsibleUserName||t.responsibleUserEmail||"N\xE3o atribu\xEDdo";case"contactName":return this.readFieldValue(t,"contactName");case"contactEmail":return this.readFieldValue(t,"contactEmail");case"contactPhone":return this.readFieldValue(t,"contactPhone");case"companyName":return this.readFieldValue(t,"companyName");case"cnpj":return this.readFieldValue(t,"cnpj");default:let n=t.fields?.[e.key];if(n!=null&&n!=="")return String(n);let i=this.getNestedProperty(t,e.field);return i?String(i):"-"}}readFieldValue(t,e){if(!t.fields)return"-";let i={companyName:["companyName","empresa","nomeEmpresa","nameCompany","company","company_name","empresa_nome","nameComapny"],contactName:["contactName","name","nome","nomeLead","nameLead","leadName"],contactEmail:["contactEmail","email","emailLead","contatoEmail","leadEmail"],contactPhone:["contactPhone","phone","telefone","celular","phoneLead","telefoneContato"],cnpj:["cnpj","cnpjCompany","cnpjEmpresa","companyCnpj"]}[e]||[e];for(let d of i){let f=t.fields[d];if(f!=null&&String(f).trim()!=="")return String(f)}return"-"}getNestedProperty(t,e){return e.split(".").reduce((n,i)=>n&&n[i]!==void 0?n[i]:null,t)}getSystemColumns(){return this.availableColumns.filter(t=>t.type==="system")}getFormColumns(){return this.availableColumns.filter(t=>t.type==="form")}hasFormColumns(){return this.availableColumns.filter(t=>t.type==="form").length>0}debugLeadStructure(){if(this.records.length===0){alert("Nenhum registro dispon\xEDvel para debug");return}let t=this.records[0];console.log("\u{1F41B} DEBUG COMPLETO DO LEAD:"),console.log("\u{1F41B} Lead completo:",t),console.log("\u{1F41B} Lead.fields:",t.fields),console.log("\u{1F41B} Chaves dos fields:",t.fields?Object.keys(t.fields):"sem fields"),console.log("\u{1F41B} Valores dos fields:",t.fields?Object.entries(t.fields):"sem entries"),console.log("\u{1F41B} TESTANDO CAMPOS PROBLEM\xC1TICOS:"),console.log("\u{1F41B} contactName tentativas:",[t.fields?.contactName,t.fields?.name,t.fields?.nome]),console.log("\u{1F41B} contactEmail tentativas:",[t.fields?.contactEmail,t.fields?.email]),console.log("\u{1F41B} RESULTADO DOS M\xC9TODOS:"),console.log("\u{1F41B} readFieldValue(contactName):",this.readFieldValue(t,"contactName")),console.log("\u{1F41B} readFieldValue(contactEmail):",this.readFieldValue(t,"contactEmail")),console.log("\u{1F41B} readFieldValue(companyName):",this.readFieldValue(t,"companyName"));let e={leadId:t.id,fieldsKeys:t.fields?Object.keys(t.fields):"no fields",contactNameResult:this.readFieldValue(t,"contactName"),contactEmailResult:this.readFieldValue(t,"contactEmail"),companyNameResult:this.readFieldValue(t,"companyName"),allFields:t.fields};alert(`DEBUG INFO (veja console para detalhes):
`+JSON.stringify(e,null,2))}applyFilters(){console.log("=== APLICANDO FILTROS KANBAN-STYLE ==="),console.log("filterQuery:",this.filterQuery),console.log("filterOnlyMine:",this.filterOnlyMine),console.log("dynamicFilters:",this.dynamicFilters),console.log("Total de registros dispon\xEDveis:",this.records.length),this.filteredRecords=this.records.filter(t=>{if(this.filterQuery&&this.filterQuery.trim()){let e=this.filterQuery.toLowerCase();if(![this.readFieldValue(t,"contactName"),this.readFieldValue(t,"contactEmail"),this.readFieldValue(t,"companyName"),this.readFieldValue(t,"contactPhone"),this.getColumnName(t.columnId)].some(d=>d.toLowerCase().includes(e)))return!1}if(this.filterOnlyMine&&t.responsibleUserId!==this.currentUser?.uid)return!1;for(let[e,n]of Object.entries(this.dynamicFilters))if(n&&typeof n=="string"&&n.trim()){let i=this.readFieldValue(t,e).toLowerCase(),d=n.toLowerCase();if(!i.includes(d))return!1}return!0}),console.log("=== RESULTADO DOS FILTROS ==="),console.log(`${this.records.length} registros total -> ${this.filteredRecords.length} registros filtrados`),this.calculateSummaryStats(),this.calculateSLAIndicators(),this.calculatePhaseMetrics(),this.generateChartData()}exportToExcel(){if(this.filteredRecords.length===0){alert("N\xE3o h\xE1 registros para exportar.");return}let t=this.filteredRecords.map(I=>{let E={};return E.ID=I.id,E.Fase=this.getColumnName(I.columnId),E.Respons\u00E1vel=I.responsibleUserId||"N\xE3o atribu\xEDdo",E["Data de Cria\xE7\xE3o"]=I.createdAt?new Date(I.createdAt.toDate()).toLocaleDateString("pt-BR"):"",I.fields&&Object.entries(I.fields).forEach(([G,D])=>{E[G]=D||""}),E});if(t.length===0){alert("N\xE3o h\xE1 dados para exportar.");return}let e=Object.keys(t[0]),n=[e.join(","),...t.map(I=>e.map(E=>{let G=I[E]||"",D=String(G).replace(/"/g,'""');return D.includes(",")?`"${D}"`:D}).join(","))].join(`
`),i=new Blob(["\uFEFF"+n],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a"),f=URL.createObjectURL(i);d.setAttribute("href",f);let b=this.board?.name||"Board",T=new Date().toLocaleDateString("pt-BR").replace(/\//g,"-");d.setAttribute("download",`${b}_Relat\xF3rio_${T}.csv`),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d),console.log(`Exported ${this.filteredRecords.length} records to Excel`)}generateAvailableChartFields(){let t=new Set;t.add("fase"),t.add("responsavel"),t.add("origem"),t.add("segmento"),this.filteredRecords.forEach(e=>{e.fields&&Object.keys(e.fields).forEach(n=>{let i=e.fields[n];typeof i=="string"&&i.length<100&&t.add(n)})}),this.availableChartFields=Array.from(t).sort(),!this.selectedChartField&&this.availableChartFields.length>0&&(this.selectedChartField=this.availableChartFields.includes("segmento")?"segmento":this.availableChartFields[0])}generateDynamicCharts(){if(this.generateAvailableChartFields(),!this.selectedChartField)return;let t=this.generateChartForField(this.selectedChartField);this.chartData.dynamicCharts=[t]}generateChartForField(t){let e=new Map;this.filteredRecords.forEach(i=>{let d="";switch(t){case"fase":d=this.getColumnName(i.columnId)||"Sem Fase";break;case"responsavel":d=i.responsibleUserName||i.responsibleUserId||"N\xE3o Atribu\xEDdo";break;case"origem":d=i.fields?.origem||i.fields?.source||"N\xE3o Informado";break;case"segmento":d=i.fields?.segmento||i.fields?.segment||"N\xE3o Informado";break;default:d=i.fields?.[t]||"N\xE3o Informado"}d=String(d).trim()||"N\xE3o Informado",e.set(d,(e.get(d)||0)+1)});let n=Array.from(e.entries()).map(([i,d])=>({name:i,value:d,color:this.generateColorForItem(i)})).sort((i,d)=>d.value-i.value).slice(0,10);return{fieldName:t,fieldLabel:this.getFieldLabel(t),items:n,total:this.filteredRecords.length}}onChartFieldChange(){this.generateDynamicCharts()}getFieldLabel(t){return{fase:"Fases",responsavel:"Respons\xE1veis",origem:"Origem",segmento:"Segmento",source:"Origem",segment:"Segmento",contactName:"Nome do Contato",companyName:"Nome da Empresa",produto:"Produto",interesse:"Interesse"}[t]||t.charAt(0).toUpperCase()+t.slice(1)}generateColorForItem(t){let e=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#06B6D4","#84CC16","#F97316","#EC4899","#6B7280"],n=0;for(let i=0;i<t.length;i++)n=t.charCodeAt(i)+((n<<5)-n);return e[Math.abs(n)%e.length]}getDynamicChartMaxValue(){return!this.chartData.dynamicCharts.length||!this.chartData.dynamicCharts[0].items.length?0:Math.max(...this.chartData.dynamicCharts[0].items.map(e=>e.value))}getDynamicChartPercentage(t){let e=this.getDynamicChartMaxValue();return e>0?t/e*100:0}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=P({type:r,selectors:[["app-reports"]],inputs:{boardId:"boardId",ownerId:"ownerId"},decls:3,vars:3,consts:[["noDynamicData",""],[4,"ngIf"],["class","p-4 md:p-8",4,"ngIf"],["class","min-h-screen bg-gray-50 flex items-center justify-center",4,"ngIf"],[3,"title"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-6"],[3,"boardId","ownerId","columns","currentUser","filterQuery","filterOnlyMine","dynamicFilters","showAdvancedFilters","filterQueryChange","filterOnlyMineChange","dynamicFiltersChange","showAdvancedFiltersChange","filtersApplied",4,"ngIf"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","mb-6"],[1,"border-b","border-gray-200"],["aria-label","Tabs",1,"-mb-px","flex","space-x-8","px-6"],["class","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm hover:text-gray-700 hover:border-gray-300 transition-colors",3,"border-blue-500","text-blue-600","border-transparent","text-gray-500","click",4,"ngFor","ngForOf"],["class","flex items-center justify-center py-12",4,"ngIf"],[3,"filterQueryChange","filterOnlyMineChange","dynamicFiltersChange","showAdvancedFiltersChange","filtersApplied","boardId","ownerId","columns","currentUser","filterQuery","filterOnlyMine","dynamicFilters","showAdvancedFilters"],[1,"whitespace-nowrap","py-4","px-1","border-b-2","font-medium","text-sm","hover:text-gray-700","hover:border-gray-300","transition-colors",3,"click"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center"],[1,"fas","fa-spinner","fa-spin","text-4xl","text-blue-500","mb-4"],[1,"text-gray-600"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","xl:grid-cols-6","gap-6","mb-8"],[1,"bg-white","p-6","rounded-lg","shadow-sm","border","border-gray-200"],[1,"flex","items-center"],[1,"flex-shrink-0"],[1,"fas","fa-users","text-2xl","text-blue-500"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-500"],[1,"text-2xl","font-bold","text-gray-900"],[1,"fas","fa-plus-circle","text-2xl","text-green-500"],[1,"fas","fa-check-circle","text-2xl","text-purple-500"],[1,"fas","fa-clock","text-2xl","text-orange-500"],[1,"fas","fa-play-circle","text-2xl","text-blue-500"],[1,"fas","fa-exclamation-triangle","text-2xl","text-red-500"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"fas","fa-chart-bar","mr-2","text-blue-500"],[1,"space-y-4"],["class","text-center py-4",4,"ngIf"],["class","space-y-2",4,"ngFor","ngForOf"],[1,"space-y-2"],["class","relative",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","border","border-gray-300","rounded-md","px-3","py-1","focus:ring-2","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],["class","space-y-4",4,"ngIf","ngIfElse"],[1,"text-center","py-4"],[1,"text-gray-500","text-sm"],[1,"flex","items-center","justify-between"],[1,"w-3","h-3","rounded-full","mr-2"],[1,"text-sm","font-medium","text-gray-700"],[1,"text-sm","font-bold","text-gray-900"],[1,"w-full","bg-gray-200","rounded-full","h-2"],[1,"h-2","rounded-full"],[1,"relative"],[1,"flex","items-center","justify-between","p-3","rounded-lg","bg-gray-50"],["class","flex justify-center py-1",4,"ngIf"],[1,"flex","justify-center","py-1"],[1,"fas","fa-chevron-down","text-gray-400"],[3,"value"],[4,"ngFor","ngForOf"],[1,"mb-3"],[1,"text-sm","text-gray-600"],[1,"space-y-3"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","overflow-hidden"],[1,"px-6","py-4","border-b","border-gray-200"],[1,"text-sm","text-gray-600","mt-1"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"px-6","py-3","text-center","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],["class","px-6 py-8 text-center",4,"ngIf"],[1,"px-6","py-4","whitespace-nowrap"],[1,"w-3","h-3","rounded-full","mr-3"],[1,"text-sm","font-medium","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-center","text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-center"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-green-100","text-green-800"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","bg-red-100","text-red-800"],[1,"flex","items-center","justify-center"],[1,"w-16","bg-gray-200","rounded-full","h-2","mr-2"],[1,"h-2","rounded-full","transition-all","duration-300"],[1,"px-6","py-8","text-center"],[1,"fas","fa-clock","text-4xl","text-gray-300","mb-4"],[1,"text-gray-500"],[1,"grid","grid-cols-1","lg:grid-cols-2","xl:grid-cols-3","gap-6"],["class","bg-white p-6 rounded-lg shadow-sm border border-gray-200",4,"ngFor","ngForOf"],[1,"w-4","h-4","rounded-full"],[1,"flex","justify-between","items-center"],[1,"text-lg","font-bold","text-gray-900"],[1,"px-6","py-4","border-b","border-gray-200","flex","justify-between","items-center"],[1,"flex","items-center","gap-3"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-blue-500",3,"click"],[1,"fas","fa-columns","mr-2"],[1,"fas","fa-chevron-down","ml-2"],["class","absolute right-0 mt-2 w-72 bg-white border border-gray-200 rounded-lg shadow-lg z-10",4,"ngIf"],["class","px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap",4,"ngFor","ngForOf"],[3,"bg-gray-50",4,"ngFor","ngForOf"],[1,"absolute","right-0","mt-2","w-72","bg-white","border","border-gray-200","rounded-lg","shadow-lg","z-10"],[1,"px-4","py-3","border-b","border-gray-200"],[1,"text-sm","font-semibold","text-gray-900"],[1,"text-xs","text-gray-600","mt-1"],[1,"max-h-80","overflow-y-auto"],[1,"px-4","py-2"],[1,"text-xs","font-medium","text-gray-500","uppercase","tracking-wide","mb-2"],["class","flex items-center cursor-pointer hover:bg-gray-50 px-2 py-1 rounded",4,"ngFor","ngForOf"],["class","px-4 py-2 border-t border-gray-100",4,"ngIf"],[1,"px-4","py-3","border-t","border-gray-200","bg-gray-50"],[1,"w-full","px-3","py-2","text-sm","bg-blue-600","text-white","rounded-md","hover:bg-blue-700","focus:outline-none","focus:ring-2","focus:ring-blue-500",3,"click"],[1,"flex","items-center","cursor-pointer","hover:bg-gray-50","px-2","py-1","rounded"],["type","checkbox",1,"h-4","w-4","text-blue-600","focus:ring-blue-500","border-gray-300","rounded",3,"change","checked"],[1,"ml-3","text-sm","text-gray-700"],[1,"px-4","py-2","border-t","border-gray-100"],[1,"ml-auto","text-xs","text-gray-400"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider","whitespace-nowrap"],["class","px-6 py-4 whitespace-nowrap",4,"ngFor","ngForOf"],["class","flex items-center",4,"ngIf"],["class","text-sm text-gray-900",4,"ngIf"],[1,"text-sm","text-gray-900"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium"],[1,"fas","fa-search","text-4xl","text-gray-300","mb-4"],[1,"p-4","md:p-8"],[1,"max-w-7xl","mx-auto"],[1,"flex","justify-between","items-center","mb-6"],[1,"flex","space-x-8","px-6"],["class","py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200",3,"border-blue-500","text-blue-600","border-transparent","text-gray-500","hover:text-gray-700","click",4,"ngFor","ngForOf"],[1,"p-6"],[1,"py-4","px-1","border-b-2","font-medium","text-sm","transition-colors","duration-200",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6","mb-8"],[1,"bg-gradient-to-r","from-blue-500","to-blue-600","rounded-lg","shadow","p-6","text-white"],[1,"text-blue-100"],[1,"text-3xl","font-bold"],[1,"bg-blue-400","bg-opacity-30","p-3","rounded-full"],[1,"fas","fa-users","text-2xl"],[1,"bg-gradient-to-r","from-green-500","to-green-600","rounded-lg","shadow","p-6","text-white"],[1,"text-green-100"],[1,"bg-green-400","bg-opacity-30","p-3","rounded-full"],[1,"fas","fa-check-circle","text-2xl"],[1,"bg-gradient-to-r","from-yellow-500","to-yellow-600","rounded-lg","shadow","p-6","text-white"],[1,"text-yellow-100"],[1,"bg-yellow-400","bg-opacity-30","p-3","rounded-full"],[1,"fas","fa-clock","text-2xl"],[1,"bg-white"],[1,"px-2","inline-flex","text-xs","leading-5","font-semibold","rounded-full"],[1,"px-6","py-4","whitespace-nowrap","text-center","text-sm","text-green-600","font-medium"],[1,"px-6","py-4","whitespace-nowrap","text-center","text-sm","text-red-600","font-medium"],[1,"space-y-6"],["class","bg-white rounded-lg border border-gray-200 p-6",4,"ngFor","ngForOf"],[1,"bg-white","rounded-lg","border","border-gray-200","p-6"],[1,"w-4","h-4","rounded-full","mr-3"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"bg-gray-50","rounded-lg","p-4"],[1,"text-xl","font-semibold","text-gray-900"],[1,"flex","justify-between","items-center","mb-4"],[1,"flex","items-center","gap-2"],[1,"inline-flex","items-center","px-3","py-2","border","border-gray-300","shadow-sm","text-sm","leading-4","font-medium","rounded-md","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-green-500",3,"click"],[1,"fas","fa-file-excel","mr-2","text-green-600"],[1,"min-h-screen","bg-gray-50","flex","items-center","justify-center"],[1,"max-w-md","w-full","mx-auto"],[1,"bg-white","rounded-lg","shadow-lg","p-8"],[1,"text-center","mb-6"],[1,"w-16","h-16","mx-auto","bg-blue-100","rounded-full","flex","items-center","justify-center","mb-4"],[1,"fas","fa-chart-bar","text-2xl","text-blue-500"],[1,"text-2xl","font-bold","text-gray-900","mb-2"],["class","p-4 border border-gray-200 rounded-lg hover:border-blue-300 hover:bg-blue-50 cursor-pointer transition-colors",3,"click",4,"ngFor","ngForOf"],["class","text-center py-8",4,"ngIf"],[1,"p-4","border","border-gray-200","rounded-lg","hover:border-blue-300","hover:bg-blue-50","cursor-pointer","transition-colors",3,"click"],[1,"font-medium","text-gray-900"],["class","text-sm text-gray-600",4,"ngIf"],[1,"fas","fa-chevron-right","text-gray-400"],[1,"text-center","py-8"],[1,"mt-4","bg-blue-500","hover:bg-blue-600","text-white","px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors",3,"click"]],template:function(e,n){e&1&&p(0,dt,10,14,"app-main-layout",1)(1,Ot,16,7,"div",2)(2,Rt,13,2,"div",3),e&2&&(m("ngIf",n.boardId&&n.isStandaloneView()),l(),m("ngIf",n.boardId&&!n.isStandaloneView()),l(),m("ngIf",!n.boardId))},dependencies:[N,V,L,U,B,Q,oe,$,j,se,de,W,te],styles:['.line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.chart-container[_ngcontent-%COMP%]{position:relative;height:300px}.chart-container[_ngcontent-%COMP%]   .chart-bar[_ngcontent-%COMP%]{transition:all .3s ease}.chart-container[_ngcontent-%COMP%]   .chart-bar[_ngcontent-%COMP%]:hover{opacity:.8}.sla-indicator[_ngcontent-%COMP%]   .compliance-bar[_ngcontent-%COMP%]{transition:width .5s ease-in-out}.sla-indicator.high-compliance[_ngcontent-%COMP%]   .compliance-bar[_ngcontent-%COMP%]{background:linear-gradient(to right,#10b981,#059669)}.sla-indicator.medium-compliance[_ngcontent-%COMP%]   .compliance-bar[_ngcontent-%COMP%]{background:linear-gradient(to right,#f59e0b,#d97706)}.sla-indicator.low-compliance[_ngcontent-%COMP%]   .compliance-bar[_ngcontent-%COMP%]{background:linear-gradient(to right,#ef4444,#dc2626)}.metric-card[_ngcontent-%COMP%]{transition:transform .2s ease,box-shadow .2s ease}.metric-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #0000001a}.table-container[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{transition:background-color .2s ease}.table-container[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:hover{background-color:#3b82f60d}.status-badge.status-active[_ngcontent-%COMP%]{background:linear-gradient(135deg,#3b82f6,#1d4ed8)}.status-badge.status-concluded[_ngcontent-%COMP%]{background:linear-gradient(135deg,#10b981,#059669)}.status-badge.status-overdue[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626)}.filters-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9);border-left:4px solid #3B82F6}.tab-nav[_ngcontent-%COMP%]   .tab-button[_ngcontent-%COMP%]{position:relative;transition:all .2s ease}.tab-nav[_ngcontent-%COMP%]   .tab-button[_ngcontent-%COMP%]:hover{color:#3b82f6}.tab-nav[_ngcontent-%COMP%]   .tab-button.active[_ngcontent-%COMP%]:after{content:"";position:absolute;bottom:-1px;left:0;right:0;height:2px;background:linear-gradient(to right,#3b82f6,#1d4ed8);border-radius:1px}.loading-spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.summary-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff,#f8fafc);border-left:4px solid transparent;transition:all .2s ease}.summary-card[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #0000001a}.summary-card.card-primary[_ngcontent-%COMP%]{border-left-color:#3b82f6}.summary-card.card-success[_ngcontent-%COMP%]{border-left-color:#10b981}.summary-card.card-warning[_ngcontent-%COMP%]{border-left-color:#f59e0b}.summary-card.card-danger[_ngcontent-%COMP%]{border-left-color:#ef4444}.chart-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:.5rem}.chart-legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]   .legend-color[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%;margin-right:.5rem}@media (max-width: 768px){.filters-section[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.summary-cards[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.tab-nav[_ngcontent-%COMP%]{overflow-x:auto;-webkit-overflow-scrolling:touch}}@media (max-width: 640px){.summary-cards[_ngcontent-%COMP%]   .grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}@media print{.no-print[_ngcontent-%COMP%]{display:none!important}.page-break[_ngcontent-%COMP%]{page-break-before:always}.chart-container[_ngcontent-%COMP%]{-webkit-print-color-adjust:exact;color-adjust:exact}}']})};export{ce as a};
