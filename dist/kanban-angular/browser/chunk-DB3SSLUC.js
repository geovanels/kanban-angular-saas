import{a as oe,b as re}from"./chunk-5FL2EFSF.js";import{a as ie}from"./chunk-UHZZH6SA.js";import"./chunk-Z6YHNIQS.js";import{E as Z,F as ee,I as te,e as W,i as H,l as K,m as X,p as Y,s as G,t as J}from"./chunk-NQFRU3X2.js";import"./chunk-C6QB7HLZ.js";import{F as D,G as T,H as k}from"./chunk-4NYDEC32.js";import{$b as R,Bb as O,Cb as F,Db as _,Eb as o,Fb as a,Gb as p,Nb as h,Nc as z,Oc as B,Pb as b,Rb as s,Ub as q,Vb as U,Wa as L,Wb as j,Wc as E,Xa as d,Yb as Q,Zb as A,ac as l,cc as g,f as C,fa as x,fb as S,fc as I,gc as N,hc as P,jc as $,kb as v,la as m,ma as u,nb as V,yb as y,zb as w}from"./chunk-JXP376XN.js";function le(r,t){if(r&1&&(o(0,"div",21),l(1),a()),r&2){let e=s(2);d(),g(" ",e.errorMessage," ")}}function ce(r,t){r&1&&p(0,"div",22)}function me(r,t){if(r&1){let e=h();o(0,"div",1),b("click",function(n){m(e);let c=s();return u(c.onBackdropClick(n))}),o(1,"div",2)(2,"div",3)(3,"h2",4),l(4,"Novo Quadro Kanban"),a(),o(5,"button",5),b("click",function(){m(e);let n=s();return u(n.hide())}),l(6," \xD7 "),a()(),o(7,"form",6),b("ngSubmit",function(){m(e);let n=s();return u(n.createBoard())}),o(8,"div")(9,"label",7),l(10," Nome do Quadro * "),a(),o(11,"input",8),P("ngModelChange",function(n){m(e);let c=s();return N(c.boardName,n)||(c.boardName=n),u(n)}),a()(),o(12,"div")(13,"label",9),l(14," Descri\xE7\xE3o (Opcional) "),a(),o(15,"textarea",10),P("ngModelChange",function(n){m(e);let c=s();return N(c.boardDescription,n)||(c.boardDescription=n),u(n)}),a()(),v(16,le,2,1,"div",11),o(17,"div",12)(18,"div",13),p(19,"i",14),o(20,"div",15)(21,"strong"),l(22,"Ap\xF3s criar o quadro:"),a(),o(23,"ul",16)(24,"li"),l(25,"Configure as fases do seu processo"),a(),o(26,"li"),l(27,"Defina os campos do formul\xE1rio conforme sua necessidade"),a(),o(28,"li"),l(29,"Personalize para qualquer tipo de processo (vendas, compras, viagens, etc.)"),a()()()()(),o(30,"div",17)(31,"button",18),b("click",function(){m(e);let n=s();return u(n.hide())}),l(32," Cancelar "),a(),o(33,"button",19),v(34,ce,1,0,"div",20),l(35),a()()()()()}if(r&2){let e=s();d(5),_("disabled",e.isLoading),d(6),I("ngModel",e.boardName),_("disabled",e.isLoading),d(4),I("ngModel",e.boardDescription),_("disabled",e.isLoading),d(),_("ngIf",e.errorMessage),d(15),_("disabled",e.isLoading),d(2),Q("background-color",e.getPrimaryColor())("opacity",e.isLoading||!e.boardName.trim()?"0.6":"1"),_("disabled",e.isLoading||!e.boardName.trim()),d(),_("ngIf",e.isLoading),d(),g(" ",e.isLoading?"Criando...":"Criar Quadro"," ")}}var M=class r{authService=x(T);firestoreService=x(k);subdomainService=x(D);boardCreated=new V;closeModal=new V;boardName="";boardDescription="";isLoading=!1;errorMessage="";isVisible=!1;show(){this.isVisible=!0,this.resetForm()}hide(){this.isVisible=!1,this.closeModal.emit()}resetForm(){this.boardName="",this.boardDescription="",this.errorMessage="",this.isLoading=!1}createBoard(){return C(this,null,function*(){if(!this.boardName.trim()){this.errorMessage="Nome do quadro \xE9 obrigat\xF3rio";return}let t=this.authService.getCurrentUser();if(!t){this.errorMessage="Usu\xE1rio n\xE3o autenticado";return}this.isLoading=!0,this.errorMessage="";try{let e={name:this.boardName.trim(),description:this.boardDescription.trim(),companyId:"",createdAt:null},i=yield this.firestoreService.createBoard(t.uid,e);yield this.firestoreService.updateBoard(t.uid,i.id,{ownerEmail:t.email||""}),this.boardCreated.emit(),this.hide()}catch(e){console.error("Erro ao criar quadro:",e),this.errorMessage="Erro ao criar quadro. Tente novamente."}finally{this.isLoading=!1}})}onBackdropClick(t){t.target===t.currentTarget&&this.hide()}getPrimaryColor(){let t=this.subdomainService.getCurrentCompany();return t?.primaryColor||t?.brandingConfig?.primaryColor||"#3B82F6"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["app-create-board-modal"]],outputs:{boardCreated:"boardCreated",closeModal:"closeModal"},decls:1,vars:1,consts:[["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",3,"click",4,"ngIf"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","text-2xl","font-bold",3,"click","disabled"],[1,"space-y-4",3,"ngSubmit"],["for","boardName",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","boardName","name","boardName","placeholder","Ex: Vendas 2024","maxlength","100","required","",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors",3,"ngModelChange","ngModel","disabled"],["for","boardDescription",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","boardDescription","name","boardDescription","rows","3","placeholder","Descreva o prop\xF3sito deste quadro...","maxlength","500",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors","resize-none",3,"ngModelChange","ngModel","disabled"],["class","text-red-500 text-sm",4,"ngIf"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-3"],[1,"flex","items-start"],[1,"fas","fa-info-circle","text-blue-500","mt-0.5","mr-2"],[1,"text-sm","text-blue-700"],[1,"mt-1","ml-2","list-disc"],[1,"flex","justify-end","gap-3","pt-4"],["type","button",1,"px-4","py-2","text-gray-700","bg-gray-200","hover:bg-gray-300","rounded-lg","font-medium","transition-colors",3,"click","disabled"],["type","submit",1,"px-6","py-2","text-white","rounded-lg","font-medium","transition-colors","flex","items-center",3,"disabled"],["class","animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2",4,"ngIf"],[1,"text-red-500","text-sm"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-white","mr-2"]],template:function(e,i){e&1&&v(0,me,36,14,"div",0),e&2&&_("ngIf",i.isVisible)},dependencies:[E,B,te,J,H,K,X,Z,ee,G,Y],styles:[".fixed[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.bg-white[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}"]})};var ue=(r,t)=>t.id;function pe(r,t){if(r&1){let e=h();o(0,"div",9)(1,"button",10),b("click",function(){m(e);let n=s();return u(n.showCreateBoardModal())}),p(2,"i",11),l(3," Novo Quadro "),a()()}}function be(r,t){if(r&1){let e=h();o(0,"button",12),b("click",function(){let n=m(e).$implicit,c=s();return u(c.switchTab(n.id))}),p(1,"i"),l(2),a()}if(r&2){let e=t.$implicit,i=s();A("border-blue-500",i.activeTab===e.id)("text-blue-600",i.activeTab===e.id)("border-transparent",i.activeTab!==e.id)("text-gray-500",i.activeTab!==e.id)("hover:text-gray-700",i.activeTab!==e.id),d(),R($("fas ",e.icon," mr-2")),d(),g(" ",e.name," ")}}function _e(r,t){r&1&&(o(0,"div",14)(1,"div",17),p(2,"i",18),o(3,"p",19),l(4,"Carregando seus quadros..."),a()()())}function fe(r,t){if(r&1){let e=h();o(0,"div",15)(1,"div",20),p(2,"i",21),a(),o(3,"h3",22),l(4,"Nenhum quadro encontrado"),a(),o(5,"p",23),l(6,"Crie seu primeiro quadro Kanban para come\xE7ar a organizar suas tarefas."),a(),o(7,"button",24),b("click",function(){m(e);let n=s(2);return u(n.showCreateBoardModal())}),p(8,"i",11),l(9," Criar Primeiro Quadro "),a()()}}function ge(r,t){if(r&1&&(o(0,"p",31),l(1),a()),r&2){let e=s().$implicit;d(),g(" ",e.description," ")}}function xe(r,t){if(r&1){let e=h();o(0,"div",35)(1,"div",42)(2,"button",43),b("click",function(n){m(e);let c=s().$implicit,f=s(3);return n.stopPropagation(),u(f.editBoard(c))}),p(3,"i",44),l(4," Editar "),a(),o(5,"button",43),b("click",function(n){m(e);let c=s().$implicit,f=s(3);return n.stopPropagation(),u(f.duplicateBoard(c))}),p(6,"i",45),l(7," Duplicar "),a(),p(8,"hr",46),o(9,"button",47),b("click",function(n){m(e);let c=s().$implicit,f=s(3);return n.stopPropagation(),u(f.deleteBoard(c.id))}),p(10,"i",48),l(11," Excluir "),a()()()}}function he(r,t){if(r&1){let e=h();o(0,"div",26),b("click",function(){let n=m(e).$implicit,c=s(3);return u(c.openBoard(n.id))}),o(1,"div",27)(2,"div",28)(3,"div",29)(4,"h3",30),l(5),a(),y(6,ge,2,1,"p",31),a(),o(7,"div",32)(8,"button",33),b("click",function(n){let c=m(e).$implicit,f=s(3);return n.stopPropagation(),u(f.toggleBoardMenu(c.id))}),p(9,"i",34),a(),y(10,xe,12,0,"div",35),a()()(),o(11,"div",36)(12,"div",37)(13,"div",38)(14,"span",19),p(15,"i",39),l(16),a(),o(17,"span",19),p(18,"i",40),l(19),a()(),o(20,"div",41),l(21),a()()()()}if(r&2){let e=t.$implicit,i=s(3);d(5),g(" ",e.name," "),d(),w(e.description?6:-1),d(4),w(i.activeBoardMenu===e.id?10:-1),d(6),g(" ",i.getBoardColumnCount(e.id)," colunas "),d(3),g(" ",i.getBoardTaskCount(e.id)," leads "),d(2),g(" ",i.formatDate(e.createdAt)," ")}}function Ce(r,t){if(r&1&&(o(0,"div",16),O(1,he,22,6,"div",25,ue),a()),r&2){let e=s(2);d(),F(e.boards)}}function ve(r,t){if(r&1&&(o(0,"div",13),y(1,_e,5,0,"div",14)(2,fe,10,0,"div",15)(3,Ce,3,0,"div",16),a()),r&2){let e=s();d(),w(e.isLoading?1:e.boards.length===0?2:3)}}function ye(r,t){r&1&&(o(0,"div"),p(1,"app-reports"),a())}function we(r,t){if(r&1){let e=h();o(0,"app-create-board-modal",49,0),b("boardCreated",function(n){m(e);let c=s();return u(c.onBoardCreated(n))})("closeModal",function(){m(e);let n=s();return u(n.showCreateModal=!1)}),a()}}var ne=class r{authService=x(T);firestoreService=x(k);subdomainService=x(D);router=x(W);createBoardModal;boards=[];isLoading=!1;currentUser=null;showConfigMenu=!1;showCreateModal=!1;activeBoardMenu=null;subscription;activeTab="boards";tabs=[{id:"boards",name:"Meus Quadros",icon:"fa-th-large"},{id:"reports",name:"Relat\xF3rios",icon:"fa-chart-bar"}];boardStats={};ngOnInit(){return C(this,null,function*(){this.currentUser=this.authService.getCurrentUser(),this.currentUser&&(yield this.loadBoards())})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}ngAfterViewInit(){}loadBoards(){return C(this,null,function*(){if(this.currentUser){this.isLoading=!0;try{this.boards=yield this.firestoreService.getBoards(this.currentUser.uid),yield this.loadBoardStatistics()}catch{}finally{this.isLoading=!1}}})}loadBoardStatistics(){return C(this,null,function*(){for(let t of this.boards)if(t.id)try{let e=yield this.firestoreService.getColumns(this.currentUser.uid,t.id),i=yield this.firestoreService.getLeads(this.currentUser.uid,t.id);this.boardStats[t.id]={columnCount:e.length,leadCount:i.length}}catch{this.boardStats[t.id]={columnCount:0,leadCount:0}}})}logout(){return C(this,null,function*(){(yield this.authService.logout()).success&&(window.location.href="/login")})}openBoard(t){let e=this.boards.find(i=>i.id===t);e&&e.owner?this.router.navigate(["/kanban",t],{queryParams:{ownerId:e.owner}}):this.router.navigate(["/kanban",t],{queryParams:{ownerId:this.currentUser.uid}})}formatDate(t){return t?t.seconds?new Date(t.seconds*1e3).toLocaleDateString("pt-BR"):new Date(t).toLocaleDateString("pt-BR"):""}showCreateBoardModal(){this.showCreateModal=!0,setTimeout(()=>{this.createBoardModal&&this.createBoardModal.show()},0)}onBoardCreated(t){this.loadBoards(),this.showCreateModal=!1}toggleBoardMenu(t){this.activeBoardMenu=this.activeBoardMenu===t?null:t}editBoard(t){this.activeBoardMenu=null}duplicateBoard(t){this.activeBoardMenu=null}deleteBoard(t){return C(this,null,function*(){let i=this.boards.find(f=>f.id===t)?.name||"Quadro",n=`\u26A0\uFE0F ATEN\xC7\xC3O: Esta a\xE7\xE3o n\xE3o pode ser desfeita!

Deseja excluir o quadro "${i}"?

Isso ir\xE1 remover PERMANENTEMENTE:
\u2022 Todas as colunas/fases
\u2022 Todos os leads/registros
\u2022 Todos os templates de email
\u2022 Todas as automa\xE7\xF5es
\u2022 Todo o hist\xF3rico e configura\xE7\xF5es

Digite "EXCLUIR" para confirmar:`;if(prompt(n)==="EXCLUIR")try{yield this.firestoreService.deleteBoard(this.currentUser.uid,t),yield this.loadBoards(),alert(`\u2705 Quadro "${i}" foi exclu\xEDdo com sucesso!`)}catch{alert("\u274C Erro ao excluir o quadro. Tente novamente.")}this.activeBoardMenu=null})}getBoardColumnCount(t){return this.boardStats[t]?.columnCount||0}getBoardTaskCount(t){return this.boardStats[t]?.leadCount||0}toggleConfigMenu(){this.showConfigMenu=!this.showConfigMenu}closeConfigMenu(){this.showConfigMenu=!1}closeBoardMenu(t){t.target.closest(".board-menu-container")||(this.activeBoardMenu=null)}switchTab(t){this.activeTab=t}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["app-dashboard"]],viewQuery:function(e,i){if(e&1&&q(M,5),e&2){let n;U(n=j())&&(i.createBoardModal=n.first)}},hostBindings:function(e,i){e&1&&b("click",function(c){return i.closeBoardMenu(c)},L)},decls:10,vars:5,consts:[["createBoardModal",""],["title","Dashboard"],["class","flex space-x-2",4,"ngIf"],[1,"bg-white","border-b","border-gray-200"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"flex","space-x-8"],["class","py-4 px-1 border-b-2 font-medium text-sm transition-colors duration-200",3,"border-blue-500","text-blue-600","border-transparent","text-gray-500","hover:text-gray-700","click",4,"ngFor","ngForOf"],["class","max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",4,"ngIf"],[4,"ngIf"],[1,"flex","space-x-2"],[1,"bg-blue-500","hover:bg-blue-600","text-white","px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors","flex","items-center",3,"click"],[1,"fas","fa-plus","mr-2"],[1,"py-4","px-1","border-b-2","font-medium","text-sm","transition-colors","duration-200",3,"click"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center","py-12"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-6"],[1,"text-center"],[1,"fas","fa-spinner","fa-spin","text-4xl","text-gray-400","mb-4"],[1,"text-gray-600"],[1,"w-24","h-24","mx-auto","bg-gray-100","rounded-full","flex","items-center","justify-center","mb-4"],[1,"fas","fa-th-large","text-3xl","text-gray-400"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600","mb-6"],[1,"bg-blue-500","hover:bg-blue-600","text-white","px-6","py-3","rounded-lg","font-medium","transition-colors",3,"click"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","hover:shadow-md","transition-shadow","cursor-pointer","group"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","hover:shadow-md","transition-shadow","cursor-pointer","group",3,"click"],[1,"p-6","border-b","border-gray-100"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"font-semibold","text-gray-900","group-hover:text-blue-600","transition-colors"],[1,"text-sm","text-gray-600","mt-1","line-clamp-2"],[1,"relative","ml-4","board-menu-container"],[1,"p-2","text-gray-600","hover:text-gray-800","hover:bg-gray-100","rounded-md","transition-all",2,"display","flex","align-items","center","justify-content","center","min-width","32px","min-height","32px",3,"click"],[1,"fas","fa-ellipsis-v"],[1,"absolute","right-0","mt-2","w-48","bg-white","rounded-md","shadow-lg","border","border-gray-200","z-50",2,"box-shadow","0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"],[1,"p-4","bg-gray-50"],[1,"flex","items-center","justify-between","text-sm"],[1,"flex","items-center","space-x-4"],[1,"fas","fa-columns","mr-1"],[1,"fas","fa-tasks","mr-1"],[1,"text-xs","text-gray-500"],[1,"py-1"],[1,"w-full","text-left","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100",3,"click"],[1,"fas","fa-edit","mr-2"],[1,"fas","fa-copy","mr-2"],[1,"my-1"],[1,"w-full","text-left","px-4","py-2","text-sm","text-red-700","hover:bg-red-50",3,"click"],[1,"fas","fa-trash","mr-2"],[3,"boardCreated","closeModal"]],template:function(e,i){e&1&&(o(0,"app-main-layout")(1,"app-company-breadcrumb",1),v(2,pe,4,0,"div",2),a(),o(3,"div",3)(4,"div",4)(5,"nav",5),v(6,be,3,14,"button",6),a()()(),v(7,ve,4,1,"div",7)(8,ye,2,0,"div",8),y(9,we,2,0,"app-create-board-modal"),a()),e&2&&(d(2),_("ngIf",i.activeTab==="boards"),d(4),_("ngForOf",i.tabs),d(),_("ngIf",i.activeTab==="boards"),d(),_("ngIf",i.activeTab==="reports"),d(),w(i.showCreateModal?9:-1))},dependencies:[E,z,B,M,ie,oe,re],styles:[".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.board-menu-container[_ngcontent-%COMP%]{position:relative}.board-menu-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{opacity:1!important;visibility:visible!important}.board-menu-container[_ngcontent-%COMP%]   .absolute[_ngcontent-%COMP%]{position:absolute!important;z-index:1000!important}"]})};export{ne as DashboardComponent};
