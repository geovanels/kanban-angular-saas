import{a as M}from"./chunk-FUZ5PWBD.js";import{a as E}from"./chunk-VRCZJENY.js";import{a as K}from"./chunk-IU7U2KCH.js";import{G as z,H as W,K as G,g as j,j as O,m as q,n as F,r as A,u as Q,v as R}from"./chunk-N33KF77X.js";import"./chunk-WLUU74ML.js";import{Ab as i,Ac as P,Bb as s,Bc as w,Hb as y,Hc as S,Ib as u,Jb as c,Mb as T,Nb as V,Ob as L,Rb as U,Ta as l,Tb as n,Ub as k,Vb as h,Yb as B,Zb as N,_b as I,bb as C,da as b,f as v,gb as x,ja as p,jb as D,ka as f,yb as m,zb as e}from"./chunk-3D7XR5P5.js";function Z(a,o){if(a&1&&(e(0,"div",21),n(1),i()),a&2){let t=c(2);l(),h(" ",t.errorMessage," ")}}function $(a,o){a&1&&s(0,"div",22)}function ee(a,o){if(a&1){let t=y();e(0,"div",1),u("click",function(d){p(t);let g=c();return f(g.onBackdropClick(d))}),e(1,"div",2)(2,"div",3)(3,"h2",4),n(4,"Novo Quadro Kanban"),i(),e(5,"button",5),u("click",function(){p(t);let d=c();return f(d.hide())}),n(6," \xD7 "),i()(),e(7,"form",6),u("ngSubmit",function(){p(t);let d=c();return f(d.createBoard())}),e(8,"div")(9,"label",7),n(10," Nome do Quadro * "),i(),e(11,"input",8),I("ngModelChange",function(d){p(t);let g=c();return N(g.boardName,d)||(g.boardName=d),f(d)}),i()(),e(12,"div")(13,"label",9),n(14," Descri\xE7\xE3o (Opcional) "),i(),e(15,"textarea",10),I("ngModelChange",function(d){p(t);let g=c();return N(g.boardDescription,d)||(g.boardDescription=d),f(d)}),i()(),x(16,Z,2,1,"div",11),e(17,"div",12)(18,"div",13),s(19,"i",14),e(20,"div",15)(21,"strong"),n(22,"O quadro ser\xE1 criado com:"),i(),e(23,"ul",16)(24,"li"),n(25,'1 coluna inicial "Novo Lead"'),i(),e(26,"li"),n(27,"Campos padr\xE3o para leads (Empresa, CNPJ, Contato, etc.)"),i()()()()(),e(28,"div",17)(29,"button",18),u("click",function(){p(t);let d=c();return f(d.hide())}),n(30," Cancelar "),i(),e(31,"button",19),x(32,$,1,0,"div",20),n(33),i()()()()()}if(a&2){let t=c();l(5),m("disabled",t.isLoading),l(6),B("ngModel",t.boardName),m("disabled",t.isLoading),l(4),B("ngModel",t.boardDescription),m("disabled",t.isLoading),l(),m("ngIf",t.errorMessage),l(13),m("disabled",t.isLoading),l(2),m("disabled",t.isLoading||!t.boardName.trim()),l(),m("ngIf",t.isLoading),l(),h(" ",t.isLoading?"Criando...":"Criar Quadro"," ")}}var _=class a{authService=b(E);firestoreService=b(M);boardCreated=new D;closeModal=new D;boardName="";boardDescription="";isLoading=!1;errorMessage="";isVisible=!1;show(){this.isVisible=!0,this.resetForm()}hide(){this.isVisible=!1,this.closeModal.emit()}resetForm(){this.boardName="",this.boardDescription="",this.errorMessage="",this.isLoading=!1}createBoard(){return v(this,null,function*(){if(!this.boardName.trim()){this.errorMessage="Nome do quadro \xE9 obrigat\xF3rio";return}let o=this.authService.getCurrentUser();if(!o){this.errorMessage="Usu\xE1rio n\xE3o autenticado";return}this.isLoading=!0,this.errorMessage="";try{let t={name:this.boardName.trim(),description:this.boardDescription.trim(),companyId:"",createdAt:null},r=yield this.firestoreService.createBoard(o.uid,t);yield this.firestoreService.updateBoard(o.uid,r.id,{ownerEmail:o.email||""});let d=[{name:"companyName",label:"Nome da Empresa",type:"text",required:!0},{name:"cnpj",label:"CNPJ",type:"cnpj",required:!0},{name:"contactName",label:"Nome Contato",type:"text",required:!0},{name:"contactEmail",label:"Email Contato",type:"email",required:!0},{name:"contactPhone",label:"Telefone Contato",type:"tel",required:!0}];yield this.firestoreService.createColumn(o.uid,r.id,{name:"Novo Lead",order:0,color:"#4A90E2",endStageType:"none",companyId:""}),this.boardCreated.emit(),this.hide()}catch(t){console.error("Erro ao criar quadro:",t),this.errorMessage="Erro ao criar quadro. Tente novamente."}finally{this.isLoading=!1}})}onBackdropClick(o){o.target===o.currentTarget&&this.hide()}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=C({type:a,selectors:[["app-create-board-modal"]],outputs:{boardCreated:"boardCreated",closeModal:"closeModal"},decls:1,vars:1,consts:[["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",3,"click",4,"ngIf"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","text-2xl","font-bold",3,"click","disabled"],[1,"space-y-4",3,"ngSubmit"],["for","boardName",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","boardName","name","boardName","placeholder","Ex: Vendas 2024","maxlength","100","required","",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors",3,"ngModelChange","ngModel","disabled"],["for","boardDescription",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","boardDescription","name","boardDescription","rows","3","placeholder","Descreva o prop\xF3sito deste quadro...","maxlength","500",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors","resize-none",3,"ngModelChange","ngModel","disabled"],["class","text-red-500 text-sm",4,"ngIf"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-3"],[1,"flex","items-start"],[1,"fas","fa-info-circle","text-blue-500","mt-0.5","mr-2"],[1,"text-sm","text-blue-700"],[1,"mt-1","ml-2","list-disc"],[1,"flex","justify-end","gap-3","pt-4"],["type","button",1,"px-4","py-2","text-gray-700","bg-gray-200","hover:bg-gray-300","rounded-lg","font-medium","transition-colors",3,"click","disabled"],["type","submit",1,"px-6","py-2","bg-blue-500","hover:bg-blue-600","disabled:bg-blue-300","text-white","rounded-lg","font-medium","transition-colors","flex","items-center",3,"disabled"],["class","animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2",4,"ngIf"],[1,"text-red-500","text-sm"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-white","mr-2"]],template:function(t,r){t&1&&x(0,ee,34,10,"div",0),t&2&&m("ngIf",r.isVisible)},dependencies:[S,w,G,R,O,q,F,z,W,Q,A],styles:[".fixed[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.bg-white[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}"]})};function te(a,o){a&1&&(e(0,"div",35)(1,"div",36)(2,"a",37),s(3,"i",38),n(4," Branding & Visual "),i(),e(5,"a",39),s(6,"i",40),n(7," Configura\xE7\xE3o SMTP "),i(),e(8,"a",41),s(9,"i",42),n(10," API & Integra\xE7\xF5es "),i()()())}function ie(a,o){a&1&&(e(0,"div",43),s(1,"div",44),i())}function re(a,o){if(a&1){let t=y();e(0,"div",45)(1,"div",46)(2,"div",47),s(3,"i",48),i(),e(4,"h3",49),n(5,"Nenhum quadro encontrado"),i(),e(6,"p",50),n(7," Voc\xEA ainda n\xE3o possui quadros Kanban. Crie seu primeiro quadro para come\xE7ar! "),i(),e(8,"button",51),u("click",function(){p(t);let d=c();return f(d.showCreateBoardModal())}),s(9,"i",20),n(10," Criar Meu Primeiro Quadro "),i()()()}}function ne(a,o){if(a&1){let t=y();e(0,"div",54),u("click",function(){let d=p(t).$implicit,g=c(2);return f(g.openBoard(d.id))}),e(1,"div",55)(2,"div",56)(3,"h3",57),n(4),i(),e(5,"div",58),s(6,"i",59),i()(),e(7,"p",60),n(8),i(),e(9,"div",61)(10,"div",4),s(11,"i",62),e(12,"span"),n(13),i()(),e(14,"div",4),s(15,"div",63),e(16,"span"),n(17,"Ativo"),i()()()(),e(18,"div",64)(19,"div",65)(20,"div",66),s(21,"i",67),e(22,"span"),n(23,"Quadro Kanban"),i()(),e(24,"button",68),n(25," Abrir \u2192 "),i()()()()}if(a&2){let t=o.$implicit,r=c(2);l(4),h(" ",t.name," "),l(4),h(" ",t.description||"Sem descri\xE7\xE3o"," "),l(5),h("Criado em ",r.formatDate(t.createdAt))}}function oe(a,o){if(a&1&&(e(0,"div",52),x(1,ne,26,3,"div",53),i()),a&2){let t=c();l(),m("ngForOf",t.boards)}}function ae(a,o){if(a&1&&(e(0,"div",69)(1,"h3",70),n(2,"Estat\xEDsticas R\xE1pidas"),i(),e(3,"div",71)(4,"div",72)(5,"div",4)(6,"div",58)(7,"div",73),s(8,"i",74),i()(),e(9,"div",75)(10,"h4",76),n(11),i(),e(12,"p",77),n(13,"Quadros Ativos"),i()()()(),e(14,"div",72)(15,"div",4)(16,"div",58)(17,"div",78),s(18,"i",79),i()(),e(19,"div",75)(20,"h4",76),n(21,"-"),i(),e(22,"p",77),n(23,"Total de Leads"),i()()()(),e(24,"div",72)(25,"div",4)(26,"div",58)(27,"div",80),s(28,"i",81),i()(),e(29,"div",75)(30,"h4",76),n(31,"-"),i(),e(32,"p",77),n(33,"Taxa de Convers\xE3o"),i()()()()()()),a&2){let t=c();l(11),k(t.boards.length)}}var J=class a{authService=b(E);firestoreService=b(M);subdomainService=b(K);router=b(j);createBoardModal;boards=[];isLoading=!1;currentUser=null;showConfigMenu=!1;subscription;ngOnInit(){return v(this,null,function*(){this.currentUser=this.authService.getCurrentUser(),this.currentUser&&(this.currentUser.email?.includes("gobuyer.com.br")&&(yield this.ensureGobuyerContext()),yield this.loadBoards())})}ensureGobuyerContext(){return v(this,null,function*(){try{this.subdomainService.getCurrentCompany()||(this.subdomainService.isDevelopment()&&localStorage.setItem("dev-subdomain","gobuyer"),yield this.subdomainService.initializeFromSubdomain())}catch{}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}loadBoards(){return v(this,null,function*(){if(this.currentUser){this.isLoading=!0;try{this.boards=yield this.firestoreService.getBoards(this.currentUser.uid)}catch{}finally{this.isLoading=!1}}})}logout(){return v(this,null,function*(){(yield this.authService.logout()).success&&(window.location.href="/login")})}openBoard(o){let t=this.boards.find(r=>r.id===o);t&&t.owner?this.router.navigate(["/kanban",o],{queryParams:{ownerId:t.owner}}):this.router.navigate(["/kanban",o],{queryParams:{ownerId:this.currentUser.uid}})}formatDate(o){return o?o.seconds?new Date(o.seconds*1e3).toLocaleDateString("pt-BR"):new Date(o).toLocaleDateString("pt-BR"):""}showCreateBoardModal(){this.createBoardModal.show()}onBoardCreated(){this.loadBoards()}toggleConfigMenu(){this.showConfigMenu=!this.showConfigMenu}closeConfigMenu(){this.showConfigMenu=!1}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=C({type:a,selectors:[["app-dashboard"]],viewQuery:function(t,r){if(t&1&&T(_,5),t&2){let d;V(d=L())&&(r.createBoardModal=d.first)}},decls:45,vars:9,consts:[[1,"min-h-screen","bg-gray-100"],[1,"bg-white","shadow-sm","border-b","border-gray-200"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"flex","justify-between","items-center","h-16"],[1,"flex","items-center"],["src","https://apps.gobuyer.com.br/sso/assets/images/logos/logo-gobuyer.png","alt","Logo GoBuyer",1,"h-8","mr-4"],[1,"text-2xl","font-bold","text-gray-900"],[1,"flex","items-center","space-x-4"],[1,"hidden","md:flex","items-center","space-x-4"],["href","/dashboard",1,"text-gray-700","hover:text-blue-600","px-3","py-2","rounded-md","text-sm","font-medium","transition-colors"],[1,"fas","fa-th-large","mr-1"],["href","/usuarios",1,"text-gray-700","hover:text-blue-600","px-3","py-2","rounded-md","text-sm","font-medium","transition-colors"],[1,"fas","fa-users","mr-1"],[1,"relative"],[1,"text-gray-700","hover:text-blue-600","px-3","py-2","rounded-md","text-sm","font-medium","transition-colors","flex","items-center",3,"click"],[1,"fas","fa-cog","mr-1"],[1,"fas","fa-chevron-down","ml-1","text-xs"],["class","absolute right-0 mt-2 w-56 bg-white rounded-md shadow-lg border border-gray-200 z-50",4,"ngIf"],[1,"h-6","border-l","border-gray-300"],[1,"bg-blue-500","hover:bg-blue-600","text-white","px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors","flex","items-center",3,"click"],[1,"fas","fa-plus","mr-2"],[1,"flex","items-center","space-x-2"],[1,"w-8","h-8","bg-blue-500","rounded-full","flex","items-center","justify-center","text-white","text-sm","font-bold"],[1,"text-sm","text-gray-700","hidden","sm:block"],[1,"text-gray-500","hover:text-gray-700","px-3","py-2","rounded-md","text-sm","font-medium","transition-colors",3,"click"],[1,"fas","fa-sign-out-alt","mr-1"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"mb-8"],[1,"text-3xl","font-bold","text-gray-900","mb-2"],[1,"text-gray-600"],["class","flex justify-center items-center py-12",4,"ngIf"],["class","text-center py-12",4,"ngIf"],["class","grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",4,"ngIf"],["class","mt-12",4,"ngIf"],[3,"boardCreated","closeModal"],[1,"absolute","right-0","mt-2","w-56","bg-white","rounded-md","shadow-lg","border","border-gray-200","z-50"],[1,"py-1"],["href","/empresa/branding",1,"flex","items-center","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100","transition-colors"],[1,"fas","fa-palette","mr-3","w-4"],["href","/empresa/smtp",1,"flex","items-center","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100","transition-colors"],[1,"fas","fa-envelope","mr-3","w-4"],["href","/empresa/integracoes",1,"flex","items-center","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100","transition-colors"],[1,"fas","fa-plug","mr-3","w-4"],[1,"flex","justify-center","items-center","py-12"],[1,"animate-spin","rounded-full","h-12","w-12","border-b-2","border-blue-500"],[1,"text-center","py-12"],[1,"max-w-md","mx-auto"],[1,"mb-4"],[1,"fas","fa-clipboard-list","text-6xl","text-gray-300"],[1,"text-xl","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600","mb-6"],[1,"bg-blue-500","hover:bg-blue-600","text-white","px-6","py-3","rounded-lg","font-medium","transition-colors","inline-flex","items-center",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],["class","bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow cursor-pointer border border-gray-200 overflow-hidden",3,"click",4,"ngFor","ngForOf"],[1,"bg-white","rounded-lg","shadow-sm","hover:shadow-md","transition-shadow","cursor-pointer","border","border-gray-200","overflow-hidden",3,"click"],[1,"p-6"],[1,"flex","items-start","justify-between","mb-4"],[1,"text-lg","font-semibold","text-gray-900","truncate"],[1,"flex-shrink-0"],[1,"fas","fa-arrow-right","text-gray-400","hover:text-blue-500","transition-colors"],[1,"text-gray-600","text-sm","mb-4","line-clamp-2"],[1,"flex","items-center","justify-between","text-xs","text-gray-500"],[1,"far","fa-calendar-alt","mr-1"],[1,"w-2","h-2","bg-green-500","rounded-full","mr-1"],[1,"bg-gray-50","px-6","py-3","border-t","border-gray-100"],[1,"flex","items-center","justify-between"],[1,"flex","items-center","text-xs","text-gray-500"],[1,"fas","fa-chart-bar","mr-1"],[1,"text-blue-500","hover:text-blue-600","text-xs","font-medium","transition-colors"],[1,"mt-12"],[1,"text-xl","font-semibold","text-gray-900","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-6"],[1,"bg-white","rounded-lg","shadow-sm","p-6","border","border-gray-200"],[1,"w-8","h-8","bg-blue-500","rounded-lg","flex","items-center","justify-center"],[1,"fas","fa-clipboard-list","text-white","text-sm"],[1,"ml-4"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"w-8","h-8","bg-green-500","rounded-lg","flex","items-center","justify-center"],[1,"fas","fa-chart-line","text-white","text-sm"],[1,"w-8","h-8","bg-purple-500","rounded-lg","flex","items-center","justify-center"],[1,"fas","fa-trophy","text-white","text-sm"]],template:function(t,r){t&1&&(e(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"div",4),s(5,"img",5),e(6,"h1",6),n(7,"Sistema Kanban"),i()(),e(8,"div",7)(9,"nav",8)(10,"a",9),s(11,"i",10),n(12," Quadros "),i(),e(13,"a",11),s(14,"i",12),n(15," Usu\xE1rios "),i(),e(16,"div",13)(17,"button",14),u("click",function(){return r.toggleConfigMenu()}),s(18,"i",15),n(19," Configura\xE7\xF5es "),s(20,"i",16),i(),x(21,te,11,0,"div",17),i()(),s(22,"div",18),e(23,"button",19),u("click",function(){return r.showCreateBoardModal()}),s(24,"i",20),n(25," Novo Quadro "),i(),e(26,"div",21)(27,"div",22),n(28),i(),e(29,"span",23),n(30),i()(),e(31,"button",24),u("click",function(){return r.logout()}),s(32,"i",25),n(33," Sair "),i()()()()(),e(34,"main",26)(35,"div",27)(36,"h2",28),n(37,"Meus Quadros Kanban"),i(),e(38,"p",29),n(39,"Gerencie seus projetos e leads de forma eficiente"),i()(),x(40,ie,2,0,"div",30)(41,re,11,0,"div",31)(42,oe,2,1,"div",32)(43,ae,34,1,"div",33),i(),e(44,"app-create-board-modal",34),u("boardCreated",function(){return r.onBoardCreated()})("closeModal",function(){return r.onBoardCreated()}),i()()),t&2&&(l(16),U("show",r.showConfigMenu),l(5),m("ngIf",r.showConfigMenu),l(7),h(" ",(r.currentUser==null||r.currentUser.displayName==null?null:r.currentUser.displayName.charAt(0))||(r.currentUser==null||r.currentUser.email==null?null:r.currentUser.email.charAt(0))||"U"," "),l(2),k((r.currentUser==null?null:r.currentUser.displayName)||(r.currentUser==null?null:r.currentUser.email)),l(10),m("ngIf",r.isLoading),l(),m("ngIf",!r.isLoading&&r.boards.length===0),l(),m("ngIf",!r.isLoading&&r.boards.length>0),l(),m("ngIf",!r.isLoading&&r.boards.length>0))},dependencies:[S,P,w,_],styles:[".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}"]})};export{J as DashboardComponent};
