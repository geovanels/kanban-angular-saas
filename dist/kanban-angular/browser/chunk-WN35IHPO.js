import{Ea as od,_ as Ut,a as U,b as ne,ba as qn,da as de,e as Ft,ea as jn,f as m,ha as sd,i as fn,ia as es,lb as ot,n as nd,na as je,o as rd,r as Zi,s as aa,t as ca,tc as ad,uc as cd,va as ts,vc as ua,wa as ze,z as id}from"./chunk-WVXLNUB3.js";var ud=()=>{};var dd=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},gy=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],c=n[t++],l=((i&7)<<18|(s&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},ns={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,c=a?n[i+1]:0,l=i+2<n.length,d=l?n[i+2]:0,p=s>>2,y=(s&3)<<4|c>>4,_=(c&15)<<2|d>>6,C=d&63;l||(C=64,a||(_=64)),r.push(t[p],t[y],t[_],t[C])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(dd(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):gy(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let y=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||d==null||y==null)throw new ha;let _=s<<2|c>>4;if(r.push(_),d!==64){let C=c<<4&240|d>>2;if(r.push(C),y!==64){let k=d<<6&192|y;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},ha=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},yy=function(n){let e=dd(n);return ns.encodeByteArray(e,!0)},Hr=function(n){return yy(n).replace(/\./g,"")},rs=function(n){try{return ns.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function fa(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var _y=()=>fa().__FIREBASE_DEFAULTS__,vy=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Iy=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&rs(n[1]);return e&&JSON.parse(e)},is=()=>{try{return ud()||_y()||vy()||Iy()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},pa=n=>{var e,t;return(t=(e=is())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},fd=n=>{let e=pa(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},ma=()=>{var n;return(n=is())===null||n===void 0?void 0:n.config},ga=n=>{var e;return(e=is())===null||e===void 0?void 0:e[`_${n}`]};var pn=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function $t(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}function ss(n){return m(this,null,function*(){return(yield fetch(n,{credentials:"include"})).ok})}function pd(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Hr(JSON.stringify(t)),Hr(JSON.stringify(a)),""].join(".")}var Gr={};function wy(){let n={prod:[],emulator:[]};for(let e of Object.keys(Gr))Gr[e]?n.emulator.push(e):n.prod.push(e);return n}function Ey(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var ld=!1;function os(n,e){if(typeof window>"u"||typeof document>"u"||!$t(window.location.host)||Gr[n]===e||Gr[n]||ld)return;Gr[n]=e;function t(_){return`__firebase__banner__${_}`}let r="__firebase__banner",s=wy().prod.length>0;function a(){let _=document.getElementById(r);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function l(_,C){_.setAttribute("width","24"),_.setAttribute("id",C),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function d(){let _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{ld=!0,a()},_}function p(_,C){_.setAttribute("id",C),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function y(){let _=Ey(r),C=t("text"),k=document.getElementById(C)||document.createElement("span"),x=t("learnmore"),D=document.getElementById(x)||document.createElement("a"),z=t("preprendIcon"),$=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){let W=_.element;c(W),p(D,x);let ee=d();l($,z),W.append($,k,D,ee),document.body.appendChild(W)}s?(k.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",C)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}function Ie(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function md(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ie())}function Ty(){var n;let e=(n=is())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function gd(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function yd(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function _d(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function vd(){let n=Ie();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Id(){return!Ty()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Kr(){try{return typeof indexedDB=="object"}catch{return!1}}function wd(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var by="FirebaseError",Ue=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=by,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ye.prototype.create)}},Ye=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?Ay(s,r):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new Ue(i,c,r)}};function Ay(n,e){return n.replace(Sy,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Sy=/\{\$([^}]+)}/g;function Ed(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function at(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(hd(s)&&hd(a)){if(!at(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function hd(n){return n!==null&&typeof n=="object"}function zn(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Wn(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Gn(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Td(n,e){let t=new da(n,e);return t.subscribe.bind(t)}var da=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Cy(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=la),i.error===void 0&&(i.error=la),i.complete===void 0&&(i.complete=la);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Cy(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function la(){}var QT=14400*1e3;function oe(n){return n&&n._delegate?n._delegate:n}var xe=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var mn="[DEFAULT]";var ya=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new pn;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Py(e))try{this.getOrInitializeService({instanceIdentifier:mn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=mn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return m(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=mn){return this.instances.has(e)}getOptions(e=mn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Ry(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=mn){return this.component?this.component.multipleInstances?e:mn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Ry(n){return n===mn?void 0:n}function Py(n){return n.instantiationMode==="EAGER"}var as=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new ya(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var ky=[],H=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(H||{}),Dy={debug:H.DEBUG,verbose:H.VERBOSE,info:H.INFO,warn:H.WARN,error:H.ERROR,silent:H.SILENT},Ny=H.INFO,Oy={[H.DEBUG]:"log",[H.VERBOSE]:"log",[H.INFO]:"info",[H.WARN]:"warn",[H.ERROR]:"error"},xy=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Oy[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ct=class{constructor(e){this.name=e,this._logLevel=Ny,this._logHandler=xy,this._userLogHandler=null,ky.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in H))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Dy[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,H.DEBUG,...e),this._logHandler(this,H.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,H.VERBOSE,...e),this._logHandler(this,H.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,H.INFO,...e),this._logHandler(this,H.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,H.WARN,...e),this._logHandler(this,H.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,H.ERROR,...e),this._logHandler(this,H.ERROR,...e)}};var Vy=(n,e)=>e.some(t=>n instanceof t),bd,Ad;function Ly(){return bd||(bd=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function My(){return Ad||(Ad=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Sd=new WeakMap,va=new WeakMap,Cd=new WeakMap,_a=new WeakMap,wa=new WeakMap;function Fy(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(ut(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&Sd.set(t,n)}).catch(()=>{}),wa.set(e,n),e}function Uy(n){if(va.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});va.set(n,e)}var Ia={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return va.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Cd.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ut(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Rd(n){Ia=n(Ia)}function $y(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(cs(this),e,...t);return Cd.set(r,e.sort?e.sort():[e]),ut(r)}:My().includes(n)?function(...e){return n.apply(cs(this),e),ut(Sd.get(this))}:function(...e){return ut(n.apply(cs(this),e))}}function By(n){return typeof n=="function"?$y(n):(n instanceof IDBTransaction&&Uy(n),Vy(n,Ly())?new Proxy(n,Ia):n)}function ut(n){if(n instanceof IDBRequest)return Fy(n);if(_a.has(n))return _a.get(n);let e=By(n);return e!==n&&(_a.set(n,e),wa.set(e,n)),e}var cs=n=>wa.get(n);function kd(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),c=ut(a);return r&&a.addEventListener("upgradeneeded",l=>{r(ut(a.result),l.oldVersion,l.newVersion,ut(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),c.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}var qy=["get","getKey","getAll","getAllKeys","count"],jy=["put","add","delete","clear"],Ea=new Map;function Pd(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Ea.get(e))return Ea.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=jy.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||qy.includes(t)))return;let s=function(a,...c){return m(this,null,function*(){let l=this.transaction(a,i?"readwrite":"readonly"),d=l.store;return r&&(d=d.index(c.shift())),(yield Promise.all([d[t](...c),i&&l.done]))[0]})};return Ea.set(e,s),s}Rd(n=>ne(U({},n),{get:(e,t,r)=>Pd(e,t)||n.get(e,t,r),has:(e,t)=>!!Pd(e,t)||n.has(e,t)}));var ba=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(zy(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function zy(n){let e=n.getComponent();return e?.type==="VERSION"}var Aa="@firebase/app",Dd="0.13.2";var It=new ct("@firebase/app"),Wy="@firebase/app-compat",Gy="@firebase/analytics-compat",Hy="@firebase/analytics",Ky="@firebase/app-check-compat",Qy="@firebase/app-check",Yy="@firebase/auth",Jy="@firebase/auth-compat",Xy="@firebase/database",Zy="@firebase/data-connect",e_="@firebase/database-compat",t_="@firebase/functions",n_="@firebase/functions-compat",r_="@firebase/installations",i_="@firebase/installations-compat",s_="@firebase/messaging",o_="@firebase/messaging-compat",a_="@firebase/performance",c_="@firebase/performance-compat",u_="@firebase/remote-config",l_="@firebase/remote-config-compat",h_="@firebase/storage",d_="@firebase/storage-compat",f_="@firebase/firestore",p_="@firebase/ai",m_="@firebase/firestore-compat",g_="firebase",y_="11.10.0";var Sa="[DEFAULT]",__={[Aa]:"fire-core",[Wy]:"fire-core-compat",[Hy]:"fire-analytics",[Gy]:"fire-analytics-compat",[Qy]:"fire-app-check",[Ky]:"fire-app-check-compat",[Yy]:"fire-auth",[Jy]:"fire-auth-compat",[Xy]:"fire-rtdb",[Zy]:"fire-data-connect",[e_]:"fire-rtdb-compat",[t_]:"fire-fn",[n_]:"fire-fn-compat",[r_]:"fire-iid",[i_]:"fire-iid-compat",[s_]:"fire-fcm",[o_]:"fire-fcm-compat",[a_]:"fire-perf",[c_]:"fire-perf-compat",[u_]:"fire-rc",[l_]:"fire-rc-compat",[h_]:"fire-gcs",[d_]:"fire-gcs-compat",[f_]:"fire-fst",[m_]:"fire-fst-compat",[p_]:"fire-vertex","fire-js":"fire-js",[g_]:"fire-js-all"};var Qr=new Map,v_=new Map,Ca=new Map;function Nd(n,e){try{n.container.addComponent(e)}catch(t){It.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Je(n){let e=n.name;if(Ca.has(e))return It.debug(`There were multiple attempts to register component ${e}.`),!1;Ca.set(e,n);for(let t of Qr.values())Nd(t,n);for(let t of v_.values())Nd(t,n);return!0}function Hn(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ve(n){return n==null?!1:n.settings!==void 0}var I_={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Bt=new Ye("app","Firebase",I_);var Ra=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new xe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Bt.create("app-deleted",{appName:this._name})}};var qt=y_;function Da(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Sa,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw Bt.create("bad-app-name",{appName:String(i)});if(t||(t=ma()),!t)throw Bt.create("no-options");let s=Qr.get(i);if(s){if(at(t,s.options)&&at(r,s.config))return s;throw Bt.create("duplicate-app",{appName:i})}let a=new as(i);for(let l of Ca.values())a.addComponent(l);let c=new Ra(t,r,a);return Qr.set(i,c),c}function gn(n=Sa){let e=Qr.get(n);if(!e&&n===Sa&&ma())return Da();if(!e)throw Bt.create("no-app",{appName:n});return e}function us(){return Array.from(Qr.values())}function le(n,e,t){var r;let i=(r=__[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let c=[`Unable to register library "${i}" with version "${e}":`];s&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),It.warn(c.join(" "));return}Je(new xe(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var w_="firebase-heartbeat-database",E_=1,Yr="firebase-heartbeat-store",Ta=null;function Ld(){return Ta||(Ta=kd(w_,E_,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Yr)}catch(t){console.warn(t)}}}}).catch(n=>{throw Bt.create("idb-open",{originalErrorMessage:n.message})})),Ta}function T_(n){return m(this,null,function*(){try{let t=(yield Ld()).transaction(Yr),r=yield t.objectStore(Yr).get(Md(n));return yield t.done,r}catch(e){if(e instanceof Ue)It.warn(e.message);else{let t=Bt.create("idb-get",{originalErrorMessage:e?.message});It.warn(t.message)}}})}function Od(n,e){return m(this,null,function*(){try{let r=(yield Ld()).transaction(Yr,"readwrite");yield r.objectStore(Yr).put(e,Md(n)),yield r.done}catch(t){if(t instanceof Ue)It.warn(t.message);else{let r=Bt.create("idb-set",{originalErrorMessage:t?.message});It.warn(r.message)}}})}function Md(n){return`${n.name}!${n.options.appId}`}var b_=1024,A_=30,Pa=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new ka(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return m(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=xd();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>A_){let a=C_(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){It.warn(r)}})}getHeartbeatsHeader(){return m(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=xd(),{heartbeatsToSend:r,unsentEntries:i}=S_(this._heartbeatsCache.heartbeats),s=Hr(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return It.warn(t),""}})}};function xd(){return new Date().toISOString().substring(0,10)}function S_(n,e=b_){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Vd(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Vd(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var ka=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return m(this,null,function*(){return Kr()?wd().then(()=>!0).catch(()=>!1):!1})}read(){return m(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield T_(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return m(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Od(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return m(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Od(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Vd(n){return Hr(JSON.stringify({version:2,heartbeats:n})).length}function C_(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function R_(n){Je(new xe("platform-logger",e=>new ba(e),"PRIVATE")),Je(new xe("heartbeat",e=>new Pa(e),"PRIVATE")),le(Aa,Dd,n),le(Aa,Dd,"esm2017"),le("fire-js","")}R_("");var P_="firebase",k_="11.10.0";le(P_,k_,"app");function Fd(n){n===void 0&&(n=de(je));let e=n.get(ts);return t=>new fn(r=>{let i=e.add(),s=!1;function a(){s||(i(),s=!0)}let c=t.subscribe({next:l=>{r.next(l),a()},complete:()=>{r.complete(),a()},error:l=>{r.error(l),a()}});return c.add(()=>{r.unsubscribe(),a()}),c})}var jt=new ad("ANGULARFIRE2_VERSION");function Jr(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Qn=(n,e)=>{let t=e?[e]:us(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},Kn=(function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n})(Kn||{}),Ud=ua()&&typeof Zone<"u"?Kn.WARN:Kn.SILENT;var ls=class{zone;delegate;constructor(e,t=rd){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i?i.runGuarded(()=>{e.apply(this,[a])}):e.apply(this,[a])};return this.delegate.schedule(s,t,r)}},zt=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=de(ot);this.outsideAngular=t.runOutsideAngular(()=>new ls(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new ls(typeof Zone>"u"?void 0:Zone.current,nd))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),$d=!1;function D_(n,e){!$d&&(Ud>Kn.SILENT||ua())&&($d=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),Ud>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function N_(n){let e=de(ot,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function yn(n){let e=de(ot,{optional:!0});return e?e.run(()=>n()):n()}var O_=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),es(t,()=>yn(()=>n.apply(void 0,r)))),re=(n,e,t)=>(t||=e?Kn.WARN:Kn.VERBOSE,function(){let r,i=arguments,s,a,c;try{s=de(zt),a=de(ts),c=de(sd)}catch{return D_(n,t),n.apply(this,i)}for(let d=0;d<arguments.length;d++)typeof i[d]=="function"&&(e&&(r||=yn(()=>a.add())),i[d]=O_(i[d],r,c));let l=N_(()=>n.apply(this,i));return e?l instanceof fn?l.pipe(ca(s.outsideAngular),aa(s.insideAngular),Fd(c)):l instanceof Promise?yn(()=>{let d=a.add();return new Promise((p,y)=>{l.then(_=>es(c,()=>yn(()=>p(_))),_=>es(c,()=>yn(()=>y(_)))).finally(d)})}):typeof l=="function"&&r?function(){return setTimeout(r,0),l.apply(this,arguments)}:yn(()=>l):l instanceof fn?l.pipe(ca(s.outsideAngular),aa(s.insideAngular)):yn(()=>l)});var wt=class{constructor(e){return e}},_n=class{constructor(){return us()}};function x_(n){return n&&n.length===1?n[0]:new wt(gn())}var Oa=new qn("angularfire2._apps"),V_={provide:wt,useFactory:x_,deps:[[new ze,Oa]]},L_={provide:_n,deps:[[new ze,Oa]]};function M_(n){return(e,t)=>{let r=t.get(od);le("angularfire",jt.full,"core"),le("angularfire",jt.full,"app"),le("angular",cd.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new wt(i)}}function Hb(n,...e){return jn([V_,L_,{provide:Oa,useFactory:M_(n),multi:!0,deps:[ot,je,zt,...e]}])}var Kb=re(Da,!0);var F_=new Map,U_={activated:!1,tokenObservers:[]},$_={initialized:!1,enabled:!1};function Xe(n){return F_.get(n)||Object.assign({},U_)}function zd(){return $_}var B_="https://content-firebaseappcheck.googleapis.com/v1";var q_="exchangeDebugToken",Bd={OFFSET_DURATION:300*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:960*1e3},rA=1440*60*1e3;var La=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return m(this,null,function*(){this.stop();try{this.pending=new pn,this.pending.promise.catch(t=>{}),yield j_(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new pn,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function j_(n){return new Promise(e=>{setTimeout(e,n)})}var z_={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},Wt=new Ye("appCheck","AppCheck",z_);function Wd(n){if(!Xe(n).activated)throw Wt.create("use-before-activation",{appName:n.name})}function Gd(r,i){return m(this,arguments,function*({url:n,body:e},t){let s={"Content-Type":"application/json"},a=t.getImmediate({optional:!0});if(a){let C=yield a.getHeartbeatsHeader();C&&(s["X-Firebase-Client"]=C)}let c={method:"POST",body:JSON.stringify(e),headers:s},l;try{l=yield fetch(n,c)}catch(C){throw Wt.create("fetch-network-error",{originalErrorMessage:C?.message})}if(l.status!==200)throw Wt.create("fetch-status-error",{httpStatus:l.status});let d;try{d=yield l.json()}catch(C){throw Wt.create("fetch-parse-error",{originalErrorMessage:C?.message})}let p=d.ttl.match(/^([\d.]+)(s)$/);if(!p||!p[2]||isNaN(Number(p[1])))throw Wt.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let y=Number(p[1])*1e3,_=Date.now();return{token:d.token,expireTimeMillis:_+y,issuedAtTimeMillis:_}})}function Hd(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${B_}/projects/${t}/apps/${r}:${q_}?key=${i}`,body:{debug_token:e}}}var W_="firebase-app-check-database",G_=1,Ma="firebase-app-check-store";var hs=null;function H_(){return hs||(hs=new Promise((n,e)=>{try{let t=indexedDB.open(W_,G_);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Wt.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Ma,{keyPath:"compositeKey"})}}}catch(t){e(Wt.create("storage-open",{originalErrorMessage:t?.message}))}}),hs)}function K_(n,e){return Q_(Y_(n),e)}function Q_(n,e){return m(this,null,function*(){let r=(yield H_()).transaction(Ma,"readwrite"),s=r.objectStore(Ma).put({compositeKey:n,value:e});return new Promise((a,c)=>{s.onsuccess=l=>{a()},r.onerror=l=>{var d;c(Wt.create("storage-set",{originalErrorMessage:(d=l.target.error)===null||d===void 0?void 0:d.message}))}})})}function Y_(n){return`${n.options.appId}-${n.name}`}var Xr=new ct("@firebase/app-check");function xa(n,e){return Kr()?K_(n,e).catch(t=>{Xr.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Kd(){return zd().enabled}function Qd(){return m(this,null,function*(){let n=zd();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var J_={error:"UNKNOWN_ERROR"};function X_(n){return ns.encodeString(JSON.stringify(n),!1)}function Fa(n,e=!1,t=!1){return m(this,null,function*(){let r=n.app;Wd(r);let i=Xe(r),s=i.token,a;if(s&&!Zr(s)&&(i.token=void 0,s=void 0),!s){let d=yield i.cachedTokenPromise;d&&(Zr(d)?s=d:yield xa(r,void 0))}if(!e&&s&&Zr(s))return{token:s.token};let c=!1;if(Kd())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=Gd(Hd(r,yield Qd()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),c=!0);let d=yield i.exchangeTokenPromise;return yield xa(r,d),i.token=d,{token:d.token}}catch(d){return d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?Xr.warn(d.message):t&&Xr.error(d),Va(d)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),c=!0),s=yield Xe(r).exchangeTokenPromise}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?Xr.warn(d.message):t&&Xr.error(d),a=d}let l;return s?a?Zr(s)?l={token:s.token,internalError:a}:l=Va(a):(l={token:s.token},i.token=s,yield xa(r,s)):l=Va(a),c&&nv(r,l),l})}function Z_(n){return m(this,null,function*(){let e=n.app;Wd(e);let{provider:t}=Xe(e);if(Kd()){let r=yield Qd(),{token:i}=yield Gd(Hd(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function ev(n,e,t,r){let{app:i}=n,s=Xe(i),a={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,a],s.token&&Zr(s.token)){let c=s.token;Promise.resolve().then(()=>{t({token:c.token}),qd(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>qd(n))}function Yd(n,e){let t=Xe(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function qd(n){let{app:e}=n,t=Xe(e),r=t.tokenRefresher;r||(r=tv(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function tv(n){let{app:e}=n;return new La(()=>m(null,null,function*(){let t=Xe(e),r;if(t.token?r=yield Fa(n,!0):r=yield Fa(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=Xe(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-300*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Bd.RETRIAL_MIN_WAIT,Bd.RETRIAL_MAX_WAIT)}function nv(n,e){let t=Xe(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Zr(n){return n.expireTimeMillis-Date.now()>0}function Va(n){return{token:X_(J_),error:n}}var Ua=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Xe(this.app);for(let t of e)Yd(this.app,t.next);return Promise.resolve()}};function rv(n,e){return new Ua(n,e)}function iv(n){return{getToken:e=>Fa(n,e),getLimitedUseToken:()=>Z_(n),addTokenListener:e=>ev(n,"INTERNAL",e),removeTokenListener:e=>Yd(n.app,e)}}var sv="@firebase/app-check",ov="0.10.1";var av="app-check",jd="app-check-internal";function cv(){Je(new xe(av,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return rv(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(jd).initialize()})),Je(new xe(jd,n=>{let e=n.getProvider("app-check").getImmediate();return iv(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),le(sv,ov)}cv();var uv="app-check";var Yn=class{constructor(){return Qn(uv)}};var lv=["localhost","0.0.0.0","127.0.0.1"],gA=typeof window<"u"&&lv.includes(window.location.hostname);function ff(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var pf=ff,mf=new Ye("auth","Firebase",ff());var ys=new ct("@firebase/auth");function hv(n,...e){ys.logLevel<=H.WARN&&ys.warn(`Auth (${qt}): ${n}`,...e)}function fs(n,...e){ys.logLevel<=H.ERROR&&ys.error(`Auth (${qt}): ${n}`,...e)}function We(n,...e){throw cc(n,...e)}function Ze(n,...e){return cc(n,...e)}function ac(n,e,t){let r=Object.assign(Object.assign({},pf()),{[e]:t});return new Ye("auth","Firebase",r).create(e,{appName:n.name})}function bt(n){return ac(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function dv(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&We(n,"argument-error"),ac(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function cc(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return mf.create(n,...e)}function F(n,e,...t){if(!n)throw cc(e,...t)}function Et(n){let e="INTERNAL ASSERTION FAILED: "+n;throw fs(e),new Error(e)}function At(n,e){n||Et(e)}function qa(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function fv(){return Jd()==="http:"||Jd()==="https:"}function Jd(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function pv(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(fv()||yd()||"connection"in navigator)?navigator.onLine:!0}function mv(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var vn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,At(t>e,"Short delay should be less than long delay!"),this.isMobile=md()||_d()}get(){return pv()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function uc(n,e){At(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var _s=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Et("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Et("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Et("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var gv={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var yv=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],_v=new vn(3e4,6e4);function Kt(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function St(s,a,c,l){return m(this,arguments,function*(n,e,t,r,i={}){return gf(n,i,()=>m(null,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let y=zn(Object.assign({key:n.config.apiKey},p)).slice(1),_=yield n._getAdditionalHeaders();_["Content-Type"]="application/json",n.languageCode&&(_["X-Firebase-Locale"]=n.languageCode);let C=Object.assign({method:e,headers:_},d);return gd()||(C.referrerPolicy="no-referrer"),n.emulatorConfig&&$t(n.emulatorConfig.host)&&(C.credentials="include"),_s.fetch()(yield yf(n,n.config.apiHost,t,y),C)}))})}function gf(n,e,t){return m(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},gv),e);try{let i=new ja(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw ds(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let c=s.ok?a.errorMessage:a.error.message,[l,d]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ds(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw ds(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw ds(n,"user-disabled",a);let p=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw ac(n,p,d);We(n,p)}}catch(i){if(i instanceof Ue)throw i;We(n,"network-request-failed",{message:String(i)})}})}function ai(s,a,c,l){return m(this,arguments,function*(n,e,t,r,i={}){let d=yield St(n,e,t,r,i);return"mfaPendingCredential"in d&&We(n,"multi-factor-auth-required",{_serverResponse:d}),d})}function yf(n,e,t,r){return m(this,null,function*(){let i=`${e}${t}?${r}`,s=n,a=s.config.emulator?uc(n.config,i):`${n.config.apiScheme}://${i}`;return yv.includes(t)&&(yield s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a})}function vv(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var ja=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Ze(this.auth,"network-request-failed")),_v.get())})}};function ds(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=Ze(n,e,r);return i.customData._tokenResponse=t,i}function Xd(n){return n!==void 0&&n.enterprise!==void 0}var za=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return vv(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};function Iv(n,e){return m(this,null,function*(){return St(n,"GET","/v2/recaptchaConfig",Kt(n,e))})}function wv(n,e){return m(this,null,function*(){return St(n,"POST","/v1/accounts:delete",e)})}function vs(n,e){return m(this,null,function*(){return St(n,"POST","/v1/accounts:lookup",e)})}function ti(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function lc(n,e=!1){return m(this,null,function*(){let t=oe(n),r=yield t.getIdToken(e),i=hc(r);F(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:ti($a(i.auth_time)),issuedAtTime:ti($a(i.iat)),expirationTime:ti($a(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function $a(n){return Number(n)*1e3}function hc(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return fs("JWT malformed, contained fewer than 3 sections"),null;try{let i=rs(t);return i?JSON.parse(i):(fs("Failed to decode base64 JWT payload"),null)}catch(i){return fs("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Zd(n){let e=hc(n);return F(e,"internal-error"),F(typeof e.exp<"u","internal-error"),F(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Xn(n,e,t=!1){return m(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Ue&&Ev(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function Ev({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Wa=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>m(this,null,function*(){yield this.iteration()}),t)}iteration(){return m(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var ri=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ti(this.lastLoginAt),this.creationTime=ti(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Is(n){return m(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Xn(n,vs(t,{idToken:r}));F(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?_f(s.providerUserInfo):[],c=Tv(n.providerData,a),l=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!c?.length,p=l?d:!1,y={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new ri(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,y)})}function dc(n){return m(this,null,function*(){let e=oe(n);yield Is(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function Tv(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function _f(n){return n.map(e=>{var{providerId:t}=e,r=Zi(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function bv(n,e){return m(this,null,function*(){let t=yield gf(n,{},()=>m(null,null,function*(){let r=zn({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=yield yf(n,i,"/v1/token",`key=${s}`),c=yield n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";let l={method:"POST",headers:c,body:r};return n.emulatorConfig&&$t(n.emulatorConfig.host)&&(l.credentials="include"),_s.fetch()(a,l)}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function Av(n,e){return m(this,null,function*(){return St(n,"POST","/v2/accounts:revokeToken",Kt(n,e))})}var ni=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){F(e.idToken,"internal-error"),F(typeof e.idToken<"u","internal-error"),F(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Zd(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){F(e.length!==0,"internal-error");let t=Zd(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return m(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(F(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return m(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield bv(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&(F(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(F(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(F(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Et("not implemented")}};function Gt(n,e){F(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Ht=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Zi(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Wa(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ri(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return m(this,null,function*(){let t=yield Xn(this,this.stsTokenManager.getToken(this.auth,e));return F(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return lc(this,e)}reload(){return dc(this)}_assign(e){this!==e&&(F(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){F(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return m(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Is(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return m(this,null,function*(){if(Ve(this.auth.app))return Promise.reject(bt(this.auth));let e=yield this.getIdToken();return yield Xn(this,wv(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,c,l,d,p;let y=(r=t.displayName)!==null&&r!==void 0?r:void 0,_=(i=t.email)!==null&&i!==void 0?i:void 0,C=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,k=(a=t.photoURL)!==null&&a!==void 0?a:void 0,x=(c=t.tenantId)!==null&&c!==void 0?c:void 0,D=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,z=(d=t.createdAt)!==null&&d!==void 0?d:void 0,$=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:W,emailVerified:ee,isAnonymous:De,providerData:Z,stsTokenManager:E}=t;F(W&&E,e,"internal-error");let g=ni.fromJSON(this.name,E);F(typeof W=="string",e,"internal-error"),Gt(y,e.name),Gt(_,e.name),F(typeof ee=="boolean",e,"internal-error"),F(typeof De=="boolean",e,"internal-error"),Gt(C,e.name),Gt(k,e.name),Gt(x,e.name),Gt(D,e.name),Gt(z,e.name),Gt($,e.name);let I=new n({uid:W,auth:e,email:_,emailVerified:ee,displayName:y,isAnonymous:De,photoURL:k,phoneNumber:C,tenantId:x,stsTokenManager:g,createdAt:z,lastLoginAt:$});return Z&&Array.isArray(Z)&&(I.providerData=Z.map(w=>Object.assign({},w))),D&&(I._redirectEventId=D),I}static _fromIdTokenResponse(e,t,r=!1){return m(this,null,function*(){let i=new ni;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Is(s),s})}static _fromGetAccountInfoResponse(e,t,r){return m(this,null,function*(){let i=t.users[0];F(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?_f(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,c=new ni;c.updateFromIdToken(r);let l=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new ri(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(l,d),l})}};var ef=new Map;function Tt(n){At(n instanceof Function,"Expected a class definition");let e=ef.get(n);return e?(At(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ef.set(n,e),e)}var Sv=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return m(this,null,function*(){return!0})}_set(t,r){return m(this,null,function*(){this.storage[t]=r})}_get(t){return m(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return m(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Ga=Sv;function ps(n,e,t){return`firebase:${n}:${e}:${t}`}var ws=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=ps(this.userKey,i.apiKey,s),this.fullPersistenceKey=ps("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return m(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=yield vs(this.auth,{idToken:e}).catch(()=>{});return t?Ht._fromGetAccountInfoResponse(this.auth,t,e):null}return Ht._fromJSON(this.auth,e)})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return m(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return m(this,null,function*(){if(!t.length)return new n(Tt(Ga),e,r);let i=(yield Promise.all(t.map(d=>m(null,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),s=i[0]||Tt(Ga),a=ps(r,e.config.apiKey,e.name),c=null;for(let d of t)try{let p=yield d._get(a);if(p){let y;if(typeof p=="string"){let _=yield vs(e,{idToken:p}).catch(()=>{});if(!_)break;y=yield Ht._fromGetAccountInfoResponse(e,_,p)}else y=Ht._fromJSON(e,p);d!==s&&(c=y),s=d;break}}catch{}let l=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new n(s,e,r):(s=l[0],c&&(yield s._set(a,c.toJSON())),yield Promise.all(t.map(d=>m(null,null,function*(){if(d!==s)try{yield d._remove(a)}catch{}}))),new n(s,e,r))})}};function tf(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Ef(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(vf(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(bf(e))return"Blackberry";if(Af(e))return"Webos";if(If(e))return"Safari";if((e.includes("chrome/")||wf(e))&&!e.includes("edge/"))return"Chrome";if(Tf(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function vf(n=Ie()){return/firefox\//i.test(n)}function If(n=Ie()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wf(n=Ie()){return/crios\//i.test(n)}function Ef(n=Ie()){return/iemobile/i.test(n)}function Tf(n=Ie()){return/android/i.test(n)}function bf(n=Ie()){return/blackberry/i.test(n)}function Af(n=Ie()){return/webos/i.test(n)}function fc(n=Ie()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Cv(n=Ie()){var e;return fc(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Rv(){return vd()&&document.documentMode===10}function Sf(n=Ie()){return fc(n)||Tf(n)||Af(n)||bf(n)||/windows phone/i.test(n)||Ef(n)}function Cf(n,e=[]){let t;switch(n){case"Browser":t=tf(Ie());break;case"Worker":t=`${tf(Ie())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${qt}/${r}`}var Ha=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,c)=>{try{let l=e(s);a(l)}catch(l){c(l)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return m(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function Pv(t){return m(this,arguments,function*(n,e={}){return St(n,"GET","/v2/passwordPolicy",Kt(n,e))})}var kv=6,Ka=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:kv,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,c;let l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(c=l.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),l}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Qa=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Es(this),this.idTokenSubscription=new Es(this),this.beforeStateQueue=new Ha(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mf,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Tt(t)),this._initializationPromise=this.queue(()=>m(this,null,function*(){var r,i,s;if(!this._deleted&&(this.persistenceManager=yield ws.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return m(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return m(this,null,function*(){try{let t=yield vs(this,{idToken:e}),r=yield Ht._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return m(this,null,function*(){var t;if(Ve(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=i?._redirectEventId,l=yield this.tryRedirectSignIn(e);(!a||a===c)&&l?.user&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return F(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return m(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return m(this,null,function*(){try{yield Is(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=mv()}_delete(){return m(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return m(this,null,function*(){if(Ve(this.app))return Promise.reject(bt(this));let t=e?oe(e):null;return t&&F(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return m(this,null,function*(){if(!this._deleted)return e&&F(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>m(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return m(this,null,function*(){return Ve(this.app)?Promise.reject(bt(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Ve(this.app)?Promise.reject(bt(this)):this.queue(()=>m(this,null,function*(){yield this.assertedPersistence.setPersistence(Tt(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return m(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return m(this,null,function*(){let e=yield Pv(this),t=new Ka(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ye("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return m(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield Av(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return m(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return m(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Tt(e)||this._popupRedirectResolver;F(t,this,"argument-error"),this.redirectPersistenceManager=yield ws.create(this,[Tt(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return m(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>m(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return m(this,null,function*(){if(e===this.currentUser)return this.queue(()=>m(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(F(c,this,"internal-error"),c.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let l=e.addObserver(t,r,i);return()=>{a=!0,l()}}else{let l=e.addObserver(t);return()=>{a=!0,l()}}}directlySetCurrentUser(e){return m(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return F(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Cf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return m(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return m(this,null,function*(){var e;if(Ve(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&hv(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function Qt(n){return oe(n)}var Es=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Td(t=>this.observer=t)}get next(){return F(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var Ds={loadJS(){return m(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Dv(n){Ds=n}function Rf(n){return Ds.loadJS(n)}function Nv(){return Ds.recaptchaEnterpriseScript}function Ov(){return Ds.gapiScript}function Pf(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var Ya=class{constructor(){this.enterprise=new Ja}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},Ja=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var xv="recaptcha-enterprise",kf="NO_RECAPTCHA",Xa=class{constructor(e){this.type=xv,this.auth=Qt(e)}verify(e="verify",t=!1){return m(this,null,function*(){function r(s){return m(this,null,function*(){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise((a,c)=>m(null,null,function*(){Iv(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{let d=new za(l);return s.tenantId==null?s._agentRecaptchaConfig=d:s._tenantRecaptchaConfigs[s.tenantId]=d,a(d.siteKey)}}).catch(l=>{c(l)})}))})}function i(s,a,c){let l=window.grecaptcha;Xd(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(d=>{a(d)}).catch(()=>{a(kf)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Ya().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{r(this.auth).then(c=>{if(!t&&Xd(window.grecaptcha))i(c,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=Nv();l.length!==0&&(l+=c),Rf(l).then(()=>{i(c,s,a)}).catch(d=>{a(d)})}}).catch(c=>{a(c)})})})}};function ei(n,e,t,r=!1,i=!1){return m(this,null,function*(){let s=new Xa(n),a;if(i)a=kf;else try{a=yield s.verify(t)}catch{a=yield s.verify(t,!0)}let c=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){let l=c.phoneEnrollmentInfo.phoneNumber,d=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:d,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){let l=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:a}):Object.assign(c,{captchaResponse:a}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c})}function Za(n,e,t,r,i){return m(this,null,function*(){var s,a;if(i==="EMAIL_PASSWORD_PROVIDER")if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let c=yield ei(n,e,t,t==="getOobCode");return r(n,c)}else return r(n,e).catch(c=>m(null,null,function*(){if(c.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let l=yield ei(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(c)}));else if(i==="PHONE_PROVIDER")if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("PHONE_PROVIDER")){let c=yield ei(n,e,t);return r(n,c).catch(l=>m(null,null,function*(){var d;if(((d=n._getRecaptchaConfig())===null||d===void 0?void 0:d.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(l.code==="auth/missing-recaptcha-token"||l.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let p=yield ei(n,e,t,!1,!0);return r(n,p)}return Promise.reject(l)}))}else{let c=yield ei(n,e,t,!1,!0);return r(n,c)}else return Promise.reject(i+" provider is not supported.")})}function pc(n,e){let t=Hn(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(at(s,e??{}))return i;We(i,"already-initialized")}return t.initialize({options:e})}function Vv(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Tt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function mc(n,e,t){let r=Qt(n);F(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Df(e),{host:a,port:c}=Lv(e),l=c===null?"":`:${c}`,d={url:`${s}//${a}${l}/`},p=Object.freeze({host:a,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){F(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),F(at(d,r.config.emulator)&&at(p,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=p,r.settings.appVerificationDisabledForTesting=!0,$t(a)?(ss(`${s}//${a}${l}`),os("Auth",!0)):i||Mv()}function Df(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Lv(n){let e=Df(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:nf(r.substr(s.length+1))}}else{let[s,a]=r.split(":");return{host:s,port:nf(a)}}}function nf(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function Mv(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Zn=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Et("not implemented")}_getIdTokenResponse(e){return Et("not implemented")}_linkToIdToken(e,t){return Et("not implemented")}_getReauthenticationResolver(e){return Et("not implemented")}};function Fv(n,e){return m(this,null,function*(){return St(n,"POST","/v1/accounts:signUp",e)})}function Uv(n,e){return m(this,null,function*(){return ai(n,"POST","/v1/accounts:signInWithPassword",Kt(n,e))})}function $v(n,e){return m(this,null,function*(){return ai(n,"POST","/v1/accounts:signInWithEmailLink",Kt(n,e))})}function Bv(n,e){return m(this,null,function*(){return ai(n,"POST","/v1/accounts:signInWithEmailLink",Kt(n,e))})}var ii=class n extends Zn{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}_getIdTokenResponse(e){return m(this,null,function*(){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Za(e,t,"signInWithPassword",Uv,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return $v(e,{email:this._email,oobCode:this._password});default:We(e,"internal-error")}})}_linkToIdToken(e,t){return m(this,null,function*(){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Za(e,r,"signUpPassword",Fv,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Bv(e,{idToken:t,email:this._email,oobCode:this._password});default:We(e,"internal-error")}})}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};function Jn(n,e){return m(this,null,function*(){return ai(n,"POST","/v1/accounts:signInWithIdp",Kt(n,e))})}var qv="http://localhost",Ts=class n extends Zn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):We("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Zi(t,["providerId","signInMethod"]);if(!r||!i)return null;let a=new n(r,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){let t=this.buildRequest();return Jn(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Jn(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Jn(e,t)}buildRequest(){let e={requestUri:qv,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=zn(t)}return e}};function jv(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function zv(n){let e=Wn(Gn(n)).link,t=e?Wn(Gn(e)).deep_link_id:null,r=Wn(Gn(n)).deep_link_id;return(r?Wn(Gn(r)).link:null)||r||t||e||n}var bs=class n{constructor(e){var t,r,i,s,a,c;let l=Wn(Gn(e)),d=(t=l.apiKey)!==null&&t!==void 0?t:null,p=(r=l.oobCode)!==null&&r!==void 0?r:null,y=jv((i=l.mode)!==null&&i!==void 0?i:null);F(d&&p&&y,"argument-error"),this.apiKey=d,this.operation=y,this.code=p,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=l.lang)!==null&&a!==void 0?a:null,this.tenantId=(c=l.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){let t=zv(e);try{return new n(t)}catch{return null}}};var Nf=(()=>{class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(t,r){return ii._fromEmailAndPassword(t,r)}static credentialWithLink(t,r){let i=bs.parseLink(r);return F(i,"argument-error"),ii._fromEmailAndCode(t,i.code,i.tenantId)}}n.PROVIDER_ID="password",n.EMAIL_PASSWORD_SIGN_IN_METHOD="password",n.EMAIL_LINK_SIGN_IN_METHOD="emailLink";return n})(),si=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var As=class extends si{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var gc=(()=>{class n extends As{constructor(){super("google.com"),this.addScope("profile")}static credential(t,r){return Ts._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:r})}static credentialFromResult(t){return n.credentialFromTaggedObject(t)}static credentialFromError(t){return n.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:r,oauthAccessToken:i}=t;if(!r&&!i)return null;try{return n.credential(r,i)}catch{return null}}}n.GOOGLE_SIGN_IN_METHOD="google.com",n.PROVIDER_ID="google.com";return n})();function Wv(n,e){return m(this,null,function*(){return ai(n,"POST","/v1/accounts:signUp",Kt(n,e))})}var er=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static _fromIdTokenResponse(e,t,r,i=!1){return m(this,null,function*(){let s=yield Ht._fromIdTokenResponse(e,r,i),a=rf(r);return new n({user:s,providerId:a,_tokenResponse:r,operationType:t})})}static _forOperation(e,t,r){return m(this,null,function*(){yield e._updateTokensIfNecessary(r,!0);let i=rf(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})})}};function rf(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var ec=class n extends Ue{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Of(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?ec._fromErrorAndOperation(n,s,e,r):s})}function Gv(n,e,t=!1){return m(this,null,function*(){let r=yield Xn(n,e._linkToIdToken(n.auth,yield n.getIdToken()),t);return er._forOperation(n,"link",r)})}function Hv(n,e,t=!1){return m(this,null,function*(){let{auth:r}=n;if(Ve(r.app))return Promise.reject(bt(r));let i="reauthenticate";try{let s=yield Xn(n,Of(r,i,e,n),t);F(s.idToken,r,"internal-error");let a=hc(s.idToken);F(a,r,"internal-error");let{sub:c}=a;return F(n.uid===c,r,"user-mismatch"),er._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&We(r,"user-mismatch"),s}})}function xf(n,e,t=!1){return m(this,null,function*(){if(Ve(n.app))return Promise.reject(bt(n));let r="signIn",i=yield Of(n,r,e),s=yield er._fromIdTokenResponse(n,r,i);return t||(yield n._updateCurrentUser(s.user)),s})}function yc(n,e){return m(this,null,function*(){return xf(Qt(n),e)})}function Vf(n){return m(this,null,function*(){let e=Qt(n);e._getPasswordPolicyInternal()&&(yield e._updatePasswordPolicy())})}function _c(n,e,t){return m(this,null,function*(){if(Ve(n.app))return Promise.reject(bt(n));let r=Qt(n),a=yield Za(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Wv,"EMAIL_PASSWORD_PROVIDER").catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&Vf(n),l}),c=yield er._fromIdTokenResponse(r,"signIn",a);return yield r._updateCurrentUser(c.user),c})}function vc(n,e,t){return Ve(n.app)?Promise.reject(bt(n)):yc(oe(n),Nf.credential(e,t)).catch(r=>m(null,null,function*(){throw r.code==="auth/password-does-not-meet-requirements"&&Vf(n),r}))}function Kv(n,e){return m(this,null,function*(){return St(n,"POST","/v1/accounts:update",e)})}function Ic(r,i){return m(this,arguments,function*(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let s=oe(n),c={idToken:yield s.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},l=yield Xn(s,Kv(s.auth,c));s.displayName=l.displayName||null,s.photoURL=l.photoUrl||null;let d=s.providerData.find(({providerId:p})=>p==="password");d&&(d.displayName=s.displayName,d.photoURL=s.photoURL),yield s._updateTokensIfNecessary(l)})}function ci(n,e,t,r){return oe(n).onIdTokenChanged(e,t,r)}function wc(n,e,t){return oe(n).beforeAuthStateChanged(e,t)}function Ec(n){return oe(n).signOut()}var Ss="__sak";var Cs=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ss,"1"),this.storage.removeItem(Ss),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var Qv=1e3,Yv=10,Jv=(()=>{class n extends Cs{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Sf(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((c,l,d)=>{this.notifyListeners(c,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let c=this.storage.getItem(i);!r&&this.localCache[i]===c||this.notifyListeners(i,c)},a=this.storage.getItem(i);Rv()&&a!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,Yv):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},Qv)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}_set(t,r){return m(this,null,function*(){yield Ft(n.prototype,this,"_set").call(this,t,r),this.localCache[t]=JSON.stringify(r)})}_get(t){return m(this,null,function*(){let r=yield Ft(n.prototype,this,"_get").call(this,t);return this.localCache[t]=JSON.stringify(r),r})}_remove(t){return m(this,null,function*(){yield Ft(n.prototype,this,"_remove").call(this,t),delete this.localCache[t]})}}return n.type="LOCAL",n})(),Lf=Jv;var Xv=(()=>{class n extends Cs{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),Tc=Xv;function Zv(n){return Promise.all(n.map(e=>m(null,null,function*(){try{return{fulfilled:!0,value:yield e}}catch(t){return{fulfilled:!1,reason:t}}})))}var eI=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}handleEvent(t){return m(this,null,function*(){let r=t,{eventId:i,eventType:s,data:a}=r.data,c=this.handlersMap[s];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let l=Array.from(c).map(p=>m(this,null,function*(){return p(r.origin,a)})),d=yield Zv(l);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function bc(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var tc=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}_send(e,t,r=50){return m(this,null,function*(){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((c,l)=>{let d=bc("",20);i.port1.start();let p=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:i,onMessage(y){let _=y;if(_.data.eventId===d)switch(_.data.status){case"ack":clearTimeout(p),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(_.data.response);break;default:clearTimeout(p),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})})}};function lt(){return window}function tI(n){lt().location.href=n}function Mf(){return typeof lt().WorkerGlobalScope<"u"&&typeof lt().importScripts=="function"}function nI(){return m(this,null,function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})}function rI(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function iI(){return Mf()?self:null}var Ff="firebaseLocalStorageDb",sI=1,Rs="firebaseLocalStorage",Uf="fbase_key",In=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Ns(n,e){return n.transaction([Rs],e?"readwrite":"readonly").objectStore(Rs)}function oI(){let n=indexedDB.deleteDatabase(Ff);return new In(n).toPromise()}function nc(){let n=indexedDB.open(Ff,sI);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Rs,{keyPath:Uf})}catch(i){t(i)}}),n.addEventListener("success",()=>m(null,null,function*(){let r=n.result;r.objectStoreNames.contains(Rs)?e(r):(r.close(),yield oI(),e(yield nc()))}))})}function sf(n,e,t){return m(this,null,function*(){let r=Ns(n,!0).put({[Uf]:e,value:t});return new In(r).toPromise()})}function aI(n,e){return m(this,null,function*(){let t=Ns(n,!1).get(e),r=yield new In(t).toPromise();return r===void 0?null:r.value})}function of(n,e){let t=Ns(n,!0).delete(e);return new In(t).toPromise()}var cI=800,uI=3,lI=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){return m(this,null,function*(){return this.db?this.db:(this.db=yield nc(),this.db)})}_withRetries(t){return m(this,null,function*(){let r=0;for(;;)try{let i=yield this._openDb();return yield t(i)}catch(i){if(r++>uI)throw i;this.db&&(this.db.close(),this.db=void 0)}})}initializeServiceWorkerMessaging(){return m(this,null,function*(){return Mf()?this.initializeReceiver():this.initializeSender()})}initializeReceiver(){return m(this,null,function*(){this.receiver=eI._getInstance(iI()),this.receiver._subscribe("keyChanged",(t,r)=>m(this,null,function*(){return{keyProcessed:(yield this._poll()).includes(r.key)}})),this.receiver._subscribe("ping",(t,r)=>m(this,null,function*(){return["keyChanged"]}))})}initializeSender(){return m(this,null,function*(){var t,r;if(this.activeServiceWorker=yield nI(),!this.activeServiceWorker)return;this.sender=new tc(this.activeServiceWorker);let i=yield this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)})}notifyServiceWorker(t){return m(this,null,function*(){if(!(!this.sender||!this.activeServiceWorker||rI()!==this.activeServiceWorker))try{yield this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}})}_isAvailable(){return m(this,null,function*(){try{if(!indexedDB)return!1;let t=yield nc();return yield sf(t,Ss,"1"),yield of(t,Ss),!0}catch{}return!1})}_withPendingWrite(t){return m(this,null,function*(){this.pendingWrites++;try{yield t()}finally{this.pendingWrites--}})}_set(t,r){return m(this,null,function*(){return this._withPendingWrite(()=>m(this,null,function*(){return yield this._withRetries(i=>sf(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)}))})}_get(t){return m(this,null,function*(){let r=yield this._withRetries(i=>aI(i,t));return this.localCache[t]=r,r})}_remove(t){return m(this,null,function*(){return this._withPendingWrite(()=>m(this,null,function*(){return yield this._withRetries(r=>of(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)}))})}_poll(){return m(this,null,function*(){let t=yield this._withRetries(s=>{let a=Ns(s,!1).getAll();return new In(a).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:a}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r})}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>m(this,null,function*(){return this._poll()}),cI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),$f=lI;var bA=Pf("rcb"),AA=new vn(3e4,6e4);function Bf(n,e){return e?Tt(e):(F(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var oi=class extends Zn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jn(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Jn(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Jn(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function hI(n){return xf(n.auth,new oi(n),n.bypassAuthState)}function dI(n){let{auth:e,user:t}=n;return F(t,e,"internal-error"),Hv(t,new oi(n),n.bypassAuthState)}function fI(n){return m(this,null,function*(){let{auth:e,user:t}=n;return F(t,e,"internal-error"),Gv(t,new oi(n),n.bypassAuthState)})}var Ps=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((e,t)=>m(this,null,function*(){this.pendingPromise={resolve:e,reject:t};try{this.eventManager=yield this.resolver._initialize(this.auth),yield this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}}))}onAuthEvent(e){return m(this,null,function*(){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:a,type:c}=e;if(a){this.reject(a);return}let l={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(yield this.getIdpTask(c)(l))}catch(d){this.reject(d)}})}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return hI;case"linkViaPopup":case"linkViaRedirect":return fI;case"reauthViaPopup":case"reauthViaRedirect":return dI;default:We(this.auth,"internal-error")}}resolve(e){At(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){At(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var pI=new vn(2e3,1e4);function Ac(n,e,t){return m(this,null,function*(){if(Ve(n.app))return Promise.reject(Ze(n,"operation-not-supported-in-this-environment"));let r=Qt(n);dv(n,e,si);let i=Bf(r,t);return new mI(r,"signInViaPopup",e,i).executeNotNull()})}var mI=(()=>{class n extends Ps{constructor(t,r,i,s,a){super(t,r,s,a),this.provider=i,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}executeNotNull(){return m(this,null,function*(){let t=yield this.execute();return F(t,this.auth,"internal-error"),t})}onExecution(){return m(this,null,function*(){At(this.filter.length===1,"Popup operations only handle one event");let t=bc();this.authWindow=yield this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Ze(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()})}get eventId(){var t;return((t=this.authWindow)===null||t===void 0?void 0:t.associatedEvent)||null}cancel(){this.reject(Ze(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let t=()=>{var r,i;if(!((i=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ze(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,pI.get())};t()}}n.currentPopupAction=null;return n})(),gI="pendingRedirect",ms=new Map,rc=class n extends Ps{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}execute(){return m(this,null,function*(){let e=ms.get(this.auth._key());if(!e){try{let r=(yield yI(this.resolver,this.auth))?yield Ft(n.prototype,this,"execute").call(this):null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}ms.set(this.auth._key(),e)}return this.bypassAuthState||ms.set(this.auth._key(),()=>Promise.resolve(null)),e()})}onAuthEvent(e){return m(this,null,function*(){if(e.type==="signInViaRedirect")return Ft(n.prototype,this,"onAuthEvent").call(this,e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=yield this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,Ft(n.prototype,this,"onAuthEvent").call(this,e);this.resolve(null)}})}onExecution(){return m(this,null,function*(){})}cleanUp(){}};function yI(n,e){return m(this,null,function*(){let t=II(e),r=vI(n);if(!(yield r._isAvailable()))return!1;let i=(yield r._get(t))==="true";return yield r._remove(t),i})}function _I(n,e){ms.set(n._key(),e)}function vI(n){return Tt(n._redirectPersistence)}function II(n){return ps(gI,n.config.apiKey,n.name)}function wI(n,e,t=!1){return m(this,null,function*(){if(Ve(n.app))return Promise.reject(bt(n));let r=Qt(n),i=Bf(r,e),a=yield new rc(r,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,yield r._persistUserIfCurrent(a.user),yield r._setRedirectUser(null,e)),a})}var EI=600*1e3,ic=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!TI(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!qf(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Ze(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EI&&this.cachedEventUids.clear(),this.cachedEventUids.has(af(e))}saveEventToCache(e){this.cachedEventUids.add(af(e)),this.lastProcessedEventTime=Date.now()}};function af(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function qf({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function TI(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qf(n);default:return!1}}function bI(t){return m(this,arguments,function*(n,e={}){return St(n,"GET","/v1/projects",e)})}var AI=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,SI=/^https?/;function CI(n){return m(this,null,function*(){if(n.config.emulator)return;let{authorizedDomains:e}=yield bI(n);for(let t of e)try{if(RI(t))return}catch{}We(n,"unauthorized-domain")})}function RI(n){let e=qa(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!SI.test(t))return!1;if(AI.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var PI=new vn(3e4,6e4);function cf(){let n=lt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function kI(n){return new Promise((e,t)=>{var r,i,s;function a(){cf(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cf(),t(Ze(n,"network-request-failed"))},timeout:PI.get()})}if(!((i=(r=lt().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=lt().gapi)===null||s===void 0)&&s.load)a();else{let c=Pf("iframefcb");return lt()[c]=()=>{gapi.load?a():t(Ze(n,"network-request-failed"))},Rf(`${Ov()}?onload=${c}`).catch(l=>t(l))}}).catch(e=>{throw gs=null,e})}var gs=null;function DI(n){return gs=gs||kI(n),gs}var NI=new vn(5e3,15e3),OI="__/auth/iframe",xI="emulator/auth/iframe",VI={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},LI=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function MI(n){let e=n.config;F(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?uc(e,xI):`https://${n.config.authDomain}/${OI}`,r={apiKey:e.apiKey,appName:n.name,v:qt},i=LI.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${zn(r).slice(1)}`}function FI(n){return m(this,null,function*(){let e=yield DI(n),t=lt().gapi;return F(t,n,"internal-error"),e.open({where:document.body,url:MI(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:VI,dontclear:!0},r=>new Promise((i,s)=>m(null,null,function*(){yield r.restyle({setHideOnLeave:!1});let a=Ze(n,"network-request-failed"),c=lt().setTimeout(()=>{s(a)},NI.get());function l(){lt().clearTimeout(c),i(r)}r.ping(l).then(l,()=>{s(a)})})))})}var UI={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$I=500,BI=600,qI="_blank",jI="http://localhost",ks=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function zI(n,e,t,r=$I,i=BI){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",l=Object.assign(Object.assign({},UI),{width:r.toString(),height:i.toString(),top:s,left:a}),d=Ie().toLowerCase();t&&(c=wf(d)?qI:t),vf(d)&&(e=e||jI,l.scrollbars="yes");let p=Object.entries(l).reduce((_,[C,k])=>`${_}${C}=${k},`,"");if(Cv(d)&&c!=="_self")return WI(e||"",c),new ks(null);let y=window.open(e||"",c,p);F(y,n,"popup-blocked");try{y.focus()}catch{}return new ks(y)}function WI(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var GI="__/auth/handler",HI="emulator/auth/handler",KI=encodeURIComponent("fac");function uf(n,e,t,r,i,s){return m(this,null,function*(){F(n.config.authDomain,n,"auth-domain-config-required"),F(n.config.apiKey,n,"invalid-api-key");let a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:qt,eventId:i};if(e instanceof si){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",Ed(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(let[p,y]of Object.entries(s||{}))a[p]=y}if(e instanceof As){let p=e.getScopes().filter(y=>y!=="");p.length>0&&(a.scopes=p.join(","))}n.tenantId&&(a.tid=n.tenantId);let c=a;for(let p of Object.keys(c))c[p]===void 0&&delete c[p];let l=yield n._getAppCheckToken(),d=l?`#${KI}=${encodeURIComponent(l)}`:"";return`${QI(n)}?${zn(c).slice(1)}${d}`})}function QI({config:n}){return n.emulator?uc(n,HI):`https://${n.authDomain}/${GI}`}var Ba="webStorageSupport",sc=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Tc,this._completeRedirectFn=wI,this._overrideRedirectResult=_I}_openPopup(e,t,r,i){return m(this,null,function*(){var s;At((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let a=yield uf(e,t,r,qa(),i);return zI(e,a,bc())})}_openRedirect(e,t,r,i){return m(this,null,function*(){yield this._originValidation(e);let s=yield uf(e,t,r,qa(),i);return tI(s),new Promise(()=>{})})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(At(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}initAndGetManager(e){return m(this,null,function*(){let t=yield FI(e),r=new ic(e);return t.register("authEvent",i=>(F(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r})}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ba,{type:Ba},i=>{var s;let a=(s=i?.[0])===null||s===void 0?void 0:s[Ba];a!==void 0&&t(!!a),We(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=CI(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Sf()||If()||fc()}},jf=sc;var lf="@firebase/auth",hf="1.10.8";var oc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return m(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){F(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function YI(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function JI(n){Je(new xe("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;F(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let l={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Cf(n)},d=new Qa(r,i,s,l);return Vv(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Je(new xe("auth-internal",e=>{let t=Qt(e.getProvider("auth").getImmediate());return(r=>new oc(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),le(lf,hf,YI(n)),le(lf,hf,"esm2017")}var XI=300,ZI=ga("authIdTokenMaxAge")||XI,df=null,ew=n=>e=>m(null,null,function*(){let t=e&&(yield e.getIdTokenResult()),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>ZI)return;let i=t?.token;df!==i&&(df=i,yield fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))});function Sc(n=gn()){let e=Hn(n,"auth");if(e.isInitialized())return e.getImmediate();let t=pc(n,{popupRedirectResolver:jf,persistence:[$f,Lf,Tc]}),r=ga("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let a=ew(s.toString());wc(t,a,()=>a(t.currentUser)),ci(t,c=>a(c))}}let i=pa("auth");return i&&mc(t,`http://${i}`),t}function tw(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}Dv({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=Ze("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",tw().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});JI("Browser");function Gf(n){return new fn(function(e){var t=ci(n,e.next.bind(e),e.error.bind(e),e.complete.bind(e));return{unsubscribe:t}})}var Hf="auth",wn=class{constructor(e){return e}},ui=class{constructor(){return Qn(Hf)}};var Cc=new qn("angularfire2.auth-instances");function $w(n,e){let t=Jr(Hf,n,e);return t&&new wn(t)}function Bw(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new wn(r)}}var qw={provide:ui,deps:[[new ze,Cc]]},jw={provide:wn,useFactory:$w,deps:[[new ze,Cc],wt]};function yS(n,...e){return le("angularfire",jt.full,"auth"),jn([jw,qw,{provide:Cc,useFactory:Bw(n),multi:!0,deps:[ot,je,zt,_n,[new ze,Yn],...e]}])}var Kf=re(Gf,!0);var Rc=re(_c,!0,2);var _S=re(Sc,!0);var Qf=re(vc,!0,2);var Yf=re(Ac,!0,2);var Jf=re(Ec,!0,2);var Xf=re(Ic,!0,2);var Zf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ep={};var Ct,Pc;(function(){var n;function e(E,g){function I(){}I.prototype=g.prototype,E.D=g.prototype,E.prototype=new I,E.prototype.constructor=E,E.C=function(w,T,A){for(var v=Array(arguments.length-2),yt=2;yt<arguments.length;yt++)v[yt-2]=arguments[yt];return g.prototype[T].apply(w,v)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,g,I){I||(I=0);var w=Array(16);if(typeof g=="string")for(var T=0;16>T;++T)w[T]=g.charCodeAt(I++)|g.charCodeAt(I++)<<8|g.charCodeAt(I++)<<16|g.charCodeAt(I++)<<24;else for(T=0;16>T;++T)w[T]=g[I++]|g[I++]<<8|g[I++]<<16|g[I++]<<24;g=E.g[0],I=E.g[1],T=E.g[2];var A=E.g[3],v=g+(A^I&(T^A))+w[0]+3614090360&4294967295;g=I+(v<<7&4294967295|v>>>25),v=A+(T^g&(I^T))+w[1]+3905402710&4294967295,A=g+(v<<12&4294967295|v>>>20),v=T+(I^A&(g^I))+w[2]+606105819&4294967295,T=A+(v<<17&4294967295|v>>>15),v=I+(g^T&(A^g))+w[3]+3250441966&4294967295,I=T+(v<<22&4294967295|v>>>10),v=g+(A^I&(T^A))+w[4]+4118548399&4294967295,g=I+(v<<7&4294967295|v>>>25),v=A+(T^g&(I^T))+w[5]+1200080426&4294967295,A=g+(v<<12&4294967295|v>>>20),v=T+(I^A&(g^I))+w[6]+2821735955&4294967295,T=A+(v<<17&4294967295|v>>>15),v=I+(g^T&(A^g))+w[7]+4249261313&4294967295,I=T+(v<<22&4294967295|v>>>10),v=g+(A^I&(T^A))+w[8]+1770035416&4294967295,g=I+(v<<7&4294967295|v>>>25),v=A+(T^g&(I^T))+w[9]+2336552879&4294967295,A=g+(v<<12&4294967295|v>>>20),v=T+(I^A&(g^I))+w[10]+4294925233&4294967295,T=A+(v<<17&4294967295|v>>>15),v=I+(g^T&(A^g))+w[11]+2304563134&4294967295,I=T+(v<<22&4294967295|v>>>10),v=g+(A^I&(T^A))+w[12]+1804603682&4294967295,g=I+(v<<7&4294967295|v>>>25),v=A+(T^g&(I^T))+w[13]+4254626195&4294967295,A=g+(v<<12&4294967295|v>>>20),v=T+(I^A&(g^I))+w[14]+2792965006&4294967295,T=A+(v<<17&4294967295|v>>>15),v=I+(g^T&(A^g))+w[15]+1236535329&4294967295,I=T+(v<<22&4294967295|v>>>10),v=g+(T^A&(I^T))+w[1]+4129170786&4294967295,g=I+(v<<5&4294967295|v>>>27),v=A+(I^T&(g^I))+w[6]+3225465664&4294967295,A=g+(v<<9&4294967295|v>>>23),v=T+(g^I&(A^g))+w[11]+643717713&4294967295,T=A+(v<<14&4294967295|v>>>18),v=I+(A^g&(T^A))+w[0]+3921069994&4294967295,I=T+(v<<20&4294967295|v>>>12),v=g+(T^A&(I^T))+w[5]+3593408605&4294967295,g=I+(v<<5&4294967295|v>>>27),v=A+(I^T&(g^I))+w[10]+38016083&4294967295,A=g+(v<<9&4294967295|v>>>23),v=T+(g^I&(A^g))+w[15]+3634488961&4294967295,T=A+(v<<14&4294967295|v>>>18),v=I+(A^g&(T^A))+w[4]+3889429448&4294967295,I=T+(v<<20&4294967295|v>>>12),v=g+(T^A&(I^T))+w[9]+568446438&4294967295,g=I+(v<<5&4294967295|v>>>27),v=A+(I^T&(g^I))+w[14]+3275163606&4294967295,A=g+(v<<9&4294967295|v>>>23),v=T+(g^I&(A^g))+w[3]+4107603335&4294967295,T=A+(v<<14&4294967295|v>>>18),v=I+(A^g&(T^A))+w[8]+1163531501&4294967295,I=T+(v<<20&4294967295|v>>>12),v=g+(T^A&(I^T))+w[13]+2850285829&4294967295,g=I+(v<<5&4294967295|v>>>27),v=A+(I^T&(g^I))+w[2]+4243563512&4294967295,A=g+(v<<9&4294967295|v>>>23),v=T+(g^I&(A^g))+w[7]+1735328473&4294967295,T=A+(v<<14&4294967295|v>>>18),v=I+(A^g&(T^A))+w[12]+2368359562&4294967295,I=T+(v<<20&4294967295|v>>>12),v=g+(I^T^A)+w[5]+4294588738&4294967295,g=I+(v<<4&4294967295|v>>>28),v=A+(g^I^T)+w[8]+2272392833&4294967295,A=g+(v<<11&4294967295|v>>>21),v=T+(A^g^I)+w[11]+1839030562&4294967295,T=A+(v<<16&4294967295|v>>>16),v=I+(T^A^g)+w[14]+4259657740&4294967295,I=T+(v<<23&4294967295|v>>>9),v=g+(I^T^A)+w[1]+2763975236&4294967295,g=I+(v<<4&4294967295|v>>>28),v=A+(g^I^T)+w[4]+1272893353&4294967295,A=g+(v<<11&4294967295|v>>>21),v=T+(A^g^I)+w[7]+4139469664&4294967295,T=A+(v<<16&4294967295|v>>>16),v=I+(T^A^g)+w[10]+3200236656&4294967295,I=T+(v<<23&4294967295|v>>>9),v=g+(I^T^A)+w[13]+681279174&4294967295,g=I+(v<<4&4294967295|v>>>28),v=A+(g^I^T)+w[0]+3936430074&4294967295,A=g+(v<<11&4294967295|v>>>21),v=T+(A^g^I)+w[3]+3572445317&4294967295,T=A+(v<<16&4294967295|v>>>16),v=I+(T^A^g)+w[6]+76029189&4294967295,I=T+(v<<23&4294967295|v>>>9),v=g+(I^T^A)+w[9]+3654602809&4294967295,g=I+(v<<4&4294967295|v>>>28),v=A+(g^I^T)+w[12]+3873151461&4294967295,A=g+(v<<11&4294967295|v>>>21),v=T+(A^g^I)+w[15]+530742520&4294967295,T=A+(v<<16&4294967295|v>>>16),v=I+(T^A^g)+w[2]+3299628645&4294967295,I=T+(v<<23&4294967295|v>>>9),v=g+(T^(I|~A))+w[0]+4096336452&4294967295,g=I+(v<<6&4294967295|v>>>26),v=A+(I^(g|~T))+w[7]+1126891415&4294967295,A=g+(v<<10&4294967295|v>>>22),v=T+(g^(A|~I))+w[14]+2878612391&4294967295,T=A+(v<<15&4294967295|v>>>17),v=I+(A^(T|~g))+w[5]+4237533241&4294967295,I=T+(v<<21&4294967295|v>>>11),v=g+(T^(I|~A))+w[12]+1700485571&4294967295,g=I+(v<<6&4294967295|v>>>26),v=A+(I^(g|~T))+w[3]+2399980690&4294967295,A=g+(v<<10&4294967295|v>>>22),v=T+(g^(A|~I))+w[10]+4293915773&4294967295,T=A+(v<<15&4294967295|v>>>17),v=I+(A^(T|~g))+w[1]+2240044497&4294967295,I=T+(v<<21&4294967295|v>>>11),v=g+(T^(I|~A))+w[8]+1873313359&4294967295,g=I+(v<<6&4294967295|v>>>26),v=A+(I^(g|~T))+w[15]+4264355552&4294967295,A=g+(v<<10&4294967295|v>>>22),v=T+(g^(A|~I))+w[6]+2734768916&4294967295,T=A+(v<<15&4294967295|v>>>17),v=I+(A^(T|~g))+w[13]+1309151649&4294967295,I=T+(v<<21&4294967295|v>>>11),v=g+(T^(I|~A))+w[4]+4149444226&4294967295,g=I+(v<<6&4294967295|v>>>26),v=A+(I^(g|~T))+w[11]+3174756917&4294967295,A=g+(v<<10&4294967295|v>>>22),v=T+(g^(A|~I))+w[2]+718787259&4294967295,T=A+(v<<15&4294967295|v>>>17),v=I+(A^(T|~g))+w[9]+3951481745&4294967295,E.g[0]=E.g[0]+g&4294967295,E.g[1]=E.g[1]+(T+(v<<21&4294967295|v>>>11))&4294967295,E.g[2]=E.g[2]+T&4294967295,E.g[3]=E.g[3]+A&4294967295}r.prototype.u=function(E,g){g===void 0&&(g=E.length);for(var I=g-this.blockSize,w=this.B,T=this.h,A=0;A<g;){if(T==0)for(;A<=I;)i(this,E,A),A+=this.blockSize;if(typeof E=="string"){for(;A<g;)if(w[T++]=E.charCodeAt(A++),T==this.blockSize){i(this,w),T=0;break}}else for(;A<g;)if(w[T++]=E[A++],T==this.blockSize){i(this,w),T=0;break}}this.h=T,this.o+=g},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var g=1;g<E.length-8;++g)E[g]=0;var I=8*this.o;for(g=E.length-8;g<E.length;++g)E[g]=I&255,I/=256;for(this.u(E),E=Array(16),g=I=0;4>g;++g)for(var w=0;32>w;w+=8)E[I++]=this.g[g]>>>w&255;return E};function s(E,g){var I=c;return Object.prototype.hasOwnProperty.call(I,E)?I[E]:I[E]=g(E)}function a(E,g){this.h=g;for(var I=[],w=!0,T=E.length-1;0<=T;T--){var A=E[T]|0;w&&A==g||(I[T]=A,w=!1)}this.g=I}var c={};function l(E){return-128<=E&&128>E?s(E,function(g){return new a([g|0],0>g?-1:0)}):new a([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return y;if(0>E)return D(d(-E));for(var g=[],I=1,w=0;E>=I;w++)g[w]=E/I|0,I*=4294967296;return new a(g,0)}function p(E,g){if(E.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(E.charAt(0)=="-")return D(p(E.substring(1),g));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=d(Math.pow(g,8)),w=y,T=0;T<E.length;T+=8){var A=Math.min(8,E.length-T),v=parseInt(E.substring(T,T+A),g);8>A?(A=d(Math.pow(g,A)),w=w.j(A).add(d(v))):(w=w.j(I),w=w.add(d(v)))}return w}var y=l(0),_=l(1),C=l(16777216);n=a.prototype,n.m=function(){if(x(this))return-D(this).m();for(var E=0,g=1,I=0;I<this.g.length;I++){var w=this.i(I);E+=(0<=w?w:4294967296+w)*g,g*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(k(this))return"0";if(x(this))return"-"+D(this).toString(E);for(var g=d(Math.pow(E,6)),I=this,w="";;){var T=ee(I,g).g;I=z(I,T.j(g));var A=((0<I.g.length?I.g[0]:I.h)>>>0).toString(E);if(I=T,k(I))return A+w;for(;6>A.length;)A="0"+A;w=A+w}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function k(E){if(E.h!=0)return!1;for(var g=0;g<E.g.length;g++)if(E.g[g]!=0)return!1;return!0}function x(E){return E.h==-1}n.l=function(E){return E=z(this,E),x(E)?-1:k(E)?0:1};function D(E){for(var g=E.g.length,I=[],w=0;w<g;w++)I[w]=~E.g[w];return new a(I,~E.h).add(_)}n.abs=function(){return x(this)?D(this):this},n.add=function(E){for(var g=Math.max(this.g.length,E.g.length),I=[],w=0,T=0;T<=g;T++){var A=w+(this.i(T)&65535)+(E.i(T)&65535),v=(A>>>16)+(this.i(T)>>>16)+(E.i(T)>>>16);w=v>>>16,A&=65535,v&=65535,I[T]=v<<16|A}return new a(I,I[I.length-1]&-2147483648?-1:0)};function z(E,g){return E.add(D(g))}n.j=function(E){if(k(this)||k(E))return y;if(x(this))return x(E)?D(this).j(D(E)):D(D(this).j(E));if(x(E))return D(this.j(D(E)));if(0>this.l(C)&&0>E.l(C))return d(this.m()*E.m());for(var g=this.g.length+E.g.length,I=[],w=0;w<2*g;w++)I[w]=0;for(w=0;w<this.g.length;w++)for(var T=0;T<E.g.length;T++){var A=this.i(w)>>>16,v=this.i(w)&65535,yt=E.i(T)>>>16,Cr=E.i(T)&65535;I[2*w+2*T]+=v*Cr,$(I,2*w+2*T),I[2*w+2*T+1]+=A*Cr,$(I,2*w+2*T+1),I[2*w+2*T+1]+=v*yt,$(I,2*w+2*T+1),I[2*w+2*T+2]+=A*yt,$(I,2*w+2*T+2)}for(w=0;w<g;w++)I[w]=I[2*w+1]<<16|I[2*w];for(w=g;w<2*g;w++)I[w]=0;return new a(I,0)};function $(E,g){for(;(E[g]&65535)!=E[g];)E[g+1]+=E[g]>>>16,E[g]&=65535,g++}function W(E,g){this.g=E,this.h=g}function ee(E,g){if(k(g))throw Error("division by zero");if(k(E))return new W(y,y);if(x(E))return g=ee(D(E),g),new W(D(g.g),D(g.h));if(x(g))return g=ee(E,D(g)),new W(D(g.g),g.h);if(30<E.g.length){if(x(E)||x(g))throw Error("slowDivide_ only works with positive integers.");for(var I=_,w=g;0>=w.l(E);)I=De(I),w=De(w);var T=Z(I,1),A=Z(w,1);for(w=Z(w,2),I=Z(I,2);!k(w);){var v=A.add(w);0>=v.l(E)&&(T=T.add(I),A=v),w=Z(w,1),I=Z(I,1)}return g=z(E,T.j(g)),new W(T,g)}for(T=y;0<=E.l(g);){for(I=Math.max(1,Math.floor(E.m()/g.m())),w=Math.ceil(Math.log(I)/Math.LN2),w=48>=w?1:Math.pow(2,w-48),A=d(I),v=A.j(g);x(v)||0<v.l(E);)I-=w,A=d(I),v=A.j(g);k(A)&&(A=_),T=T.add(A),E=z(E,v)}return new W(T,E)}n.A=function(E){return ee(this,E).h},n.and=function(E){for(var g=Math.max(this.g.length,E.g.length),I=[],w=0;w<g;w++)I[w]=this.i(w)&E.i(w);return new a(I,this.h&E.h)},n.or=function(E){for(var g=Math.max(this.g.length,E.g.length),I=[],w=0;w<g;w++)I[w]=this.i(w)|E.i(w);return new a(I,this.h|E.h)},n.xor=function(E){for(var g=Math.max(this.g.length,E.g.length),I=[],w=0;w<g;w++)I[w]=this.i(w)^E.i(w);return new a(I,this.h^E.h)};function De(E){for(var g=E.g.length+1,I=[],w=0;w<g;w++)I[w]=E.i(w)<<1|E.i(w-1)>>>31;return new a(I,E.h)}function Z(E,g){var I=g>>5;g%=32;for(var w=E.g.length-I,T=[],A=0;A<w;A++)T[A]=0<g?E.i(A+I)>>>g|E.i(A+I+1)<<32-g:E.i(A+I);return new a(T,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Pc=ep.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,Ct=ep.Integer=a}).apply(typeof Zf<"u"?Zf:typeof self<"u"?self:typeof window<"u"?window:{});var Os=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Rt={};var kc,zw,tr,Dc,li,xs,Nc,Oc,xc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,u,h){return o==Array.prototype||o==Object.prototype||(o[u]=h.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof Os=="object"&&Os];for(var u=0;u<o.length;++u){var h=o[u];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=t(this);function i(o,u){if(u)e:{var h=r;o=o.split(".");for(var f=0;f<o.length-1;f++){var b=o[f];if(!(b in h))break e;h=h[b]}o=o[o.length-1],f=h[o],u=u(f),u!=f&&u!=null&&e(h,o,{configurable:!0,writable:!0,value:u})}}function s(o,u){o instanceof String&&(o+="");var h=0,f=!1,b={next:function(){if(!f&&h<o.length){var S=h++;return{value:u(S,o[S]),done:!1}}return f=!0,{done:!0,value:void 0}}};return b[Symbol.iterator]=function(){return b},b}i("Array.prototype.values",function(o){return o||function(){return s(this,function(u,h){return h})}});var a=a||{},c=this||self;function l(o){var u=typeof o;return u=u!="object"?u:o?Array.isArray(o)?"array":u:"null",u=="array"||u=="object"&&typeof o.length=="number"}function d(o){var u=typeof o;return u=="object"&&o!=null||u=="function"}function p(o,u,h){return o.call.apply(o.bind,arguments)}function y(o,u,h){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var b=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(b,f),o.apply(u,b)}}return function(){return o.apply(u,arguments)}}function _(o,u,h){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:y,_.apply(null,arguments)}function C(o,u){var h=Array.prototype.slice.call(arguments,1);return function(){var f=h.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function k(o,u){function h(){}h.prototype=u.prototype,o.aa=u.prototype,o.prototype=new h,o.prototype.constructor=o,o.Qb=function(f,b,S){for(var N=Array(arguments.length-2),te=2;te<arguments.length;te++)N[te-2]=arguments[te];return u.prototype[b].apply(f,N)}}function x(o){let u=o.length;if(0<u){let h=Array(u);for(let f=0;f<u;f++)h[f]=o[f];return h}return[]}function D(o,u){for(let h=1;h<arguments.length;h++){let f=arguments[h];if(l(f)){let b=o.length||0,S=f.length||0;o.length=b+S;for(let N=0;N<S;N++)o[b+N]=f[N]}else o.push(f)}}class z{constructor(u,h){this.i=u,this.j=h,this.h=0,this.g=null}get(){let u;return 0<this.h?(this.h--,u=this.g,this.g=u.next,u.next=null):u=this.i(),u}}function $(o){return/^[\s\xa0]*$/.test(o)}function W(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function ee(o){return ee[" "](o),o}ee[" "]=function(){};var De=W().indexOf("Gecko")!=-1&&!(W().toLowerCase().indexOf("webkit")!=-1&&W().indexOf("Edge")==-1)&&!(W().indexOf("Trident")!=-1||W().indexOf("MSIE")!=-1)&&W().indexOf("Edge")==-1;function Z(o,u,h){for(let f in o)u.call(h,o[f],f,o)}function E(o,u){for(let h in o)u.call(void 0,o[h],h,o)}function g(o){let u={};for(let h in o)u[h]=o[h];return u}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function w(o,u){let h,f;for(let b=1;b<arguments.length;b++){f=arguments[b];for(h in f)o[h]=f[h];for(let S=0;S<I.length;S++)h=I[S],Object.prototype.hasOwnProperty.call(f,h)&&(o[h]=f[h])}}function T(o){var u=1;o=o.split(":");let h=[];for(;0<u&&o.length;)h.push(o.shift()),u--;return o.length&&h.push(o.join(":")),h}function A(o){c.setTimeout(()=>{throw o},0)}function v(){var o=Lo;let u=null;return o.g&&(u=o.g,o.g=o.g.next,o.g||(o.h=null),u.next=null),u}class yt{constructor(){this.h=this.g=null}add(u,h){let f=Cr.get();f.set(u,h),this.h?this.h.next=f:this.g=f,this.h=f}}var Cr=new z(()=>new Lg,o=>o.reset());class Lg{constructor(){this.next=this.g=this.h=null}set(u,h){this.h=u,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let Rr,Pr=!1,Lo=new yt,th=()=>{let o=c.Promise.resolve(void 0);Rr=()=>{o.then(Mg)}};var Mg=()=>{for(var o;o=v();){try{o.h.call(o.g)}catch(h){A(h)}var u=Cr;u.j(o),100>u.h&&(u.h++,o.next=u.g,u.g=o)}Pr=!1};function xt(){this.s=this.s,this.C=this.C}xt.prototype.s=!1,xt.prototype.ma=function(){this.s||(this.s=!0,this.N())},xt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ae(o,u){this.type=o,this.g=this.target=u,this.defaultPrevented=!1}Ae.prototype.h=function(){this.defaultPrevented=!0};var Fg=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,u=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let h=()=>{};c.addEventListener("test",h,u),c.removeEventListener("test",h,u)}catch{}return o})();function kr(o,u){if(Ae.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var h=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=u,u=o.relatedTarget){if(De){e:{try{ee(u.nodeName);var b=!0;break e}catch{}b=!1}b||(u=null)}}else h=="mouseover"?u=o.fromElement:h=="mouseout"&&(u=o.toElement);this.relatedTarget=u,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:Ug[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&kr.aa.h.call(this)}}k(kr,Ae);var Ug={2:"touch",3:"pen",4:"mouse"};kr.prototype.h=function(){kr.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Dr="closure_listenable_"+(1e6*Math.random()|0),$g=0;function Bg(o,u,h,f,b){this.listener=o,this.proxy=null,this.src=u,this.type=h,this.capture=!!f,this.ha=b,this.key=++$g,this.da=this.fa=!1}function Li(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function Mi(o){this.src=o,this.g={},this.h=0}Mi.prototype.add=function(o,u,h,f,b){var S=o.toString();o=this.g[S],o||(o=this.g[S]=[],this.h++);var N=Fo(o,u,f,b);return-1<N?(u=o[N],h||(u.fa=!1)):(u=new Bg(u,this.src,S,!!f,b),u.fa=h,o.push(u)),u};function Mo(o,u){var h=u.type;if(h in o.g){var f=o.g[h],b=Array.prototype.indexOf.call(f,u,void 0),S;(S=0<=b)&&Array.prototype.splice.call(f,b,1),S&&(Li(u),o.g[h].length==0&&(delete o.g[h],o.h--))}}function Fo(o,u,h,f){for(var b=0;b<o.length;++b){var S=o[b];if(!S.da&&S.listener==u&&S.capture==!!h&&S.ha==f)return b}return-1}var Uo="closure_lm_"+(1e6*Math.random()|0),$o={};function nh(o,u,h,f,b){if(f&&f.once)return ih(o,u,h,f,b);if(Array.isArray(u)){for(var S=0;S<u.length;S++)nh(o,u[S],h,f,b);return null}return h=zo(h),o&&o[Dr]?o.K(u,h,d(f)?!!f.capture:!!f,b):rh(o,u,h,!1,f,b)}function rh(o,u,h,f,b,S){if(!u)throw Error("Invalid event type");var N=d(b)?!!b.capture:!!b,te=qo(o);if(te||(o[Uo]=te=new Mi(o)),h=te.add(u,h,f,N,S),h.proxy)return h;if(f=qg(),h.proxy=f,f.src=o,f.listener=h,o.addEventListener)Fg||(b=N),b===void 0&&(b=!1),o.addEventListener(u.toString(),f,b);else if(o.attachEvent)o.attachEvent(oh(u.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return h}function qg(){function o(h){return u.call(o.src,o.listener,h)}let u=jg;return o}function ih(o,u,h,f,b){if(Array.isArray(u)){for(var S=0;S<u.length;S++)ih(o,u[S],h,f,b);return null}return h=zo(h),o&&o[Dr]?o.L(u,h,d(f)?!!f.capture:!!f,b):rh(o,u,h,!0,f,b)}function sh(o,u,h,f,b){if(Array.isArray(u))for(var S=0;S<u.length;S++)sh(o,u[S],h,f,b);else f=d(f)?!!f.capture:!!f,h=zo(h),o&&o[Dr]?(o=o.i,u=String(u).toString(),u in o.g&&(S=o.g[u],h=Fo(S,h,f,b),-1<h&&(Li(S[h]),Array.prototype.splice.call(S,h,1),S.length==0&&(delete o.g[u],o.h--)))):o&&(o=qo(o))&&(u=o.g[u.toString()],o=-1,u&&(o=Fo(u,h,f,b)),(h=-1<o?u[o]:null)&&Bo(h))}function Bo(o){if(typeof o!="number"&&o&&!o.da){var u=o.src;if(u&&u[Dr])Mo(u.i,o);else{var h=o.type,f=o.proxy;u.removeEventListener?u.removeEventListener(h,f,o.capture):u.detachEvent?u.detachEvent(oh(h),f):u.addListener&&u.removeListener&&u.removeListener(f),(h=qo(u))?(Mo(h,o),h.h==0&&(h.src=null,u[Uo]=null)):Li(o)}}}function oh(o){return o in $o?$o[o]:$o[o]="on"+o}function jg(o,u){if(o.da)o=!0;else{u=new kr(u,this);var h=o.listener,f=o.ha||o.src;o.fa&&Bo(o),o=h.call(f,u)}return o}function qo(o){return o=o[Uo],o instanceof Mi?o:null}var jo="__closure_events_fn_"+(1e9*Math.random()>>>0);function zo(o){return typeof o=="function"?o:(o[jo]||(o[jo]=function(u){return o.handleEvent(u)}),o[jo])}function Se(){xt.call(this),this.i=new Mi(this),this.M=this,this.F=null}k(Se,xt),Se.prototype[Dr]=!0,Se.prototype.removeEventListener=function(o,u,h,f){sh(this,o,u,h,f)};function Ne(o,u){var h,f=o.F;if(f)for(h=[];f;f=f.F)h.push(f);if(o=o.M,f=u.type||u,typeof u=="string")u=new Ae(u,o);else if(u instanceof Ae)u.target=u.target||o;else{var b=u;u=new Ae(f,o),w(u,b)}if(b=!0,h)for(var S=h.length-1;0<=S;S--){var N=u.g=h[S];b=Fi(N,f,!0,u)&&b}if(N=u.g=o,b=Fi(N,f,!0,u)&&b,b=Fi(N,f,!1,u)&&b,h)for(S=0;S<h.length;S++)N=u.g=h[S],b=Fi(N,f,!1,u)&&b}Se.prototype.N=function(){if(Se.aa.N.call(this),this.i){var o=this.i,u;for(u in o.g){for(var h=o.g[u],f=0;f<h.length;f++)Li(h[f]);delete o.g[u],o.h--}}this.F=null},Se.prototype.K=function(o,u,h,f){return this.i.add(String(o),u,!1,h,f)},Se.prototype.L=function(o,u,h,f){return this.i.add(String(o),u,!0,h,f)};function Fi(o,u,h,f){if(u=o.i.g[String(u)],!u)return!0;u=u.concat();for(var b=!0,S=0;S<u.length;++S){var N=u[S];if(N&&!N.da&&N.capture==h){var te=N.listener,Te=N.ha||N.src;N.fa&&Mo(o.i,N),b=te.call(Te,f)!==!1&&b}}return b&&!f.defaultPrevented}function ah(o,u,h){if(typeof o=="function")h&&(o=_(o,h));else if(o&&typeof o.handleEvent=="function")o=_(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(u)?-1:c.setTimeout(o,u||0)}function ch(o){o.g=ah(()=>{o.g=null,o.i&&(o.i=!1,ch(o))},o.l);let u=o.h;o.h=null,o.m.apply(null,u)}class zg extends xt{constructor(u,h){super(),this.m=u,this.l=h,this.h=null,this.i=!1,this.g=null}j(u){this.h=arguments,this.g?this.i=!0:ch(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nr(o){xt.call(this),this.h=o,this.g={}}k(Nr,xt);var uh=[];function lh(o){Z(o.g,function(u,h){this.g.hasOwnProperty(h)&&Bo(u)},o),o.g={}}Nr.prototype.N=function(){Nr.aa.N.call(this),lh(this)},Nr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Wo=c.JSON.stringify,Wg=c.JSON.parse,Gg=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function Go(){}Go.prototype.h=null;function hh(o){return o.h||(o.h=o.i())}function dh(){}var Or={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ho(){Ae.call(this,"d")}k(Ho,Ae);function Ko(){Ae.call(this,"c")}k(Ko,Ae);var un={},fh=null;function Ui(){return fh=fh||new Se}un.La="serverreachability";function ph(o){Ae.call(this,un.La,o)}k(ph,Ae);function xr(o){let u=Ui();Ne(u,new ph(u))}un.STAT_EVENT="statevent";function mh(o,u){Ae.call(this,un.STAT_EVENT,o),this.stat=u}k(mh,Ae);function Oe(o){let u=Ui();Ne(u,new mh(u,o))}un.Ma="timingevent";function gh(o,u){Ae.call(this,un.Ma,o),this.size=u}k(gh,Ae);function Vr(o,u){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},u)}function Lr(){this.g=!0}Lr.prototype.xa=function(){this.g=!1};function Hg(o,u,h,f,b,S){o.info(function(){if(o.g)if(S)for(var N="",te=S.split("&"),Te=0;Te<te.length;Te++){var J=te[Te].split("=");if(1<J.length){var Ce=J[0];J=J[1];var Re=Ce.split("_");N=2<=Re.length&&Re[1]=="type"?N+(Ce+"="+J+"&"):N+(Ce+"=redacted&")}}else N=null;else N=S;return"XMLHTTP REQ ("+f+") [attempt "+b+"]: "+u+`
`+h+`
`+N})}function Kg(o,u,h,f,b,S,N){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+b+"]: "+u+`
`+h+`
`+S+" "+N})}function Fn(o,u,h,f){o.info(function(){return"XMLHTTP TEXT ("+u+"): "+Yg(o,h)+(f?" "+f:"")})}function Qg(o,u){o.info(function(){return"TIMEOUT: "+u})}Lr.prototype.info=function(){};function Yg(o,u){if(!o.g)return u;if(!u)return null;try{var h=JSON.parse(u);if(h){for(o=0;o<h.length;o++)if(Array.isArray(h[o])){var f=h[o];if(!(2>f.length)){var b=f[1];if(Array.isArray(b)&&!(1>b.length)){var S=b[0];if(S!="noop"&&S!="stop"&&S!="close")for(var N=1;N<b.length;N++)b[N]=""}}}}return Wo(h)}catch{return u}}var $i={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},yh={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Qo;function Bi(){}k(Bi,Go),Bi.prototype.g=function(){return new XMLHttpRequest},Bi.prototype.i=function(){return{}},Qo=new Bi;function Vt(o,u,h,f){this.j=o,this.i=u,this.l=h,this.R=f||1,this.U=new Nr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new _h}function _h(){this.i=null,this.g="",this.h=!1}var vh={},Yo={};function Jo(o,u,h){o.L=1,o.v=Wi(_t(u)),o.m=h,o.P=!0,Ih(o,null)}function Ih(o,u){o.F=Date.now(),qi(o),o.A=_t(o.v);var h=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),xh(h.i,"t",f),o.C=0,h=o.j.J,o.h=new _h,o.g=Xh(o.j,h?u:null,!o.m),0<o.O&&(o.M=new zg(_(o.Y,o,o.g),o.O)),u=o.U,h=o.g,f=o.ca;var b="readystatechange";Array.isArray(b)||(b&&(uh[0]=b.toString()),b=uh);for(var S=0;S<b.length;S++){var N=nh(h,b[S],f||u.handleEvent,!1,u.h||u);if(!N)break;u.g[N.key]=N}u=o.H?g(o.H):{},o.m?(o.u||(o.u="POST"),u["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,u)):(o.u="GET",o.g.ea(o.A,o.u,null,u)),xr(),Hg(o.i,o.u,o.A,o.l,o.R,o.m)}Vt.prototype.ca=function(o){o=o.target;let u=this.M;u&&vt(o)==3?u.j():this.Y(o)},Vt.prototype.Y=function(o){try{if(o==this.g)e:{let Re=vt(this.g);var u=this.g.Ba();let Bn=this.g.Z();if(!(3>Re)&&(Re!=3||this.g&&(this.h.h||this.g.oa()||Bh(this.g)))){this.J||Re!=4||u==7||(u==8||0>=Bn?xr(3):xr(2)),Xo(this);var h=this.g.Z();this.X=h;t:if(wh(this)){var f=Bh(this.g);o="";var b=f.length,S=vt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ln(this),Mr(this);var N="";break t}this.h.i=new c.TextDecoder}for(u=0;u<b;u++)this.h.h=!0,o+=this.h.i.decode(f[u],{stream:!(S&&u==b-1)});f.length=0,this.h.g+=o,this.C=0,N=this.h.g}else N=this.g.oa();if(this.o=h==200,Kg(this.i,this.u,this.A,this.l,this.R,Re,h),this.o){if(this.T&&!this.K){t:{if(this.g){var te,Te=this.g;if((te=Te.g?Te.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!$(te)){var J=te;break t}}J=null}if(h=J)Fn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Zo(this,h);else{this.o=!1,this.s=3,Oe(12),ln(this),Mr(this);break e}}if(this.P){h=!0;let Qe;for(;!this.J&&this.C<N.length;)if(Qe=Jg(this,N),Qe==Yo){Re==4&&(this.s=4,Oe(14),h=!1),Fn(this.i,this.l,null,"[Incomplete Response]");break}else if(Qe==vh){this.s=4,Oe(15),Fn(this.i,this.l,N,"[Invalid Chunk]"),h=!1;break}else Fn(this.i,this.l,Qe,null),Zo(this,Qe);if(wh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Re!=4||N.length!=0||this.h.h||(this.s=1,Oe(16),h=!1),this.o=this.o&&h,!h)Fn(this.i,this.l,N,"[Invalid Chunked Response]"),ln(this),Mr(this);else if(0<N.length&&!this.W){this.W=!0;var Ce=this.j;Ce.g==this&&Ce.ba&&!Ce.M&&(Ce.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),sa(Ce),Ce.M=!0,Oe(11))}}else Fn(this.i,this.l,N,null),Zo(this,N);Re==4&&ln(this),this.o&&!this.J&&(Re==4?Kh(this.j,this):(this.o=!1,qi(this)))}else py(this.g),h==400&&0<N.indexOf("Unknown SID")?(this.s=3,Oe(12)):(this.s=0,Oe(13)),ln(this),Mr(this)}}}catch{}finally{}};function wh(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function Jg(o,u){var h=o.C,f=u.indexOf(`
`,h);return f==-1?Yo:(h=Number(u.substring(h,f)),isNaN(h)?vh:(f+=1,f+h>u.length?Yo:(u=u.slice(f,f+h),o.C=f+h,u)))}Vt.prototype.cancel=function(){this.J=!0,ln(this)};function qi(o){o.S=Date.now()+o.I,Eh(o,o.I)}function Eh(o,u){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Vr(_(o.ba,o),u)}function Xo(o){o.B&&(c.clearTimeout(o.B),o.B=null)}Vt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(Qg(this.i,this.A),this.L!=2&&(xr(),Oe(17)),ln(this),this.s=2,Mr(this)):Eh(this,this.S-o)};function Mr(o){o.j.G==0||o.J||Kh(o.j,o)}function ln(o){Xo(o);var u=o.M;u&&typeof u.ma=="function"&&u.ma(),o.M=null,lh(o.U),o.g&&(u=o.g,o.g=null,u.abort(),u.ma())}function Zo(o,u){try{var h=o.j;if(h.G!=0&&(h.g==o||ea(h.h,o))){if(!o.K&&ea(h.h,o)&&h.G==3){try{var f=h.Da.g.parse(u)}catch{f=null}if(Array.isArray(f)&&f.length==3){var b=f;if(b[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<o.F)Yi(h),Ki(h);else break e;ia(h),Oe(18)}}else h.za=b[1],0<h.za-h.T&&37500>b[2]&&h.F&&h.v==0&&!h.C&&(h.C=Vr(_(h.Za,h),6e3));if(1>=Ah(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else dn(h,11)}else if((o.K||h.g==o)&&Yi(h),!$(u))for(b=h.Da.g.parse(u),u=0;u<b.length;u++){let J=b[u];if(h.T=J[0],J=J[1],h.G==2)if(J[0]=="c"){h.K=J[1],h.ia=J[2];let Ce=J[3];Ce!=null&&(h.la=Ce,h.j.info("VER="+h.la));let Re=J[4];Re!=null&&(h.Aa=Re,h.j.info("SVER="+h.Aa));let Bn=J[5];Bn!=null&&typeof Bn=="number"&&0<Bn&&(f=1.5*Bn,h.L=f,h.j.info("backChannelRequestTimeoutMs_="+f)),f=h;let Qe=o.g;if(Qe){let Xi=Qe.g?Qe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xi){var S=f.h;S.g||Xi.indexOf("spdy")==-1&&Xi.indexOf("quic")==-1&&Xi.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(ta(S,S.h),S.h=null))}if(f.D){let oa=Qe.g?Qe.g.getResponseHeader("X-HTTP-Session-Id"):null;oa&&(f.ya=oa,se(f.I,f.D,oa))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-o.F,h.j.info("Handshake RTT: "+h.R+"ms")),f=h;var N=o;if(f.qa=Jh(f,f.J?f.ia:null,f.W),N.K){Sh(f.h,N);var te=N,Te=f.L;Te&&(te.I=Te),te.B&&(Xo(te),qi(te)),f.g=N}else Gh(f);0<h.i.length&&Qi(h)}else J[0]!="stop"&&J[0]!="close"||dn(h,7);else h.G==3&&(J[0]=="stop"||J[0]=="close"?J[0]=="stop"?dn(h,7):ra(h):J[0]!="noop"&&h.l&&h.l.ta(J),h.v=0)}}xr(4)}catch{}}var Xg=class{constructor(o,u){this.g=o,this.map=u}};function Th(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function bh(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Ah(o){return o.h?1:o.g?o.g.size:0}function ea(o,u){return o.h?o.h==u:o.g?o.g.has(u):!1}function ta(o,u){o.g?o.g.add(u):o.h=u}function Sh(o,u){o.h&&o.h==u?o.h=null:o.g&&o.g.has(u)&&o.g.delete(u)}Th.prototype.cancel=function(){if(this.i=Ch(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function Ch(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let u=o.i;for(let h of o.g.values())u=u.concat(h.D);return u}return x(o.i)}function Zg(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(l(o)){for(var u=[],h=o.length,f=0;f<h;f++)u.push(o[f]);return u}u=[],h=0;for(f in o)u[h++]=o[f];return u}function ey(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(l(o)||typeof o=="string"){var u=[];o=o.length;for(var h=0;h<o;h++)u.push(h);return u}u=[],h=0;for(let f in o)u[h++]=f;return u}}}function Rh(o,u){if(o.forEach&&typeof o.forEach=="function")o.forEach(u,void 0);else if(l(o)||typeof o=="string")Array.prototype.forEach.call(o,u,void 0);else for(var h=ey(o),f=Zg(o),b=f.length,S=0;S<b;S++)u.call(void 0,f[S],h&&h[S],o)}var Ph=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ty(o,u){if(o){o=o.split("&");for(var h=0;h<o.length;h++){var f=o[h].indexOf("="),b=null;if(0<=f){var S=o[h].substring(0,f);b=o[h].substring(f+1)}else S=o[h];u(S,b?decodeURIComponent(b.replace(/\+/g," ")):"")}}}function hn(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof hn){this.h=o.h,ji(this,o.j),this.o=o.o,this.g=o.g,zi(this,o.s),this.l=o.l;var u=o.i,h=new $r;h.i=u.i,u.g&&(h.g=new Map(u.g),h.h=u.h),kh(this,h),this.m=o.m}else o&&(u=String(o).match(Ph))?(this.h=!1,ji(this,u[1]||"",!0),this.o=Fr(u[2]||""),this.g=Fr(u[3]||"",!0),zi(this,u[4]),this.l=Fr(u[5]||"",!0),kh(this,u[6]||"",!0),this.m=Fr(u[7]||"")):(this.h=!1,this.i=new $r(null,this.h))}hn.prototype.toString=function(){var o=[],u=this.j;u&&o.push(Ur(u,Dh,!0),":");var h=this.g;return(h||u=="file")&&(o.push("//"),(u=this.o)&&o.push(Ur(u,Dh,!0),"@"),o.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&o.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(Ur(h,h.charAt(0)=="/"?iy:ry,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",Ur(h,oy)),o.join("")};function _t(o){return new hn(o)}function ji(o,u,h){o.j=h?Fr(u,!0):u,o.j&&(o.j=o.j.replace(/:$/,""))}function zi(o,u){if(u){if(u=Number(u),isNaN(u)||0>u)throw Error("Bad port number "+u);o.s=u}else o.s=null}function kh(o,u,h){u instanceof $r?(o.i=u,ay(o.i,o.h)):(h||(u=Ur(u,sy)),o.i=new $r(u,o.h))}function se(o,u,h){o.i.set(u,h)}function Wi(o){return se(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Fr(o,u){return o?u?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Ur(o,u,h){return typeof o=="string"?(o=encodeURI(o).replace(u,ny),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function ny(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Dh=/[#\/\?@]/g,ry=/[#\?:]/g,iy=/[#\?]/g,sy=/[#\?@]/g,oy=/#/g;function $r(o,u){this.h=this.g=null,this.i=o||null,this.j=!!u}function Lt(o){o.g||(o.g=new Map,o.h=0,o.i&&ty(o.i,function(u,h){o.add(decodeURIComponent(u.replace(/\+/g," ")),h)}))}n=$r.prototype,n.add=function(o,u){Lt(this),this.i=null,o=Un(this,o);var h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(u),this.h+=1,this};function Nh(o,u){Lt(o),u=Un(o,u),o.g.has(u)&&(o.i=null,o.h-=o.g.get(u).length,o.g.delete(u))}function Oh(o,u){return Lt(o),u=Un(o,u),o.g.has(u)}n.forEach=function(o,u){Lt(this),this.g.forEach(function(h,f){h.forEach(function(b){o.call(u,b,f,this)},this)},this)},n.na=function(){Lt(this);let o=Array.from(this.g.values()),u=Array.from(this.g.keys()),h=[];for(let f=0;f<u.length;f++){let b=o[f];for(let S=0;S<b.length;S++)h.push(u[f])}return h},n.V=function(o){Lt(this);let u=[];if(typeof o=="string")Oh(this,o)&&(u=u.concat(this.g.get(Un(this,o))));else{o=Array.from(this.g.values());for(let h=0;h<o.length;h++)u=u.concat(o[h])}return u},n.set=function(o,u){return Lt(this),this.i=null,o=Un(this,o),Oh(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[u]),this.h+=1,this},n.get=function(o,u){return o?(o=this.V(o),0<o.length?String(o[0]):u):u};function xh(o,u,h){Nh(o,u),0<h.length&&(o.i=null,o.g.set(Un(o,u),x(h)),o.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],u=Array.from(this.g.keys());for(var h=0;h<u.length;h++){var f=u[h];let S=encodeURIComponent(String(f)),N=this.V(f);for(f=0;f<N.length;f++){var b=S;N[f]!==""&&(b+="="+encodeURIComponent(String(N[f]))),o.push(b)}}return this.i=o.join("&")};function Un(o,u){return u=String(u),o.j&&(u=u.toLowerCase()),u}function ay(o,u){u&&!o.j&&(Lt(o),o.i=null,o.g.forEach(function(h,f){var b=f.toLowerCase();f!=b&&(Nh(this,f),xh(this,b,h))},o)),o.j=u}function cy(o,u){let h=new Lr;if(c.Image){let f=new Image;f.onload=C(Mt,h,"TestLoadImage: loaded",!0,u,f),f.onerror=C(Mt,h,"TestLoadImage: error",!1,u,f),f.onabort=C(Mt,h,"TestLoadImage: abort",!1,u,f),f.ontimeout=C(Mt,h,"TestLoadImage: timeout",!1,u,f),c.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else u(!1)}function uy(o,u){let h=new Lr,f=new AbortController,b=setTimeout(()=>{f.abort(),Mt(h,"TestPingServer: timeout",!1,u)},1e4);fetch(o,{signal:f.signal}).then(S=>{clearTimeout(b),S.ok?Mt(h,"TestPingServer: ok",!0,u):Mt(h,"TestPingServer: server error",!1,u)}).catch(()=>{clearTimeout(b),Mt(h,"TestPingServer: error",!1,u)})}function Mt(o,u,h,f,b){try{b&&(b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null),f(h)}catch{}}function ly(){this.g=new Gg}function hy(o,u,h){let f=h||"";try{Rh(o,function(b,S){let N=b;d(b)&&(N=Wo(b)),u.push(f+S+"="+encodeURIComponent(N))})}catch(b){throw u.push(f+"type="+encodeURIComponent("_badmap")),b}}function Br(o){this.l=o.Ub||null,this.j=o.eb||!1}k(Br,Go),Br.prototype.g=function(){return new Gi(this.l,this.j)},Br.prototype.i=(function(o){return function(){return o}})({});function Gi(o,u){Se.call(this),this.D=o,this.o=u,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(Gi,Se),n=Gi.prototype,n.open=function(o,u){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=u,this.readyState=1,jr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let u={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(u.body=o),(this.D||c).fetch(new Request(this.A,u)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,qr(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,jr(this)),this.g&&(this.readyState=3,jr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vh(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Vh(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var u=o.value?o.value:new Uint8Array(0);(u=this.v.decode(u,{stream:!o.done}))&&(this.response=this.responseText+=u)}o.done?qr(this):jr(this),this.readyState==3&&Vh(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,qr(this))},n.Qa=function(o){this.g&&(this.response=o,qr(this))},n.ga=function(){this.g&&qr(this)};function qr(o){o.readyState=4,o.l=null,o.j=null,o.v=null,jr(o)}n.setRequestHeader=function(o,u){this.u.append(o,u)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],u=this.h.entries();for(var h=u.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=u.next();return o.join(`\r
`)};function jr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Gi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Lh(o){let u="";return Z(o,function(h,f){u+=f,u+=":",u+=h,u+=`\r
`}),u}function na(o,u,h){e:{for(f in h){var f=!1;break e}f=!0}f||(h=Lh(h),typeof o=="string"?h!=null&&encodeURIComponent(String(h)):se(o,u,h))}function ue(o){Se.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(ue,Se);var dy=/^https?$/i,fy=["POST","PUT"];n=ue.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,u,h,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);u=u?u.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Qo.g(),this.v=this.o?hh(this.o):hh(Qo),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(u,String(o),!0),this.B=!1}catch(S){Mh(this,S);return}if(o=h||"",h=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var b in f)h.set(b,f[b]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let S of f.keys())h.set(S,f.get(S));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(h.keys()).find(S=>S.toLowerCase()=="content-type"),b=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(fy,u,void 0))||f||b||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,N]of h)this.g.setRequestHeader(S,N);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{$h(this),this.u=!0,this.g.send(o),this.u=!1}catch(S){Mh(this,S)}};function Mh(o,u){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=u,o.m=5,Fh(o),Hi(o)}function Fh(o){o.A||(o.A=!0,Ne(o,"complete"),Ne(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,Ne(this,"complete"),Ne(this,"abort"),Hi(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Hi(this,!0)),ue.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Uh(this):this.bb())},n.bb=function(){Uh(this)};function Uh(o){if(o.h&&typeof a<"u"&&(!o.v[1]||vt(o)!=4||o.Z()!=2)){if(o.u&&vt(o)==4)ah(o.Ea,0,o);else if(Ne(o,"readystatechange"),vt(o)==4){o.h=!1;try{let N=o.Z();e:switch(N){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var u=!0;break e;default:u=!1}var h;if(!(h=u)){var f;if(f=N===0){var b=String(o.D).match(Ph)[1]||null;!b&&c.self&&c.self.location&&(b=c.self.location.protocol.slice(0,-1)),f=!dy.test(b?b.toLowerCase():"")}h=f}if(h)Ne(o,"complete"),Ne(o,"success");else{o.m=6;try{var S=2<vt(o)?o.g.statusText:""}catch{S=""}o.l=S+" ["+o.Z()+"]",Fh(o)}}finally{Hi(o)}}}}function Hi(o,u){if(o.g){$h(o);let h=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,u||Ne(o,"ready");try{h.onreadystatechange=f}catch{}}}function $h(o){o.I&&(c.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function vt(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<vt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var u=this.g.responseText;return o&&u.indexOf(o)==0&&(u=u.substring(o.length)),Wg(u)}};function Bh(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function py(o){let u={};o=(o.g&&2<=vt(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if($(o[f]))continue;var h=T(o[f]);let b=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let S=u[b]||[];u[b]=S,S.push(h)}E(u,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function zr(o,u,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||u}function qh(o){this.Aa=0,this.i=[],this.j=new Lr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=zr("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=zr("baseRetryDelayMs",5e3,o),this.cb=zr("retryDelaySeedMs",1e4,o),this.Wa=zr("forwardChannelMaxRetries",2,o),this.wa=zr("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Th(o&&o.concurrentRequestLimit),this.Da=new ly,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=qh.prototype,n.la=8,n.G=1,n.connect=function(o,u,h,f){Oe(0),this.W=o,this.H=u||{},h&&f!==void 0&&(this.H.OSID=h,this.H.OAID=f),this.F=this.X,this.I=Jh(this,null,this.W),Qi(this)};function ra(o){if(jh(o),o.G==3){var u=o.U++,h=_t(o.I);if(se(h,"SID",o.K),se(h,"RID",u),se(h,"TYPE","terminate"),Wr(o,h),u=new Vt(o,o.j,u),u.L=2,u.v=Wi(_t(h)),h=!1,c.navigator&&c.navigator.sendBeacon)try{h=c.navigator.sendBeacon(u.v.toString(),"")}catch{}!h&&c.Image&&(new Image().src=u.v,h=!0),h||(u.g=Xh(u.j,null),u.g.ea(u.v)),u.F=Date.now(),qi(u)}Yh(o)}function Ki(o){o.g&&(sa(o),o.g.cancel(),o.g=null)}function jh(o){Ki(o),o.u&&(c.clearTimeout(o.u),o.u=null),Yi(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function Qi(o){if(!bh(o.h)&&!o.s){o.s=!0;var u=o.Ga;Rr||th(),Pr||(Rr(),Pr=!0),Lo.add(u,o),o.B=0}}function my(o,u){return Ah(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=u.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Vr(_(o.Ga,o,u),Qh(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let b=new Vt(this,this.j,o),S=this.o;if(this.S&&(S?(S=g(S),w(S,this.S)):S=this.S),this.m!==null||this.O||(b.H=S,S=null),this.P)e:{for(var u=0,h=0;h<this.i.length;h++){t:{var f=this.i[h];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(u+=f,4096<u){u=h;break e}if(u===4096||h===this.i.length-1){u=h+1;break e}}u=1e3}else u=1e3;u=Wh(this,b,u),h=_t(this.I),se(h,"RID",o),se(h,"CVER",22),this.D&&se(h,"X-HTTP-Session-Id",this.D),Wr(this,h),S&&(this.O?u="headers="+encodeURIComponent(String(Lh(S)))+"&"+u:this.m&&na(h,this.m,S)),ta(this.h,b),this.Ua&&se(h,"TYPE","init"),this.P?(se(h,"$req",u),se(h,"SID","null"),b.T=!0,Jo(b,h,null)):Jo(b,h,u),this.G=2}}else this.G==3&&(o?zh(this,o):this.i.length==0||bh(this.h)||zh(this))};function zh(o,u){var h;u?h=u.l:h=o.U++;let f=_t(o.I);se(f,"SID",o.K),se(f,"RID",h),se(f,"AID",o.T),Wr(o,f),o.m&&o.o&&na(f,o.m,o.o),h=new Vt(o,o.j,h,o.B+1),o.m===null&&(h.H=o.o),u&&(o.i=u.D.concat(o.i)),u=Wh(o,h,1e3),h.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),ta(o.h,h),Jo(h,f,u)}function Wr(o,u){o.H&&Z(o.H,function(h,f){se(u,f,h)}),o.l&&Rh({},function(h,f){se(u,f,h)})}function Wh(o,u,h){h=Math.min(o.i.length,h);var f=o.l?_(o.l.Na,o.l,o):null;e:{var b=o.i;let S=-1;for(;;){let N=["count="+h];S==-1?0<h?(S=b[0].g,N.push("ofs="+S)):S=0:N.push("ofs="+S);let te=!0;for(let Te=0;Te<h;Te++){let J=b[Te].g,Ce=b[Te].map;if(J-=S,0>J)S=Math.max(0,b[Te].g-100),te=!1;else try{hy(Ce,N,"req"+J+"_")}catch{f&&f(Ce)}}if(te){f=N.join("&");break e}}}return o=o.i.splice(0,h),u.D=o,f}function Gh(o){if(!o.g&&!o.u){o.Y=1;var u=o.Fa;Rr||th(),Pr||(Rr(),Pr=!0),Lo.add(u,o),o.v=0}}function ia(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Vr(_(o.Fa,o),Qh(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,Hh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Vr(_(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Oe(10),Ki(this),Hh(this))};function sa(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function Hh(o){o.g=new Vt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var u=_t(o.qa);se(u,"RID","rpc"),se(u,"SID",o.K),se(u,"AID",o.T),se(u,"CI",o.F?"0":"1"),!o.F&&o.ja&&se(u,"TO",o.ja),se(u,"TYPE","xmlhttp"),Wr(o,u),o.m&&o.o&&na(u,o.m,o.o),o.L&&(o.g.I=o.L);var h=o.g;o=o.ia,h.L=1,h.v=Wi(_t(u)),h.m=null,h.P=!0,Ih(h,o)}n.Za=function(){this.C!=null&&(this.C=null,Ki(this),ia(this),Oe(19))};function Yi(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function Kh(o,u){var h=null;if(o.g==u){Yi(o),sa(o),o.g=null;var f=2}else if(ea(o.h,u))h=u.D,Sh(o.h,u),f=1;else return;if(o.G!=0){if(u.o)if(f==1){h=u.m?u.m.length:0,u=Date.now()-u.F;var b=o.B;f=Ui(),Ne(f,new gh(f,h)),Qi(o)}else Gh(o);else if(b=u.s,b==3||b==0&&0<u.X||!(f==1&&my(o,u)||f==2&&ia(o)))switch(h&&0<h.length&&(u=o.h,u.i=u.i.concat(h)),b){case 1:dn(o,5);break;case 4:dn(o,10);break;case 3:dn(o,6);break;default:dn(o,2)}}}function Qh(o,u){let h=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(h*=2),h*u}function dn(o,u){if(o.j.info("Error code "+u),u==2){var h=_(o.fb,o),f=o.Xa;let b=!f;f=new hn(f||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||ji(f,"https"),Wi(f),b?cy(f.toString(),h):uy(f.toString(),h)}else Oe(2);o.G=0,o.l&&o.l.sa(u),Yh(o),jh(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Oe(2)):(this.j.info("Failed to ping google.com"),Oe(1))};function Yh(o){if(o.G=0,o.ka=[],o.l){let u=Ch(o.h);(u.length!=0||o.i.length!=0)&&(D(o.ka,u),D(o.ka,o.i),o.h.i.length=0,x(o.i),o.i.length=0),o.l.ra()}}function Jh(o,u,h){var f=h instanceof hn?_t(h):new hn(h);if(f.g!="")u&&(f.g=u+"."+f.g),zi(f,f.s);else{var b=c.location;f=b.protocol,u=u?u+"."+b.hostname:b.hostname,b=+b.port;var S=new hn(null);f&&ji(S,f),u&&(S.g=u),b&&zi(S,b),h&&(S.l=h),f=S}return h=o.D,u=o.ya,h&&u&&se(f,h,u),se(f,"VER",o.la),Wr(o,f),f}function Xh(o,u,h){if(u&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return u=o.Ca&&!o.pa?new ue(new Br({eb:h})):new ue(o.pa),u.Ha(o.J),u}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zh(){}n=Zh.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ji(){}Ji.prototype.g=function(o,u){return new Fe(o,u)};function Fe(o,u){Se.call(this),this.g=new qh(u),this.l=o,this.h=u&&u.messageUrlParams||null,o=u&&u.messageHeaders||null,u&&u.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=u&&u.initMessageHeaders||null,u&&u.messageContentType&&(o?o["X-WebChannel-Content-Type"]=u.messageContentType:o={"X-WebChannel-Content-Type":u.messageContentType}),u&&u.va&&(o?o["X-WebChannel-Client-Profile"]=u.va:o={"X-WebChannel-Client-Profile":u.va}),this.g.S=o,(o=u&&u.Sb)&&!$(o)&&(this.g.m=o),this.v=u&&u.supportsCrossDomainXhr||!1,this.u=u&&u.sendRawJson||!1,(u=u&&u.httpSessionIdParam)&&!$(u)&&(this.g.D=u,o=this.h,o!==null&&u in o&&(o=this.h,u in o&&delete o[u])),this.j=new $n(this)}k(Fe,Se),Fe.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Fe.prototype.close=function(){ra(this.g)},Fe.prototype.o=function(o){var u=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.u&&(h={},h.__data__=Wo(o),o=h);u.i.push(new Xg(u.Ya++,o)),u.G==3&&Qi(u)},Fe.prototype.N=function(){this.g.l=null,delete this.j,ra(this.g),delete this.g,Fe.aa.N.call(this)};function ed(o){Ho.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var u=o.__sm__;if(u){e:{for(let h in u){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,u=u!==null&&o in u?u[o]:void 0),this.data=u}else this.data=o}k(ed,Ho);function td(){Ko.call(this),this.status=1}k(td,Ko);function $n(o){this.g=o}k($n,Zh),$n.prototype.ua=function(){Ne(this.g,"a")},$n.prototype.ta=function(o){Ne(this.g,new ed(o))},$n.prototype.sa=function(o){Ne(this.g,new td)},$n.prototype.ra=function(){Ne(this.g,"b")},Ji.prototype.createWebChannel=Ji.prototype.g,Fe.prototype.send=Fe.prototype.o,Fe.prototype.open=Fe.prototype.m,Fe.prototype.close=Fe.prototype.close,xc=Rt.createWebChannelTransport=function(){return new Ji},Oc=Rt.getStatEventTarget=function(){return Ui()},Nc=Rt.Event=un,xs=Rt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},$i.NO_ERROR=0,$i.TIMEOUT=8,$i.HTTP_ERROR=6,li=Rt.ErrorCode=$i,yh.COMPLETE="complete",Dc=Rt.EventType=yh,dh.EventType=Or,Or.OPEN="a",Or.CLOSE="b",Or.ERROR="c",Or.MESSAGE="d",Se.prototype.listen=Se.prototype.K,tr=Rt.WebChannel=dh,zw=Rt.FetchXmlHttpFactory=Br,ue.prototype.listenOnce=ue.prototype.L,ue.prototype.getLastError=ue.prototype.Ka,ue.prototype.getLastErrorCode=ue.prototype.Ba,ue.prototype.getStatus=ue.prototype.Z,ue.prototype.getResponseJson=ue.prototype.Oa,ue.prototype.getResponseText=ue.prototype.oa,ue.prototype.send=ue.prototype.ea,ue.prototype.setWithCredentials=ue.prototype.Ha,kc=Rt.XhrIo=ue}).apply(typeof Os<"u"?Os:typeof self<"u"?self:typeof window<"u"?window:{});var tp="@firebase/firestore",np="4.8.0";var we=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};we.UNAUTHENTICATED=new we(null),we.GOOGLE_CREDENTIALS=new we("google-credentials-uid"),we.FIRST_PARTY=new we("first-party-uid"),we.MOCK_USER=new we("mock-user");var wr="11.10.0";var Cn=new ct("@firebase/firestore");function nr(){return Cn.logLevel}function V(n,...e){if(Cn.logLevel<=H.DEBUG){let t=e.map(Sl);Cn.debug(`Firestore (${wr}): ${n}`,...t)}}function Pt(n,...e){if(Cn.logLevel<=H.ERROR){let t=e.map(Sl);Cn.error(`Firestore (${wr}): ${n}`,...t)}}function en(n,...e){if(Cn.logLevel<=H.WARN){let t=e.map(Sl);Cn.warn(`Firestore (${wr}): ${n}`,...t)}}function Sl(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function M(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,Kp(n,r,t)}function Kp(n,e,t){let r=`FIRESTORE (${wr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Pt(r),new Error(r)}function X(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||Kp(e,i,r)}function B(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},O=class extends Ue{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var et=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Bs=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},$c=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(we.UNAUTHENTICATED))}shutdown(){}},Bc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},qc=class{constructor(e){this.t=e,this.currentUser=we.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){X(this.o===void 0,42304);let r=this.i,i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve(),s=new et;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new et,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let l=s;e.enqueueRetryable(()=>m(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},c=l=>{V("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){let l=this.t.getImmediate({optional:!0});l?c(l):(V("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new et)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(V("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(X(typeof r.accessToken=="string",31837,{l:r}),new Bs(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return X(e===null||typeof e=="string",2055,{h:e}),new we(e)}},jc=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=we.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},zc=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new jc(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(we.FIRST_PARTY))}shutdown(){}invalidateToken(){}},qs=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Wc=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ve(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){X(this.o===void 0,3512);let r=s=>{s.error!=null&&V("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.m;return this.m=s.token,V("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{V("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):V("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new qs(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(X(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new qs(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Ww(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function Qp(){return new TextEncoder}var gi=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=Ww(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function G(n,e){return n<e?-1:n>e?1:0}function Gc(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return G(r,i);{let s=Qp(),a=Gw(s.encode(rp(n,t)),s.encode(rp(e,t)));return a!==0?a:G(r,i)}}t+=r>65535?2:1}return G(n.length,e.length)}function rp(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function Gw(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return G(n[t],e[t]);return G(n.length,e.length)}function ur(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var ip="__name__",js=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&M(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&M(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return G(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):Gc(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ct.fromString(e.substring(4,e.length-2))}},ce=class n extends js{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new O(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},Hw=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Be=class n extends js{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return Hw.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ip}static keyField(){return new n([ip])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new O(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new O(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new O(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(r+=c,i++):(s(),i++)}if(s(),a)throw new O(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var L=class n{constructor(e){this.path=e}static fromPath(e){return new n(ce.fromString(e))}static fromName(e){return new n(ce.fromString(e).popFirst(5))}static empty(){return new n(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ce(e.slice()))}};function Yp(n,e,t){if(!t)throw new O(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Kw(n,e,t,r){if(e===!0&&r===!0)throw new O(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function sp(n){if(!L.isDocumentKey(n))throw new O(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function op(n){if(L.isDocumentKey(n))throw new O(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Jp(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Eo(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":M(12329,{type:typeof n})}function Le(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new O(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Eo(n);throw new O(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function ge(n,e){let t={typeString:n};return e&&(t.value=e),t}function Pi(n,e){if(!Jp(n))throw new O(R.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let a=n[r];if(i&&typeof a!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new O(R.INVALID_ARGUMENT,t);return!0}var ap=-62135596800,cp=1e6,ye=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*cp);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new O(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new O(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ap)throw new O(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new O(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cp}_compareTo(e){return this.seconds===e.seconds?G(this.nanoseconds,e.nanoseconds):G(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Pi(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-ap;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};ye._jsonSchemaVersion="firestore/timestamp/1.0",ye._jsonSchema={type:ge("string",ye._jsonSchemaVersion),seconds:ge("number"),nanoseconds:ge("number")};var j=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new ye(0,0))}static max(){return new n(new ye(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var yi=-1,Hc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Hc.UNKNOWN_ID=-1;function Qw(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=j.fromTimestamp(r===1e9?new ye(t+1,0):new ye(t,r));return new Rn(i,L.empty(),e)}function Yw(n){return new Rn(n.readTime,n.key,yi)}var Rn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(j.min(),L.empty(),yi)}static max(){return new n(j.max(),L.empty(),yi)}};function Jw(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=L.comparator(n.documentKey,e.documentKey),t!==0?t:G(n.largestBatchId,e.largestBatchId))}var Xw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Kc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Er(n){return m(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==Xw)throw n;V("LocalStore","Unexpectedly lost primary lease")})}var P=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&M(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++s,a&&s===i&&t()},l=>r(l))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),c=0;for(let l=0;l<s;l++){let d=l;t(e[d]).next(p=>{a[d]=p,++c,c===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function Zw(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Tr(n){return n.name==="IndexedDbTransactionError"}var Cl=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),Rl=-1;function To(n){return n==null}function _i(n){return n===0&&1/n==-1/0}function eE(n){return typeof n=="number"&&Number.isInteger(n)&&!_i(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Xp="";function tE(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=up(e)),e=nE(n.get(t),e);return up(e)}function nE(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case Xp:t+="";break;default:t+=s}}return t}function up(n){return n+Xp+""}var rE="remoteDocuments",Zp="owner";var em="mutationQueues";var tm="mutations";var nm="documentMutations",iE="remoteDocumentsV14";var rm="remoteDocumentGlobal";var im="targets";var sm="targetDocuments";var om="targetGlobal",am="collectionParents";var cm="clientMetadata";var um="bundles";var lm="namedQueries";var sE="indexConfiguration";var oE="indexState";var aE="indexEntries";var hm="documentOverlays";var cE="globals";var uE=[em,tm,nm,rE,im,Zp,om,sm,cm,rm,am,um,lm],OS=[...uE,hm],lE=[em,tm,nm,iE,im,Zp,om,sm,cm,rm,am,um,lm,hm],hE=lE,dE=[...hE,sE,oE,aE];var xS=[...dE,cE];function lp(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function an(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function dm(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var he=class n{constructor(e,t){this.comparator=e,this.root=t||ht.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ht.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ht.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new or(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new or(this.root,e,this.comparator,!1)}getReverseIterator(){return new or(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new or(this.root,e,this.comparator,!0)}},or=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ht=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw M(43730,{key:this.key,value:this.value});if(this.right.isRed())throw M(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw M(27949);return e+(this.isRed()?0:1)}};ht.EMPTY=null,ht.RED=!0,ht.BLACK=!1;ht.EMPTY=new class{constructor(){this.size=0}get key(){throw M(57766)}get value(){throw M(16141)}get color(){throw M(16727)}get left(){throw M(29726)}get right(){throw M(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new ht(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ee=class n{constructor(e){this.comparator=e,this.data=new he(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new zs(this.data.getIterator())}getIteratorFrom(e){return new zs(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},zs=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var He=class n{constructor(e){this.fields=e,e.sort(Be.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ee(Be.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ur(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Ws=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var ke=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Ws("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return G(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ke.EMPTY_BYTE_STRING=new ke("");var fE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function kt(n){if(X(!!n,39018),typeof n=="string"){let e=0,t=fE.exec(n);if(X(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ae(n.seconds),nanos:ae(n.nanos)}}function ae(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Dt(n){return typeof n=="string"?ke.fromBase64String(n):ke.fromUint8Array(n)}var fm="server_timestamp",pm="__type__",mm="__previous_value__",gm="__local_write_time__";function Pl(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[pm])===null||t===void 0?void 0:t.stringValue)===fm}function bo(n){let e=n.mapValue.fields[mm];return Pl(e)?bo(e):e}function vi(n){let e=kt(n.mapValue.fields[gm].timestampValue);return new ye(e.seconds,e.nanos)}var Qc=class{constructor(e,t,r,i,s,a,c,l,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=d,this.isUsingEmulator=p}},Gs="(default)",Hs=class n{constructor(e,t){this.projectId=e,this.database=t||Gs}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===Gs}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var kl="__type__",ym="__max__",Vs={mapValue:{fields:{__type__:{stringValue:ym}}}},Dl="__vector__",lr="value";function tn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Pl(n)?4:vm(n)?9007199254740991:_m(n)?10:11:M(28295,{value:n})}function pt(n,e){if(n===e)return!0;let t=tn(n);if(t!==tn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return vi(n).isEqual(vi(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=kt(i.timestampValue),c=kt(s.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return Dt(i.bytesValue).isEqual(Dt(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return ae(i.geoPointValue.latitude)===ae(s.geoPointValue.latitude)&&ae(i.geoPointValue.longitude)===ae(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return ae(i.integerValue)===ae(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=ae(i.doubleValue),c=ae(s.doubleValue);return a===c?_i(a)===_i(c):isNaN(a)&&isNaN(c)}return!1})(n,e);case 9:return ur(n.arrayValue.values||[],e.arrayValue.values||[],pt);case 10:case 11:return(function(i,s){let a=i.mapValue.fields||{},c=s.mapValue.fields||{};if(lp(a)!==lp(c))return!1;for(let l in a)if(a.hasOwnProperty(l)&&(c[l]===void 0||!pt(a[l],c[l])))return!1;return!0})(n,e);default:return M(52216,{left:n})}}function Ii(n,e){return(n.values||[]).find(t=>pt(t,e))!==void 0}function hr(n,e){if(n===e)return 0;let t=tn(n),r=tn(e);if(t!==r)return G(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return G(n.booleanValue,e.booleanValue);case 2:return(function(s,a){let c=ae(s.integerValue||s.doubleValue),l=ae(a.integerValue||a.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1})(n,e);case 3:return hp(n.timestampValue,e.timestampValue);case 4:return hp(vi(n),vi(e));case 5:return Gc(n.stringValue,e.stringValue);case 6:return(function(s,a){let c=Dt(s),l=Dt(a);return c.compareTo(l)})(n.bytesValue,e.bytesValue);case 7:return(function(s,a){let c=s.split("/"),l=a.split("/");for(let d=0;d<c.length&&d<l.length;d++){let p=G(c[d],l[d]);if(p!==0)return p}return G(c.length,l.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,a){let c=G(ae(s.latitude),ae(a.latitude));return c!==0?c:G(ae(s.longitude),ae(a.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return dp(n.arrayValue,e.arrayValue);case 10:return(function(s,a){var c,l,d,p;let y=s.fields||{},_=a.fields||{},C=(c=y[lr])===null||c===void 0?void 0:c.arrayValue,k=(l=_[lr])===null||l===void 0?void 0:l.arrayValue,x=G(((d=C?.values)===null||d===void 0?void 0:d.length)||0,((p=k?.values)===null||p===void 0?void 0:p.length)||0);return x!==0?x:dp(C,k)})(n.mapValue,e.mapValue);case 11:return(function(s,a){if(s===Vs.mapValue&&a===Vs.mapValue)return 0;if(s===Vs.mapValue)return 1;if(a===Vs.mapValue)return-1;let c=s.fields||{},l=Object.keys(c),d=a.fields||{},p=Object.keys(d);l.sort(),p.sort();for(let y=0;y<l.length&&y<p.length;++y){let _=Gc(l[y],p[y]);if(_!==0)return _;let C=hr(c[l[y]],d[p[y]]);if(C!==0)return C}return G(l.length,p.length)})(n.mapValue,e.mapValue);default:throw M(23264,{le:t})}}function hp(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return G(n,e);let t=kt(n),r=kt(e),i=G(t.seconds,r.seconds);return i!==0?i:G(t.nanos,r.nanos)}function dp(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=hr(t[i],r[i]);if(s)return s}return G(t.length,r.length)}function dr(n){return Yc(n)}function Yc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=kt(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Dt(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return L.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Yc(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${Yc(t.fields[a])}`;return i+"}"})(n.mapValue):M(61005,{value:n})}function Fs(n){switch(tn(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=bo(n);return e?16+Fs(e):16;case 5:return 2*n.stringValue.length;case 6:return Dt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,s)=>i+Fs(s),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return an(r.fields,(s,a)=>{i+=s.length+Fs(a)}),i})(n.mapValue);default:throw M(13486,{value:n})}}function fp(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Jc(n){return!!n&&"integerValue"in n}function Nl(n){return!!n&&"arrayValue"in n}function pp(n){return!!n&&"nullValue"in n}function mp(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Us(n){return!!n&&"mapValue"in n}function _m(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[kl])===null||t===void 0?void 0:t.stringValue)===Dl}function di(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return an(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=di(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=di(n.arrayValue.values[t]);return e}return Object.assign({},n)}function vm(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===ym}var LS={mapValue:{fields:{[kl]:{stringValue:Dl},[lr]:{arrayValue:{}}}}};var $e=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Us(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=di(t)}setAll(e){let t=Be.emptyPath(),r={},i=[];e.forEach((a,c)=>{if(!t.isImmediateParentOf(c)){let l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=c.popLast()}a?r[c.lastSegment()]=di(a):i.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Us(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return pt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Us(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){an(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(di(this.value))}};function Im(n){let e=[];return an(n.fields,(t,r)=>{let i=new Be([t]);if(Us(r)){let s=Im(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new He(e)}var tt=class n{constructor(e,t,r,i,s,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=c}static newInvalidDocument(e){return new n(e,0,j.min(),j.min(),j.min(),$e.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,j.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,j.min(),j.min(),$e.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,j.min(),j.min(),$e.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(j.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$e.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$e.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=j.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var fr=class{constructor(e,t){this.position=e,this.inclusive=t}};function gp(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=L.comparator(L.fromName(a.referenceValue),t.key):r=hr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function yp(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!pt(n.position[t],e.position[t]))return!1;return!0}var Pn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function pE(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Ks=class{},me=class n extends Ks{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Zc(e,t,r):t==="array-contains"?new nu(e,r):t==="in"?new ru(e,r):t==="not-in"?new iu(e,r):t==="array-contains-any"?new su(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new eu(e,r):new tu(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(hr(t,this.value)):t!==null&&tn(this.value)===tn(t)&&this.matchesComparison(hr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return M(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},nt=class n extends Ks{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return wm(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function wm(n){return n.op==="and"}function Em(n){return mE(n)&&wm(n)}function mE(n){for(let e of n.filters)if(e instanceof nt)return!1;return!0}function Xc(n){if(n instanceof me)return n.field.canonicalString()+n.op.toString()+dr(n.value);if(Em(n))return n.filters.map(e=>Xc(e)).join(",");{let e=n.filters.map(t=>Xc(t)).join(",");return`${n.op}(${e})`}}function Tm(n,e){return n instanceof me?(function(r,i){return i instanceof me&&r.op===i.op&&r.field.isEqual(i.field)&&pt(r.value,i.value)})(n,e):n instanceof nt?(function(r,i){return i instanceof nt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,c)=>s&&Tm(a,i.filters[c]),!0):!1})(n,e):void M(19439)}function bm(n){return n instanceof me?(function(t){return`${t.field.canonicalString()} ${t.op} ${dr(t.value)}`})(n):n instanceof nt?(function(t){return t.op.toString()+" {"+t.getFilters().map(bm).join(" ,")+"}"})(n):"Filter"}var Zc=class extends me{constructor(e,t,r){super(e,t,r),this.key=L.fromName(r.referenceValue)}matches(e){let t=L.comparator(e.key,this.key);return this.matchesComparison(t)}},eu=class extends me{constructor(e,t){super(e,"in",t),this.keys=Am("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},tu=class extends me{constructor(e,t){super(e,"not-in",t),this.keys=Am("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function Am(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>L.fromName(r.referenceValue))}var nu=class extends me{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Nl(t)&&Ii(t.arrayValue,this.value)}},ru=class extends me{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ii(this.value.arrayValue,t)}},iu=class extends me{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ii(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Ii(this.value.arrayValue,t)}},su=class extends me{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Nl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ii(this.value.arrayValue,r))}};var ou=class{constructor(e,t=null,r=[],i=[],s=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=c,this.Pe=null}};function _p(n,e=null,t=[],r=[],i=null,s=null,a=null){return new ou(n,e,t,r,i,s,a)}function Ol(n){let e=B(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Xc(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(s){return s.field.canonicalString()+s.dir})(r)).join(","),To(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>dr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>dr(r)).join(",")),e.Pe=t}return e.Pe}function xl(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!pE(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Tm(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!yp(n.startAt,e.startAt)&&yp(n.endAt,e.endAt)}function au(n){return L.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var nn=class{constructor(e,t=null,r=[],i=[],s=null,a="F",c=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=c,this.endAt=l,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function gE(n,e,t,r,i,s,a,c){return new nn(n,e,t,r,i,s,a,c)}function Ao(n){return new nn(n)}function vp(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Sm(n){return n.collectionGroup!==null}function fi(n){let e=B(n);if(e.Te===null){e.Te=[];let t=new Set;for(let s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new Ee(Be.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new Pn(s,r))}),t.has(Be.keyField().canonicalString())||e.Te.push(new Pn(Be.keyField(),r))}return e.Te}function dt(n){let e=B(n);return e.Ie||(e.Ie=yE(e,fi(n))),e.Ie}function yE(n,e){if(n.limitType==="F")return _p(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Pn(i.field,s)});let t=n.endAt?new fr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new fr(n.startAt.position,n.startAt.inclusive):null;return _p(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function cu(n,e){let t=n.filters.concat([e]);return new nn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function uu(n,e,t){return new nn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function So(n,e){return xl(dt(n),dt(e))&&n.limitType===e.limitType}function Cm(n){return`${Ol(dt(n))}|lt:${n.limitType}`}function rr(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>bm(i)).join(", ")}]`),To(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(a){return`${a.field.canonicalString()} (${a.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>dr(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>dr(i)).join(",")),`Target(${r})`})(dt(n))}; limitType=${n.limitType})`}function Co(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):L.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of fi(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(a,c,l){let d=gp(a,c,l);return a.inclusive?d<=0:d<0})(r.startAt,fi(r),i)||r.endAt&&!(function(a,c,l){let d=gp(a,c,l);return a.inclusive?d>=0:d>0})(r.endAt,fi(r),i))})(n,e)}function _E(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Rm(n){return(e,t)=>{let r=!1;for(let i of fi(n)){let s=vE(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function vE(n,e,t){let r=n.field.isKeyField()?L.comparator(e.key,t.key):(function(s,a,c){let l=a.data.field(s),d=c.data.field(s);return l!==null&&d!==null?hr(l,d):M(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return M(19790,{direction:n.dir})}}var Nt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){an(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return dm(this.inner)}size(){return this.innerSize}};var IE=new he(L.comparator);function Ot(){return IE}var Pm=new he(L.comparator);function hi(...n){let e=Pm;for(let t of n)e=e.insert(t.key,t);return e}function km(n){let e=Pm;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function En(){return pi()}function Dm(){return pi()}function pi(){return new Nt(n=>n.toString(),(n,e)=>n.isEqual(e))}var wE=new he(L.comparator),EE=new Ee(L.comparator);function K(...n){let e=EE;for(let t of n)e=e.add(t);return e}var TE=new Ee(G);function bE(){return TE}function Vl(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_i(e)?"-0":e}}function Nm(n){return{integerValue:""+n}}function AE(n,e){return eE(e)?Nm(e):Vl(n,e)}var pr=class{constructor(){this._=void 0}};function SE(n,e,t){return n instanceof kn?(function(i,s){let a={fields:{[pm]:{stringValue:fm},[gm]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Pl(s)&&(s=bo(s)),s&&(a.fields[mm]=s),{mapValue:a}})(t,e):n instanceof Dn?xm(n,e):n instanceof Nn?Vm(n,e):(function(i,s){let a=Om(i,s),c=Ip(a)+Ip(i.Ee);return Jc(a)&&Jc(i.Ee)?Nm(c):Vl(i.serializer,c)})(n,e)}function CE(n,e,t){return n instanceof Dn?xm(n,e):n instanceof Nn?Vm(n,e):t}function Om(n,e){return n instanceof mr?(function(r){return Jc(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var kn=class extends pr{},Dn=class extends pr{constructor(e){super(),this.elements=e}};function xm(n,e){let t=Lm(e);for(let r of n.elements)t.some(i=>pt(i,r))||t.push(r);return{arrayValue:{values:t}}}var Nn=class extends pr{constructor(e){super(),this.elements=e}};function Vm(n,e){let t=Lm(e);for(let r of n.elements)t=t.filter(i=>!pt(i,r));return{arrayValue:{values:t}}}var mr=class extends pr{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function Ip(n){return ae(n.integerValue||n.doubleValue)}function Lm(n){return Nl(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var lu=class{constructor(e,t){this.field=e,this.transform=t}};function RE(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Dn&&i instanceof Dn||r instanceof Nn&&i instanceof Nn?ur(r.elements,i.elements,pt):r instanceof mr&&i instanceof mr?pt(r.Ee,i.Ee):r instanceof kn&&i instanceof kn})(n.transform,e.transform)}var hu=class{constructor(e,t){this.version=e,this.transformResults=t}},qe=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function $s(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var gr=class{};function Mm(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new yr(n.key,qe.none()):new On(n.key,n.data,qe.none());{let t=n.data,r=$e.empty(),i=new Ee(Be.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new mt(n.key,r,new He(i.toArray()),qe.none())}}function PE(n,e,t){n instanceof On?(function(i,s,a){let c=i.value.clone(),l=Ep(i.fieldTransforms,s,a.transformResults);c.setAll(l),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()})(n,e,t):n instanceof mt?(function(i,s,a){if(!$s(i.precondition,s))return void s.convertToUnknownDocument(a.version);let c=Ep(i.fieldTransforms,s,a.transformResults),l=s.data;l.setAll(Fm(i)),l.setAll(c),s.convertToFoundDocument(a.version,l).setHasCommittedMutations()})(n,e,t):(function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()})(0,e,t)}function mi(n,e,t,r){return n instanceof On?(function(s,a,c,l){if(!$s(s.precondition,a))return c;let d=s.value.clone(),p=Tp(s.fieldTransforms,l,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof mt?(function(s,a,c,l){if(!$s(s.precondition,a))return c;let d=Tp(s.fieldTransforms,l,a),p=a.data;return p.setAll(Fm(s)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(y=>y.field))})(n,e,t,r):(function(s,a,c){return $s(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c})(n,e,t)}function kE(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=Om(r.transform,i||null);s!=null&&(t===null&&(t=$e.empty()),t.set(r.field,s))}return t||null}function wp(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ur(r,i,(s,a)=>RE(s,a))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var On=class extends gr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},mt=class extends gr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Fm(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Ep(n,e,t){let r=new Map;X(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,c=e.data.field(s.field);r.set(s.field,CE(a,c,t[i]))}return r}function Tp(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,SE(s,a,e))}return r}var yr=class extends gr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},du=class extends gr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var fu=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&PE(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=mi(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=mi(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Dm();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,c=this.applyToLocalView(a,s.mutatedFields);c=t.has(i.key)?null:c;let l=Mm(a,c);l!==null&&r.set(i.key,l),a.isValidDocument()||a.convertToNoDocument(j.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),K())}isEqual(e){return this.batchId===e.batchId&&ur(this.mutations,e.mutations,(t,r)=>wp(t,r))&&ur(this.baseMutations,e.baseMutations,(t,r)=>wp(t,r))}},pu=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){X(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=(function(){return wE})(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var mu=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var gu=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var fe,Y;function DE(n){switch(n){case R.OK:return M(64938);case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0;default:return M(15467,{code:n})}}function Um(n){if(n===void 0)return Pt("GRPC error has no .code"),R.UNKNOWN;switch(n){case fe.OK:return R.OK;case fe.CANCELLED:return R.CANCELLED;case fe.UNKNOWN:return R.UNKNOWN;case fe.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case fe.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case fe.INTERNAL:return R.INTERNAL;case fe.UNAVAILABLE:return R.UNAVAILABLE;case fe.UNAUTHENTICATED:return R.UNAUTHENTICATED;case fe.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case fe.NOT_FOUND:return R.NOT_FOUND;case fe.ALREADY_EXISTS:return R.ALREADY_EXISTS;case fe.PERMISSION_DENIED:return R.PERMISSION_DENIED;case fe.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case fe.ABORTED:return R.ABORTED;case fe.OUT_OF_RANGE:return R.OUT_OF_RANGE;case fe.UNIMPLEMENTED:return R.UNIMPLEMENTED;case fe.DATA_LOSS:return R.DATA_LOSS;default:return M(39323,{code:n})}}(Y=fe||(fe={}))[Y.OK=0]="OK",Y[Y.CANCELLED=1]="CANCELLED",Y[Y.UNKNOWN=2]="UNKNOWN",Y[Y.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Y[Y.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Y[Y.NOT_FOUND=5]="NOT_FOUND",Y[Y.ALREADY_EXISTS=6]="ALREADY_EXISTS",Y[Y.PERMISSION_DENIED=7]="PERMISSION_DENIED",Y[Y.UNAUTHENTICATED=16]="UNAUTHENTICATED",Y[Y.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Y[Y.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Y[Y.ABORTED=10]="ABORTED",Y[Y.OUT_OF_RANGE=11]="OUT_OF_RANGE",Y[Y.UNIMPLEMENTED=12]="UNIMPLEMENTED",Y[Y.INTERNAL=13]="INTERNAL",Y[Y.UNAVAILABLE=14]="UNAVAILABLE",Y[Y.DATA_LOSS=15]="DATA_LOSS";var bp=null;var NE=new Ct([4294967295,4294967295],0);function Ap(n){let e=Qp().encode(n),t=new Pc;return t.update(e),new Uint8Array(t.digest())}function Sp(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ct([t,r],0),new Ct([i,s],0)]}var yu=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Tn(`Invalid padding: ${t}`);if(r<0)throw new Tn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Tn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Tn(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Ct.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(Ct.fromNumber(r)));return i.compare(NE)===1&&(i=new Ct([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let t=Ap(e),[r,i]=Sp(t);for(let s=0;s<this.hashCount;s++){let a=this.pe(r,i,s);if(!this.ye(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(c=>a.insert(c)),a}insert(e){if(this.fe===0)return;let t=Ap(e),[r,i]=Sp(t);for(let s=0;s<this.hashCount;s++){let a=this.pe(r,i,s);this.we(a)}}we(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Tn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Qs=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,wi.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(j.min(),i,new he(G),Ot(),K())}},wi=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,K(),K(),K())}};var ar=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}},Ys=class{constructor(e,t){this.targetId=e,this.De=t}},Js=class{constructor(e,t,r=ke.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},Xs=class{constructor(){this.ve=0,this.Ce=Cp(),this.Fe=ke.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=K(),t=K(),r=K();return this.Ce.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:M(38017,{changeType:s})}}),new wi(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=Cp()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,X(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},_u=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=Ot(),this.je=Ls(),this.Je=Ls(),this.He=new he(G)}Ye(e){for(let t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(let t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{let r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:M(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,i)=>{this.nt(i)&&t(i)})}it(e){let t=e.targetId,r=e.De.count,i=this.st(t);if(i){let s=i.target;if(au(s))if(r===0){let a=new L(s.path);this.Xe(t,a,tt.newNoDocument(a,j.min()))}else X(r===1,20013,{expectedCount:r});else{let a=this.ot(t);if(a!==r){let c=this._t(e),l=c?this.ut(c,e,a):1;if(l!==0){this.rt(t);let d=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,d)}bp?.ct((function(p,y,_,C,k){var x,D,z,$,W,ee;let De={localCacheCount:p,existenceFilterCount:y.count,databaseId:_.database,projectId:_.projectId},Z=y.unchangedNames;return Z&&(De.bloomFilter={applied:k===0,hashCount:(x=Z?.hashCount)!==null&&x!==void 0?x:0,bitmapLength:($=(z=(D=Z?.bits)===null||D===void 0?void 0:D.bitmap)===null||z===void 0?void 0:z.length)!==null&&$!==void 0?$:0,padding:(ee=(W=Z?.bits)===null||W===void 0?void 0:W.padding)!==null&&ee!==void 0?ee:0,mightContain:E=>{var g;return(g=C?.mightContain(E))!==null&&g!==void 0&&g}}),De})(a,e.De,this.We.lt(),c,l))}}}}_t(e){let t=e.De.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,c;try{a=Dt(r).toUint8Array()}catch(l){if(l instanceof Ws)return en("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new yu(a,i,s)}catch(l){return en(l instanceof Tn?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.fe===0?null:c}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){let r=this.We.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.We.lt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Xe(t,s,null),i++)}),i}Pt(e){let t=new Map;this.Ge.forEach((s,a)=>{let c=this.st(a);if(c){if(s.current&&au(c.target)){let l=new L(c.target.path);this.Tt(l).has(a)||this.It(a,l)||this.Xe(a,l,tt.newNoDocument(l,e))}s.Ne&&(t.set(a,s.Le()),s.ke())}});let r=K();this.Je.forEach((s,a)=>{let c=!0;a.forEachWhile(l=>{let d=this.st(l);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.ze.forEach((s,a)=>a.setReadTime(e));let i=new Qs(e,t,this.He,this.ze,r);return this.ze=Ot(),this.je=Ls(),this.Je=Ls(),this.He=new he(G),i}Ze(e,t){if(!this.nt(e))return;let r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;let i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){let t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Xs,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Ee(G),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Ee(G),this.je=this.je.insert(e,t)),t}nt(e){let t=this.st(e)!==null;return t||V("WatchChangeAggregator","Detected inactive target",e),t}st(e){let t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Xs),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}};function Ls(){return new he(L.comparator)}function Cp(){return new he(L.comparator)}var OE={asc:"ASCENDING",desc:"DESCENDING"},xE={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},VE={and:"AND",or:"OR"},vu=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Iu(n,e){return n.useProto3Json||To(e)?e:{value:e}}function Zs(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $m(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function LE(n,e){return Zs(n,e.toTimestamp())}function ft(n){return X(!!n,49232),j.fromTimestamp((function(t){let r=kt(t);return new ye(r.seconds,r.nanos)})(n))}function Ll(n,e){return wu(n,e).canonicalString()}function wu(n,e){let t=(function(i){return new ce(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function Bm(n){let e=ce.fromString(n);return X(Gm(e),10190,{key:e.toString()}),e}function Eu(n,e){return Ll(n.databaseId,e.path)}function Vc(n,e){let t=Bm(e);if(t.get(1)!==n.databaseId.projectId)throw new O(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new O(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new L(jm(t))}function qm(n,e){return Ll(n.databaseId,e)}function ME(n){let e=Bm(n);return e.length===4?ce.emptyPath():jm(e)}function Tu(n){return new ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function jm(n){return X(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Rp(n,e,t){return{name:Eu(n,e),fields:t.value.mapValue.fields}}function FE(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:M(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(d,p){return d.useProto3Json?(X(p===void 0||typeof p=="string",58123),ke.fromBase64String(p||"")):(X(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),ke.fromUint8Array(p||new Uint8Array))})(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&(function(d){let p=d.code===void 0?R.UNKNOWN:Um(d.code);return new O(p,d.message||"")})(a);t=new Js(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Vc(n,r.document.name),s=ft(r.document.updateTime),a=r.document.createTime?ft(r.document.createTime):j.min(),c=new $e({mapValue:{fields:r.document.fields}}),l=tt.newFoundDocument(i,s,a,c),d=r.targetIds||[],p=r.removedTargetIds||[];t=new ar(d,p,l.key,l)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Vc(n,r.document),s=r.readTime?ft(r.readTime):j.min(),a=tt.newNoDocument(i,s),c=r.removedTargetIds||[];t=new ar([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Vc(n,r.document),s=r.removedTargetIds||[];t=new ar([],s,i,null)}else{if(!("filter"in e))return M(11601,{At:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new gu(i,s),c=r.targetId;t=new Ys(c,a)}}return t}function UE(n,e){let t;if(e instanceof On)t={update:Rp(n,e.key,e.value)};else if(e instanceof yr)t={delete:Eu(n,e.key)};else if(e instanceof mt)t={update:Rp(n,e.key,e.data),updateMask:KE(e.fieldMask)};else{if(!(e instanceof du))return M(16599,{Rt:e.type});t={verify:Eu(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(s,a){let c=a.transform;if(c instanceof kn)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Dn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Nn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof mr)return{fieldPath:a.field.canonicalString(),increment:c.Ee};throw M(20930,{transform:a.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:LE(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:M(27497)})(n,e.precondition)),t}function $E(n,e){return n&&n.length>0?(X(e!==void 0,14353),n.map(t=>(function(i,s){let a=i.updateTime?ft(i.updateTime):ft(s);return a.isEqual(j.min())&&(a=ft(s)),new hu(a,i.transformResults||[])})(t,e))):[]}function BE(n,e){return{documents:[qm(n,e.path)]}}function qE(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=qm(n,i);let s=(function(d){if(d.length!==0)return Wm(nt.create(d,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let a=(function(d){if(d.length!==0)return d.map(p=>(function(_){return{field:ir(_.field),direction:WE(_.dir)}})(p))})(e.orderBy);a&&(t.structuredQuery.orderBy=a);let c=Iu(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{Vt:t,parent:i}}function jE(n){let e=ME(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){X(r===1,65062);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=(function(y){let _=zm(y);return _ instanceof nt&&Em(_)?_.getFilters():[_]})(t.where));let a=[];t.orderBy&&(a=(function(y){return y.map(_=>(function(k){return new Pn(sr(k.field),(function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(_))})(t.orderBy));let c=null;t.limit&&(c=(function(y){let _;return _=typeof y=="object"?y.value:y,To(_)?null:_})(t.limit));let l=null;t.startAt&&(l=(function(y){let _=!!y.before,C=y.values||[];return new fr(C,_)})(t.startAt));let d=null;return t.endAt&&(d=(function(y){let _=!y.before,C=y.values||[];return new fr(C,_)})(t.endAt)),gE(e,i,a,s,c,"F",l,d)}function zE(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return M(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function zm(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=sr(t.unaryFilter.field);return me.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=sr(t.unaryFilter.field);return me.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=sr(t.unaryFilter.field);return me.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=sr(t.unaryFilter.field);return me.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return M(61313);default:return M(60726)}})(n):n.fieldFilter!==void 0?(function(t){return me.create(sr(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return M(58110);default:return M(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return nt.create(t.compositeFilter.filters.map(r=>zm(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return M(1026)}})(t.compositeFilter.op))})(n):M(30097,{filter:n})}function WE(n){return OE[n]}function GE(n){return xE[n]}function HE(n){return VE[n]}function ir(n){return{fieldPath:n.canonicalString()}}function sr(n){return Be.fromServerFormat(n.fieldPath)}function Wm(n){return n instanceof me?(function(t){if(t.op==="=="){if(mp(t.value))return{unaryFilter:{field:ir(t.field),op:"IS_NAN"}};if(pp(t.value))return{unaryFilter:{field:ir(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(mp(t.value))return{unaryFilter:{field:ir(t.field),op:"IS_NOT_NAN"}};if(pp(t.value))return{unaryFilter:{field:ir(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ir(t.field),op:GE(t.op),value:t.value}}})(n):n instanceof nt?(function(t){let r=t.getFilters().map(i=>Wm(i));return r.length===1?r[0]:{compositeFilter:{op:HE(t.op),filters:r}}})(n):M(54877,{filter:n})}function KE(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Gm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ei=class n{constructor(e,t,r,i,s=j.min(),a=j.min(),c=ke.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var bu=class{constructor(e){this.gt=e}};function QE(n){let e=jE({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?uu(e,e.limit,"L"):e}var eo=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(ae(e.integerValue));else if("doubleValue"in e){let r=ae(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),_i(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=kt(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(Dt(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?vm(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):_m(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):M(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let i of Object.keys(r))this.xt(i,t),this.Dt(r[i],t)}Lt(e,t){var r,i;let s=e.fields||{};this.Ct(t,53);let a=lr,c=((i=(r=s[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(t,15),t.Ft(ae(c)),this.xt(a,t),this.Dt(s[a],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let i of r)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),L.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};eo.Ut=new eo;var Au=class{constructor(){this.Dn=new Su}addToCollectionParentIndex(e,t){return this.Dn.add(t),P.resolve()}getCollectionParents(e,t){return P.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return P.resolve()}deleteFieldIndex(e,t){return P.resolve()}deleteAllFieldIndexes(e){return P.resolve()}createTargetIndexes(e,t){return P.resolve()}getDocumentsMatchingTarget(e,t){return P.resolve(null)}getIndexType(e,t){return P.resolve(0)}getFieldIndexes(e,t){return P.resolve([])}getNextCollectionGroupToUpdate(e){return P.resolve(null)}getMinOffset(e,t){return P.resolve(Rn.min())}getMinOffsetFromCollectionGroup(e,t){return P.resolve(Rn.min())}updateCollectionGroup(e,t,r){return P.resolve()}updateIndexEntries(e,t){return P.resolve()}},Su=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ee(ce.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ee(ce.comparator)).toArray()}};var MS=new Uint8Array(0);var Pp={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Hm=41943040,Ge=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Ge.DEFAULT_COLLECTION_PERCENTILE=10,Ge.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ge.DEFAULT=new Ge(Hm,Ge.DEFAULT_COLLECTION_PERCENTILE,Ge.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ge.DISABLED=new Ge(-1,0,0);var Ti=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var kp="LruGarbageCollector",YE=1048576;function Dp([n,e],[t,r]){let i=G(n,t);return i===0?G(e,r):i}var Cu=class{constructor(e){this.Tr=e,this.buffer=new Ee(Dp),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();Dp(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},Ru=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){V(kp,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>m(this,null,function*(){this.Ar=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(t){Tr(t)?V(kp,"Ignoring IndexedDB error during garbage collection: ",t):yield Er(t)}yield this.Rr(3e5)}))}},Pu=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return P.resolve(Cl.ue);let r=new Cu(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(V("LruGarbageCollector","Garbage collection skipped; disabled"),P.resolve(Pp)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(V("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Pp):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,s,a,c,l,d,p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(V("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,a=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(r=y,c=Date.now(),this.removeTargets(e,r,t))).next(y=>(s=y,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(y=>(d=Date.now(),nr()<=H.DEBUG&&V("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-p}ms
	Determined least recently used ${i} in `+(c-a)+`ms
	Removed ${s} targets in `+(l-c)+`ms
	Removed ${y} documents in `+(d-l)+`ms
Total Duration: ${d-p}ms`),P.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:y})))}};function JE(n,e){return new Pu(n,e)}var ku=class{constructor(){this.changes=new Nt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,tt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?P.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Du=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Nu=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&mi(r.mutation,i,He.empty(),ye.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,K()).next(()=>r))}getLocalViewOfDocuments(e,t,r=K()){let i=En();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=hi();return s.forEach((c,l)=>{a=a.insert(c,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=En();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,K()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,c)=>{t.set(a,c)})})}computeViews(e,t,r,i){let s=Ot(),a=pi(),c=(function(){return pi()})();return t.forEach((l,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof mt)?s=s.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),mi(p.mutation,d,p.mutation.getFieldMask(),ye.now())):a.set(d.key,He.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var y;return c.set(d,new Du(p,(y=a.get(d))!==null&&y!==void 0?y:null))}),c))}recalculateAndSaveOverlays(e,t){let r=pi(),i=new he((a,c)=>a-c),s=K();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let c of a)c.keys().forEach(l=>{let d=t.get(l);if(d===null)return;let p=r.get(l)||He.empty();p=c.applyToLocalView(d,p),r.set(l,p);let y=(i.get(c.batchId)||K()).add(l);i=i.insert(c.batchId,y)})}).next(()=>{let a=[],c=i.getReverseIterator();for(;c.hasNext();){let l=c.getNext(),d=l.key,p=l.value,y=Dm();p.forEach(_=>{if(!s.has(_)){let C=Mm(t.get(_),r.get(_));C!==null&&y.set(_,C),s=s.add(_)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,y))}return P.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(a){return L.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Sm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):P.resolve(En()),c=yi,l=s;return a.next(d=>P.forEach(d,(p,y)=>(c<y.largestBatchId&&(c=y.largestBatchId),s.get(p)?P.resolve():this.remoteDocumentCache.getEntry(e,p).next(_=>{l=l.insert(p,_)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,l,d,K())).next(p=>({batchId:c,changes:km(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new L(t)).next(r=>{let i=hi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=hi();return this.indexManager.getCollectionParents(e,s).next(c=>P.forEach(c,l=>{let d=(function(y,_){return new nn(_,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)})(t,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((y,_)=>{a=a.insert(y,_)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((l,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,tt.newInvalidDocument(p)))});let c=hi();return a.forEach((l,d)=>{let p=s.get(l);p!==void 0&&mi(p.mutation,d,He.empty(),ye.now()),Co(t,d)&&(c=c.insert(l,d))}),c})}};var Ou=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return P.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:ft(i.createTime)}})(t)),P.resolve()}getNamedQuery(e,t){return P.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(i){return{name:i.name,query:QE(i.bundledQuery),readTime:ft(i.readTime)}})(t)),P.resolve()}};var xu=class{constructor(){this.overlays=new he(L.comparator),this.kr=new Map}getOverlay(e,t){return P.resolve(this.overlays.get(t))}getOverlays(e,t){let r=En();return P.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.wt(e,t,s)}),P.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),P.resolve()}getOverlaysForCollection(e,t,r){let i=En(),s=t.length+1,a=new L(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){let l=c.getNext().value,d=l.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return P.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new he((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=En(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let c=En(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((d,p)=>c.set(d,p)),!(c.size()>=i)););return P.resolve(c)}wt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new mu(t,r));let s=this.kr.get(t);s===void 0&&(s=K(),this.kr.set(t,s)),this.kr.set(t,s.add(r.key))}};var Vu=class{constructor(){this.sessionToken=ke.EMPTY_BYTE_STRING}getSessionToken(e){return P.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,P.resolve()}};var bi=class{constructor(){this.qr=new Ee(pe.Qr),this.$r=new Ee(pe.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new pe(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new pe(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new L(new ce([])),r=new pe(t,e),i=new pe(t,e+1),s=[];return this.$r.forEachInRange([r,i],a=>{this.Wr(a),s.push(a.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new L(new ce([])),r=new pe(t,e),i=new pe(t,e+1),s=K();return this.$r.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new pe(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},pe=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return L.comparator(e.key,t.key)||G(e.Hr,t.Hr)}static Ur(e,t){return G(e.Hr,t.Hr)||L.comparator(e.key,t.key)}};var Lu=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Ee(pe.Qr)}checkEmpty(e){return P.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new fu(s,t,r,i);this.mutationQueue.push(a);for(let c of i)this.Yr=this.Yr.add(new pe(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return P.resolve(a)}lookupMutationBatch(e,t){return P.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),s=i<0?0:i;return P.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return P.resolve(this.mutationQueue.length===0?Rl:this.er-1)}getAllMutationBatches(e){return P.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new pe(t,0),i=new pe(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],a=>{let c=this.Zr(a.Hr);s.push(c)}),P.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ee(G);return t.forEach(i=>{let s=new pe(i,0),a=new pe(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,a],c=>{r=r.add(c.Hr)})}),P.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;L.isDocumentKey(s)||(s=s.child(""));let a=new pe(new L(s),0),c=new Ee(G);return this.Yr.forEachWhile(l=>{let d=l.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(l.Hr)),!0)},a),P.resolve(this.ei(c))}ei(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){X(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return P.forEach(t.mutations,i=>{let s=new pe(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new pe(t,0),i=this.Yr.firstAfterOrEqual(r);return P.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,P.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Mu=class{constructor(e){this.ni=e,this.docs=(function(){return new he(L.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return P.resolve(r?r.document.mutableCopy():tt.newInvalidDocument(t))}getEntries(e,t){let r=Ot();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():tt.newInvalidDocument(i))}),P.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ot(),a=t.path,c=new L(a.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){let{key:d,value:{document:p}}=l.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||Jw(Yw(p),r)<=0||(i.has(p.key)||Co(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return P.resolve(s)}getAllFromCollectionGroup(e,t,r,i){M(9500)}ri(e,t){return P.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Fu(this)}getSize(e){return P.resolve(this.size)}},Fu=class extends ku{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),P.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var Uu=class{constructor(e){this.persistence=e,this.ii=new Nt(t=>Ol(t),xl),this.lastRemoteSnapshotVersion=j.min(),this.highestTargetId=0,this.si=0,this.oi=new bi,this.targetCount=0,this._i=Ti.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),P.resolve()}getLastRemoteSnapshotVersion(e){return P.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return P.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),P.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),P.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new Ti(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,P.resolve()}updateTargetData(e,t){return this.hr(t),P.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,P.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.ii.forEach((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.ii.delete(a),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),P.waitFor(s).next(()=>i)}getTargetCount(e){return P.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return P.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),P.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),P.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),P.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return P.resolve(r)}containsKey(e,t){return P.resolve(this.oi.containsKey(t))}};var to=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new Cl(0),this.ci=!1,this.ci=!0,this.li=new Vu,this.referenceDelegate=e(this),this.hi=new Uu(this),this.indexManager=new Au,this.remoteDocumentCache=(function(i){return new Mu(i)})(r=>this.referenceDelegate.Pi(r)),this.serializer=new bu(t),this.Ti=new Ou(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new xu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new Lu(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){V("MemoryPersistence","Starting transaction:",e);let i=new $u(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,t){return P.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},$u=class extends Kc{constructor(e){super(),this.currentSequenceNumber=e}},Bu=class n{constructor(e){this.persistence=e,this.Ai=new bi,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw M(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),P.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),P.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),P.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return P.forEach(this.mi,r=>{let i=L.fromPath(r);return this.fi(e,i).next(s=>{s||t.removeEntry(i,j.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return P.or([()=>P.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},no=class n{constructor(e,t){this.persistence=e,this.gi=new Nt(r=>tE(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=JE(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return P.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return P.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(s=>s?P.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(e,a=>this.Sr(e,a,t).next(c=>{c||(r++,s.removeEntry(a,j.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),P.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),P.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),P.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),P.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Fs(e.data.value)),t}Sr(e,t,r){return P.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.gi.get(t);return P.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var qu=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=K(),i=K();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var ju=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var zu=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return Id()?8:Zw(Ie())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ps(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ys(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new ju;return this.ws(e,t,a).next(c=>{if(s.result=c,this.Rs)return this.Ss(e,t,a,c.size)})}).next(()=>s.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(nr()<=H.DEBUG&&V("QueryEngine","SDK will not create cache indexes for query:",rr(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),P.resolve()):(nr()<=H.DEBUG&&V("QueryEngine","Query:",rr(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(nr()<=H.DEBUG&&V("QueryEngine","The SDK decides to create cache indexes for query:",rr(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dt(t))):P.resolve())}ps(e,t){if(vp(t))return P.resolve(null);let r=dt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=uu(t,null,"F"),r=dt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=K(...s);return this.gs.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,r).next(l=>{let d=this.bs(t,c);return this.Ds(t,d,a,l.readTime)?this.ps(e,uu(t,null,"F")):this.vs(e,d,t,l)}))})))}ys(e,t,r,i){return vp(t)||i.isEqual(j.min())?P.resolve(null):this.gs.getDocuments(e,r).next(s=>{let a=this.bs(t,s);return this.Ds(t,a,r,i)?P.resolve(null):(nr()<=H.DEBUG&&V("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),rr(t)),this.vs(e,a,t,Qw(i,yi)).next(c=>c))})}bs(e,t){let r=new Ee(Rm(e));return t.forEach((i,s)=>{Co(e,s)&&(r=r.add(s))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(e,t,r){return nr()<=H.DEBUG&&V("QueryEngine","Using full collection scan to execute query:",rr(t)),this.gs.getDocumentsMatchingQuery(e,t,Rn.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var Ml="LocalStore",XE=3e8,Wu=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new he(G),this.Ms=new Nt(s=>Ol(s),xl),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Nu(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function ZE(n,e,t,r){return new Wu(n,e,t,r)}function Km(n,e){return m(this,null,function*(){let t=B(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],c=[],l=K();for(let d of i){a.push(d.batchId);for(let p of d.mutations)l=l.add(p.key)}for(let d of s){c.push(d.batchId);for(let p of d.mutations)l=l.add(p.key)}return t.localDocuments.getDocuments(r,l).next(d=>({Bs:d,removedBatchIds:a,addedBatchIds:c}))})})})}function eT(n,e){let t=B(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return(function(c,l,d,p){let y=d.batch,_=y.keys(),C=P.resolve();return _.forEach(k=>{C=C.next(()=>p.getEntry(l,k)).next(x=>{let D=d.docVersions.get(k);X(D!==null,48541),x.version.compareTo(D)<0&&(y.applyToRemoteDocument(x,d),x.isValidDocument()&&(x.setReadTime(d.commitVersion),p.addEntry(x)))})}),C.next(()=>c.mutationQueue.removeMutationBatch(l,y))})(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let l=K();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(l=l.add(c.batch.mutations[d].key));return l})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Qm(n){let e=B(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function tT(n,e){let t=B(n),r=e.snapshotVersion,i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;let c=[];e.targetChanges.forEach((p,y)=>{let _=i.get(y);if(!_)return;c.push(t.hi.removeMatchingKeys(s,p.removedDocuments,y).next(()=>t.hi.addMatchingKeys(s,p.addedDocuments,y)));let C=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(y)!==null?C=C.withResumeToken(ke.EMPTY_BYTE_STRING,j.min()).withLastLimboFreeSnapshotVersion(j.min()):p.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(p.resumeToken,r)),i=i.insert(y,C),(function(x,D,z){return x.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=XE?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0})(_,C,p)&&c.push(t.hi.updateTargetData(s,C))});let l=Ot(),d=K();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),c.push(nT(s,a,e.documentUpdates).next(p=>{l=p.Ls,d=p.ks})),!r.isEqual(j.min())){let p=t.hi.getLastRemoteSnapshotVersion(s).next(y=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(p)}return P.waitFor(c).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,d)).next(()=>l)}).then(s=>(t.Fs=i,s))}function nT(n,e,t){let r=K(),i=K();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Ot();return t.forEach((c,l)=>{let d=s.get(c);l.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),l.isNoDocument()&&l.version.isEqual(j.min())?(e.removeEntry(c,l.readTime),a=a.insert(c,l)):!d.isValidDocument()||l.version.compareTo(d.version)>0||l.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(l),a=a.insert(c,l)):V(Ml,"Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",l.version)}),{Ls:a,ks:i}})}function rT(n,e){let t=B(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Rl),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function iT(n,e){let t=B(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.hi.getTargetData(r,e).next(s=>s?(i=s,P.resolve(i)):t.hi.allocateTargetId(r).next(a=>(i=new Ei(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}function Gu(n,e,t){return m(this,null,function*(){let r=B(n),i=r.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Tr(a))throw a;V(Ml,`Failed to update sequence numbers for target ${e}: ${a}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)})}function Np(n,e,t){let r=B(n),i=j.min(),s=K();return r.persistence.runTransaction("Execute query","readwrite",a=>(function(l,d,p){let y=B(l),_=y.Ms.get(p);return _!==void 0?P.resolve(y.Fs.get(_)):y.hi.getTargetData(d,p)})(r,a,dt(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(a,c.targetId).next(l=>{s=l})}).next(()=>r.Cs.getDocumentsMatchingQuery(a,e,t?i:j.min(),t?s:K())).next(c=>(sT(r,_E(e),c),{documents:c,qs:s})))}function sT(n,e,t){let r=n.xs.get(e)||j.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.xs.set(e,r)}var ro=class{constructor(){this.activeTargetIds=bE()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var Hu=class{constructor(){this.Fo=new ro,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new ro,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Ku=class{xo(e){}shutdown(){}};var Op="ConnectivityMonitor",io=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){V(Op,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){V(Op,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ms=null;function Qu(){return Ms===null?Ms=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ms++,"0x"+Ms.toString(16)}var Lc="RestConnection",oT={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},Yu=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===Gs?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,s){let a=Qu(),c=this.Go(e,t.toUriEncodedString());V(Lc,`Sending RPC '${e}' ${a}:`,c,r);let l={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(l,i,s);let{host:d}=new URL(c),p=$t(d);return this.jo(e,c,l,r,p).then(y=>(V(Lc,`Received RPC '${e}' ${a}: `,y),y),y=>{throw en(Lc,`RPC '${e}' ${a} failed with error: `,y,"url: ",c,"request:",r),y})}Jo(e,t,r,i,s,a){return this.Wo(e,t,r,i,s)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+wr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Go(e,t){let r=oT[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var Ju=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var Pe="WebChannelConnection",Xu=class extends Yu{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,s){let a=Qu();return new Promise((c,l)=>{let d=new kc;d.setWithCredentials(!0),d.listenOnce(Dc.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case li.NO_ERROR:let y=d.getResponseJson();V(Pe,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(y)),c(y);break;case li.TIMEOUT:V(Pe,`RPC '${e}' ${a} timed out`),l(new O(R.DEADLINE_EXCEEDED,"Request time out"));break;case li.HTTP_ERROR:let _=d.getStatus();if(V(Pe,`RPC '${e}' ${a} failed with status:`,_,"response text:",d.getResponseText()),_>0){let C=d.getResponseJson();Array.isArray(C)&&(C=C[0]);let k=C?.error;if(k&&k.status&&k.message){let x=(function(z){let $=z.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf($)>=0?$:R.UNKNOWN})(k.status);l(new O(x,k.message))}else l(new O(R.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new O(R.UNAVAILABLE,"Connection failed."));break;default:M(9055,{c_:e,streamId:a,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{V(Pe,`RPC '${e}' ${a} completed.`)}});let p=JSON.stringify(i);V(Pe,`RPC '${e}' ${a} sending request:`,i),d.send(t,"POST",p,r,15)})}P_(e,t,r){let i=Qu(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=xc(),c=Oc(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(l.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(l.useFetchStreams=!0),this.zo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;let p=s.join("");V(Pe,`Creating RPC '${e}' stream ${i}: ${p}`,l);let y=a.createWebChannel(p,l);this.T_(y);let _=!1,C=!1,k=new Ju({Ho:D=>{C?V(Pe,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(_||(V(Pe,`Opening RPC '${e}' stream ${i} transport.`),y.open(),_=!0),V(Pe,`RPC '${e}' stream ${i} sending:`,D),y.send(D))},Yo:()=>y.close()}),x=(D,z,$)=>{D.listen(z,W=>{try{$(W)}catch(ee){setTimeout(()=>{throw ee},0)}})};return x(y,tr.EventType.OPEN,()=>{C||(V(Pe,`RPC '${e}' stream ${i} transport opened.`),k.s_())}),x(y,tr.EventType.CLOSE,()=>{C||(C=!0,V(Pe,`RPC '${e}' stream ${i} transport closed`),k.__(),this.I_(y))}),x(y,tr.EventType.ERROR,D=>{C||(C=!0,en(Pe,`RPC '${e}' stream ${i} transport errored. Name:`,D.name,"Message:",D.message),k.__(new O(R.UNAVAILABLE,"The operation could not be completed")))}),x(y,tr.EventType.MESSAGE,D=>{var z;if(!C){let $=D.data[0];X(!!$,16349);let W=$,ee=W?.error||((z=W[0])===null||z===void 0?void 0:z.error);if(ee){V(Pe,`RPC '${e}' stream ${i} received error:`,ee);let De=ee.status,Z=(function(I){let w=fe[I];if(w!==void 0)return Um(w)})(De),E=ee.message;Z===void 0&&(Z=R.INTERNAL,E="Unknown error status: "+De+" with message "+ee.message),C=!0,k.__(new O(Z,E)),y.close()}else V(Pe,`RPC '${e}' stream ${i} received:`,$),k.a_($)}}),x(c,Nc.STAT_EVENT,D=>{D.stat===xs.PROXY?V(Pe,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===xs.NOPROXY&&V(Pe,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{k.o_()},0),k}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function Mc(){return typeof document<"u"?document:null}function Ro(n){return new vu(n,!0)}var so=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&V("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var xp="PersistentStream",oo=class{constructor(e,t,r,i,s,a,c,l){this.Fi=e,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new so(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}stop(){return m(this,null,function*(){this.M_()&&(yield this.close(0))})}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}L_(){return m(this,null,function*(){if(this.x_())return this.close(0)})}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}close(e,t){return m(this,null,function*(){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(Pt(t.toString()),Pt("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.n_(t)})}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{let i=new O(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(()=>m(this,null,function*(){this.state=0,this.start()}))}G_(e){return V(xp,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(V(xp,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Zu=class extends oo{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let t=FE(this.serializer,e),r=(function(s){if(!("targetChange"in s))return j.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?j.min():a.readTime?ft(a.readTime):j.min()})(e);return this.listener.J_(t,r)}H_(e){let t={};t.database=Tu(this.serializer),t.addTarget=(function(s,a){let c,l=a.target;if(c=au(l)?{documents:BE(s,l)}:{query:qE(s,l).Vt},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=$m(s,a.resumeToken);let d=Iu(s,a.expectedCount);d!==null&&(c.expectedCount=d)}else if(a.snapshotVersion.compareTo(j.min())>0){c.readTime=Zs(s,a.snapshotVersion.toTimestamp());let d=Iu(s,a.expectedCount);d!==null&&(c.expectedCount=d)}return c})(this.serializer,e);let r=zE(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){let t={};t.database=Tu(this.serializer),t.removeTarget=e,this.k_(t)}},el=class extends oo{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return X(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,X(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){X(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=$E(e.writeResults,e.commitTime),r=ft(e.commitTime);return this.listener.ta(r,t)}na(){let e={};e.database=Tu(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>UE(this.serializer,r))};this.k_(t)}};var tl=class{},nl=class extends tl{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new O(R.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Wo(e,wu(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new O(R.UNKNOWN,s.toString())})}Jo(e,t,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Jo(e,wu(t,r),i,a,c,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new O(R.UNKNOWN,a.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},rl=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Pt(t),this._a=!1):V("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var xn="RemoteStore",il=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(a=>{r.enqueueAndForget(()=>m(this,null,function*(){Ln(this)&&(V(xn,"Restarting streams for network reachability change."),yield(function(l){return m(this,null,function*(){let d=B(l);d.Ia.add(4),yield ki(d),d.Aa.set("Unknown"),d.Ia.delete(4),yield Po(d)})})(this))}))}),this.Aa=new rl(r,i)}};function Po(n){return m(this,null,function*(){if(Ln(n))for(let e of n.da)yield e(!0)})}function ki(n){return m(this,null,function*(){for(let e of n.da)yield e(!1)})}function Ym(n,e){let t=B(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Bl(t)?$l(t):br(t).x_()&&Ul(t,e))}function Fl(n,e){let t=B(n),r=br(t);t.Ta.delete(e),r.x_()&&Jm(t,e),t.Ta.size===0&&(r.x_()?r.B_():Ln(t)&&t.Aa.set("Unknown"))}function Ul(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(j.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}br(n).H_(e)}function Jm(n,e){n.Ra.$e(e),br(n).Y_(e)}function $l(n){n.Ra=new _u({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),br(n).start(),n.Aa.aa()}function Bl(n){return Ln(n)&&!br(n).M_()&&n.Ta.size>0}function Ln(n){return B(n).Ia.size===0}function Xm(n){n.Ra=void 0}function aT(n){return m(this,null,function*(){n.Aa.set("Online")})}function cT(n){return m(this,null,function*(){n.Ta.forEach((e,t)=>{Ul(n,e)})})}function uT(n,e){return m(this,null,function*(){Xm(n),Bl(n)?(n.Aa.la(e),$l(n)):n.Aa.set("Unknown")})}function lT(n,e,t){return m(this,null,function*(){if(n.Aa.set("Online"),e instanceof Js&&e.state===2&&e.cause)try{yield(function(i,s){return m(this,null,function*(){let a=s.cause;for(let c of s.targetIds)i.Ta.has(c)&&(yield i.remoteSyncer.rejectListen(c,a),i.Ta.delete(c),i.Ra.removeTarget(c))})})(n,e)}catch(r){V(xn,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield ao(n,r)}else if(e instanceof ar?n.Ra.Ye(e):e instanceof Ys?n.Ra.it(e):n.Ra.et(e),!t.isEqual(j.min()))try{let r=yield Qm(n.localStore);t.compareTo(r)>=0&&(yield(function(s,a){let c=s.Ra.Pt(a);return c.targetChanges.forEach((l,d)=>{if(l.resumeToken.approximateByteSize()>0){let p=s.Ta.get(d);p&&s.Ta.set(d,p.withResumeToken(l.resumeToken,a))}}),c.targetMismatches.forEach((l,d)=>{let p=s.Ta.get(l);if(!p)return;s.Ta.set(l,p.withResumeToken(ke.EMPTY_BYTE_STRING,p.snapshotVersion)),Jm(s,l);let y=new Ei(p.target,l,d,p.sequenceNumber);Ul(s,y)}),s.remoteSyncer.applyRemoteEvent(c)})(n,t))}catch(r){V(xn,"Failed to raise snapshot:",r),yield ao(n,r)}})}function ao(n,e,t){return m(this,null,function*(){if(!Tr(e))throw e;n.Ia.add(1),yield ki(n),n.Aa.set("Offline"),t||(t=()=>Qm(n.localStore)),n.asyncQueue.enqueueRetryable(()=>m(null,null,function*(){V(xn,"Retrying IndexedDB access"),yield t(),n.Ia.delete(1),yield Po(n)}))})}function Zm(n,e){return e().catch(t=>ao(n,t,e))}function ko(n){return m(this,null,function*(){let e=B(n),t=rn(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Rl;for(;hT(e);)try{let i=yield rT(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,dT(e,i)}catch(i){yield ao(e,i)}eg(e)&&tg(e)})}function hT(n){return Ln(n)&&n.Pa.length<10}function dT(n,e){n.Pa.push(e);let t=rn(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function eg(n){return Ln(n)&&!rn(n).M_()&&n.Pa.length>0}function tg(n){rn(n).start()}function fT(n){return m(this,null,function*(){rn(n).na()})}function pT(n){return m(this,null,function*(){let e=rn(n);for(let t of n.Pa)e.X_(t.mutations)})}function mT(n,e,t){return m(this,null,function*(){let r=n.Pa.shift(),i=pu.from(r,e,t);yield Zm(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield ko(n)})}function gT(n,e){return m(this,null,function*(){e&&rn(n).Z_&&(yield(function(r,i){return m(this,null,function*(){if((function(a){return DE(a)&&a!==R.ABORTED})(i.code)){let s=r.Pa.shift();rn(r).N_(),yield Zm(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield ko(r)}})})(n,e)),eg(n)&&tg(n)})}function Vp(n,e){return m(this,null,function*(){let t=B(n);t.asyncQueue.verifyOperationInProgress(),V(xn,"RemoteStore received new credentials");let r=Ln(t);t.Ia.add(3),yield ki(t),r&&t.Aa.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),yield Po(t)})}function yT(n,e){return m(this,null,function*(){let t=B(n);e?(t.Ia.delete(2),yield Po(t)):e||(t.Ia.add(2),yield ki(t),t.Aa.set("Unknown"))})}function br(n){return n.Va||(n.Va=(function(t,r,i){let s=B(t);return s.ia(),new Zu(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:aT.bind(null,n),e_:cT.bind(null,n),n_:uT.bind(null,n),J_:lT.bind(null,n)}),n.da.push(e=>m(null,null,function*(){e?(n.Va.N_(),Bl(n)?$l(n):n.Aa.set("Unknown")):(yield n.Va.stop(),Xm(n))}))),n.Va}function rn(n){return n.ma||(n.ma=(function(t,r,i){let s=B(t);return s.ia(),new el(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:fT.bind(null,n),n_:gT.bind(null,n),ea:pT.bind(null,n),ta:mT.bind(null,n)}),n.da.push(e=>m(null,null,function*(){e?(n.ma.N_(),yield ko(n)):(yield n.ma.stop(),n.Pa.length>0&&(V(xn,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}var sl=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new et,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,c=new n(e,t,a,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new O(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ql(n,e){if(Pt("AsyncQueue",`${e}: ${n}`),Tr(n))return new O(R.UNAVAILABLE,`${e}: ${n}`);throw n}var co=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||L.comparator(t.key,r.key):(t,r)=>L.comparator(t.key,r.key),this.keyedMap=hi(),this.sortedSet=new he(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var uo=class{constructor(){this.fa=new he(L.comparator)}track(e){let t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):M(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){let e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}},_r=class n{constructor(e,t,r,i,s,a,c,l,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(c=>{a.push({type:0,doc:c})}),new n(e,t,co.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&So(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var ol=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},al=class{constructor(){this.queries=Lp(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let i=B(t),s=i.queries;i.queries=Lp(),s.forEach((a,c)=>{for(let l of c.wa)l.onError(r)})})(this,new O(R.ABORTED,"Firestore shutting down"))}};function Lp(){return new Nt(n=>Cm(n),So)}function jl(n,e){return m(this,null,function*(){let t=B(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Sa()&&e.ba()&&(r=2):(s=new ol,r=e.ba()?0:1);try{switch(r){case 0:s.ya=yield t.onListen(i,!0);break;case 1:s.ya=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let c=ql(a,`Initialization of query '${rr(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&Wl(t)})}function zl(n,e){return m(this,null,function*(){let t=B(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.wa.indexOf(e);a>=0&&(s.wa.splice(a,1),s.wa.length===0?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function _T(n,e){let t=B(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let c of a.wa)c.Ca(i)&&(r=!0);a.ya=i}}r&&Wl(t)}function vT(n,e,t){let r=B(n),i=r.queries.get(e);if(i)for(let s of i.wa)s.onError(t);r.queries.delete(e)}function Wl(n){n.Da.forEach(e=>{e.next()})}var cl,Mp;(Mp=cl||(cl={})).Fa="default",Mp.Cache="cache";var Ai=class{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new _r(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;let r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=_r.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==cl.Cache}};var lo=class{constructor(e){this.key=e}},ho=class{constructor(e){this.key=e}},ul=class{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=K(),this.mutatedKeys=K(),this.Xa=Rm(e),this.eu=new co(this.Xa)}get tu(){return this.Ha}nu(e,t){let r=t?t.ru:new uo,i=t?t.eu:this.eu,s=t?t.mutatedKeys:this.mutatedKeys,a=i,c=!1,l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,y)=>{let _=i.get(p),C=Co(this.query,y)?y:null,k=!!_&&this.mutatedKeys.has(_.key),x=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations),D=!1;_&&C?_.data.isEqual(C.data)?k!==x&&(r.track({type:3,doc:C}),D=!0):this.iu(_,C)||(r.track({type:2,doc:C}),D=!0,(l&&this.Xa(C,l)>0||d&&this.Xa(C,d)<0)&&(c=!0)):!_&&C?(r.track({type:0,doc:C}),D=!0):_&&!C&&(r.track({type:1,doc:_}),D=!0,(l||d)&&(c=!0)),D&&(C?(a=a.add(C),s=x?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{eu:a,ru:r,Ds:c,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let a=e.ru.pa();a.sort((p,y)=>(function(C,k){let x=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return M(20277,{At:D})}};return x(C)-x(k)})(p.type,y.type)||this.Xa(p.doc,y.doc)),this.su(r),i=i!=null&&i;let c=t&&!i?this.ou():[],l=this.Za.size===0&&this.current&&!i?1:0,d=l!==this.Ya;return this.Ya=l,a.length!==0||d?{snapshot:new _r(this.query,e.eu,s,a,e.mutatedKeys,l===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:c}:{_u:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new uo,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=K(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});let t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new ho(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new lo(r))}),t}uu(e){this.Ha=e.qs,this.Za=K();let t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return _r.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},Gl="SyncEngine",ll=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},hl=class{constructor(e){this.key=e,this.lu=!1}},dl=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.hu={},this.Pu=new Nt(c=>Cm(c),So),this.Tu=new Map,this.Iu=new Set,this.du=new he(L.comparator),this.Eu=new Map,this.Au=new bi,this.Ru={},this.Vu=new Map,this.mu=Ti.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};function IT(n,e,t=!0){return m(this,null,function*(){let r=ag(n),i,s=r.Pu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=yield ng(r,e,t,!0),i})}function wT(n,e){return m(this,null,function*(){let t=ag(n);yield ng(t,e,!0,!1)})}function ng(n,e,t,r){return m(this,null,function*(){let i=yield iT(n.localStore,dt(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),c;return r&&(c=yield ET(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Ym(n.remoteStore,i),c})}function ET(n,e,t,r,i){return m(this,null,function*(){n.gu=(y,_,C)=>(function(x,D,z,$){return m(this,null,function*(){let W=D.view.nu(z);W.Ds&&(W=yield Np(x.localStore,D.query,!1).then(({documents:E})=>D.view.nu(E,W)));let ee=$&&$.targetChanges.get(D.targetId),De=$&&$.targetMismatches.get(D.targetId)!=null,Z=D.view.applyChanges(W,x.isPrimaryClient,ee,De);return Up(x,D.targetId,Z._u),Z.snapshot})})(n,y,_,C);let s=yield Np(n.localStore,e,!0),a=new ul(e,s.qs),c=a.nu(s.documents),l=wi.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(c,n.isPrimaryClient,l);Up(n,t,d._u);let p=new ll(e,t,a);return n.Pu.set(e,p),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),d.snapshot})}function TT(n,e,t){return m(this,null,function*(){let r=B(n),i=r.Pu.get(e),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(a=>!So(a,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Gu(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Fl(r.remoteStore,i.targetId),fl(r,i.targetId)}).catch(Er))):(fl(r,i.targetId),yield Gu(r.localStore,i.targetId,!0))})}function bT(n,e){return m(this,null,function*(){let t=B(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Fl(t.remoteStore,r.targetId))})}function AT(n,e,t){return m(this,null,function*(){let r=NT(n);try{let i=yield(function(a,c){let l=B(a),d=ye.now(),p=c.reduce((C,k)=>C.add(k.key),K()),y,_;return l.persistence.runTransaction("Locally write mutations","readwrite",C=>{let k=Ot(),x=K();return l.Os.getEntries(C,p).next(D=>{k=D,k.forEach((z,$)=>{$.isValidDocument()||(x=x.add(z))})}).next(()=>l.localDocuments.getOverlayedDocuments(C,k)).next(D=>{y=D;let z=[];for(let $ of c){let W=kE($,y.get($.key).overlayedDocument);W!=null&&z.push(new mt($.key,W,Im(W.value.mapValue),qe.exists(!0)))}return l.mutationQueue.addMutationBatch(C,d,z,c)}).next(D=>{_=D;let z=D.applyToLocalDocumentSet(y,x);return l.documentOverlayCache.saveOverlays(C,D.batchId,z)})}).then(()=>({batchId:_.batchId,changes:km(y)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(a,c,l){let d=a.Ru[a.currentUser.toKey()];d||(d=new he(G)),d=d.insert(c,l),a.Ru[a.currentUser.toKey()]=d})(r,i.batchId,t),yield Di(r,i.changes),yield ko(r.remoteStore)}catch(i){let s=ql(i,"Failed to persist write");t.reject(s)}})}function rg(n,e){return m(this,null,function*(){let t=B(n);try{let r=yield tT(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Eu.get(s);a&&(X(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.lu=!0:i.modifiedDocuments.size>0?X(a.lu,14607):i.removedDocuments.size>0&&(X(a.lu,42227),a.lu=!1))}),yield Di(t,r,e)}catch(r){yield Er(r)}})}function Fp(n,e,t){let r=B(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Pu.forEach((s,a)=>{let c=a.view.va(e);c.snapshot&&i.push(c.snapshot)}),(function(a,c){let l=B(a);l.onlineState=c;let d=!1;l.queries.forEach((p,y)=>{for(let _ of y.wa)_.va(c)&&(d=!0)}),d&&Wl(l)})(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function ST(n,e,t){return m(this,null,function*(){let r=B(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Eu.get(e),s=i&&i.key;if(s){let a=new he(L.comparator);a=a.insert(s,tt.newNoDocument(s,j.min()));let c=K().add(s),l=new Qs(j.min(),new Map,new he(G),a,c);yield rg(r,l),r.du=r.du.remove(s),r.Eu.delete(e),Hl(r)}else yield Gu(r.localStore,e,!1).then(()=>fl(r,e,t)).catch(Er)})}function CT(n,e){return m(this,null,function*(){let t=B(n),r=e.batch.batchId;try{let i=yield eT(t.localStore,e);sg(t,r,null),ig(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Di(t,i)}catch(i){yield Er(i)}})}function RT(n,e,t){return m(this,null,function*(){let r=B(n);try{let i=yield(function(a,c){let l=B(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return l.mutationQueue.lookupMutationBatch(d,c).next(y=>(X(y!==null,37113),p=y.keys(),l.mutationQueue.removeMutationBatch(d,y))).next(()=>l.mutationQueue.performConsistencyCheck(d)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(d,p,c)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>l.localDocuments.getDocuments(d,p))})})(r.localStore,e);sg(r,e,t),ig(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Di(r,i)}catch(i){yield Er(i)}})}function ig(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function sg(n,e,t){let r=B(n),i=r.Ru[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function fl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||og(n,r)})}function og(n,e){n.Iu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(Fl(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Hl(n))}function Up(n,e,t){for(let r of t)r instanceof lo?(n.Au.addReference(r.key,e),PT(n,r)):r instanceof ho?(V(Gl,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||og(n,r.key)):M(19791,{yu:r})}function PT(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(V(Gl,"New document in limbo: "+t),n.Iu.add(r),Hl(n))}function Hl(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Iu.values().next().value;n.Iu.delete(e);let t=new L(ce.fromString(e)),r=n.mu.next();n.Eu.set(r,new hl(t)),n.du=n.du.insert(t,r),Ym(n.remoteStore,new Ei(dt(Ao(t.path)),r,"TargetPurposeLimboResolution",Cl.ue))}}function Di(n,e,t){return m(this,null,function*(){let r=B(n),i=[],s=[],a=[];r.Pu.isEmpty()||(r.Pu.forEach((c,l)=>{a.push(r.gu(l,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let y=d?!d.fromCache:(p=t?.targetChanges.get(l.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(l.targetId,y?"current":"not-current")}if(d){i.push(d);let y=qu.Es(l.targetId,d);s.push(y)}}))}),yield Promise.all(a),r.hu.J_(i),yield(function(l,d){return m(this,null,function*(){let p=B(l);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>P.forEach(d,_=>P.forEach(_.Is,C=>p.persistence.referenceDelegate.addReference(y,_.targetId,C)).next(()=>P.forEach(_.ds,C=>p.persistence.referenceDelegate.removeReference(y,_.targetId,C)))))}catch(y){if(!Tr(y))throw y;V(Ml,"Failed to update sequence numbers: "+y)}for(let y of d){let _=y.targetId;if(!y.fromCache){let C=p.Fs.get(_),k=C.snapshotVersion,x=C.withLastLimboFreeSnapshotVersion(k);p.Fs=p.Fs.insert(_,x)}}})})(r.localStore,s))})}function kT(n,e){return m(this,null,function*(){let t=B(n);if(!t.currentUser.isEqual(e)){V(Gl,"User change. New user:",e.toKey());let r=yield Km(t.localStore,e);t.currentUser=e,(function(s,a){s.Vu.forEach(c=>{c.forEach(l=>{l.reject(new O(R.CANCELLED,a))})}),s.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Di(t,r.Bs)}})}function DT(n,e){let t=B(n),r=t.Eu.get(e);if(r&&r.lu)return K().add(r.key);{let i=K(),s=t.Tu.get(e);if(!s)return i;for(let a of s){let c=t.Pu.get(a);i=i.unionWith(c.view.tu)}return i}}function ag(n){let e=B(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=rg.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ST.bind(null,e),e.hu.J_=_T.bind(null,e.eventManager),e.hu.pu=vT.bind(null,e.eventManager),e}function NT(n){let e=B(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=CT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=RT.bind(null,e),e}var cg=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return m(this,null,function*(){this.serializer=Ro(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),yield this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)})}Cu(t,r){return null}Fu(t,r){return null}vu(t){return ZE(this.persistence,new zu,t.initialUser,this.serializer)}Du(t){return new to(Bu.Vi,this.serializer)}bu(t){return new Hu}terminate(){return m(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})(),pl=class extends cg{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){X(this.persistence.referenceDelegate instanceof no,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new Ru(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?Ge.withCacheSize(this.cacheSizeBytes):Ge.DEFAULT;return new to(r=>no.Vi(r,t),this.serializer)}};var OT=(()=>{class n{initialize(t,r){return m(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Fp(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=kT.bind(null,this.syncEngine),yield yT(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return(function(){return new al})()}createDatastore(t){let r=Ro(t.databaseInfo.databaseId),i=(function(a){return new Xu(a)})(t.databaseInfo);return(function(a,c,l,d){return new nl(a,c,l,d)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,s,a,c,l){return new il(i,s,a,c,l)})(this.localStore,this.datastore,t.asyncQueue,r=>Fp(this.syncEngine,r,0),(function(){return io.C()?new io:new Ku})())}createSyncEngine(t,r){return(function(s,a,c,l,d,p,y){let _=new dl(s,a,c,l,d,p);return y&&(_.fu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return m(this,null,function*(){var t,r;yield(function(s){return m(this,null,function*(){let a=B(s);V(xn,"RemoteStore shutting down."),a.Ia.add(5),yield ki(a),a.Ea.shutdown(),a.Aa.set("Unknown")})})(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Si=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Pt("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var sn="FirestoreClient",ml=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=we.UNAUTHENTICATED,this.clientId=gi.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,a=>m(this,null,function*(){V(sn,"Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(V(sn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new et;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>m(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=ql(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Fc(n,e){return m(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),V(sn,"Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>m(null,null,function*(){r.isEqual(i)||(yield Km(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>{en("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{V("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{en("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e})}function $p(n,e){return m(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield xT(n);V(sn,"Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Vp(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Vp(e.remoteStore,i)),n._onlineComponents=e})}function xT(n){return m(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){V(sn,"Using user provided OfflineComponentProvider");try{yield Fc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===R.FAILED_PRECONDITION||i.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;en("Error using user provided cache. Falling back to memory cache: "+t),yield Fc(n,new cg)}}else V(sn,"Using default OfflineComponentProvider"),yield Fc(n,new pl(void 0));return n._offlineComponents})}function ug(n){return m(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(V(sn,"Using user provided OnlineComponentProvider"),yield $p(n,n._uninitializedComponentsProvider._online)):(V(sn,"Using default OnlineComponentProvider"),yield $p(n,new OT))),n._onlineComponents})}function VT(n){return ug(n).then(e=>e.syncEngine)}function fo(n){return m(this,null,function*(){let e=yield ug(n),t=e.eventManager;return t.onListen=IT.bind(null,e.syncEngine),t.onUnlisten=TT.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wT.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=bT.bind(null,e.syncEngine),t})}function LT(n,e,t={}){let r=new et;return n.asyncQueue.enqueueAndForget(()=>m(null,null,function*(){return(function(s,a,c,l,d){let p=new Si({next:_=>{p.Ou(),a.enqueueAndForget(()=>zl(s,y));let C=_.docs.has(c);!C&&_.fromCache?d.reject(new O(R.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&_.fromCache&&l&&l.source==="server"?d.reject(new O(R.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(_)},error:_=>d.reject(_)}),y=new Ai(Ao(c.path),p,{includeMetadataChanges:!0,ka:!0});return jl(s,y)})(yield fo(n),n.asyncQueue,e,t,r)})),r.promise}function MT(n,e,t={}){let r=new et;return n.asyncQueue.enqueueAndForget(()=>m(null,null,function*(){return(function(s,a,c,l,d){let p=new Si({next:_=>{p.Ou(),a.enqueueAndForget(()=>zl(s,y)),_.fromCache&&l.source==="server"?d.reject(new O(R.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(_)},error:_=>d.reject(_)}),y=new Ai(c,p,{includeMetadataChanges:!0,ka:!0});return jl(s,y)})(yield fo(n),n.asyncQueue,e,t,r)})),r.promise}function lg(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Bp=new Map;var hg="firestore.googleapis.com",qp=!0,po=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new O(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=hg,this.ssl=qp}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:qp;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Hm;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<YE)throw new O(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Kw("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lg((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new O(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new O(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new O(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},vr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new po({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new O(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new O(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new po(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new $c;switch(r.type){case"firstParty":return new zc(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new O(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return m(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=Bp.get(t);r&&(V("ComponentProvider","Removing Datastore"),Bp.delete(t),r.terminate())})(this),Promise.resolve()}};function dg(n,e,t,r={}){var i;n=Le(n,vr);let s=$t(e),a=n._getSettings(),c=Object.assign(Object.assign({},a),{emulatorOptions:n._getEmulatorOptions()}),l=`${e}:${t}`;s&&(ss(`https://${l}`),os("Firestore",!0)),a.host!==hg&&a.host!==l&&en("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let d=Object.assign(Object.assign({},a),{host:l,ssl:s,emulatorOptions:r});if(!at(d,c)&&(n._setSettings(d),r.mockUserToken)){let p,y;if(typeof r.mockUserToken=="string")p=r.mockUserToken,y=we.MOCK_USER;else{p=pd(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let _=r.mockUserToken.sub||r.mockUserToken.user_id;if(!_)throw new O(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new we(_)}n._authCredentials=new Bc(new Bs(p,y))}}var on=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},ve=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Pi(t,n._jsonSchema))return new n(e,r||null,new L(ce.fromString(t.referencePath)))}};ve._jsonSchemaVersion="firestore/documentReference/1.0",ve._jsonSchema={type:ge("string",ve._jsonSchemaVersion),referencePath:ge("string")};var Yt=class n extends on{constructor(e,t,r){super(e,t,Ao(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ve(this.firestore,null,new L(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function fg(n,e,...t){if(n=oe(n),Yp("collection","path",e),n instanceof vr){let r=ce.fromString(e,...t);return op(r),new Yt(n,null,r)}{if(!(n instanceof ve||n instanceof Yt))throw new O(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return op(r),new Yt(n.firestore,null,r)}}function Kl(n,e,...t){if(n=oe(n),arguments.length===1&&(e=gi.newId()),Yp("doc","path",e),n instanceof vr){let r=ce.fromString(e,...t);return sp(r),new ve(n,null,new L(r))}{if(!(n instanceof ve||n instanceof Yt))throw new O(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ce.fromString(e,...t));return sp(r),new ve(n.firestore,n instanceof Yt?n.converter:null,new L(r))}}var jp="AsyncQueue",mo=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new so(this,"async_queue_retry"),this.oc=()=>{let r=Mc();r&&V(jp,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=Mc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=Mc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new et;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}cc(){return m(this,null,function*(){if(this.Zu.length!==0){try{yield this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Tr(e))throw e;V(jp,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}})}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Pt("INTERNAL UNHANDLED ERROR: ",zp(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let i=sl.createAndSchedule(this,e,t,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&M(47125,{hc:zp(this.tc)})}verifyOperationInProgress(){}Pc(){return m(this,null,function*(){let e;do e=this._c,yield e;while(e!==this._c)})}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function zp(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function Wp(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}var Ke=class extends vr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new mo,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return m(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new mo(e),this._firestoreClient=void 0,yield e}})}};function pg(n,e){let t=typeof n=="object"?n:gn(),r=typeof n=="string"?n:e||Gs,i=Hn(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=fd("firestore");s&&dg(i,...s)}return i}function Ni(n){if(n._terminated)throw new O(R.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||FT(n),n._firestoreClient}function FT(n){var e,t,r;let i=n._freezeSettings(),s=(function(c,l,d,p){return new Qc(c,l,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,lg(p.experimentalLongPollingOptions),p.useFetchStreams,p.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new ml(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(c){let l=c?._online.build();return{_offline:c?._offline.build(l),_online:l}})(n._componentsProvider))}var Jt=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(ke.fromBase64String(e))}catch(t){throw new O(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(ke.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Pi(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Jt._jsonSchemaVersion="firestore/bytes/1.0",Jt._jsonSchema={type:ge("string",Jt._jsonSchemaVersion),bytes:ge("string")};var Vn=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new O(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Be(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ir=class{constructor(e){this._methodName=e}};var Xt=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new O(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new O(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return G(this._lat,e._lat)||G(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Pi(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Xt._jsonSchemaVersion="firestore/geoPoint/1.0",Xt._jsonSchema={type:ge("string",Xt._jsonSchemaVersion),latitude:ge("number"),longitude:ge("number")};var Zt=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Pi(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new O(R.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Zt._jsonSchemaVersion="firestore/vectorValue/1.0",Zt._jsonSchema={type:ge("string",Zt._jsonSchemaVersion),vectorValues:ge("object")};var UT=/^__.*__$/,gl=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new mt(e,this.data,this.fieldMask,t,this.fieldTransforms):new On(e,this.data,t,this.fieldTransforms)}},go=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new mt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function mg(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw M(40011,{Ec:n})}}var yl=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return _o(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(mg(this.Ec)&&UT.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},_l=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ro(e)}Dc(e,t,r,i=!1){return new yl({Ec:e,methodName:t,bc:r,path:Be.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Oi(n){let e=n._freezeSettings(),t=Ro(n._databaseId);return new _l(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Ql(n,e,t,r,i,s={}){let a=n.Dc(s.merge||s.mergeFields?2:0,e,t,i);Yl("Data must be an object, but it was:",a,r);let c=_g(r,a),l,d;if(s.merge)l=new He(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let y of s.mergeFields){let _=Il(e,y,t);if(!a.contains(_))throw new O(R.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);Ig(p,_)||p.push(_)}l=new He(p),d=a.fieldTransforms.filter(y=>l.covers(y.field))}else l=null,d=a.fieldTransforms;return new gl(new $e(c),l,d)}var yo=class n extends Ir{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};var vl=class n extends Ir{_toFieldTransform(e){return new lu(e.path,new kn)}isEqual(e){return e instanceof n}};function gg(n,e,t,r){let i=n.Dc(1,e,t);Yl("Data must be an object, but it was:",i,r);let s=[],a=$e.empty();an(r,(l,d)=>{let p=Jl(e,l,t);d=oe(d);let y=i.gc(p);if(d instanceof yo)s.push(p);else{let _=xi(d,y);_!=null&&(s.push(p),a.set(p,_))}});let c=new He(s);return new go(a,c,i.fieldTransforms)}function yg(n,e,t,r,i,s){let a=n.Dc(1,e,t),c=[Il(e,r,t)],l=[i];if(s.length%2!=0)throw new O(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)c.push(Il(e,s[_])),l.push(s[_+1]);let d=[],p=$e.empty();for(let _=c.length-1;_>=0;--_)if(!Ig(d,c[_])){let C=c[_],k=l[_];k=oe(k);let x=a.gc(C);if(k instanceof yo)d.push(C);else{let D=xi(k,x);D!=null&&(d.push(C),p.set(C,D))}}let y=new He(d);return new go(p,y,a.fieldTransforms)}function $T(n,e,t,r=!1){return xi(t,n.Dc(r?4:3,e))}function xi(n,e){if(vg(n=oe(n)))return Yl("Unsupported field value:",e,n),_g(n,e);if(n instanceof Ir)return(function(r,i){if(!mg(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,i){let s=[],a=0;for(let c of r){let l=xi(c,i.yc(a));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),a++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=oe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return AE(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=ye.fromDate(r);return{timestampValue:Zs(i.serializer,s)}}if(r instanceof ye){let s=new ye(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Zs(i.serializer,s)}}if(r instanceof Xt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jt)return{bytesValue:$m(i.serializer,r._byteString)};if(r instanceof ve){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.wc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ll(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Zt)return(function(a,c){return{mapValue:{fields:{[kl]:{stringValue:Dl},[lr]:{arrayValue:{values:a.toArray().map(d=>{if(typeof d!="number")throw c.wc("VectorValues must only contain numeric values.");return Vl(c.serializer,d)})}}}}}})(r,i);throw i.wc(`Unsupported field value: ${Eo(r)}`)})(n,e)}function _g(n,e){let t={};return dm(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):an(n,(r,i)=>{let s=xi(i,e.Vc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function vg(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ye||n instanceof Xt||n instanceof Jt||n instanceof ve||n instanceof Ir||n instanceof Zt)}function Yl(n,e,t){if(!vg(t)||!Jp(t)){let r=Eo(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function Il(n,e,t){if((e=oe(e))instanceof Vn)return e._internalPath;if(typeof e=="string")return Jl(n,e);throw _o("Field path arguments must be of type string or ",n,!1,void 0,t)}var BT=new RegExp("[~\\*/\\[\\]]");function Jl(n,e,t){if(e.search(BT)>=0)throw _o(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Vn(...e.split("."))._internalPath}catch{throw _o(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function _o(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${r}`),a&&(l+=` in document ${i}`),l+=")"),new O(R.INVALID_ARGUMENT,c+n+l)}function Ig(n,e){return n.some(t=>t.isEqual(e))}var vo=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ve(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new wl(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Do("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},wl=class extends vo{data(){return super.data()}};function Do(n,e){return typeof e=="string"?Jl(n,e):e instanceof Vn?e._internalPath:e._delegate._internalPath}function wg(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new O(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ci=class{},Io=class extends Ci{};function Eg(n,e,...t){let r=[];e instanceof Ci&&r.push(e),r=r.concat(t),(function(s){let a=s.filter(l=>l instanceof El).length,c=s.filter(l=>l instanceof wo).length;if(a>1||a>0&&c>0)throw new O(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(let i of r)n=i._apply(n);return n}var wo=class n extends Io{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return Ag(e._query,t),new on(e.firestore,e.converter,cu(e._query,t))}_parse(e){let t=Oi(e.firestore);return(function(s,a,c,l,d,p,y){let _;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new O(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Hp(y,p);let k=[];for(let x of y)k.push(Gp(l,s,x));_={arrayValue:{values:k}}}else _=Gp(l,s,y)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Hp(y,p),_=$T(c,a,y,p==="in"||p==="not-in");return me.create(d,p,_)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function Tg(n,e,t){let r=e,i=Do("where",n);return wo._create(i,r,t)}var El=class n extends Ci{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:nt.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let a=i,c=s.getFlattenedFilters();for(let l of c)Ag(a,l),a=cu(a,l)})(e._query,t),new on(e.firestore,e.converter,cu(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Tl=class n extends Io{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(i,s,a){if(i.startAt!==null)throw new O(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new O(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Pn(s,a)})(e._query,this._field,this._direction);return new on(e.firestore,e.converter,(function(i,s){let a=i.explicitOrderBy.concat([s]);return new nn(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}};function bg(n,e="asc"){let t=e,r=Do("orderBy",n);return Tl._create(r,t)}function Gp(n,e,t){if(typeof(t=oe(t))=="string"){if(t==="")throw new O(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Sm(e)&&t.indexOf("/")!==-1)throw new O(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ce.fromString(t));if(!L.isDocumentKey(r))throw new O(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return fp(n,new L(r))}if(t instanceof ve)return fp(n,t._key);throw new O(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Eo(t)}.`)}function Hp(n,e){if(!Array.isArray(n)||n.length===0)throw new O(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ag(n,e){let t=(function(i,s){for(let a of i)for(let c of a.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new O(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new O(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var bl=class{convertValue(e,t="none"){switch(tn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ae(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Dt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw M(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return an(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[lr].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>ae(a.doubleValue));return new Zt(s)}convertGeoPoint(e){return new Xt(ae(e.latitude),ae(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=bo(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(vi(e));default:return null}}convertTimestamp(e){let t=kt(e);return new ye(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ce.fromString(e);X(Gm(r),9688,{name:e});let i=new Hs(r.get(1),r.get(3)),s=new L(r.popFirst(5));return i.isEqual(t)||Pt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function Xl(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var bn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},An=class n extends vo{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new cr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Do("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new O(R.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};An._jsonSchemaVersion="firestore/documentSnapshot/1.0",An._jsonSchema={type:ge("string",An._jsonSchemaVersion),bundleSource:ge("string","DocumentSnapshot"),bundleName:ge("string"),bundle:ge("string")};var cr=class extends An{data(e={}){return super.data(e)}},Sn=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new bn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new cr(this._firestore,this._userDataWriter,r.key,r,new bn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new O(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{let l=new cr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new bn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let l=new cr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new bn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return c.type!==0&&(d=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),p=a.indexOf(c.doc.key)),{type:qT(c.type),doc:l,oldIndex:d,newIndex:p}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new O(R.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=gi.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function qT(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return M(61501,{type:n})}}function Sg(n){n=Le(n,ve);let e=Le(n.firestore,Ke);return LT(Ni(e),n._key).then(t=>Og(e,n,t))}Sn._jsonSchemaVersion="firestore/querySnapshot/1.0",Sn._jsonSchema={type:ge("string",Sn._jsonSchemaVersion),bundleSource:ge("string","QuerySnapshot"),bundleName:ge("string"),bundle:ge("string")};var Ri=class extends bl{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jt(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new ve(this.firestore,null,t)}};function Cg(n){n=Le(n,on);let e=Le(n.firestore,Ke),t=Ni(e),r=new Ri(e);return wg(n._query),MT(t,n._query).then(i=>new Sn(e,r,n,i))}function Rg(n,e,t){n=Le(n,ve);let r=Le(n.firestore,Ke),i=Xl(n.converter,e,t);return Vi(r,[Ql(Oi(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,qe.none())])}function Pg(n,e,t,...r){n=Le(n,ve);let i=Le(n.firestore,Ke),s=Oi(i),a;return a=typeof(e=oe(e))=="string"||e instanceof Vn?yg(s,"updateDoc",n._key,e,t,r):gg(s,"updateDoc",n._key,e),Vi(i,[a.toMutation(n._key,qe.exists(!0))])}function kg(n){return Vi(Le(n.firestore,Ke),[new yr(n._key,qe.none())])}function Dg(n,e){let t=Le(n.firestore,Ke),r=Kl(n),i=Xl(n.converter,e);return Vi(t,[Ql(Oi(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,qe.exists(!1))]).then(()=>r)}function Ng(n,...e){var t,r,i;n=oe(n);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Wp(e[a])||(s=e[a++]);let c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Wp(e[a])){let y=e[a];e[a]=(t=y.next)===null||t===void 0?void 0:t.bind(y),e[a+1]=(r=y.error)===null||r===void 0?void 0:r.bind(y),e[a+2]=(i=y.complete)===null||i===void 0?void 0:i.bind(y)}let l,d,p;if(n instanceof ve)d=Le(n.firestore,Ke),p=Ao(n._key.path),l={next:y=>{e[a]&&e[a](Og(d,n,y))},error:e[a+1],complete:e[a+2]};else{let y=Le(n,on);d=Le(y.firestore,Ke),p=y._query;let _=new Ri(d);l={next:C=>{e[a]&&e[a](new Sn(d,_,y,C))},error:e[a+1],complete:e[a+2]},wg(n._query)}return(function(_,C,k,x){let D=new Si(x),z=new Ai(C,D,k);return _.asyncQueue.enqueueAndForget(()=>m(null,null,function*(){return jl(yield fo(_),z)})),()=>{D.Ou(),_.asyncQueue.enqueueAndForget(()=>m(null,null,function*(){return zl(yield fo(_),z)}))}})(Ni(d),p,c,l)}function Vi(n,e){return(function(r,i){let s=new et;return r.asyncQueue.enqueueAndForget(()=>m(null,null,function*(){return AT(yield VT(r),i,s)})),s.promise})(Ni(n),e)}function Og(n,e,t){let r=t.docs.get(e._key),i=new Ri(n);return new An(n,i,e._key,r,new bn(t.hasPendingWrites,t.fromCache),e.converter)}var Al=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Oi(e)}set(e,t,r){this._verifyNotCommitted();let i=Uc(e,this._firestore),s=Xl(i.converter,t,r),a=Ql(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(a.toMutation(i._key,qe.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=Uc(e,this._firestore),a;return a=typeof(t=oe(t))=="string"||t instanceof Vn?yg(this._dataReader,"WriteBatch.update",s._key,t,r,i):gg(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,qe.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Uc(e,this._firestore);return this._mutations=this._mutations.concat(new yr(t._key,qe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new O(R.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Uc(n,e){if((n=oe(n)).firestore!==e)throw new O(R.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function _e(){return new vl("serverTimestamp")}function xg(n){return Ni(n=Le(n,Ke)),new Al(n,e=>Vi(n,e))}(function(e,t=!0){(function(i){wr=i})(qt),Je(new xe("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),c=new Ke(new qc(r.getProvider("auth-internal")),new Wc(a,r.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new O(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hs(d.options.projectId,p)})(a,i),a);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),le(tp,np,e),le(tp,np,"esm2017")})();var rt=class{constructor(e){return e}},Vg="firestore",Zl=class{constructor(){return Qn(Vg)}};var eh=new qn("angularfire2.firestore-instances");function jT(n,e){let t=Jr(Vg,n,e);return t&&new rt(t)}function zT(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new rt(r)}}var WT={provide:Zl,deps:[[new ze,eh]]},GT={provide:rt,useFactory:jT,deps:[[new ze,eh],wt]};function U0(n,...e){return le("angularfire",jt.full,"fst"),jn([GT,WT,{provide:eh,useFactory:zT(n),multi:!0,deps:[ot,je,zt,_n,[new ze,ui],[new ze,Yn],...e]}])}var gt=re(Dg,!0,2);var q=re(fg,!0,2);var be=re(kg,!0,2);var Q=re(Kl,!0,2);var Mn=re(Sg,!0);var ie=re(Cg,!0);var $0=re(pg,!0);var it=re(Ng,!0);var Ar=re(bg,!0,2),st=re(Eg,!0,2);var cn=re(Rg,!0,2);var Me=re(Pg,!0,2);var Sr=re(Tg,!0,2),No=re(xg,!0,2);var Oo=class n{firestore=de(rt);injector=de(je);firestoreService=de(xo);createCompany(e){return m(this,null,function*(){try{let t=Q(q(this.firestore,"companies")),r=new Date,i=ne(U({},e),{id:t.id,smtpConfig:e.smtpConfig||{host:"smtp.gmail.com",port:587,secure:!1,user:"",password:"",fromName:e.name,fromEmail:e.contactEmail||""},apiConfig:{enabled:!0,token:this.generateApiToken(),endpoint:`https://${e.subdomain}.taskboard.com.br/api/v1/lead-intake`,webhookUrl:""},features:this.getFeaturesByPlan(e.plan),status:"active",createdAt:r,updatedAt:r});return yield cn(t,i),yield this.createDefaultSettings(t.id,e.ownerId),t.id}catch(t){throw t}})}getCompanyBySubdomain(e){return m(this,null,function*(){return this.queryCompanyBySubdomain(e)})}queryCompanyBySubdomain(e){return m(this,null,function*(){try{let t=q(this.firestore,"companies"),r=st(t,Sr("subdomain","==",e)),i=yield ie(r);if(i.empty)return null;let s=i.docs[0];return U({id:s.id},s.data())}catch{return null}})}getCompany(e){return m(this,null,function*(){try{let t=Q(this.firestore,"companies",e),r=yield Mn(t);return r.exists()?U({id:r.id},r.data()):null}catch(t){throw t}})}updateCompany(e,t){return m(this,null,function*(){try{let r=Q(this.firestore,"companies",e);yield Me(r,ne(U({},t),{updatedAt:new Date}))}catch(r){throw r}})}addUserToCompany(e,t,r){return m(this,null,function*(){try{let i=Q(this.firestore,"companies",e,"users",t),s={uid:"",email:t,displayName:"",role:r,permissions:this.getPermissionsByRole(r),joinedAt:new Date};yield cn(i,s);try{yield this.sendInvitationEmail(t,r,e)}catch{throw new Error("Usu\xE1rio adicionado com sucesso, mas houve erro ao enviar email de convite. Verifique a configura\xE7\xE3o do SMTP.")}}catch(i){throw i}})}sendInvitationEmail(e,t,r){return m(this,null,function*(){try{let{SmtpService:i}=yield import("./chunk-TTLHSEXR.js"),s=this.injector.get(i),a=yield this.getCompany(r);if(!a)throw new Error("Empresa n\xE3o encontrada");let c={admin:"Administrador",manager:"Gerente",user:"Usu\xE1rio"},l=`${window.location.origin}/login`,d=`Convite para participar da ${a.name}`,p=`
        <div style="font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;">
          <div style="text-align: center; margin-bottom: 30px;">
            ${a.brandingConfig?.logo?`<img src="${a.brandingConfig.logo}" alt="${a.name}" style="max-height: 80px;">`:""}
            <h1 style="color: ${a.brandingConfig?.primaryColor||"#3B82F6"}; margin-top: 20px;">
              Convite para ${a.name}
            </h1>
          </div>
          
          <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
            <h2 style="color: #333; margin-top: 0;">Voc\xEA foi convidado!</h2>
            <p>Ol\xE1,</p>
            <p>Voc\xEA foi convidado para fazer parte da <strong>${a.name}</strong> com a fun\xE7\xE3o de <strong>${c[t]}</strong>.</p>
            <p>Para aceitar o convite e come\xE7ar a usar a plataforma, clique no bot\xE3o abaixo:</p>
          </div>
          
          <div style="text-align: center; margin: 30px 0;">
            <a href="${l}" 
               style="background-color: ${a.brandingConfig?.primaryColor||"#3B82F6"}; 
                      color: white; 
                      padding: 12px 30px; 
                      text-decoration: none; 
                      border-radius: 6px; 
                      font-weight: bold;
                      display: inline-block;">
              Aceitar Convite
            </a>
          </div>
          
          <div style="font-size: 12px; color: #666; text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #ddd;">
            <p>Se voc\xEA n\xE3o conseguir clicar no bot\xE3o, copie e cole este link no seu navegador:</p>
            <p><a href="${l}" style="color: #3B82F6;">${l}</a></p>
            <p>Este convite foi enviado por ${a.name}.</p>
          </div>
        </div>
      `;yield s.sendEmail({to:e,subject:d,html:p}).toPromise()}catch(i){throw i}})}getCompanyUsers(e){return m(this,null,function*(){try{let t=q(this.firestore,"companies",e,"users");return(yield ie(t)).docs.map(s=>U({uid:s.id},s.data()))}catch{return[]}})}removeUserFromCompany(e,t){return m(this,null,function*(){try{let r=Q(this.firestore,"companies",e,"users",t);yield be(r)}catch(r){throw r}})}updateUserRole(e,t,r){return m(this,null,function*(){try{let i=Q(this.firestore,"companies",e,"users",t);yield Me(i,{role:r,permissions:this.getPermissionsByRole(r)})}catch(i){throw i}})}deleteCompany(e){return m(this,null,function*(){try{let t=q(this.firestore,"companies",e,"users"),r=yield ie(t);for(let d of r.docs)yield be(d.ref);let i=Q(this.firestore,"companies",e,"settings","general");(yield Mn(i)).exists()&&(yield be(i));let a=q(this.firestore,"companies",e,"boards"),c=yield ie(a);for(let d of c.docs){let p=d.id,y=q(this.firestore,"companies",e,"boards",p,"columns"),_=yield ie(y);for(let x of _.docs)yield be(x.ref);let C=q(this.firestore,"companies",e,"boards",p,"leads"),k=yield ie(C);for(let x of k.docs)yield be(x.ref);yield be(d.ref)}let l=Q(this.firestore,"companies",e);yield be(l)}catch(t){throw t}})}createDefaultSettings(e,t){return m(this,null,function*(){try{let r=Q(this.firestore,"companies",e,"settings","general");yield cn(r,{companyId:e,timezone:"America/Sao_Paulo",language:"pt-BR",dateFormat:"DD/MM/YYYY",notifications:{emailOnNewLead:!0,emailOnLeadMove:!0,emailOnLeadComment:!1},formSettings:{allowPublicForm:!0,requireCaptcha:!1,thankyouMessage:"Obrigado! Entraremos em contato em breve."}})}catch(r){throw r}})}getCompanySettings(e){return m(this,null,function*(){try{let t=Q(this.firestore,"companies",e,"settings","general"),r=yield Mn(t);return r.exists()?r.data():null}catch(t){throw t}})}updateCompanySettings(e,t){return m(this,null,function*(){try{let r=Q(this.firestore,"companies",e,"settings","general");yield Me(r,t)}catch(r){throw r}})}isSubdomainAvailable(e){return m(this,null,function*(){try{return(yield this.getCompanyBySubdomain(e))===null}catch{return!1}})}seedGobuyerCompany(){return m(this,null,function*(){try{if(yield this.getCompanyBySubdomain("gobuyer"))return;let t={subdomain:"gobuyer",name:"Gobuyer Digital",contactEmail:"contato@gobuyer.com.br",contactPhone:"+55 11 99999-9999",address:"S\xE3o Paulo, SP",cnpj:"12.345.678/0001-90",plan:"professional",status:"active",ownerId:"system",ownerEmail:"geovane.lopes@gobuyer.com.br",maxUsers:50,maxBoards:100,smtpConfig:{host:"smtp.gmail.com",port:587,secure:!1,user:"",password:"",fromName:"Gobuyer Digital",fromEmail:"contato@gobuyer.com.br"},apiConfig:{enabled:!0,token:this.generateApiToken(),endpoint:"https://gobuyer.taskboard.com.br/api/v1/lead-intake",webhookUrl:""},features:this.getFeaturesByPlan("professional"),brandingConfig:{primaryColor:"#3B82F6",secondaryColor:"#1E40AF",logo:"https://apps.gobuyer.com.br/sso/assets/images/logos/logo-gobuyer.png",favicon:"",customCSS:"",companyName:"Gobuyer Digital"}},r=yield this.createCompany(t)}catch{}})}getCompanySubdomain(){if(typeof window<"u"){let e=window.location.hostname;if(e==="localhost"||e==="127.0.0.1")return localStorage.getItem("dev-subdomain")||"gobuyer";if(e.includes("taskboard.com.br")){let t=e.split(".");if(t.length>=3)return t[0]}}return null}getCompanyByUserEmail(e){return m(this,null,function*(){try{let t=q(this.firestore,"companies"),r=yield ie(t);for(let i of r.docs){let s=i.data();if(s.ownerEmail===e)return U({id:i.id},s);let a=q(this.firestore,"companies",i.id,"users");if((yield ie(a)).docs.some(d=>d.data().email===e))return U({id:i.id},s)}return null}catch{return null}})}generateApiToken(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%&*",t="";for(let r=0;r<32;r++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}getFeaturesByPlan(e){switch(e){case"free":return{maxBoards:1,maxUsers:2,maxLeadsPerMonth:100,maxEmailsPerMonth:50,customBranding:!1,apiAccess:!1,webhooks:!1,advancedReports:!1,whiteLabel:!1};case"starter":return{maxBoards:3,maxUsers:5,maxLeadsPerMonth:1e3,maxEmailsPerMonth:500,customBranding:!0,apiAccess:!0,webhooks:!1,advancedReports:!1,whiteLabel:!1};case"professional":return{maxBoards:10,maxUsers:20,maxLeadsPerMonth:5e3,maxEmailsPerMonth:2500,customBranding:!0,apiAccess:!0,webhooks:!0,advancedReports:!0,whiteLabel:!1};case"enterprise":return{maxBoards:-1,maxUsers:-1,maxLeadsPerMonth:-1,maxEmailsPerMonth:-1,customBranding:!0,apiAccess:!0,webhooks:!0,advancedReports:!0,whiteLabel:!0};default:return this.getFeaturesByPlan("free")}}getPermissionsByRole(e){switch(e){case"admin":return["*"];case"manager":return["leads.read","leads.create","leads.update","leads.delete","boards.read","boards.create","boards.update","users.read","users.invite","templates.read","templates.create","templates.update","templates.delete","automations.read","automations.create","automations.update","automations.delete","reports.read"];case"user":return["leads.read","leads.create","leads.update","boards.read","templates.read","automations.read"];default:return["leads.read"]}}subscribeToCompany(e,t){let r=Q(this.firestore,"companies",e);return it(r,i=>{i.exists()?t(U({id:i.id},i.data())):t(null)})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})};var Vo=class n{auth=de(wn);firestore=de(rt);user$=Kf(this.auth);signInWithEmail(e,t){return m(this,null,function*(){try{return{success:!0,user:(yield Qf(this.auth,e,t)).user}}catch(r){return{success:!1,error:r.message}}})}createUserWithEmail(e,t){return m(this,null,function*(){try{return{success:!0,user:(yield Rc(this.auth,e,t)).user}}catch(r){return{success:!1,error:r.message}}})}updateUserProfile(e){return m(this,null,function*(){try{let t=this.auth.currentUser;if(!t)throw new Error("Usu\xE1rio n\xE3o autenticado");return yield Xf(t,{displayName:e.displayName,photoURL:e.photoURL}),yield cn(Q(this.firestore,"users",t.uid),{email:t.email,displayName:e.displayName||t.displayName,phoneNumber:e.phoneNumber,photoURL:e.photoURL||t.photoURL,createdAt:new Date,lastLogin:new Date}),{success:!0}}catch(t){return{success:!1,error:t.message}}})}signUpWithEmail(e,t,r){return m(this,null,function*(){try{let i=yield Rc(this.auth,e,t);return yield this.updateUserProfile({displayName:r}),{success:!0,user:i.user}}catch(i){return{success:!1,error:i.message}}})}signInWithGoogle(){return m(this,null,function*(){try{let e=new gc,t=yield Yf(this.auth,e);return yield this.createOrUpdateUser(t.user),t}catch(e){throw console.error("Erro no login com Google:",e),e}})}createOrUpdateUser(e){return m(this,null,function*(){try{let t=Q(this.firestore,"users",e.uid);(yield Mn(t)).exists()?yield Me(t,{lastLogin:new Date}):yield cn(t,{email:e.email,displayName:e.displayName,createdAt:new Date,lastLogin:new Date})}catch(t){console.error("Erro ao criar/atualizar usu\xE1rio:",t)}})}logout(){return m(this,null,function*(){try{return yield Jf(this.auth),{success:!0}}catch(e){return{success:!1,error:e.message}}})}getCurrentUser(){return this.auth.currentUser}isAuthenticated(){return this.user$.pipe(id(e=>!!e))}getUserCompany(e){return m(this,null,function*(){try{let t=yield Mn(Q(this.firestore,"users",e));return t.exists()&&t.data().companyId||null}catch(t){return console.error("Erro ao buscar empresa do usu\xE1rio:",t),null}})}linkUserToCompany(e,t){return m(this,null,function*(){try{yield cn(Q(this.firestore,"users",e),{companyId:t,updatedAt:new Date},{merge:!0})}catch(r){throw console.error("Erro ao associar usu\xE1rio \xE0 empresa:",r),r}})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})};var xo=class n{firestore=de(rt);authService=de(Vo);injector=de(je);get companyService(){return this.injector.get(Oo)}currentCompanyId=null;currentCompany=null;initializeCompanyContext(){return m(this,null,function*(){try{let e=this.companyService.getCompanySubdomain();return!e||(this.currentCompany=yield this.companyService.getCompanyBySubdomain(e),!this.currentCompany)?null:(this.currentCompanyId=this.currentCompany.id,this.currentCompany)}catch{return null}})}getCurrentCompany(){return this.currentCompany}getCurrentCompanyId(){return this.currentCompanyId}setCompanyContext(e){this.currentCompany=e,this.currentCompanyId=e.id}getBoards(e){return m(this,null,function*(){try{let t=this.currentCompanyId;if(!t)try{yield this.initializeCompanyContext(),t=this.currentCompanyId}catch{return[]}if(!t)return[];try{let r=q(this.firestore,"companies",t,"boards"),s=(yield ie(r)).docs.map(a=>ne(U({id:a.id},a.data()),{companyId:t}));if(s.length===0)try{let a=q(this.firestore,"users",e,"boards");s=(yield ie(a)).docs.map(d=>ne(U({id:d.id},d.data()),{companyId:t}))}catch{}return s=s.filter(a=>(a.status||"active")==="active"),s}catch{return[]}}catch{return[]}})}createBoard(e,t){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)throw new Error("Contexto da empresa n\xE3o inicializado");let r=q(this.firestore,"companies",this.currentCompanyId,"boards"),i=ne(U({},t),{companyId:this.currentCompanyId,owner:e,ownerEmail:"",status:"active",createdAt:_e()});return yield gt(r,i)}catch(r){throw console.error("Erro ao criar quadro:",r),r}})}updateBoard(e,t,r){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)throw new Error("Contexto da empresa n\xE3o inicializado");let i=Q(this.firestore,"companies",this.currentCompanyId,"boards",t);return yield Me(i,r)}catch(i){throw console.error("Erro ao atualizar quadro:",i),i}})}deleteBoard(e,t){return m(this,null,function*(){try{if(!this.currentCompanyId)throw new Error("Contexto da empresa n\xE3o inicializado");console.log("\u{1F5D1}\uFE0F Iniciando exclus\xE3o completa do quadro:",t),yield this.deleteBoardSubcollections(t);let r=Q(this.firestore,"companies",this.currentCompanyId,"boards",t);yield be(r),console.log("\u2705 Quadro exclu\xEDdo completamente:",t)}catch(r){throw console.error("\u274C Erro ao excluir quadro:",r),r}})}deleteBoardSubcollections(e){return m(this,null,function*(){if(!this.currentCompanyId)return;let t=`companies/${this.currentCompanyId}/boards/${e}`;console.log("\u{1F504} Excluindo subcole\xE7\xF5es do quadro:",t);try{let r=["leads","columns","emailTemplates","automations","phaseFormConfigs","outboxEmails","mail","automationHistory"];for(let i of r)yield this.deleteCollection(`${t}/${i}`);console.log("\u2705 Subcole\xE7\xF5es exclu\xEDdas com sucesso")}catch(r){throw console.error("\u274C Erro ao excluir subcole\xE7\xF5es:",r),r}})}deleteCollection(e){return m(this,null,function*(){try{let t=q(this.firestore,e),r=yield ie(t);if(r.empty){console.log(`\u{1F4ED} Cole\xE7\xE3o ${e} j\xE1 est\xE1 vazia`);return}console.log(`\u{1F5D1}\uFE0F Excluindo ${r.docs.length} documentos de ${e}`);let i=500,s=[];for(let a=0;a<r.docs.length;a+=i){let c=r.docs.slice(a,a+i),l=No(this.firestore);c.forEach(d=>{l.delete(d.ref)}),s.push(l.commit())}yield Promise.all(s),console.log(`\u2705 ${r.docs.length} documentos exclu\xEDdos de ${e}`)}catch(t){console.warn(`\u26A0\uFE0F Erro ao excluir cole\xE7\xE3o ${e}:`,t)}})}getColumns(e,t){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)return console.error("Contexto da empresa n\xE3o inicializado"),[];let r=q(this.firestore,"companies",this.currentCompanyId,"boards",t,"columns"),i=st(r,Ar("order"));return(yield ie(i)).docs.map(a=>ne(U({id:a.id},a.data()),{companyId:this.currentCompanyId,boardId:t}))}catch(r){return console.error("Erro ao buscar colunas:",r),[]}})}createColumn(e,t,r){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)throw new Error("Contexto da empresa n\xE3o inicializado");let i=q(this.firestore,"companies",this.currentCompanyId,"boards",t,"columns"),s=ne(U({},r),{companyId:this.currentCompanyId,boardId:t,createdAt:_e(),updatedAt:_e()});return yield gt(i,s)}catch(i){throw console.error("Erro ao criar coluna:",i),i}})}updateColumn(e,t,r,i){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)throw new Error("Contexto da empresa n\xE3o inicializado");let s=Q(this.firestore,"companies",this.currentCompanyId,"boards",t,"columns",r);return yield Me(s,i)}catch(s){throw console.error("Erro ao atualizar coluna:",s),s}})}deleteColumn(e,t,r){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)throw new Error("Contexto da empresa n\xE3o inicializado");let i=Q(this.firestore,"companies",this.currentCompanyId,"boards",t,"columns",r);return yield be(i)}catch(i){throw console.error("Erro ao excluir coluna:",i),i}})}getLeads(e,t){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)return console.error("Contexto da empresa n\xE3o inicializado"),[];let r=q(this.firestore,"companies",this.currentCompanyId,"boards",t,"leads");return(yield ie(r)).docs.map(s=>ne(U({id:s.id},s.data()),{companyId:this.currentCompanyId,boardId:t}))}catch(r){return console.error("Erro ao buscar leads:",r),[]}})}createLead(e,t,r){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)throw new Error("Contexto da empresa n\xE3o inicializado");let i=q(this.firestore,"companies",this.currentCompanyId,"boards",t,"leads"),s=ne(U({},r),{companyId:this.currentCompanyId,boardId:t,createdAt:_e(),movedToCurrentColumnAt:_e()});return yield gt(i,s)}catch(i){throw console.error("Erro ao criar lead:",i),i}})}updateLead(e,t,r,i){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)throw new Error("Contexto da empresa n\xE3o inicializado");let s=Q(this.firestore,"companies",this.currentCompanyId,"boards",t,"leads",r);return yield Me(s,i)}catch(s){throw console.error("Erro ao atualizar lead:",s),s}})}deleteLead(e,t,r){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)throw new Error("Contexto da empresa n\xE3o inicializado");let i=Q(this.firestore,"companies",this.currentCompanyId,"boards",t,"leads",r);return yield be(i)}catch(i){throw console.error("Erro ao excluir lead:",i),i}})}moveLead(e,t,r,i){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)throw new Error("Contexto da empresa n\xE3o inicializado");let s=Q(this.firestore,"companies",this.currentCompanyId,"boards",t,"leads",r),a={columnId:i,movedToCurrentColumnAt:_e()};return yield Me(s,a)}catch(s){throw console.error("Erro ao mover lead:",s),s}})}subscribeToBoards(e,t){return this.currentCompanyId?this.performBoardsSubscription(t):(this.initializeCompanyContext().then(()=>{this.currentCompanyId&&this.performBoardsSubscription(t)}),()=>{})}performBoardsSubscription(e){if(!this.currentCompanyId)return e([]),()=>{};let t=q(this.firestore,"companies",this.currentCompanyId,"boards");return it(t,r=>{let i=r.docs.map(s=>ne(U({id:s.id},s.data()),{companyId:this.currentCompanyId})).filter(s=>(s.status||"active")==="active");e(i)})}subscribeToColumns(e,t,r){return this.currentCompanyId?this.performColumnsSubscription(t,r):(this.initializeCompanyContext().then(()=>{this.currentCompanyId&&this.performColumnsSubscription(t,r)}),()=>{})}performColumnsSubscription(e,t){if(!this.currentCompanyId)return t([]),()=>{};let r=q(this.firestore,"companies",this.currentCompanyId,"boards",e,"columns"),i=st(r,Ar("order"));return it(i,s=>{let a=s.docs.map(c=>ne(U({id:c.id},c.data()),{companyId:this.currentCompanyId,boardId:e}));t(a)})}subscribeToLeads(e,t,r){return this.currentCompanyId?this.performLeadsSubscription(t,r):(this.initializeCompanyContext().then(()=>{this.currentCompanyId&&this.performLeadsSubscription(t,r)}),()=>{})}performLeadsSubscription(e,t){if(!this.currentCompanyId)return t([]),()=>{};let r=q(this.firestore,"companies",this.currentCompanyId,"boards",e,"leads");return it(r,i=>{let s=i.docs.map(a=>ne(U({id:a.id},a.data()),{companyId:this.currentCompanyId,boardId:e}));t(s)})}updateMultipleLeads(e,t,r){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)throw new Error("Contexto da empresa n\xE3o inicializado");let i=No(this.firestore);return r.forEach(s=>{let a=Q(this.firestore,"companies",this.currentCompanyId,"boards",t,"leads",s.leadId);i.update(a,s.data)}),yield i.commit()}catch(i){throw console.error("Erro ao atualizar m\xFAltiplos leads:",i),i}})}addLeadHistory(e,t,r,i){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)throw new Error("Contexto da empresa n\xE3o inicializado");let s=q(this.firestore,"companies",this.currentCompanyId,"boards",t,"leads",r,"history"),a=ne(U({},i),{timestamp:_e()});return yield gt(s,a)}catch(s){throw console.error("Erro ao adicionar hist\xF3rico do lead:",s),s}})}getLeadHistory(e,t,r){return m(this,null,function*(){try{if(this.currentCompanyId||(yield this.initializeCompanyContext()),!this.currentCompanyId)return console.error("Contexto da empresa n\xE3o inicializado"),[];let i=q(this.firestore,"companies",this.currentCompanyId,"boards",t,"leads",r,"history"),s=st(i,Ar("timestamp","desc"));return(yield ie(s)).docs.map(c=>U({id:c.id},c.data()))}catch(i){return console.error("Erro ao buscar hist\xF3rico do lead:",i),[]}})}createPhaseFormConfig(e,t,r){return m(this,null,function*(){let i=q(this.firestore,`users/${e}/boards/${t}/phaseFormConfigs`),s=ne(U({},r),{createdAt:_e(),updatedAt:_e()});return yield gt(i,s)})}updatePhaseFormConfig(e,t,r,i){return m(this,null,function*(){let s=Q(this.firestore,`users/${e}/boards/${t}/phaseFormConfigs/${r}`),a=ne(U({},i),{updatedAt:_e()});return yield Me(s,a)})}getPhaseFormConfig(e,t,r){return m(this,null,function*(){let i=q(this.firestore,`users/${e}/boards/${t}/phaseFormConfigs`),s=st(i,Sr("columnId","==",r)),a=yield ie(s);if(!a.empty){let c=a.docs[0];return U({id:c.id},c.data())}return null})}deletePhaseFormConfig(e,t,r){return m(this,null,function*(){let i=Q(this.firestore,`users/${e}/boards/${t}/phaseFormConfigs/${r}`);return yield be(i)})}getOutboxEmails(e,t){return m(this,null,function*(){let r=q(this.firestore,`users/${e}/boards/${t}/mail`),i=st(r,Ar("createdAt","desc"));return(yield ie(i)).docs.map(a=>U({id:a.id},a.data())).filter(a=>a.to)})}createOutboxEmail(e,t,r){return m(this,null,function*(){let i=q(this.firestore,`users/${e}/boards/${t}/mail`),s=ne(U({},r),{createdAt:_e(),updatedAt:_e()});return yield gt(i,s)})}updateOutboxEmail(e,t,r,i){return m(this,null,function*(){let s=Q(this.firestore,`users/${e}/boards/${t}/mail/${r}`),a=ne(U({},i),{updatedAt:_e()});return yield Me(s,a)})}deleteOutboxEmail(e,t,r){return m(this,null,function*(){let i=Q(this.firestore,`users/${e}/boards/${t}/mail/${r}`);return yield be(i)})}subscribeToOutboxEmails(e,t,r){let i=q(this.firestore,`users/${e}/boards/${t}/mail`),s=st(i,Ar("createdAt","desc"));return it(s,a=>{let c=a.docs.map(l=>U({id:l.id},l.data())).filter(l=>l.to);r(c)})}clearOutboxEmails(e,t){return m(this,null,function*(){try{let r=q(this.firestore,`users/${e}/boards/${t}/mail`),s=(yield ie(r)).docs.map(a=>be(a.ref));yield Promise.all(s),console.log(`\u2705 Exclu\xEDdos ${s.length} emails da caixa de sa\xEDda`)}catch(r){throw console.error("\u274C Erro ao limpar caixa de sa\xEDda:",r),r}})}getEmailTemplates(e,t){return m(this,null,function*(){try{if(this.currentCompanyId){let c=`companies/${this.currentCompanyId}/boards/${t}/emailTemplates`;console.log("Buscando templates em (multi-empresa):",c);let l=q(this.firestore,c),p=(yield ie(l)).docs.map(y=>U({id:y.id},y.data()));return console.log(`Templates encontrados (multi-empresa): ${p.length} itens`),p}let r=e?`users/${e}/boards/${t}/emailTemplates`:`boards/${t}/emailTemplates`;console.log("Buscando templates em (estrutura antiga):",r);let i=q(this.firestore,r),a=(yield ie(i)).docs.map(c=>U({id:c.id},c.data()));return console.log(`Templates encontrados (estrutura antiga): ${a.length} itens`),a}catch(r){return console.error("Erro ao buscar templates:",r),[]}})}createEmailTemplate(e,t,r){return m(this,null,function*(){let i=this.currentCompanyId?`companies/${this.currentCompanyId}/boards/${t}/emailTemplates`:`users/${e}/boards/${t}/emailTemplates`,s=q(this.firestore,i),a=ne(U({},r),{boardId:t,createdAt:_e(),updatedAt:_e()});return console.log("Criando template em:",i,a),yield gt(s,a)})}updateEmailTemplate(e,t,r,i){return m(this,null,function*(){let s=this.currentCompanyId?`companies/${this.currentCompanyId}/boards/${t}/emailTemplates/${r}`:`users/${e}/boards/${t}/emailTemplates/${r}`,a=Q(this.firestore,s),c=ne(U({},i),{boardId:t,updatedAt:_e()});return console.log("Atualizando template em:",s,c),yield Me(a,c)})}deleteEmailTemplate(e,t,r){return m(this,null,function*(){let i=this.currentCompanyId?`companies/${this.currentCompanyId}/boards/${t}/emailTemplates/${r}`:`users/${e}/boards/${t}/emailTemplates/${r}`,s=Q(this.firestore,i);return yield be(s)})}subscribeToEmailTemplates(e,t,r){if(console.log(`Iniciando subscri\xE7\xE3o de templates para boardId: ${t}`),!this.currentCompanyId)return console.warn("Contexto da empresa n\xE3o definido, retornando array vazio"),r([]),()=>{};let i=`companies/${this.currentCompanyId}/boards/${t}/emailTemplates`;console.log("Subscribing templates em:",i);let s=q(this.firestore,i);return it(s,a=>{let c=a.docs.map(l=>U({id:l.id,path:l.ref.path},l.data()));console.log(`Templates encontrados (multi-empresa) para boardId: ${t}:`,c.length),r(c)},a=>{console.error("Erro ao subscrever templates (multi-empresa):",a),r([])})}getAutomations(e,t){return m(this,null,function*(){try{if(console.log("Buscando automa\xE7\xF5es para boardId:",t),this.currentCompanyId){let c=`companies/${this.currentCompanyId}/boards/${t}/automations`;console.log("Buscando automa\xE7\xF5es em (multi-empresa):",c);let l=q(this.firestore,c),p=(yield ie(l)).docs.map(y=>U({id:y.id},y.data()));return console.log(`Automa\xE7\xF5es encontradas (multi-empresa): ${p.length} itens`),p}console.log("Contexto de empresa n\xE3o definido, usando estrutura antiga");let r=`users/${e}/boards/${t}/automations`;console.log("Buscando automa\xE7\xF5es em (estrutura antiga):",r);let i=q(this.firestore,r),a=(yield ie(i)).docs.map(c=>U({id:c.id},c.data()));return console.log(`Automa\xE7\xF5es encontradas (estrutura antiga): ${a.length} itens`),a}catch(r){return console.error("Erro ao buscar automa\xE7\xF5es:",r),[]}})}createAutomation(e,t,r){return m(this,null,function*(){let i=q(this.firestore,`users/${e}/boards/${t}/automations`),s=ne(U({},r),{boardId:t,createdAt:_e(),updatedAt:_e(),active:!0});return console.log("Criando automa\xE7\xE3o em:",`users/${e}/boards/${t}/automations`,s),yield gt(i,s)})}updateAutomation(e,t,r,i){return m(this,null,function*(){let s=Q(this.firestore,`users/${e}/boards/${t}/automations/${r}`),a=ne(U({},i),{boardId:t,updatedAt:_e()});return console.log("Atualizando automa\xE7\xE3o em:",`users/${e}/boards/${t}/automations/${r}`,a),yield Me(s,a)})}deleteAutomation(e,t,r){return m(this,null,function*(){let i=Q(this.firestore,`users/${e}/boards/${t}/automations/${r}`);return console.log("Excluindo automa\xE7\xE3o:",`users/${e}/boards/${t}/automations/${r}`),yield be(i)})}subscribeToAutomationHistory(e,t,r,i){console.log("Subscribing to automation history for:",{userId:e,boardId:t,automationId:r});let s=q(this.firestore,`users/${e}/boards/${t}/automationHistory`),a=st(s,Sr("automationId","==",r));return it(a,c=>{let l=c.docs.map(d=>U({id:d.id},d.data()));console.log(`Hist\xF3rico de automa\xE7\xE3o encontrado: ${l.length} itens`),i(l)},c=>{console.error("Erro ao buscar hist\xF3rico de automa\xE7\xE3o:",c);let l=q(this.firestore,`boards/${t}/automationHistory`),d=st(l,Sr("automationId","==",r));return it(d,p=>{let y=p.docs.map(_=>U({id:_.id},_.data()));console.log(`Hist\xF3rico de automa\xE7\xE3o (estrutura alternativa): ${y.length} itens`),i(y)},p=>{console.error("Erro ao buscar hist\xF3rico de automa\xE7\xE3o (estrutura alternativa):",p),i([])})})}addAutomationHistoryItem(e,t,r){return m(this,null,function*(){try{let i=q(this.firestore,`users/${e}/boards/${t}/automationHistory`),s=yield gt(i,ne(U({},r),{timestamp:new Date,createdAt:new Date}));return console.log("Item de hist\xF3rico de automa\xE7\xE3o adicionado:",s.id),s.id}catch(i){throw console.error("Erro ao adicionar item de hist\xF3rico de automa\xE7\xE3o:",i),i}})}subscribeToAutomations(e,t,r){if(console.log(`Iniciando subscri\xE7\xE3o de automa\xE7\xF5es para boardId: ${t}`),!this.currentCompanyId)return console.warn("Contexto da empresa n\xE3o definido, retornando array vazio"),r([]),()=>{};let i=`companies/${this.currentCompanyId}/boards/${t}/automations`;console.log("Subscribing automa\xE7\xF5es em:",i);let s=q(this.firestore,i);return it(s,a=>{let c=a.docs.map(l=>U({id:l.id,path:l.ref.path},l.data()));console.log(`Automa\xE7\xF5es encontradas (multi-empresa) para boardId: ${t}:`,c.length),r(c)},a=>{console.error("Erro ao subscrever automa\xE7\xF5es (multi-empresa):",a),r([])})}clearAllData(e){return m(this,null,function*(){try{let t=No(this.firestore),r=0;if(this.currentCompanyId){let i=q(this.firestore,`companies/${this.currentCompanyId}/boards`),s=yield ie(i);for(let a of s.docs){let c=a.id,l=["leads","columns","emailTemplates","automations","phaseFormConfigs","outboxEmails","mail","automationHistory"];for(let d of l)try{let p=q(this.firestore,`companies/${this.currentCompanyId}/boards/${c}/${d}`);(yield ie(p)).docs.forEach(_=>{t.delete(_.ref),r++})}catch{}t.delete(a.ref),r++}}if(e){let i=["boards","emailTemplates","automations","outboxEmails","leads","columns"];for(let s of i)try{let a=q(this.firestore,`users/${e}/${s}`);(yield ie(a)).docs.forEach(l=>{t.delete(l.ref),r++})}catch{}}r>0&&(yield t.commit())}catch(t){throw t}})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Ut({token:n,factory:n.\u0275fac,providedIn:"root"})};export{fd as a,$t as b,ss as c,pd as d,os as e,Ue as f,oe as g,xe as h,Je as i,Hn as j,Ve as k,qt as l,gn as m,le as n,jt as o,Jr as p,Qn as q,zt as r,re as s,wt as t,_n as u,Hb as v,Kb as w,Yn as x,ui as y,yS as z,_S as A,U0 as B,$0 as C,Vo as D,xo as E,Oo as F};
