import{a as z}from"./chunk-RHNPUN54.js";import{a as K}from"./chunk-4RPGT7VY.js";import{A as I,J as R,K as B,L as W,M as H,i as A,j as O,k as d,m as q,n as D,u as G,v as V,w as L,z as j}from"./chunk-XFXMLSII.js";import{R as U}from"./chunk-4U6ZKXZY.js";import{Ab as i,Bb as e,Cb as a,Lb as v,Lc as k,Nb as h,Ta as m,Wb as S,Xb as t,Zb as C,a as _,ac as T,b as M,bb as w,bc as F,cc as N,da as x,f as E,gc as P,ta as p,ub as c,vb as g,zb as f}from"./chunk-O3JLSHCU.js";var Q=()=>({standalone:!0});function X(s,n){s&1&&(i(0,"span",2),a(1,"i",50),t(2," Preencha todos os campos "),e())}function Y(s,n){s&1&&(a(0,"i",51),t(1," Salvando... "))}function Z(s,n){s&1&&(a(0,"i",52),t(1," Salvar Configura\xE7\xF5es "))}function $(s,n){if(s&1&&(i(0,"div",5),a(1,"i",53),t(2),e()),s&2){let o=h();m(2),C(" ",o.successMessage()," ")}}function ee(s,n){if(s&1&&(i(0,"div",6),a(1,"i",54),t(2),e()),s&2){let o=h();m(2),C(" ",o.errorMessage()," ")}}function te(s,n){s&1&&(a(0,"i",51),t(1," Enviando... "))}function ie(s,n){s&1&&(a(0,"i",55),t(1," Testar "))}var J=class s{fb=x(R);companyService=x(U);subdomainService=x(H);smtpForm;currentCompany=p(null);isSaving=p(!1);isTesting=p(!1);testEmail="";successMessage=p(null);errorMessage=p(null);constructor(){this.smtpForm=this.fb.group({host:["smtp.gmail.com",d.required],port:[587,[d.required,d.min(1),d.max(65535)]],secure:[!0],user:["",[d.required,d.email]],password:["",d.required],fromName:["",d.required],fromEmail:["",[d.required,d.email]]})}ngOnInit(){this.loadCurrentConfiguration()}loadCurrentConfiguration(){let n=this.subdomainService.getCurrentCompany();n&&(this.currentCompany.set(n),n.smtpConfig?this.smtpForm.patchValue({host:n.smtpConfig.host,port:n.smtpConfig.port,secure:n.smtpConfig.secure,user:n.smtpConfig.user,password:n.smtpConfig.password,fromName:n.smtpConfig.fromName,fromEmail:n.smtpConfig.fromEmail}):this.smtpForm.patchValue({fromName:n.name||"Sistema Kanban",secure:!0,port:587}))}saveConfiguration(){return E(this,null,function*(){if(this.markAllFieldsAsTouched(),this.smtpForm.invalid){this.showError("Por favor, preencha todos os campos obrigat\xF3rios corretamente.");return}let n=this.currentCompany();if(!n?.id){this.showError("Empresa n\xE3o encontrada");return}this.isSaving.set(!0),this.clearMessages();try{let o=this.smtpForm.value,r={host:String(o.host||""),port:Number(o.port||587),secure:!!o.secure,user:String(o.user||""),password:String(o.password||""),fromName:String(o.fromName||""),fromEmail:String(o.fromEmail||"")},u={smtpConfig:r};yield this.companyService.updateCompany(n.id,u);let l=M(_({},n),{smtpConfig:r});this.subdomainService.setCurrentCompany(l),this.currentCompany.set(l),this.showSuccess("Configura\xE7\xF5es SMTP salvas com sucesso!")}catch(o){console.error("Erro ao salvar configura\xE7\xF5es SMTP:",o),this.showError("Erro ao salvar configura\xE7\xF5es: "+(o?.message||"Tente novamente."))}finally{this.isSaving.set(!1)}})}sendTestEmail(){return E(this,null,function*(){if(!(!this.testEmail||this.smtpForm.invalid)){this.isTesting.set(!0),this.clearMessages();try{yield new Promise(n=>setTimeout(n,2e3)),this.showSuccess(`Email de teste enviado para ${this.testEmail}!`)}catch(n){console.error("Erro ao enviar email de teste:",n),this.showError("Erro ao enviar email de teste. Verifique as configura\xE7\xF5es.")}finally{this.isTesting.set(!1)}}})}showSuccess(n){this.successMessage.set(n),this.errorMessage.set(null),setTimeout(()=>this.successMessage.set(null),5e3)}showError(n){this.errorMessage.set(n),this.successMessage.set(null),setTimeout(()=>this.errorMessage.set(null),5e3)}clearMessages(){this.successMessage.set(null),this.errorMessage.set(null)}getFormErrors(){let n={};return Object.keys(this.smtpForm.controls).forEach(o=>{let r=this.smtpForm.get(o);r&&!r.valid&&r.touched&&(n[o]=r.errors)}),n}markAllFieldsAsTouched(){Object.keys(this.smtpForm.controls).forEach(n=>{this.smtpForm.get(n)?.markAsTouched()})}static \u0275fac=function(o){return new(o||s)};static \u0275cmp=w({type:s,selectors:[["app-smtp-config"]],decls:153,vars:18,consts:[["title","Configura\xE7\xE3o SMTP"],[1,"flex","items-center","space-x-3"],[1,"text-sm","text-red-600","flex","items-center"],[1,"bg-green-500","hover:bg-green-600","text-white","px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"mb-6","p-4","bg-green-50","border","border-green-200","rounded-lg","text-green-800"],[1,"mb-6","p-4","bg-red-50","border","border-red-200","rounded-lg","text-red-800"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200"],[1,"p-6","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-900","flex","items-center"],[1,"fas","fa-envelope","text-blue-500","mr-2"],[1,"text-sm","text-gray-600","mt-1"],[1,"p-6"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","lg:grid-cols-4","gap-4"],[1,"lg:col-span-3"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","formControlName","host","placeholder","smtp.gmail.com"],[1,"text-xs","text-gray-500","mt-1"],["type","number","formControlName","port","placeholder","587",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-blue-500","focus:border-blue-500"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-4"],["type","email","formControlName","user","placeholder","seu-email@gmail.com"],["type","password","formControlName","password","placeholder","sua-senha-ou-app-password"],["type","text","formControlName","fromName",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-blue-500","focus:border-blue-500",3,"placeholder"],["type","email","formControlName","fromEmail","placeholder","noreply@suaempresa.com",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-blue-500","focus:border-blue-500"],[1,"space-y-3"],[1,"text-md","font-medium","text-gray-900"],[1,"flex","items-center"],["type","checkbox","formControlName","secure","id","secureConnection",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["for","secureConnection",1,"ml-2","text-sm","text-gray-700"],[1,"text-xs","text-gray-500"],[1,"pt-6","border-t","border-gray-200"],[1,"text-md","font-medium","text-gray-900","mb-4"],[1,"flex","space-x-3"],["type","email","placeholder","seu-email@exemplo.com",1,"flex-1","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","ngModel","ngModelOptions"],["type","button",1,"bg-blue-500","hover:bg-blue-600","text-white","px-4","py-2","rounded-md","text-sm","font-medium","transition-colors",3,"click","disabled"],[1,"text-xs","text-gray-500","mt-2"],[1,"mt-8","bg-white","rounded-lg","shadow-sm","border","border-gray-200"],[1,"fas","fa-question-circle","text-blue-500","mr-2"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"border","border-gray-200","rounded-lg","p-4"],[1,"flex","items-center","mb-3"],[1,"w-8","h-8","bg-red-500","rounded","flex","items-center","justify-center"],[1,"fab","fa-google","text-white","text-sm"],[1,"ml-3","text-sm","font-semibold","text-gray-900"],[1,"text-xs","text-gray-600","space-y-1"],[1,"w-8","h-8","bg-blue-500","rounded","flex","items-center","justify-center"],[1,"fab","fa-microsoft","text-white","text-sm"],[1,"w-8","h-8","bg-gray-500","rounded","flex","items-center","justify-center"],[1,"fas","fa-server","text-white","text-sm"],[1,"fas","fa-exclamation-circle","mr-1"],[1,"fas","fa-spinner","fa-spin","mr-1"],[1,"fas","fa-save","mr-1"],[1,"fas","fa-check-circle","mr-2"],[1,"fas","fa-exclamation-circle","mr-2"],[1,"fas","fa-paper-plane","mr-1"]],template:function(o,r){if(o&1&&(i(0,"app-main-layout")(1,"app-config-header",0)(2,"div",1),c(3,X,3,0,"span",2),i(4,"button",3),v("click",function(){return r.saveConfiguration()}),c(5,Y,2,0)(6,Z,2,0),e()()(),i(7,"div",4),c(8,$,3,1,"div",5),c(9,ee,3,1,"div",6),i(10,"div",7)(11,"div",8)(12,"h3",9),a(13,"i",10),t(14," Configura\xE7\xE3o do Servidor SMTP "),e(),i(15,"p",11),t(16,"Configure o servidor de email para sua empresa enviar notifica\xE7\xF5es"),e()(),i(17,"div",12)(18,"form",13),v("ngSubmit",function(){return r.saveConfiguration()}),i(19,"div",14)(20,"div",15)(21,"label",16),t(22," Servidor SMTP * "),e(),a(23,"input",17),i(24,"p",18),t(25,"Endere\xE7o do servidor SMTP"),e()(),i(26,"div")(27,"label",16),t(28," Porta * "),e(),a(29,"input",19),i(30,"p",18),t(31,"Porta SMTP"),e()()(),i(32,"div",20)(33,"div")(34,"label",16),t(35," Usu\xE1rio/Email * "),e(),a(36,"input",21),i(37,"p",18),t(38,"Email para autentica\xE7\xE3o no servidor"),e()(),i(39,"div")(40,"label",16),t(41," Senha * "),e(),a(42,"input",22),i(43,"p",18),t(44,"Senha ou App Password do Gmail"),e()()(),i(45,"div",20)(46,"div")(47,"label",16),t(48," Nome do Remetente * "),e(),a(49,"input",23),i(50,"p",18),t(51,"Nome que aparecer\xE1 nos emails enviados"),e()(),i(52,"div")(53,"label",16),t(54," Email do Remetente * "),e(),a(55,"input",24),i(56,"p",18),t(57,"Email que aparecer\xE1 como remetente"),e()()(),i(58,"div",25)(59,"h4",26),t(60,"Op\xE7\xF5es de Seguran\xE7a"),e(),i(61,"div",27),a(62,"input",28),i(63,"label",29),t(64," Usar conex\xE3o segura (SSL/TLS) "),e()(),i(65,"p",30),t(66,"Recomendado para a maioria dos provedores de email"),e()(),i(67,"div",31)(68,"h4",32),t(69,"Testar Configura\xE7\xE3o"),e(),i(70,"div",33)(71,"input",34),N("ngModelChange",function(l){return F(r.testEmail,l)||(r.testEmail=l),l}),e(),i(72,"button",35),v("click",function(){return r.sendTestEmail()}),c(73,te,2,0)(74,ie,2,0),e()(),i(75,"p",36),t(76,"Envie um email de teste para verificar se a configura\xE7\xE3o est\xE1 funcionando"),e()()()()(),i(77,"div",37)(78,"div",8)(79,"h3",9),a(80,"i",38),t(81," Guias de Configura\xE7\xE3o R\xE1pida "),e()(),i(82,"div",12)(83,"div",39)(84,"div",40)(85,"div",41)(86,"div",42),a(87,"i",43),e(),i(88,"h4",44),t(89,"Gmail"),e()(),i(90,"div",45)(91,"p")(92,"strong"),t(93,"Servidor:"),e(),t(94," smtp.gmail.com"),e(),i(95,"p")(96,"strong"),t(97,"Porta:"),e(),t(98," 587"),e(),i(99,"p")(100,"strong"),t(101,"Seguro:"),e(),t(102," Sim"),e(),i(103,"p")(104,"strong"),t(105,"Senha:"),e(),t(106," App Password necess\xE1ria"),e()()(),i(107,"div",40)(108,"div",41)(109,"div",46),a(110,"i",47),e(),i(111,"h4",44),t(112,"Outlook"),e()(),i(113,"div",45)(114,"p")(115,"strong"),t(116,"Servidor:"),e(),t(117," smtp-mail.outlook.com"),e(),i(118,"p")(119,"strong"),t(120,"Porta:"),e(),t(121," 587"),e(),i(122,"p")(123,"strong"),t(124,"Seguro:"),e(),t(125," Sim"),e(),i(126,"p")(127,"strong"),t(128,"Auth:"),e(),t(129," STARTTLS"),e()()(),i(130,"div",40)(131,"div",41)(132,"div",48),a(133,"i",49),e(),i(134,"h4",44),t(135,"Outros"),e()(),i(136,"div",45)(137,"p")(138,"strong"),t(139,"Porta 25:"),e(),t(140," N\xE3o segura"),e(),i(141,"p")(142,"strong"),t(143,"Porta 465:"),e(),t(144," SSL"),e(),i(145,"p")(146,"strong"),t(147,"Porta 587:"),e(),t(148," TLS"),e(),i(149,"p")(150,"strong"),t(151,"Porta 2525:"),e(),t(152," Alternativa"),e()()()()()()()()),o&2){let u,l,b,y;m(3),g(r.smtpForm.invalid?3:-1),m(),f("disabled",r.isSaving()),m(),g(r.isSaving()?5:6),m(3),g(r.successMessage()?8:-1),m(),g(r.errorMessage()?9:-1),m(9),f("formGroup",r.smtpForm),m(5),S("w-full px-3 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 "+((u=r.smtpForm.get("host"))!=null&&u.invalid&&((u=r.smtpForm.get("host"))!=null&&u.touched)?"border-red-300 bg-red-50":"border-gray-300")),m(13),S("w-full px-3 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 "+((l=r.smtpForm.get("user"))!=null&&l.invalid&&((l=r.smtpForm.get("user"))!=null&&l.touched)?"border-red-300 bg-red-50":"border-gray-300")),m(6),S("w-full px-3 py-2 border rounded-md focus:ring-blue-500 focus:border-blue-500 "+((b=r.smtpForm.get("password"))!=null&&b.invalid&&((b=r.smtpForm.get("password"))!=null&&b.touched)?"border-red-300 bg-red-50":"border-gray-300")),m(7),f("placeholder",((y=r.currentCompany())==null?null:y.name)||"Nome da Empresa"),m(22),T("ngModel",r.testEmail),f("ngModelOptions",P(17,Q)),m(),f("disabled",r.isTesting()||!r.testEmail||r.smtpForm.invalid),m(),g(r.isTesting()?73:74)}},dependencies:[k,W,V,O,L,A,q,D,j,I,B,G,z,K],styles:["[_nghost-%COMP%]{display:block}"]})};export{J as SmtpConfigComponent};
