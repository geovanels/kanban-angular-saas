import{a as W}from"./chunk-QYFWIVZ2.js";import{a as j}from"./chunk-IU7U2KCH.js";import{A,J as V,K as I,L,i as N,j as P,k as l,m as F,n as k,u as q,v as D,w as G,z as O}from"./chunk-N33KF77X.js";import{$ as R}from"./chunk-WLUU74ML.js";import{Ab as e,Bb as o,Hc as T,Ib as x,Jb as S,Ta as m,Tb as t,Vb as C,Yb as y,Zb as M,_b as w,a as E,bb as h,cc as _,da as f,f as v,ta as u,tb as c,ub as g,yb as p,zb as i}from"./chunk-3D7XR5P5.js";var U=()=>({standalone:!0});function H(s,n){s&1&&(o(0,"i",49),t(1," Salvando... "))}function z(s,n){s&1&&(o(0,"i",50),t(1," Salvar Configura\xE7\xF5es "))}function J(s,n){if(s&1&&(i(0,"div",4),o(1,"i",51),t(2),e()),s&2){let a=S();m(2),C(" ",a.successMessage()," ")}}function K(s,n){if(s&1&&(i(0,"div",5),o(1,"i",52),t(2),e()),s&2){let a=S();m(2),C(" ",a.errorMessage()," ")}}function Q(s,n){s&1&&(o(0,"i",49),t(1," Enviando... "))}function X(s,n){s&1&&(o(0,"i",53),t(1," Testar "))}var B=class s{fb=f(V);companyService=f(R);subdomainService=f(j);smtpForm;currentCompany=u(null);isSaving=u(!1);isTesting=u(!1);testEmail="";successMessage=u(null);errorMessage=u(null);constructor(){this.smtpForm=this.fb.group({host:["",l.required],port:[587,[l.required,l.min(1),l.max(65535)]],secure:[!1],user:["",[l.required,l.email]],password:["",l.required],fromName:["",l.required],fromEmail:["",[l.required,l.email]]})}ngOnInit(){this.loadCurrentConfiguration()}loadCurrentConfiguration(){let n=this.subdomainService.getCurrentCompany();n&&(this.currentCompany.set(n),n.smtpConfig&&this.smtpForm.patchValue({host:n.smtpConfig.host,port:n.smtpConfig.port,secure:n.smtpConfig.secure,user:n.smtpConfig.user,password:n.smtpConfig.password,fromName:n.smtpConfig.fromName,fromEmail:n.smtpConfig.fromEmail}))}saveConfiguration(){return v(this,null,function*(){if(this.smtpForm.invalid)return;let n=this.currentCompany();if(!n){this.showError("Empresa n\xE3o encontrada");return}this.isSaving.set(!0),this.clearMessages();try{let a=this.smtpForm.value,r={smtpConfig:{host:a.host,port:a.port,secure:a.secure,user:a.user,password:a.password,fromName:a.fromName,fromEmail:a.fromEmail}};yield this.companyService.updateCompany(n.id,r);let d=E(E({},n),r);this.subdomainService.setCurrentCompany(d),this.currentCompany.set(d),this.showSuccess("Configura\xE7\xF5es SMTP salvas com sucesso!")}catch(a){console.error("Erro ao salvar configura\xE7\xF5es SMTP:",a),this.showError("Erro ao salvar configura\xE7\xF5es. Tente novamente.")}finally{this.isSaving.set(!1)}})}sendTestEmail(){return v(this,null,function*(){if(!(!this.testEmail||this.smtpForm.invalid)){this.isTesting.set(!0),this.clearMessages();try{yield new Promise(n=>setTimeout(n,2e3)),this.showSuccess(`Email de teste enviado para ${this.testEmail}!`)}catch(n){console.error("Erro ao enviar email de teste:",n),this.showError("Erro ao enviar email de teste. Verifique as configura\xE7\xF5es.")}finally{this.isTesting.set(!1)}}})}showSuccess(n){this.successMessage.set(n),this.errorMessage.set(null),setTimeout(()=>this.successMessage.set(null),5e3)}showError(n){this.errorMessage.set(n),this.successMessage.set(null),setTimeout(()=>this.errorMessage.set(null),5e3)}clearMessages(){this.successMessage.set(null),this.errorMessage.set(null)}static \u0275fac=function(a){return new(a||s)};static \u0275cmp=h({type:s,selectors:[["app-smtp-config"]],decls:151,vars:11,consts:[[1,"min-h-screen","bg-gray-100"],["title","Configura\xE7\xE3o SMTP"],[1,"bg-green-500","hover:bg-green-600","text-white","px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors",3,"click","disabled"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"mb-6","p-4","bg-green-50","border","border-green-200","rounded-lg","text-green-800"],[1,"mb-6","p-4","bg-red-50","border","border-red-200","rounded-lg","text-red-800"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200"],[1,"p-6","border-b","border-gray-200"],[1,"text-lg","font-semibold","text-gray-900","flex","items-center"],[1,"fas","fa-envelope","text-blue-500","mr-2"],[1,"text-sm","text-gray-600","mt-1"],[1,"p-6"],[1,"space-y-6",3,"ngSubmit","formGroup"],[1,"grid","grid-cols-1","lg:grid-cols-4","gap-4"],[1,"lg:col-span-3"],[1,"block","text-sm","font-medium","text-gray-700","mb-2"],["type","text","formControlName","host","placeholder","smtp.gmail.com",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-blue-500","focus:border-blue-500"],[1,"text-xs","text-gray-500","mt-1"],["type","number","formControlName","port","placeholder","587",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-blue-500","focus:border-blue-500"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-4"],["type","email","formControlName","user","placeholder","seu-email@gmail.com",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-blue-500","focus:border-blue-500"],["type","password","formControlName","password","placeholder","sua-senha-ou-app-password",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-blue-500","focus:border-blue-500"],["type","text","formControlName","fromName",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-blue-500","focus:border-blue-500",3,"placeholder"],["type","email","formControlName","fromEmail","placeholder","noreply@suaempresa.com",1,"w-full","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-blue-500","focus:border-blue-500"],[1,"space-y-3"],[1,"text-md","font-medium","text-gray-900"],[1,"flex","items-center"],["type","checkbox","formControlName","secure","id","secureConnection",1,"h-4","w-4","text-blue-600","border-gray-300","rounded","focus:ring-blue-500"],["for","secureConnection",1,"ml-2","text-sm","text-gray-700"],[1,"text-xs","text-gray-500"],[1,"pt-6","border-t","border-gray-200"],[1,"text-md","font-medium","text-gray-900","mb-4"],[1,"flex","space-x-3"],["type","email","placeholder","seu-email@exemplo.com",1,"flex-1","px-3","py-2","border","border-gray-300","rounded-md","focus:ring-blue-500","focus:border-blue-500",3,"ngModelChange","ngModel","ngModelOptions"],["type","button",1,"bg-blue-500","hover:bg-blue-600","text-white","px-4","py-2","rounded-md","text-sm","font-medium","transition-colors",3,"click","disabled"],[1,"text-xs","text-gray-500","mt-2"],[1,"mt-8","bg-white","rounded-lg","shadow-sm","border","border-gray-200"],[1,"fas","fa-question-circle","text-blue-500","mr-2"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6"],[1,"border","border-gray-200","rounded-lg","p-4"],[1,"flex","items-center","mb-3"],[1,"w-8","h-8","bg-red-500","rounded","flex","items-center","justify-center"],[1,"fab","fa-google","text-white","text-sm"],[1,"ml-3","text-sm","font-semibold","text-gray-900"],[1,"text-xs","text-gray-600","space-y-1"],[1,"w-8","h-8","bg-blue-500","rounded","flex","items-center","justify-center"],[1,"fab","fa-microsoft","text-white","text-sm"],[1,"w-8","h-8","bg-gray-500","rounded","flex","items-center","justify-center"],[1,"fas","fa-server","text-white","text-sm"],[1,"fas","fa-spinner","fa-spin","mr-1"],[1,"fas","fa-save","mr-1"],[1,"fas","fa-check-circle","mr-2"],[1,"fas","fa-exclamation-circle","mr-2"],[1,"fas","fa-paper-plane","mr-1"]],template:function(a,r){if(a&1&&(i(0,"div",0)(1,"app-config-header",1)(2,"button",2),x("click",function(){return r.saveConfiguration()}),c(3,H,2,0)(4,z,2,0),e()(),i(5,"div",3),c(6,J,3,1,"div",4),c(7,K,3,1,"div",5),i(8,"div",6)(9,"div",7)(10,"h3",8),o(11,"i",9),t(12," Configura\xE7\xE3o do Servidor SMTP "),e(),i(13,"p",10),t(14,"Configure o servidor de email para sua empresa enviar notifica\xE7\xF5es"),e()(),i(15,"div",11)(16,"form",12),x("ngSubmit",function(){return r.saveConfiguration()}),i(17,"div",13)(18,"div",14)(19,"label",15),t(20," Servidor SMTP * "),e(),o(21,"input",16),i(22,"p",17),t(23,"Endere\xE7o do servidor SMTP"),e()(),i(24,"div")(25,"label",15),t(26," Porta * "),e(),o(27,"input",18),i(28,"p",17),t(29,"Porta SMTP"),e()()(),i(30,"div",19)(31,"div")(32,"label",15),t(33," Usu\xE1rio/Email * "),e(),o(34,"input",20),i(35,"p",17),t(36,"Email para autentica\xE7\xE3o no servidor"),e()(),i(37,"div")(38,"label",15),t(39," Senha * "),e(),o(40,"input",21),i(41,"p",17),t(42,"Senha ou App Password do Gmail"),e()()(),i(43,"div",19)(44,"div")(45,"label",15),t(46," Nome do Remetente * "),e(),o(47,"input",22),i(48,"p",17),t(49,"Nome que aparecer\xE1 nos emails enviados"),e()(),i(50,"div")(51,"label",15),t(52," Email do Remetente * "),e(),o(53,"input",23),i(54,"p",17),t(55,"Email que aparecer\xE1 como remetente"),e()()(),i(56,"div",24)(57,"h4",25),t(58,"Op\xE7\xF5es de Seguran\xE7a"),e(),i(59,"div",26),o(60,"input",27),i(61,"label",28),t(62," Usar conex\xE3o segura (SSL/TLS) "),e()(),i(63,"p",29),t(64,"Recomendado para a maioria dos provedores de email"),e()(),i(65,"div",30)(66,"h4",31),t(67,"Testar Configura\xE7\xE3o"),e(),i(68,"div",32)(69,"input",33),w("ngModelChange",function(b){return M(r.testEmail,b)||(r.testEmail=b),b}),e(),i(70,"button",34),x("click",function(){return r.sendTestEmail()}),c(71,Q,2,0)(72,X,2,0),e()(),i(73,"p",35),t(74,"Envie um email de teste para verificar se a configura\xE7\xE3o est\xE1 funcionando"),e()()()()(),i(75,"div",36)(76,"div",7)(77,"h3",8),o(78,"i",37),t(79," Guias de Configura\xE7\xE3o R\xE1pida "),e()(),i(80,"div",11)(81,"div",38)(82,"div",39)(83,"div",40)(84,"div",41),o(85,"i",42),e(),i(86,"h4",43),t(87,"Gmail"),e()(),i(88,"div",44)(89,"p")(90,"strong"),t(91,"Servidor:"),e(),t(92," smtp.gmail.com"),e(),i(93,"p")(94,"strong"),t(95,"Porta:"),e(),t(96," 587"),e(),i(97,"p")(98,"strong"),t(99,"Seguro:"),e(),t(100," Sim"),e(),i(101,"p")(102,"strong"),t(103,"Senha:"),e(),t(104," App Password necess\xE1ria"),e()()(),i(105,"div",39)(106,"div",40)(107,"div",45),o(108,"i",46),e(),i(109,"h4",43),t(110,"Outlook"),e()(),i(111,"div",44)(112,"p")(113,"strong"),t(114,"Servidor:"),e(),t(115," smtp-mail.outlook.com"),e(),i(116,"p")(117,"strong"),t(118,"Porta:"),e(),t(119," 587"),e(),i(120,"p")(121,"strong"),t(122,"Seguro:"),e(),t(123," Sim"),e(),i(124,"p")(125,"strong"),t(126,"Auth:"),e(),t(127," STARTTLS"),e()()(),i(128,"div",39)(129,"div",40)(130,"div",47),o(131,"i",48),e(),i(132,"h4",43),t(133,"Outros"),e()(),i(134,"div",44)(135,"p")(136,"strong"),t(137,"Porta 25:"),e(),t(138," N\xE3o segura"),e(),i(139,"p")(140,"strong"),t(141,"Porta 465:"),e(),t(142," SSL"),e(),i(143,"p")(144,"strong"),t(145,"Porta 587:"),e(),t(146," TLS"),e(),i(147,"p")(148,"strong"),t(149,"Porta 2525:"),e(),t(150," Alternativa"),e()()()()()()()()),a&2){let d;m(2),p("disabled",r.isSaving()||r.smtpForm.invalid),m(),g(r.isSaving()?3:4),m(3),g(r.successMessage()?6:-1),m(),g(r.errorMessage()?7:-1),m(9),p("formGroup",r.smtpForm),m(31),p("placeholder",((d=r.currentCompany())==null?null:d.name)||"Nome da Empresa"),m(22),y("ngModel",r.testEmail),p("ngModelOptions",_(10,U)),m(),p("disabled",r.isTesting()||!r.testEmail||r.smtpForm.invalid),m(),g(r.isTesting()?71:72)}},dependencies:[T,L,D,P,G,N,F,k,O,A,I,q,W],styles:["[_nghost-%COMP%]{display:block}"]})};export{B as SmtpConfigComponent};
