import{a as N}from"./chunk-6ZWZNKWQ.js";import{a as de}from"./chunk-4RPGT7VY.js";import{G as re,H as ne,K as ae,M as T,g as D,j as X,m as Z,n as ee,r as te,u as ie,v as oe}from"./chunk-XFXMLSII.js";import{S as V}from"./chunk-4U6ZKXZY.js";import{Ab as n,Bb as a,Cb as p,Db as S,Eb as v,Fb as q,Fc as H,Jb as w,Kb as Q,Lb as b,Lc as B,Mb as z,Nb as s,Ob as R,Pb as W,Qb as K,Rb as $,Sa as U,Sb as G,Ta as l,Ub as J,Xb as d,Yb as Y,Zb as g,ac as P,bb as M,bc as F,cc as j,da as f,f as C,gb as k,ja as m,jb as L,ka as u,ub as _,vb as h,xb as O,yb as A,zb as x}from"./chunk-O3JLSHCU.js";function me(i,t){if(i&1&&(n(0,"div",21),d(1),a()),i&2){let e=s(2);l(),g(" ",e.errorMessage," ")}}function ue(i,t){i&1&&p(0,"div",22)}function pe(i,t){if(i&1){let e=w();n(0,"div",1),b("click",function(r){m(e);let c=s();return u(c.onBackdropClick(r))}),n(1,"div",2)(2,"div",3)(3,"h2",4),d(4,"Novo Quadro Kanban"),a(),n(5,"button",5),b("click",function(){m(e);let r=s();return u(r.hide())}),d(6," \xD7 "),a()(),n(7,"form",6),b("ngSubmit",function(){m(e);let r=s();return u(r.createBoard())}),n(8,"div")(9,"label",7),d(10," Nome do Quadro * "),a(),n(11,"input",8),j("ngModelChange",function(r){m(e);let c=s();return F(c.boardName,r)||(c.boardName=r),u(r)}),a()(),n(12,"div")(13,"label",9),d(14," Descri\xE7\xE3o (Opcional) "),a(),n(15,"textarea",10),j("ngModelChange",function(r){m(e);let c=s();return F(c.boardDescription,r)||(c.boardDescription=r),u(r)}),a()(),k(16,me,2,1,"div",11),n(17,"div",12)(18,"div",13),p(19,"i",14),n(20,"div",15)(21,"strong"),d(22,"O quadro ser\xE1 criado com:"),a(),n(23,"ul",16)(24,"li"),d(25,'1 coluna inicial "Novo Lead"'),a(),n(26,"li"),d(27,"Campos padr\xE3o para leads (Empresa, CNPJ, Contato, etc.)"),a()()()()(),n(28,"div",17)(29,"button",18),b("click",function(){m(e);let r=s();return u(r.hide())}),d(30," Cancelar "),a(),n(31,"button",19),k(32,ue,1,0,"div",20),d(33),a()()()()()}if(i&2){let e=s();l(5),x("disabled",e.isLoading),l(6),P("ngModel",e.boardName),x("disabled",e.isLoading),l(4),P("ngModel",e.boardDescription),x("disabled",e.isLoading),l(),x("ngIf",e.errorMessage),l(13),x("disabled",e.isLoading),l(2),x("disabled",e.isLoading||!e.boardName.trim()),l(),x("ngIf",e.isLoading),l(),g(" ",e.isLoading?"Criando...":"Criar Quadro"," ")}}var E=class i{authService=f(V);firestoreService=f(N);boardCreated=new L;closeModal=new L;boardName="";boardDescription="";isLoading=!1;errorMessage="";isVisible=!1;show(){this.isVisible=!0,this.resetForm()}hide(){this.isVisible=!1,this.closeModal.emit()}resetForm(){this.boardName="",this.boardDescription="",this.errorMessage="",this.isLoading=!1}createBoard(){return C(this,null,function*(){if(!this.boardName.trim()){this.errorMessage="Nome do quadro \xE9 obrigat\xF3rio";return}let t=this.authService.getCurrentUser();if(!t){this.errorMessage="Usu\xE1rio n\xE3o autenticado";return}this.isLoading=!0,this.errorMessage="";try{let e={name:this.boardName.trim(),description:this.boardDescription.trim(),companyId:"",createdAt:null},o=yield this.firestoreService.createBoard(t.uid,e);yield this.firestoreService.updateBoard(t.uid,o.id,{ownerEmail:t.email||""});let r=[{name:"companyName",label:"Nome da Empresa",type:"text",required:!0},{name:"cnpj",label:"CNPJ",type:"cnpj",required:!0},{name:"contactName",label:"Nome Contato",type:"text",required:!0},{name:"contactEmail",label:"Email Contato",type:"email",required:!0},{name:"contactPhone",label:"Telefone Contato",type:"tel",required:!0}];yield this.firestoreService.createColumn(t.uid,o.id,{name:"Novo Lead",order:0,color:"#4A90E2",endStageType:"none",companyId:""}),this.boardCreated.emit(),this.hide()}catch(e){console.error("Erro ao criar quadro:",e),this.errorMessage="Erro ao criar quadro. Tente novamente."}finally{this.isLoading=!1}})}onBackdropClick(t){t.target===t.currentTarget&&this.hide()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=M({type:i,selectors:[["app-create-board-modal"]],outputs:{boardCreated:"boardCreated",closeModal:"closeModal"},decls:1,vars:1,consts:[["class","fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",3,"click",4,"ngIf"],[1,"fixed","inset-0","bg-black","bg-opacity-50","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","rounded-xl","shadow-2xl","w-full","max-w-md","p-6"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-gray-400","hover:text-gray-600","text-2xl","font-bold",3,"click","disabled"],[1,"space-y-4",3,"ngSubmit"],["for","boardName",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","boardName","name","boardName","placeholder","Ex: Vendas 2024","maxlength","100","required","",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors",3,"ngModelChange","ngModel","disabled"],["for","boardDescription",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","boardDescription","name","boardDescription","rows","3","placeholder","Descreva o prop\xF3sito deste quadro...","maxlength","500",1,"w-full","p-3","border","border-gray-300","rounded-lg","focus:ring-2","focus:ring-blue-500","focus:border-blue-500","transition-colors","resize-none",3,"ngModelChange","ngModel","disabled"],["class","text-red-500 text-sm",4,"ngIf"],[1,"bg-blue-50","border","border-blue-200","rounded-lg","p-3"],[1,"flex","items-start"],[1,"fas","fa-info-circle","text-blue-500","mt-0.5","mr-2"],[1,"text-sm","text-blue-700"],[1,"mt-1","ml-2","list-disc"],[1,"flex","justify-end","gap-3","pt-4"],["type","button",1,"px-4","py-2","text-gray-700","bg-gray-200","hover:bg-gray-300","rounded-lg","font-medium","transition-colors",3,"click","disabled"],["type","submit",1,"px-6","py-2","bg-blue-500","hover:bg-blue-600","disabled:bg-blue-300","text-white","rounded-lg","font-medium","transition-colors","flex","items-center",3,"disabled"],["class","animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2",4,"ngIf"],[1,"text-red-500","text-sm"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-white","mr-2"]],template:function(e,o){e&1&&k(0,pe,34,10,"div",0),e&2&&x("ngIf",o.isVisible)},dependencies:[B,H,ae,oe,X,Z,ee,re,ne,ie,te],styles:[".fixed[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .2s ease-out}.bg-white[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideUp .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}"]})};var be=["*"];function ge(i,t){if(i&1&&q(0,"img",6),i&2){let e=s();Q("src",e.companyLogo,U)("alt","Logo "+e.companyName)}}function fe(i,t){if(i&1&&(S(0,"div",11),d(1),v()),i&2){let e=s();J("background-color",e.primaryColor),l(),g(" ",e.getCompanyInitials()," ")}}function xe(i,t){if(i&1&&(S(0,"p",9),d(1),v()),i&2){let e=s();l(),Y(e.subtitle)}}var I=class i{title="Meus quadros Kanban";subtitle;subdomainService=f(T);router=f(D);get companyName(){return this.subdomainService.getCurrentCompany()?.name||"Task Board"}get companyLogo(){let t=this.subdomainService.getCurrentCompany();return t?.brandingConfig?.logo&&t.brandingConfig.logo.trim()!==""?t.brandingConfig.logo:t?.subdomain==="gobuyer"?"https://apps.gobuyer.com.br/sso/assets/images/logos/logo-gobuyer.png":""}hasCustomLogo(){let t=this.subdomainService.getCurrentCompany();return!!(t?.brandingConfig?.logo&&t.brandingConfig.logo.trim()!==""||t?.subdomain==="gobuyer")}get primaryColor(){return this.subdomainService.getCurrentCompany()?.brandingConfig?.primaryColor||"#3B82F6"}getCompanyInitials(){let t=this.companyName;if(!t||t==="Task Board")return"TB";let e=t.split(" ").filter(o=>o.length>0);return e.length===1?e[0].charAt(0).toUpperCase():e.length>=2?e[0].charAt(0).toUpperCase()+e[1].charAt(0).toUpperCase():"TB"}goBack(){let t=this.router.url;t.includes("/empresa/")||t.includes("/usuarios")?this.router.navigate(["/dashboard"]):window.history.back()}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=M({type:i,selectors:[["app-company-breadcrumb"]],inputs:{title:"title",subtitle:"subtitle"},ngContentSelectors:be,decls:14,vars:3,consts:[[1,"bg-gray-50","border-b","border-gray-200"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-4"],[1,"flex","items-center","space-x-4"],[1,"flex","items-center","space-x-3"],[1,"text-gray-500","hover:text-gray-700","p-1","rounded","hover:bg-gray-100","transition-colors",3,"click"],[1,"fas","fa-arrow-left"],[1,"h-10","w-auto","rounded",3,"src","alt"],[1,"h-10","w-10","rounded-lg","flex","items-center","justify-center","text-white","font-bold",3,"background-color"],[1,"text-lg","font-semibold","text-gray-900"],[1,"text-sm","text-gray-600"],[1,"flex-1","flex","justify-end"],[1,"h-10","w-10","rounded-lg","flex","items-center","justify-center","text-white","font-bold"]],template:function(e,o){e&1&&(R(),S(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"button",4),z("click",function(){return o.goBack()}),q(5,"i",5),v(),_(6,ge,1,2,"img",6)(7,fe,2,3,"div",7),S(8,"div")(9,"h2",8),d(10),v(),_(11,xe,2,1,"p",9),v()(),S(12,"div",10),W(13),v()()()()),e&2&&(l(6),h(o.hasCustomLogo()?6:7),l(4),g(" ",o.title," "),l(),h(o.subtitle?11:-1))},dependencies:[B],styles:["[_nghost-%COMP%]{display:block}"]})};var Ce=(i,t)=>t.id;function _e(i,t){i&1&&(n(0,"div",5)(1,"div",8),p(2,"i",9),n(3,"p",10),d(4,"Carregando seus quadros..."),a()()())}function he(i,t){if(i&1){let e=w();n(0,"div",6)(1,"div",11),p(2,"i",12),a(),n(3,"h3",13),d(4,"Nenhum quadro encontrado"),a(),n(5,"p",14),d(6,"Crie seu primeiro quadro Kanban para come\xE7ar a organizar suas tarefas."),a(),n(7,"button",15),b("click",function(){m(e);let r=s();return u(r.showCreateBoardModal())}),p(8,"i",3),d(9," Criar Primeiro Quadro "),a()()}}function ye(i,t){if(i&1&&(n(0,"p",22),d(1),a()),i&2){let e=s().$implicit;l(),g(" ",e.description," ")}}function ve(i,t){if(i&1){let e=w();n(0,"div",26)(1,"div",33)(2,"button",34),b("click",function(r){m(e);let c=s().$implicit,y=s(2);return r.stopPropagation(),u(y.editBoard(c))}),p(3,"i",35),d(4," Editar "),a(),n(5,"button",34),b("click",function(r){m(e);let c=s().$implicit,y=s(2);return r.stopPropagation(),u(y.duplicateBoard(c))}),p(6,"i",36),d(7," Duplicar "),a(),p(8,"hr",37),n(9,"button",38),b("click",function(r){m(e);let c=s().$implicit,y=s(2);return r.stopPropagation(),u(y.deleteBoard(c.id))}),p(10,"i",39),d(11," Excluir "),a()()()}}function we(i,t){if(i&1){let e=w();n(0,"div",17),b("click",function(){let r=m(e).$implicit,c=s(2);return u(c.openBoard(r.id))}),n(1,"div",18)(2,"div",19)(3,"div",20)(4,"h3",21),d(5),a(),_(6,ye,2,1,"p",22),a(),n(7,"div",23)(8,"button",24),b("click",function(r){let c=m(e).$implicit,y=s(2);return r.stopPropagation(),u(y.toggleBoardMenu(c.id))}),p(9,"i",25),a(),_(10,ve,12,0,"div",26),a()()(),n(11,"div",27)(12,"div",28)(13,"div",29)(14,"span",10),p(15,"i",30),d(16),a(),n(17,"span",10),p(18,"i",31),d(19),a()(),n(20,"div",32),d(21),a()()()()}if(i&2){let e=t.$implicit,o=s(2);l(5),g(" ",e.name," "),l(),h(e.description?6:-1),l(4),h(o.activeBoardMenu===e.id?10:-1),l(6),g(" ",o.getBoardColumnCount(e.id)," colunas "),l(3),g(" ",o.getBoardTaskCount(e.id)," leads "),l(2),g(" ",o.formatDate(e.createdAt)," ")}}function Me(i,t){if(i&1&&(n(0,"div",7),O(1,we,22,6,"div",16,Ce),a()),i&2){let e=s();l(),A(e.boards)}}function Se(i,t){if(i&1){let e=w();n(0,"app-create-board-modal",40,0),b("boardCreated",function(r){m(e);let c=s();return u(c.onBoardCreated(r))})("modalClosed",function(){m(e);let r=s();return u(r.showCreateModal=!1)}),a()}}var ce=class i{authService=f(V);firestoreService=f(N);subdomainService=f(T);router=f(D);createBoardModal;boards=[];isLoading=!1;currentUser=null;showConfigMenu=!1;showCreateModal=!1;activeBoardMenu=null;subscription;ngOnInit(){return C(this,null,function*(){this.currentUser=this.authService.getCurrentUser(),this.currentUser&&(this.currentUser.email?.includes("gobuyer.com.br")&&(yield this.ensureGobuyerContext()),yield this.loadBoards())})}ensureGobuyerContext(){return C(this,null,function*(){try{this.subdomainService.getCurrentCompany()||(this.subdomainService.isDevelopment()&&localStorage.setItem("dev-subdomain","gobuyer"),yield this.subdomainService.initializeFromSubdomain())}catch{}})}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}loadBoards(){return C(this,null,function*(){if(this.currentUser){this.isLoading=!0;try{this.boards=yield this.firestoreService.getBoards(this.currentUser.uid)}catch{}finally{this.isLoading=!1}}})}logout(){return C(this,null,function*(){(yield this.authService.logout()).success&&(window.location.href="/login")})}openBoard(t){let e=this.boards.find(o=>o.id===t);e&&e.owner?this.router.navigate(["/kanban",t],{queryParams:{ownerId:e.owner}}):this.router.navigate(["/kanban",t],{queryParams:{ownerId:this.currentUser.uid}})}formatDate(t){return t?t.seconds?new Date(t.seconds*1e3).toLocaleDateString("pt-BR"):new Date(t).toLocaleDateString("pt-BR"):""}showCreateBoardModal(){this.showCreateModal=!0}onBoardCreated(t){this.loadBoards(),this.showCreateModal=!1}toggleBoardMenu(t){this.activeBoardMenu=this.activeBoardMenu===t?null:t}editBoard(t){console.log("Editar quadro:",t),this.activeBoardMenu=null}duplicateBoard(t){console.log("Duplicar quadro:",t),this.activeBoardMenu=null}deleteBoard(t){return C(this,null,function*(){if(confirm("Tem certeza que deseja excluir este quadro?"))try{yield this.firestoreService.deleteBoard(this.currentUser.uid,t),yield this.loadBoards()}catch(e){console.error("Erro ao excluir quadro:",e)}this.activeBoardMenu=null})}getBoardColumnCount(t){return 3}getBoardTaskCount(t){return 0}toggleConfigMenu(){this.showConfigMenu=!this.showConfigMenu}closeConfigMenu(){this.showConfigMenu=!1}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=M({type:i,selectors:[["app-dashboard"]],viewQuery:function(e,o){if(e&1&&K(E,5),e&2){let r;$(r=G())&&(o.createBoardModal=r.first)}},decls:10,vars:2,consts:[["createBoardModal",""],["title","Meus quadros Kanban"],[1,"bg-blue-500","hover:bg-blue-600","text-white","px-4","py-2","rounded-lg","text-sm","font-medium","transition-colors","flex","items-center",3,"click"],[1,"fas","fa-plus","mr-2"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"flex","items-center","justify-center","py-12"],[1,"text-center","py-12"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-6"],[1,"text-center"],[1,"fas","fa-spinner","fa-spin","text-4xl","text-gray-400","mb-4"],[1,"text-gray-600"],[1,"w-24","h-24","mx-auto","bg-gray-100","rounded-full","flex","items-center","justify-center","mb-4"],[1,"fas","fa-th-large","text-3xl","text-gray-400"],[1,"text-lg","font-semibold","text-gray-900","mb-2"],[1,"text-gray-600","mb-6"],[1,"bg-blue-500","hover:bg-blue-600","text-white","px-6","py-3","rounded-lg","font-medium","transition-colors",3,"click"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","hover:shadow-md","transition-shadow","cursor-pointer","group"],[1,"bg-white","rounded-lg","shadow-sm","border","border-gray-200","hover:shadow-md","transition-shadow","cursor-pointer","group",3,"click"],[1,"p-6","border-b","border-gray-100"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"font-semibold","text-gray-900","group-hover:text-blue-600","transition-colors"],[1,"text-sm","text-gray-600","mt-1","line-clamp-2"],[1,"relative","ml-4"],[1,"opacity-0","group-hover:opacity-100","p-1","text-gray-400","hover:text-gray-600","transition-all",3,"click"],[1,"fas","fa-ellipsis-v"],[1,"absolute","right-0","mt-2","w-48","bg-white","rounded-md","shadow-lg","ring-1","ring-black","ring-opacity-5","z-10"],[1,"p-4","bg-gray-50"],[1,"flex","items-center","justify-between","text-sm"],[1,"flex","items-center","space-x-4"],[1,"fas","fa-columns","mr-1"],[1,"fas","fa-tasks","mr-1"],[1,"text-xs","text-gray-500"],[1,"py-1"],[1,"w-full","text-left","px-4","py-2","text-sm","text-gray-700","hover:bg-gray-100",3,"click"],[1,"fas","fa-edit","mr-2"],[1,"fas","fa-copy","mr-2"],[1,"my-1"],[1,"w-full","text-left","px-4","py-2","text-sm","text-red-700","hover:bg-red-50",3,"click"],[1,"fas","fa-trash","mr-2"],[3,"boardCreated","modalClosed"]],template:function(e,o){e&1&&(n(0,"app-main-layout")(1,"app-company-breadcrumb",1)(2,"button",2),b("click",function(){return o.showCreateBoardModal()}),p(3,"i",3),d(4," Novo Quadro "),a()(),n(5,"div",4),_(6,_e,5,0,"div",5)(7,he,10,0,"div",6)(8,Me,3,0,"div",7),a(),_(9,Se,2,0,"app-create-board-modal"),a()),e&2&&(l(6),h(o.isLoading?6:o.boards.length===0?7:8),l(3),h(o.showCreateModal?9:-1))},dependencies:[B,E,de,I],styles:[".line-clamp-2[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}"]})};export{ce as DashboardComponent};
