{"version":3,"sources":["index.js","../src/mentioncommand.ts","../src/mentionediting.ts","../src/ui/mentionsview.ts","../src/ui/domwrapperview.ts","../src/ui/mentionlistitemview.ts","../src/mentionui.ts","../src/mention.ts"],"names":["BRACKET_PAIRS","MentionCommand","Command","refresh","model","editor","doc","document","isEnabled","schema","checkAttributeInSelection","selection","execute","options","mentionData","mention","id","mentionID","range","getFirstRange","canEditAt","mentionText","text","_addMentionAttributes","_text","marker","length","CKEditorError","charAt","change","writer","currentAttributes","toMap","getAttributes","attributesWithMention","Map","entries","set","insertionRange","insertContent","createText","nodeBefore","start","nodeAfter","end","isFollowedByWhiteSpace","is","data","startsWith","isInsertedInBrackets","precedingCharacter","slice","isPrecededByOpeningBracket","isFollowedByBracketClosure","getShiftedBy","constructor","_isEnabledBasedOnSelection","MentionEditing","Plugin","pluginName","init","extend","allowAttributes","conversion","for","elementToAttribute","view","name","key","classes","value","viewElement","_toMentionAttribute","attributeToElement","createViewMentionElement","add","preventPartialMentionDowncast","registerPostFixer","removePartialMentionPostFixer","extendAttributeOnMentionPostFixer","selectionMentionAttributePostFixer","commands","baseMentionData","Object","assign","uid","viewElementOrMention","dataMention","getAttribute","textNode","getChild","dispatcher","on","evt","conversionApi","attributeNewValue","item","consumable","consume","priority","attributes","class","createAttributeElement","focus","isCollapsed","hasAttribute","shouldNotTypeWithMentionAt","removeSelectionAttribute","position","isAtStart","isAfterAMention","changes","differ","getChanges","wasChanged","type","nodeAfterInsertedTextNode","nextSibling","checkAndFix","insertedNode","createRangeIn","getItems","isInline","nodeAfterInserted","attributeKey","node","isBrokenMentionNode","setAttribute","expectedText","removeAttribute","MentionsView","ListView","selectFirst","select","selectNext","selected","index","items","getIndex","selectPrevious","indexToGet","get","removeHighlight","highlight","_isItemVisibleInScrolledArea","element","scrollTop","offsetTop","executeSelected","fire","Rect","contains","locale","extendTemplate","tabindex","DomWrapperView","View","render","domElement","template","undefined","classList","isOn","remove","listenTo","MentionListItemView","ListItemView","child","children","first","VERTICAL_SPACING","defaultHandledKeyCodes","keyCodes","arrowup","arrowdown","esc","defaultCommitKeyCodes","enter","tab","MentionUI","requires","ContextualBalloon","commitKeys","config","handledKeyCodes","concat","_balloon","plugins","editing","isHandledKey","keyCode","_isUIVisible","preventDefault","stop","_mentionsView","includes","_hideUIAndRemoveMarker","clickOutsideHandler","emitter","activator","contextElements","callback","feeds","mentionDescription","feed","dropdownLimit","isValidMentionMarker","feedCallback","bind","createFeedCallback","itemRenderer","definition","_mentionsConfigurations","_setupTextWatcher","_handleFeedResponse","destroy","visibleView","_createMentionView","mentionsView","bindTo","_items","using","markerDropdownLimit","listItemView","_renderItem","delegate","to","mentionMarker","markers","createPositionAt","getStart","createRange","_getItemRenderer","_requestFeed","feedText","_lastRequested","feedResponse","isAsynchronous","Promise","then","response","catch","error","logWarning","feedsWithPattern","map","pattern","createRegExp","minimumCharacters","watcher","TextWatcher","createTestCallback","markerDefinition","getLastValidMarkerInText","markerPosition","parent","isPositionInExistingMention","isMarkerInExistingMention","requestFeedText","matchedTextLength","markerRange","checkIfStillInCompletionMode","updateMarker","addMarker","usingOperation","affectsData","_requestFeedDebounced","mentionCommand","clear","feedItem","_showOrUpdateUI","markerMarker","updatePosition","_getBalloonPanelPositionData","singleViewMode","hasView","removeMarker","label","renderer","renderResult","buttonView","ButtonView","withText","preferredPosition","domConverter","mapper","uiLanguageDirection","target","modelRange","getRange","root","rootName","viewRange","toViewRange","rangeRects","getDomRangeRects","viewRangeToDom","pop","limiter","viewDocument","editableElement","mapViewToDom","positions","getBalloonPanelPositions","Collection","debounce","define","targetRect","top","bottom","left","right","withArrow","balloonRect","height","width","prototype","hasOwnProperty","call","caret_se","caret_sw","caret_ne","caret_nw","lastValidMarker","currentMarkerLastIndex","lastIndexOf","substring","match","numberOfCharacters","openAfterCharacters","env","features","isRegExpUnicodePropertySupported","mentionCharacters","RegExp","textMatcher","splitStringFrom","textToTest","test","regExp","textToMatch","feedItems","filteredItems","filter","itemId","String","toLowerCase","hasMention","has","Mention","toMentionAttribute"],"mappings":"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